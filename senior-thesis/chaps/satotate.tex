% !TEX root = ../thesis.tex

\documentclass[../thesis.tex]{subfiles}

\begin{document}

\chapter{The Sato--Tate Conjecture}
Now that we have a good handle on monodromy groups, we describe one of their applications: the Sato--Tate conjecture. These notions are not central for the results we want to prove, so we will be somewhat sketchy throughout.

\section{The Statement} \label{sec:sato-tate}
In this section, we state the Sato--Tate conjecture, and then we explain how it can be numerically verified in some cases.

\subsection{The Weil Conjectures}
Roughly speaking, the Sato--Tate conjecture is about counting points on an abelian variety $A$ over finite fields $\FF_q$ as $q$ varies. In this subsection, we will briefly describe the Weil conjectures because they explain why these point-counts ought to be related to cohomology; these conjectures are now theorems due to Deligne \cite{deligne-weil-1,deligne-weil-2}.
\begin{theorem}[Weil conjectures] \label{thm:weil-conj}
	Fix a smooth projective variety $X$ over a finite field $\FF_q$ of dimension $n$. Consider the formal power series.
	\[\zeta_X(T)\coloneqq\exp\Bigg(\sum_{r=1}^\infty\#X\left(\FF_{q^r}\right)\frac{T^r}r\Bigg)\]
	\begin{listalph}
		\item Rationality: one can write
		\[\zeta_X(T)=\frac{P_1(T)\cdots P_{2n-1}(T)}{P_2(T)\cdots P_{2n}(T)}\]
		for polynomials $P_\bullet(T)\in 1+T\ZZ[T]$.
		\item Riemann hypothesis: the roots of the polynomial $P_\bullet(T)$ are complex numbers with roots of magnitude $q^{-\bullet/2}$.
		% \item Betti numbers: suppose $X$ is the reduction of a smooth projective variety $\mc X$ defined over a number ring $\OO_K$. Then $\deg P_\bullet=\dim_\CC\mathrm H_{\mathrm B}^\bullet(\mc X(\CC),\CC)$.
	\end{listalph}
\end{theorem}
It is worth explaining a bit of the proof of these conjectures for abelian varieties. Our exposition is an abbreviated form of the exposition in (say) \cite[Chapter~II]{milne-av}.

Fix an abelian variety $A$ of dimension $g$ over a finite field $\FF_q$. The main point is to find a way to compute $\#A(\FF_q)$, and then \Cref{thm:weil-conj} will follow. Viewing $A(\FF_q)$ is the set of fixed (geometric) points of the Frobenius endomorphism $\op{Frob}_q\colon A\to A$, one would like to use the Lefschetz fixed point formula to conclude. In particular, we should be able to read off the value of $\#A(\FF_q)$ from a suitably defined characteristic polynomial of $\mathrm{Frob}_{\mf p}$.

To be explicit, one finds that the characteristic polynomial $P(T)$ of $\mathrm{Frob}_{\mf p}$ acting on $\mathrm H^1_{\mathrm{\acute et}}(A_{\ov{\FF_q}},\QQ_\ell)$ satisfies
\[P(1)=\#A(\FF_q).\]
Thus, by factoring $P(T)=\prod_{i=1}^{2g}(T-\alpha_i)$, one finds that
\[\#A(\FF_{q^r})=\prod_{i=1}^{2g}\left(1-\alpha_i^r\right),\]
which proves the rationality conjecture of \Cref{thm:weil-conj} after some manipulation. In brief, one finds that $P(T)=P_1(T)$, and in general, the polynomial $P_i(T)$ has roots given by multiplying $i$ of the roots in the set $\{\alpha_1,\ldots,\alpha_{2g}\}$ together.
\begin{remark}
	Comparing the previous paragaph with the proof of the rationality conjecture from the Lefschetz trace formula
	\[\#A(\FF_q)=\sum_{i=0}^{2g}(-1)^i\tr\left(\mathrm{Frob}_q\mid\mathrm H^i_{\mathrm{\acute et}}(A_{\overline{\FF_q}},\QQ_\ell)\right),\]
	one sees that what allows us to recover all the polynomials $P_\bullet(T)$ from merely $P_1(T)$ is that the higher cohomology of $A$ is generated by the cohomology in degree $1$ by \Cref{prop:cohom-ring-av}.
\end{remark}
It remains to prove the Riemann hypothesis conjecture of \Cref{thm:weil-conj}. This amounts to checking that the roots of $P(T)$ have magnitude $1/\sqrt p$, which eventually corresponds to the following fact.
\begin{proposition} \label{prop:frob-multiplier}
	Fix an abelian variety $A$ over a finite field $\FF_q$, and consider the induced Frobenius endomorphism $\mathrm{Frob}_q$. Then
	\[\mathrm{Frob}_q\circ\mathrm{Frob}_q^\dagger=[q]_A.\]
\end{proposition}
\begin{proof}
	Proving this requires more tools than we would like to introduce at this time, so we refer to \cite[Lemma~III.1.2]{milne-av}.
\end{proof}

\subsection{The Sato--Tate Group}
In this section, we will define the Sato--Tate group and state the Sato--Tate conjecture. Our exposition loosely follows \cite{sutherland-sato-tate}. Fix an abelian variety $A$ defined over a number field $K$, and choose a prime $\ell$. We also let $\rho_\ell\colon\op{Gal}(\ov K/K)\to\op{GL}\left(\mathrm H^1_{\mathrm{\acute et}}(A_{\ov K},\QQ_\ell)\right)$ denote the associated Galois representation.

Intuitively, the Sato--Tate conjecture asserts that the Frobenius elements $\rho_\ell(\mathrm{Frob}_{\mf p})$ equidistribute in $G_\ell(A)$ as $\mf p$ varies over the maximal ideals of $\OO_K$. This conjecture does not make sense verbatim, so we will have to work a bit to write down something formal. Consider the following points.
\begin{itemize}
	\item To begin, we note that $\mathrm{Frob}_{\mf p}$ only makes sense as a conjugacy class, and it only makes sense as a conjugacy class when $\rho_\ell$ vanishes on the relevant inertia subgroup of $\op{Gal}(\ov K/K)$.
	
	Two remarks are thus in order. First, to vanish on the inertia subgroup, we must exclude a finite set of primes $\mf p$ where $A$ has bad reduction. (We are using the N\'eron--Ogg--Shafarevich criterion \cite[Theorem~5]{bosch-neron-models}.) Second, we will simply regard $\rho_\ell(\mathrm{Frob}_{\mf p})$ as a conjugacy class as well. Thus, we really want to say that conjugacy classes equidistribute in a suitable space of conjugacy classes.

	\item It turns out that $\rho_\ell(\mathrm{Frob}_{\mf p})$ is not a totally random element of $G_\ell(A)$. Indeed, by \Cref{prop:frob-multiplier}, we see that the multiplier of $\mathrm{Frob}_{\mf p}$ acting on $\mathrm H^1_{\mathrm{\acute et}}(A_{\ov K},\QQ_\ell)$ equals $\op N(\mf p)$. Thus, we would like to rescale $\mathrm{Frob}_{\mf p}$ back down by $1/\sqrt{\op N(\mf p)}$.
	
	Once again, this requires two remarks. First, after rescaling, we will be working in the smaller subgroup
	\[G_\ell^1(A)\coloneqq G_\ell(A)\cap\op{Sp}(e_\varphi),\]
	where $\varphi$ is a choice of polarization on $A$. Second, the rescaling cannot happen in $\QQ_\ell$ because $\QQ_\ell$ does not have enough square roots. As such, we must choose an embedding $\iota\colon\QQ_\ell\into\CC$, allowing us to consider the elements $\frac1{\sqrt{\op N(\mf p)}}\iota\rho_\ell(\mathrm{Frob}_{\mf p})$ in the complex Lie group $G_\ell^1(A)_\iota(\CC)$.\footnote{Another reason for passing to $\CC$ is that groups in $\CC$ have access to a good measure theory.}

	\item Another piece of structure to keep track of is that $\rho_\ell(\mathrm{Frob}_{\mf p})$ is semisimple (see \Cref{rem:frob-semisimple}). This means that the subgroup topological generated by $\frac1{\sqrt{\op N(\mf p)}}\iota\rho_\ell(\mathrm{Frob}_{\mf p})$ (which we now see has all eigenvalues equal to $1$ after the normalization in the previous step) will be compact! A standard result in the structure theory of complex Lie groups is that they have maximal compact subgroups unique up to conjugacy, so one can find an element in our conjugacy class $\frac1{\sqrt{\op N(\mf p)}}\iota\rho_\ell(\mathrm{Frob}_{\mf p})$ in any given maximal compact subgroup of $G_\ell^1(A)_\iota(\CC)$.
\end{itemize}
With the above preparations, we are now ready to state the Sato--Tate conjecture.
\begin{definition}[Sato--Tate group]
	Fix an abelian variety $A$ defined over a number field $K$, and choose a prime $\ell$ and an embedding $\iota\colon\QQ_\ell\into\CC$. Then we define the \textit{Sato--Tate group} $\op{ST}(A)$ to be a maximal compact subgroup of the complex Lie group $G_\ell^1(A)_\iota$, where $G_\ell^1(A)$ is the subset of $G_\ell(A)$ with multiplier equal to $1$.
\end{definition}
\begin{conj}[Sato--Tate] \label{conj:st}
	Fix an abelian variety $A$ defined over a number field $K$, and choose a prime $\ell$ and an embedding $\iota\colon\QQ_\ell\into\CC$. For each nonzero prime ideal $\mf p$ of $K$ such that $A$ has good reduction at $\mf p$, choose the conjugacy class $x_{\mf p}\in\op{Conj}(\op{ST}(A))$ containing the conjugacy class $\frac1{\sqrt{\op N(\mf p)}}\iota\rho_\ell(\mathrm{Frob}_{\mf p})$. Then the conjugacy classes $\{x_{\mf p}\}$ equidistribute with respect to the pushforward of the Haar measure along $\op{ST}(A)\to\op{Conj}(\op{ST}(A))$.
\end{conj}
The relevance of the Sato--Tate conjecture for us is that it will let us numerically check that we have the correct $\ell$-adic monodromy group; precisely how this is done will be explained in the subsequent subsections.

We will spend the rest of the present subsection making some remarks about \Cref{conj:st}.
\begin{remark}
	Not much is known about \Cref{conj:st}. Roughly speaking, all known proofs prove something akin to modularity for not just the Galois representation attached to $A$ but also its symmetric powers (and maybe more!).
	\begin{itemize}
		\item If $A$ has complex multiplication, then this essentially follows from the Fundamental theorem of complex multiplication.
		\item For elliptic curves, the state of the art is \cite{bgtt-potential-automorphy,bgdht-potential-automorphy-2}, where the Sato--Tate conjecture is proven for elliptic curves over totally real and CM fields.
		\item These potential automorphy techniques were extended to some classes of abelian varieties by Johansson in \cite[Theorem~1]{johansson-sato-tate}.
	\end{itemize}
\end{remark}
One obnoxious defect of \Cref{conj:st} is that we must make choices regarding $\ell$ and $\iota$. The choice $\iota$ is not so egregious because everything ought to descend to something algebraic, but it is quite unclear that $\op{ST}(A)$ and even $G_\ell^1(A)$ does not depend crucially on $\ell$. One expects $G_\ell(A)^\circ$ to not depend on $\ell$ by the Mumford--Tate conjecture (\Cref{conj:mt}). The relevant conjecture for the full group $G_\ell(A)$ is the Algebraic Sato--Tate conjecture \cite[Conjecture~2.1]{bk-algebraic-st}.
\begin{conj}[Algebraic Sato--Tate] \label{conj:ast}
	Fix an abelian variety $A$ defined over a number field $K$. Then there exists an algerbaic subgroup $\op{AST}(A)\subseteq\op{GL}_{2g}(\QQ)$ such that
	\[\op{AST}(A)_{\QQ_\ell}=G_\ell^1(A)\]
	for all primes $\ell$.
\end{conj}
This conjecture, being similar in spirit to the Mumford--Tate conjecture, has quite a bit known. For example, Banaszak and Kedlaya have shown this conjecture for products of abelian varieties of dimensions at most $3$ \cite[Theorem~6.11]{bk-algebraic-st}. Roughly speaking, their proof boils down to the fact that one has $\op{Hg}(A)=\op L(A)^\circ$ in these small dimensions, which permits a direct computation of $\op{AST}(A)$ along the lines of \Cref{prop:galois-computes-monodromy} (see \Cref{rem:galois-computes-monodromy-finite}).

Remarkably, Farf\'an and Commelin have shown that the Algebraic Sato--Tate conjecture is implied by the Mumford--Tate conjecture in \cite{farfan-commelin-mtc-astc}.
\begin{theorem}[Farf\'an--Commelin] \label{thm:mtc-implies-astc}
	Fix an abelian variety $A$ defined over a number field $K$. If $A$ satisfies the Mumford--Tate conjecture (\Cref{conj:mt}) that $G_\ell(A)^\circ=\op{MT}(A)$ for all primes $\ell$, then $A$ satisfies the Algebraic Sato--Tate conjecture (\Cref{conj:ast}) that there exists an algebraic group $\op{AST}(A)\subseteq\op{GL}_{2g}(\QQ)$ such that $\op{AST}(A)_{\QQ_\ell}=G_\ell^1(A)$ for all primes $\ell$.
\end{theorem}
\begin{proof}
	The proof requires a discussion of Tannakian formalism, so we will not include it. We remark that they actually prove that the Mumford--Tate conjecture is equivalent to a more refined version of the Algebraic Sato--Tate conjecture with $\op{AST}(A)$ equal to the ``motivic Galois group'' of $A$.\todo{Include proof if include abelian motives}
\end{proof}

% define the sato--tate group
% state the conjecture
% discuss some of what is known
% mtc implies astc?

\subsection{Some Examples}
In this subsection, we compute some basic Sato--Tate groups. The general outline is to compute the Hodge or Mumford--Tate groups first, check the Mumford--Tate conjecture to get $G_\ell^\circ$, and then compute some Galois action to get $G_\ell$. We begin with some elliptic curves.
\begin{example}[no complex multiplication] \label{ex:ec-no-cm-st}
	Consider the elliptic curve $E\colon y^2=x^3+x+1$ over $\QQ$. One can compute that $\op{End}_\CC(E)=\ZZ$, so $E$ does not have complex multiplication. Thus, $\op{Hg}(E)\subseteq\op{SL}_{2,\QQ}$ needs to be a connected reductive subgroup which is not a torus (see \Cref{prop:cm-is-mt-torus}); however, the only Lie subalgebras of $\mf{sl}_2(\CC)$ are either commutative or all of $\mf{sl}_2(\CC)$, so we conclude that $\op{Hg}(E)=\op{SL}_{2,\QQ}$. Thus, $\op{MT}(E)=\op{GL}_{2,\QQ}$.
	
	The same computation (with \Cref{rem:cm-is-l-adic-torus}) allows us to conclude that $G_\ell(E)=\op{GL}_{2,\QQ_\ell}$ for all primes $\ell$, thus proving the Mumford--Tate conjecture (\Cref{conj:mt}) in this case. We thus find $G_\ell^1(E)=\op{SL}_{2,\QQ_\ell}$, so upon choosing $\iota\colon\QQ_\ell\into\CC$, we see that $G_\ell^1(E)_\iota=\op{SL}_{2,\CC}$, so choosing a maximal compact subgroup finds $\op{ST}(E)=\op{SU}_2$.
\end{example}
\begin{example}[complex multiplication] \label{ex:cm-ec-st}
	Consider the elliptic curve $E\colon y^2=x^3+1$ over $\QQ(\zeta_3)$. Then we see that $\op{End}_\CC(E)=\ZZ[\zeta_3]$, where $\zeta_3$ acts by $(x,y)\mapsto(\zeta_3x,y)$, so $E$ has complex multiplication. Thus, $\op{Hg}(E)\subseteq\op{SL}_{2,\QQ(\zeta_3)}$ is a torus (by \Cref{prop:cm-is-mt-torus}), but it cannot be trivial (by \Cref{cor:mt-fixes-av-endos}), so we conclude that $\op{Hg}(E)$ is the diagonal torus of $\op{SL}_{2,\QQ(\zeta_3)}$.

	For primes $\ell$ which split completely in $\QQ(\zeta_3)$, the same computation (with \Cref{rem:cm-is-l-adic-torus} and \Cref{cor:l-adic-fixes-endos}) where $\ell$ splits completely in $\QQ_\ell$ reveals $G_\ell(E)=\mathbb G_{m,\QQ_\ell}^2$ equals the diagonal torus in $\op{GL}_{2,\QQ(\zeta_3)}$, proving the Mumford--Tate conjecture (\Cref{conj:mt}) in this case. We thus find $G_\ell^1(E)\cong\mathbb G_{m,\QQ_\ell}$, so upon choosing $\iota\colon\QQ_\ell\into\CC$, we see that $G_\ell^1(E)\cong\mathbb G_{m,\QQ_\ell}$, so choosing a maximal compact subgroup finds $\op{ST}(E)\cong\op U_1$.
\end{example}
\begin{example}[potential complex multiplication] \label{ex:pot-cm-ec-st}
	Consider the elliptic curve $E\colon y^2=x^3+1$ but now over $\QQ$. \Cref{ex:cm-ec-st} computed that $\op{MT}(E)\cong\mathbb G_{m,\QQ}$ and $G_\ell(E)^\circ=\mathbb G_{m,\QQ_\ell}$ (for primes $\ell\equiv1\pmod3$). In this case, we see that there are endomorphisms not defined over $\QQ$ and hence not fixed by $\op{Gal}(\ov\QQ/\QQ)$, so $K_E^{\mathrm{conn}}\ne\QQ$; instead, these endomorphisms are defined over $K_E^{\mathrm{conn}}=\QQ(\zeta_3)$. We thus see that $G_\ell(E)\subseteq\op{GL}_{2,\QQ_\ell}$ normalizes its index-$2$ subgroup $G_\ell(E)^\circ$ (which is the diagonal torus), so $G_\ell(E)$ must be the diagonal torus together with the nontrivial Weyl element in $\op{GL}_{2,\QQ_\ell}$, which we write as $\mathbb G_{m,\QQ_\ell}^2\rtimes S_2$. We thus find $G_\ell^1(E)\cong\mathbb G_{m,\QQ_\ell}\rtimes S_2$, so $\op{ST}(E)\cong\mathrm U_1\rtimes S_2$.
\end{example}
\begin{remark}
	In the above example, we appealed to the fact that the only elements normalizing the diagonal torus are the Weyl elements, which is a bit ad-hoc and will not work in higher dimensions. Roughly speaking, \Cref{prop:galois-computes-monodromy} provides the machine which works in higher dimensions, where we know that the Galois representation now factors through $\op{Gal}(\QQ(\zeta_3)/\QQ)$, and we are allowed to replace $W$ with merely $W_1\oplus W_2$, which can be computed to be generated by the endomorphisms and polarization.
\end{remark}
We take a moment to remark that the above examples generalize to work with all elliptic curves, doing casework on having no complex multiplication, complex multiplication, and potential complex multiplication.

We now introduce the main example of the present thesis.
\begin{proposition} \label{prop:generic-fermat-st}
	Fix $\lambda\in\CC\setminus\{0,1\}$, and define $A$ to be the Jacobian of the normalization of the proper curve $C$ with affine chart $y^9=x(x-1)(x-\lambda)$. If $A$ does not have complex multiplication, then
	\[\begin{cases}
		\op{MT}(A)^{\mathrm{der}}_\CC\cong\op{SL}_2(\CC)^3 \\
		Z(\op{MT}(A))^\circ_\CC\cong\mathbb G_m^4.
	\end{cases}\]
	We use this to compute $\op{ST}(A_K)$ if $\lambda\in K$ and $K$ contains $K_A^{\mathrm{conn}}$.
\end{proposition}
\begin{proof}
	We proceed in steps.
	\begin{enumerate}
		\item To begin, we do some prelimarinary algebraic geometry, along the lines of \cite[Section~1]{moonen-special-cyclic-cover}. The curve $C$ comes equipped with a natural map $x\colon C\to\PP^1$, with Galois with cyclic Galois group $\mu_9$, where $\mu_9$ acts on $C$ by multiplication of the $y$-coordinate. As such, a computation with the Riemann--Hurwitz formula reveals that the genus is $g=7$, so $\dim A=7$. From here, we can find the differentials
		\[\left\{\frac{dx}{y^4},\frac{dx}{y^5},\frac{dx}{y^6},\frac{dx}{y^7},\frac{dx}{y^8},\frac{x\,dx}{y^7},\frac{x\,dx}{y^8}\right\}\]
		are all holomorphic on $C$, and they are linearly independent, so we see that this is a basis of the space of differentials in $\mathrm H^0(C,\Omega^1_{C/\CC})=\mathrm H^0(A,\Omega^1_{A/\CC})$. We remark that the above is also an eigenbasis for the induced $\mu_9$-action on $\mathrm H^0(A,\Omega^1_{A/\CC})$.

		\item We decompose $A$ into pieces. Note that $C$ projects onto the elliptic curve $C_0\colon y^3=x(x-1)(x-\lambda)$ via the map $(x,y)\mapsto\left(x,y^3\right)$, so $C_0$ is a factor of $A$. One can see that the basis of differentials of $C_0$ is given by $dx/y^2$, which pulls back to the differential $dx/y^6$ on $A$. In this way, we see that the quotient $A_1\coloneqq A/C_0$ will have $\mathrm H^0(A_1,\Omega^1_{A_1/\CC})$ have a basis given by
		\[\left\{\frac{dx}{y^4},\frac{dx}{y^5},\frac{dx}{y^7},\frac{dx}{y^8},\frac{x\,dx}{y^7},\frac{x\,dx}{y^8}\right\}.\]
		Note that we do not yet know if $A_1$ is simple!

		\item We compute some endomorphism algebras. Note $C_0$ has $\mu_3\subseteq\op{Aut}(C_0)$ where $\zeta_3$ acts by multiplication on the $y$-coordinate, so $C_0$ has complex multiplication by $F_0\coloneqq\QQ(\zeta_3)$.

		We conclude this step by showing that $A_1$ is simple. This will follow from the fact that $A$ does not have complex multiplication. Note the $\mu_9$-action on $A$ fixes $C_0$ (we can be seen on the level of the Hodge structure), so it must also fix $A_1$, so we see $\QQ(\zeta_9)\subseteq\op{End}_\CC(A_1)_\QQ$. Thus, $A_1$ contains an isotypic component $B^r$ (where $B$ is simple) such that
		\[\QQ(\zeta_9)\subseteq\op{End}_\CC(B^r)=M_r\left(\op{End}_\CC(\mathrm H^1_{\mathrm B}(B,\CC))\right).\]
		As such, we set $D\coloneqq\op{End}_\CC(B)$ and $F\coloneqq Z(D)$ so that $d\coloneqq\sqrt{[D:F]}$ and $e\coloneqq[F:\QQ]$ satisfy $6\mid rde$ (because $\QQ(\zeta_9)$ is contained in a maximal subfield of $M_r(D)$) and $r^2d^2e\le2\dim A_1=12$. If we had $r^2d^2e=12$, then $A_1$ would have complex multiplication, which contradicts the fact that $A$ does not have complex multiplication. Thus, we must instead have $rde=r^2d^2e=6$, which implies that $r=d=1$ and so $A_1=B$ with $\op{End}_\CC(A_1)$ given exactly by $F_1\coloneqq\QQ(\zeta_9)$.

		\item We compute some signatures. We begin with $C_0$. Letting $\tau_i\in\op{Gal}(\QQ(\zeta_3)/\QQ)$ be given by $\tau_i(\zeta_3)\coloneqq\zeta_3^i$ for $i\in\{1,2\}$, we see that the signature $\Phi_0\colon\op{Gal}(\QQ(\zeta_3)/\QQ)\to\ZZ_{\ge0}$ of $E_0$ is thus given by $\Phi_0(\tau_1)=1$ and $\Phi_0(\tau_2)=0$ because the second step provided an (eigen)basis of $\mathrm H^{10}(C_0)=\mathrm H^0(C_0,\Omega^1_{C_0/\CC})$.

		We next consider $A_1$. The second step provided a basis of $\mathrm H^{10}(A_1)=\mathrm H^0(A_1,\Omega^1_{A_1/\CC})$. As such, we define $\sigma_i\in\op{Gal}(\QQ(\zeta_9)/\QQ)$ to be the automorphism given by $\sigma_i(\zeta_9)\coloneqq\zeta_9^i$ for $i\in\{1,2,4,5,7,8\}$, and we are able to compute that our signature $\Phi_1\colon\op{Gal}(\QQ(\zeta_9)/\QQ)\to\ZZ_{\ge0}$ is given by
		\[\Phi(\sigma_i)=\begin{cases}
			0 & \text{if }i\in\{7,8\}, \\
			1 & \text{if }i\in\{4,5\}, \\
			2 & \text{if }i\in\{1,2\}.
		\end{cases}\]

		\item We compute $\op{MT}(A)^{\mathrm{der}}$; note that this equals $\op{Hg}(A)^{\mathrm{der}}$ by \Cref{lem:mt-by-hg}. By \Cref{lem:product-of-hg}, we have an inclusion
		\[\op{Hg}(A)\to\op{Hg}(C_0)\oplus\op{Hg}(A_1)\]
		which surjects onto each factor. Now, $C_0$ has complex multiplication, so $\op{Hg}(C_0)$ is a torus by \Cref{prop:cm-is-mt-torus}, so $\op{Hg}(A)^{\mathrm{der}}$ has trivial projection onto $\op{Hg}(C_0)$. We conclude that the above inclusion upgrades into an isomorphism $\op{Hg}(A)^{\mathrm{der}}\to\op{Hg}(A_1)^{\mathrm{der}}$.
		
		To compute $\op{Hg}(A_1)^{\mathrm{der}}$, we use \Cref{prop:mtc-reldim-2} to see that this equals $\op L(A_1)^{\mathrm{der}}$, so we complete this step by noting that $\op L(A_1)^{\mathrm{der}}_\CC\cong\op{SL}_2(\CC)^3$ by the computation in \Cref{lem:lefschetz-type-iv-1}.

		\item We compute $Z(\op{MT}(A))^\circ_\CC$. We use \Cref{prop:z-mt-as-reflex-monodromy} and in particular the discussion following the proof. Indeed, set $L\coloneqq\QQ(\zeta_9)$, which we note is a Galois extension of $\QQ$ containing $F_0F_1$. Then we note that $Z(\op{MT}(A))^\circ\subseteq\mathrm T_F$, where $F\coloneqq F_0\times F_1$ has $(\mathrm T_F)_L$ embedded into $\op{GL}\left(\mathrm H^1_{\mathrm B}(A,L)\right)$ as a subtorus of the diagonal torus. Explicitly, we can choose an $F$-eigenbasis of $\mathrm H^1_{\mathrm B}(A,L)=\mathrm H^1_{\mathrm B}(C_0,L)\oplus\mathrm H^1_{\mathrm B}(A_1,L)$ as
		\[\{u_1,u_2,v_1,v_1',v_2,v_2',v_4,v_4',v_5,v_5',v_7,v_7',v_8,v_8'\},\]
		where the subscript partially indicates the $F$-eigenvalue. (For technical reasons, we will want to know that $\{v_i,v_i'\}$ is a dual basis for $\{v_{9-i},v_{9-i}'\}$ according to the polarization.) Then we see that $(\op T_F)_L\subseteq\op{GL}\left(\mathrm H^1_{\mathrm B}(A,L)\right)$ embeds as
		\[\left\{\op{diag}(\mu_1,\mu_2,\lambda_1,\lambda_1,\lambda_2,\lambda_2,\lambda_4,\lambda_4,\lambda_5,\lambda_5,\lambda_7,\lambda_7,\lambda_8,\lambda_8):\mu_\bullet,\lambda_\bullet\in\mathbb G_{m,L}\right\}.\]
		The discussion following \Cref{prop:z-mt-as-reflex-monodromy} explains that equations cutting out $Z(\op{MT}(A))^\circ_L\subseteq(\mathrm T_F)_L$ can be viewed as elements of the kernel of the map
		\[\mathrm X^*\left(({\op N_{\Phi_0^*}},{\op N_{\Phi_1^*}})\right)\colon\mathrm X^*(\mathrm T_F)\to\mathrm X^*(\mathrm T_L).\]
		Using the established bases for these lattices, we see that our map can be written as the matrix
		\[\begin{blockarray}{ccc|cccccccc}
			& \mu_1 & \mu_2 & \lambda_1 & \lambda_2 & \lambda_4 & \lambda_5 & \lambda_7 & \lambda_8 \\
			\begin{block}{c[cc|cccccccc]}
				\sigma_1 & 1 & 0 & 2 & 2 & 1 & 1 & 0 & 0 \\
				\sigma_2 & 0 & 1 & 1 & 2 & 2 & 0 & 0 & 1 \\
				\sigma_4 & 1 & 0 & 0 & 1 & 2 & 0 & 1 & 2 \\
				\sigma_5 & 0 & 1 & 2 & 1 & 0 & 2 & 1 & 0 \\
				\sigma_7 & 1 & 0 & 1 & 0 & 0 & 2 & 2 & 1 \\
				\sigma_8 & 0 & 1 & 0 & 0 & 1 & 1 & 2 & 2 \\
			\end{block}
		\end{blockarray}.\]
		Then one can compute a basis of the kernel of the matrix, which tells us that $Z(\op{MT}(A))^\circ_L\subseteq(\mathrm T_F)_L$ is cut out by the equations
		\begin{align*}
			\lambda_1\lambda_8 &= \lambda_2\lambda_7, \\
			\lambda_1\lambda_8 &= \lambda_4\lambda_5, \\
			\mu_1\mu_2\lambda_7 &= \lambda_5\lambda_8, \\
			\lambda_1\lambda_4\lambda_7 &= \lambda_2\lambda_5\lambda_8.
		\end{align*}
		Thus, we see that $Z(\op{MT}(A))^\circ_\CC\cong\mathbb G_{m,\CC}^4$ with isomorphism given by the cocharacters $(\mu_1,\lambda_1,\lambda_4,\lambda_8)$.

		\item We use the previous steps to compute $G_\ell^1(A)$ when $\ell$ splits completely in $K_A^{\mathrm{conn}}$. Recall we notably know the Mumford--Tate conjecture that $G_\ell(A)^\circ=\op{MT}(A)_{\QQ_\ell}$ by \Cref{prop:mtc-reldim-2}. Thus, we choose $\ell$ to split completely in $K_A^{\mathrm{conn}}$ so that $\QQ(\zeta_9)\subseteq\QQ_\ell$, allowing us to engage in the diagonalization of the previous step. For example, the computation in \Cref{lem:lefschetz-type-iv-1} reveals that the isomorphism between $\op L(A)^{\mathrm{der}}$ and $\op{SL}_2^3$ is defined over $L$ (indeed, one merely needs to be able to take $L$-eigenspaces), so we find that
		\[G_\ell(A)^{\mathrm{der}}=\left\{\op{diag}\left(1_2,g_1,g_2,g_4,g_4^{-\intercal},g_2^{-\intercal},g_1^{-\intercal}\right):g_1,g_2,g_3\in\op{SL}_{2,\QQ_\ell}\right\}.\]
		Continuing, we add in the equation $\det g=1$ to the equations cutting out $Z(G_\ell(A_L))^\circ\subseteq(\mathrm T_F)_{\QQ_\ell}$ given in the previous step. This reveals that $Z\left(G_\ell^1(A_L)\right)^\circ\subseteq(\mathrm T_F)_{\QQ_\ell}$ is cut out by the equations
		\begin{align*}
			\mu_1\mu_2 &= 1, \\
			\lambda_1\lambda_8 &= 1, \\
			\lambda_2\lambda_7 &= 1, \\
			\lambda_4\lambda_5 &= 1, \\
			\lambda_2 &= \lambda_1\lambda_4.
		\end{align*}
		In particular, we see that $Z\left(G_\ell^1(A)\right)^\circ\cong\mathbb G_{m,\QQ_\ell}^3$ given by the cocharacters $(\mu_1,\lambda_1,\lambda_4)$. In total, we find $G_\ell^1(A)\subseteq\op{GL}_{14,\QQ_\ell}$ equals
		\[\left\{\op{diag}\left(\mu_1,\mu_1^{-1},\lambda_1g_1,\lambda_1\lambda_4g_2,\lambda_4g_4,\lambda_4^{-1}g_4^{-\intercal},\lambda_1^{-1}\lambda_4^{-1}g_2^{-\intercal},\lambda_1^{-1}g_1^{-\intercal}\right):\mu_\bullet,\lambda_\bullet\in\mathbb G_{m,\QQ_\ell},g_\bullet\in\op{SL}_{2,\QQ_\ell}\right\}.\]

		\item At last, we compute $\op{ST}(A_K)$ where $K$ contains $K_A^{\mathrm{conn}}$. By \Cref{thm:mtc-implies-astc}, we see that $\op{ST}(A)$ does not depend on the choice $\ell$, so we may as well choose $\ell$ to split completely in $K_A^{\mathrm{conn}}$. Then we simply base-change the result of the previous step to $\CC$, and then we may take maximal compact subgroups to see $\op{ST}$ is
		\[\left\{\op{diag}\left(\mu_1,\mu_1^{-1},\lambda_1g_1,\lambda_1\lambda_4g_2,\lambda_4g_4,\lambda_4^{-1}g_4^{-\intercal},\lambda_1^{-1}\lambda_4^{-1}g_2^{-\intercal},\lambda_1^{-1}g_1^{-\intercal}\right):\mu_\bullet,\lambda_\bullet\in\mathrm U_1,g_\bullet\in\mathrm{SU}_{2}\right\}.\]
		(It is not too hard to see that the product of maximal compact subgroups continues to be a maximal compact subgroup.) This completes the computation.
		\qedhere
	\end{enumerate}
\end{proof}
\begin{remark}
	Note that $\op MT(A)\ne\op L(A)$ because the centers are different! This continues to be visible in the Sato--Tate group: the first four equations $\mu_1\mu_2=\lambda_1\lambda_8=\lambda_2\lambda_7=\lambda_4\lambda_5=1$ can be explained by the polarization (see \Cref{lem:hg-center-in-u-torus}), but the last equation $\lambda_2=\lambda_1\lambda_4$ corresponds to an exceptional Hodge class not generated by endomorphisms or the polarization.
\end{remark}
\begin{remark}
	Up to squaring, one can replace the equation $\mu_1\mu_2\lambda_7=\lambda_5\lambda_8$ with the equation $\lambda_1\lambda_8=\mu_1^2\mu_2^2$, thus making it clear that it arises from the polarization. Note this squaring is not too much of an issue because we had to take a determinant in \Cref{rem:z-mt-as-det-monodromy} anyway; in particular, by looking at the end result of the computation, we do see that $\op{MT}(A)$ contains the diagonalizable group cut out by our equations where we have done the replacement with $\lambda_1\lambda_8=\mu_1^2\mu_2^2$.
\end{remark}
The hypothesis that $A$ fails to have CM is necessary, as we will see in the following two examples.
\begin{proposition} \label{prop:special-fermat-st-1}
	Define $A$ to be the Jacobian of the proper curve $C$ with affine chart $y^9=x^3-1$. Then $\op{MT}(A)_\CC$ is a torus isomorphic to $\mathbb G_{m,\CC}^4$. We use this to compute $\op{ST}(A_K)$ where $K$ contains $K_A^{\mathrm{conn}}$.
\end{proposition}
\begin{proof}
	We proceed in steps, following \Cref{prop:generic-fermat-st}.
	\begin{enumerate}
		\item To begin, we once again note that $C$ has genus $7$, so $A$ has dimension $7$, and we have a basis of holomorpic differentials given by
		\[\left\{\frac{dx}{y^4},\frac{dx}{y^5},\frac{dx}{y^6},\frac{dx}{y^7},\frac{dx}{y^8},\frac{x\,dx}{y^7},\frac{x\,dx}{y^8}\right\}.\]
		This time around, we see that $\mu_3\times\mu_9$ acts on $C$ by coordinate-wise multiplication on $(x,y)\in C$.

		\item We decompose $A$ into pieces.
		\begin{itemize}
			\item Note $C$ projects onto $C_0\colon y^3=x^3-1$ by $(x,y)\mapsto\left(x,y^3\right)$. (This is the quotient of $C$ by $\mu_3\times1$.) We see that $C_0$ is an elliptic curve, and it has complex multiplicatino by $\mu_3$; for example, $\mu_3$ can act by multiplication on $y$. One can compute that $C_0$ has a basis of holomorphic differentials given by $dx/y^2$, which pulls back to the differential $dx/y^6$ on $C$.

			\item Note $C$ projects onto the proper curve $C_1$ with affine chart $y^9=x^3(x-1)$ by $(x,y)\mapsto\left(x^3,xy\right)$, so $A$ has $A_1\coloneqq\op{Jac}C_1$ as a factor.\footnote{Technically, we should take normalizations everywhere. We will omit these normalizations.} (This is the quotient of $C$ by $\mu_3\subseteq\mu_3\times\mu_9$ embedded by $\zeta\mapsto\left(\zeta,\ov\zeta\right)$.) One can compute that $C_1$ is genus $3$ using the Riemann--Hurwitz formula, and then we can compute that it has a basis of holomorphic differentials given by $\left\{x^2\,dx/y^8,x^2\,dx/y^7,x\,dx/y^5\right\}$, which pull back to the differentials $\left\{dx/y^8,x\,dx/y^7,dx/y^5\right\}$ on $C$ (up to a scalar).

			Note that $C_1$ has an action by $\mu_9$ by multiplying on the $y$-coordinate, so $\QQ(\zeta_9)\subseteq\op{End}_\CC(A_1)_\QQ$. However, $\dim A_1=3$, so we see that $A_1$ has complex multiplication. We will check that $A_1$ is simple shortly.

			\item Note $C$ projects onto the proper curve $C_2$ with affine chart $y^9=x^6(x-1)$ by $(x,y)\mapsto\left(x^3,x^2y\right)$, so $A$ has $A_2\coloneqq\op{Jac}C_2$ as a factor. (This is the quotient of $C$ by $\mu_3\subseteq\mu_3\times\mu_9$ embedded by $\zeta\mapsto\left(\zeta,\zeta\right)$.) One can compute that $C_2$ has genus $3$ using the Riemann--Hurwitz formula, and then we can compute that it has a basis of holomorphic differentials given by $\left\{x^5\,dx/y^8,x^4\,dx/y^7,x^2\,dx/y^4\right\}$, which pull back to the differentials $\left\{x\,dx/y^8,dx/y^7,dx/y^4\right\}$ on $C$ (up to a scalar).

			Note that $C_2$ has an action by $\mu_9$ by multiplying on the $y$-coordinate, so $\QQ(\zeta_9)\subseteq\op{End}_\CC(A_2)_\QQ$. However, $\dim A_2=3$, so we see that $A_2$ has complex multiplication. We will check that $A_2$ is simple shortly.
		\end{itemize}
		We spend a moment checking that $A$ is isogenous to $C_0\times A_1\times A_2$. The above computations have provided a map $C_0\times A_1\times A_2\to A$, so it is enough to check that this is an isomorphism after base-changing to $\CC$. The computations above have shown that this map provides an isomorphism
		\[\mathrm H^0\left(A,\Omega^1_{A/\CC}\right)\to\mathrm H^0\left(C_0,\Omega^1_{C_0/\CC}\right)\oplus\mathrm H^0\left(A_1,\Omega^1_{A_1/\CC}\right)\oplus\mathrm H^0\left(A_2,\Omega^1_{A_2/\CC}\right).\]
		(We take a moment to remark that the right-hand side is even a decomposition of $\mathrm H^0\left(A,\Omega^1_{A/\CC}\right)$ into $\mu_3$-eigenspaces!) This corresponds to an isomorphism on one piece of the Hodge structure, which we note upgrades to an isomorphism of Hodge structures because the relevant Hodge structures are concentrated in $(0,1)$ and $(1,0)$, which are complex conjugates. We conclude that $A$ is isogenous to $C_0\times A_1\times A_2$ by \Cref{thm:riemann}.

		\item We compute some signatures. For our notation, we let $F_0\coloneqq\QQ(\zeta_3)$ have the embeddings $\{\tau_1,\tau_2\}$, where $\tau_\bullet\in\op{Gal}(F_0/\QQ)$ sends $\zeta_3\mapsto\zeta_3^\bullet$; similarly, we let $F_1=F_2\coloneqq\QQ(\zeta_9)$ have the embeddings $\{\sigma_1,\sigma_2,\sigma_4,\sigma_5,\sigma_7,\sigma_8\}$ where $\sigma_\bullet\in\op{Gal}(\QQ(\zeta_9)/\QQ)$ sends $\zeta_9\mapsto\zeta_9^\bullet$. Here are our signatures.
		\begin{itemize}
			\item On $C_0$, we see that $\mathrm H^{10}$ is spanned by $dx/y^2$, so with $\mu_3$ acting on $y$, we get the signature $\Phi_0(\tau_1)=1$ and $\Phi_0(\tau_2)=0$.

			\item On $C_1$, we see that $\mathrm H^{10}$ has basis given by $\left\{x^2\,dx/y^8,x^2\,dx/y^7,x\,dx/y^5\right\}$. Thus, with $\mu_9$ acting on $y$, we get the signature
			\[\Phi_1(\sigma_i)=\begin{cases}
				0 & \text{if }i\in\{5,7,8\}, \\
				1 & \text{if }i\in\{1,2,4\}.
			\end{cases}\]
			One can check that $\Phi_1$ satisfies the check of \Cref{rem:simple-by-type}, proving that $A_1$ is simple.
			
			\item On $C_2$, we see that $\mathrm H^{10}$ has basis given by $\left\{x\,dx/y^8,dx/y^7,dx/y^4\right\}$. Thus, with $\mu_9$ acting on $y$, we get the signature
			\[\Phi_2(\sigma_i)=\begin{cases}
				0 & \text{if }i\in\{4,7,8\}, \\
				1 & \text{if }i\in\{1,2,5\}.
			\end{cases}\]
			One can check that $\Phi_2$ satisfies the check of \Cref{rem:simple-by-type}, proving that $A_1$ is simple.
		\end{itemize}
		The above computation allows us to conclude that we have decomposed $A$ into simple abelian varieties with complex multiplication.

		\item We compute $\op{MT}(A)_\CC$. Because $A$ has complex multiplication, we see that $\op{MT}(A)$ is a torus by \Cref{prop:cm-is-mt-torus} embedded in $\mathrm T_F$, where $F\coloneqq F_0\times F_1\times F_2$. As such, we may use \Cref{prop:z-mt-as-reflex-monodromy} and the surrounding discussion following the proof to compute equations cutting out $\op{MT}(A)\subseteq\mathrm T_F$. In particular, set $L\coloneqq\QQ(\zeta_9)$, which we note is a Galois extension of $\QQ$ containing $F_0F_1F_2$. Then we note that $\mathrm H^1_{\mathrm B}(A,L)=\mathrm H^1_{\mathrm B}(C_0,L)\oplus\mathrm H^1_{\mathrm B}(A_1,L)\oplus\mathrm H^1_{\mathrm B}(A_2,L)$ can be given a basis
		\[\{u_1,u_2,v_1,v_2,v_4,v_5,v_7,v_8,w_1,w_2,w_4,w_5,w_7,w_8\},\]
		where the subscript partially indicates the $F$-eigenvalue. Then we see that $(\mathrm T_F)_L\subseteq\op{GL}\left(\mathrm H^1_{\mathrm B}(A,L)\right)$ embeds as
		\[\left\{\op{diag}(\mu_1,\mu_2,\lambda_1,\lambda_2,\lambda_4,\lambda_5,\lambda_7,\lambda_8,\kappa_1,\kappa_2,\kappa_4,\kappa_5,\kappa_7,\kappa_8):\mu_\bullet,\lambda_\bullet,\kappa_\bullet\in\mathbb G_{m,L}\right\}.\]
		The discussion following \Cref{prop:z-mt-as-reflex-monodromy} explains that equations cutting out $Z(\op{MT}(A))^\circ_L\subseteq(\mathrm T_F)_L$ can be viewed as elements of the kernel of the map
		\[\mathrm X^*\left(({\op N_{\Phi_0^*}},{\op N_{\Phi_1^*}},{\op N_{\Phi_2^*}})\right)\colon\mathrm X^*(\mathrm T_F)\to\mathrm X^*(T_L).\]
		Using the established bases for these lattices, we see that our map can be written as the matrix
		\[\begin{blockarray}{ccc|cccccc|cccccc}
			& \mu_1 & \mu_2 & \lambda_1 & \lambda_2 & \lambda_4 & \lambda_5 & \lambda_7 & \lambda_8 & \kappa_1 & \kappa_2 & \kappa_4 & \kappa_5 & \kappa_7 & \kappa_8 \\
			\begin{block}{c[cc|cccccc|cccccc]}
				\sigma_1 & 1 & 0 & 1 & 1 & 1 & 0 & 0 & 0 & 1 & 1 & 0 & 1 & 0 & 0 \\
				\sigma_2 & 0 & 1 & 0 & 1 & 1 & 0 & 0 & 1 & 1 & 1 & 1 & 0 & 0 & 0 \\
				\sigma_4 & 1 & 0 & 1 & 1 & 0 & 1 & 0 & 0 & 1 & 0 & 0 & 1 & 1 & 0 \\
				\sigma_5 & 0 & 1 & 1 & 1 & 0 & 1 & 0 & 0 & 1 & 0 & 0 & 1 & 1 & 0 \\
				\sigma_7 & 1 & 0 & 1 & 0 & 0 & 1 & 1 & 0 & 0 & 0 & 0 & 1 & 1 & 1 \\
				\sigma_8 & 0 & 1 & 0 & 0 & 0 & 1 & 1 & 1 & 0 & 0 & 1 & 0 & 1 & 1 \\
			\end{block}
		\end{blockarray}.\]
		Then one can compute a basis of the kernel of the matrix, which tells us that $\op{MT}(A)_L\subseteq(\mathrm T_F)_L$ is cut out by the following equations. To begin, it turns out that $(A_1)_L$ and $(A_2)_L$ are isogenous, which we can see from the six equations
		\begin{align*}
			\lambda_1 &= \kappa_5, \\
			\lambda_2 &= \kappa_1, \\
			\lambda_4 &= \kappa_2, \\
			\lambda_5 &= \kappa_7, \\
			\lambda_7 &= \kappa_8, \\
			\lambda_8 &= \kappa_4.
		\end{align*}
		(Namely, these equations imply an isomorphism of $\op{MT}(A)$-representations $\mathrm H^1_{\mathrm B}(A_1,L)\cong\mathrm H^1_{\mathrm B}(A_2,L)$ and hence an isomorphism of Hodge structures, which gives the isogeny by \Cref{thm:riemann}.) Then there are the equations given by the polarization (via \Cref{lem:hg-center-in-u-torus})
		\begin{align*}
			\mu_1\mu_2 &= \kappa_1\kappa_8, \\
			\kappa_1\kappa_8 &= \kappa_2\kappa_7, \\
			\kappa_1\kappa_8 &= \kappa_4\kappa_5.
		\end{align*}
		Lastly, there is the exceptional equation
		\begin{align*}
			\mu_1\kappa_7 &= \kappa_5\kappa_8.
		\end{align*}
		In total, we find that $\op{MT}(A)_L$ is a torus isomorphic to $\mathbb G_{m,L}^4$ via the cocharacters $(\kappa_1,\kappa_2,\kappa_4,\kappa_8)$.

		\item We use the previous step to compute $G_\ell^1(A_K)$ when $\ell$ splits completely in $K\coloneqq K_A^{\mathrm{conn}}$. Recall that we know the Mumford--Tate conjecture that $G_\ell(A)^\circ=\op{MT}(A)_{G_\ell}$ by \Cref{rem:mtc-cm}. Thus, we choose $\ell$ to split completely in $K_A^{\mathrm{conn}}$ so that $L\subseteq\QQ_\ell$, allowing us to engage in the diagonalization of the previous step. Now, to compute $G_\ell^1(A_K)$ from $G_\ell(A_K)$, we simply need to add in the equation that the multipler is $1$. This reveals that $G_\ell^1(A_{K_A^{\mathrm{conn}}})\subseteq(\mathrm T_F)_{\QQ_\ell}$ is cut out by the following equations. As before, we have the six equations
		\begin{align*}
			\lambda_1 &= \kappa_5, \\
			\lambda_2 &= \kappa_1, \\
			\lambda_4 &= \kappa_2, \\
			\lambda_5 &= \kappa_7, \\
			\lambda_7 &= \kappa_8, \\
			\lambda_8 &= \kappa_4
		\end{align*}
		given by the isogeny $(A_1)_L\sim (A_2)_L$, and we have the equations given by the polarization
		\begin{align*}
			\mu_1\mu_2 &= 1, \\
			\kappa_1\kappa_8 &= 1, \\
			\kappa_2\kappa_7 &= 1, \\
			\kappa_4\kappa_5 &= 1.
		\end{align*}
		Lastly, there is still the exceptional equation
		\[\mu_1\kappa_7=\kappa_5\kappa_8.\]
		In total, we find that $G_\ell^1(A)$ is a torus isomorphic to $\mathbb G_{m,L}^3$ via the cocharacters $(\kappa_1,\kappa_2,\kappa_4)$. In total, we see $G_\ell^1(A_K)^\circ\subseteq\op{GL}_{14}$ is
		\[\left\{\op{diag}\left(\frac{\kappa_2}{\kappa_1\kappa_4},\frac{\kappa_1\kappa_4}{\kappa_2},\kappa_4^{-1},\kappa_1,\kappa_2,\kappa_2^{-1},\kappa_1^{-1},\kappa_4,\kappa_1,\kappa_2,\kappa_4,\kappa_4^{-1},\kappa_2^{-1},\kappa_1^{-1}\right):\kappa_\bullet\in\mathbb G_{m,\QQ_\ell}\right\}.\]

		\item At last, we compute $\op{ST}(A_K)$ where $K$ contains $K_A^{\mathrm{conn}}$. By \Cref{thm:mtc-implies-astc}, we see that $\op{ST}$ does not depend on the choice of $\ell$, so we may as well choose $\ell$ to split completely in $K_A^{\mathrm{conn}}$. Then we may simply base-change the result of the previous step to $\CC$, and then we may take maximal compact subgroups to see $\op{ST}$ is
		\[\left\{\op{diag}\left(\frac{\kappa_2}{\kappa_1\kappa_4},\frac{\kappa_1\kappa_4}{\kappa_2},\kappa_4^{-1},\kappa_1,\kappa_2,\kappa_2^{-1},\kappa_1^{-1},\kappa_4,\kappa_1,\kappa_2,\kappa_4,\kappa_4^{-1},\kappa_2^{-1},\kappa_1^{-1}\right):\kappa_\bullet\in\mathrm U_1\right\}.\]
		Once again, we remark that the product of maximal compact subgroups continues to be maximal compact.
		\qedhere
	\end{enumerate}
\end{proof}
\begin{proposition} \label{prop:special-fermat-st-2}
	Define $A$ to be the Jacobian of the proper curve $C$ with affine chart $y^9=x\left(x^2+1\right)$. Then $\op{MT}(A)_\CC$ is a torus isomorphic to $\mathbb G_{m,\CC}^4$. We use this to compute $\op{ST}(A_K)$ where $K$ contains $K_A^{\mathrm{conn}}$.
\end{proposition}
\begin{proof}
	This argument is essentially the same as \Cref{prop:special-fermat-st-1}, so we will be a bit briefer.
	\begin{enumerate}
		\item Once again, we see that $C$ has genus $7$, so $A$ has dimension $7$, and we have a basis of holomorphic differentials given by
		\[\left\{\frac{dx}{y^4},\frac{dx}{y^5},\frac{dx}{y^6},\frac{dx}{y^7},\frac{dx}{y^8},\frac{x\,dx}{y^7},\frac{x\,dx}{y^8}\right\}.\]
		This time around, we see that $\mu_{18}$ acts on $C$ by $\zeta_{18}\cdot(x,y)=(-x,-\zeta_9y)$.

		\item We decompose $A$ into pieces.
		\begin{itemize}
			\item As usual, $C_0$ projects onto $y^3=x\left(x^2+1\right)$ by $(x,y)\mapsto\left(x,y^3\right)$. (This is the quotient of $C$ by $\mu_3$.) The Riemann--Hurwitz formula yields that $C_0$ is an elliptic curve with complex multiplication by $\mu_3$ acting on the $y$-coordinate. We see that $C_0$ has a basis of holomorphic differentials given by $dx/y^2$, which pulls back to $dx/y^6$ ln $C$.

			\item Now, $C$ projects onto the proper curve $C_1$ with affine chart $y^9=x^5(x+1)$ by $(x,y)\mapsto\left(x^2,xy\right)$, so $A$ has $A_1\coloneqq\op{Jac}C_1$ as a factor. (This is the quotient of $C$ by $\mu_2$.) The Riemann--Hurwitz formula implies that $C_1$ has genus $3$, and then we can compute that it has a basis of holomorphic differentials given by $\left\{x^4\,dx/y^8,x^3\,dx/y^7,x^2\,dx/y^5\right\}$, which pulls back to $\left\{x\,dx/y^8,dx/y^7,dx/y^5\right\}$ on $C$ (up to scalar).

			Note that $C_1$ has an action by $\mu_9$ acting on the $y$-coordinate, so $\QQ(\zeta_9)\subseteq\op{End}_\CC(A_1)_\QQ$. We will check in the next step that $A_1$ is simple by computing its signature and applying \Cref{rem:simple-by-type}.
		\end{itemize}
		We can see on the level of differentials that the induced map $C_0\times A_1\to A$ is injective, so we let $A_2$ be the cokernel. In terms of Hodge structures, we can see from the computation that
		\[\mathrm H^1_{\mathrm B}(A,\QQ)=\mathrm H^1_{\mathrm B}(C_0,\QQ)\oplus\mathrm H^1_{\mathrm B}(A_1,\QQ)\oplus\mathrm H^1_{\mathrm B}(A_2,\QQ)\]
		is a decomposition of $\mu_{18}$-representations because the left two spaces on the right-hand side are stable under the $\mu_{18}$-action. We conclude that $\QQ(\zeta_9)\subseteq\op{End}_\CC(A_2)_\QQ$ as well.

		\item We compute some signatures. As before, we let $F_0\coloneqq\QQ(\zeta_3)$ have $\{\tau_1,\tau_2\}=\op{Gal}(\QQ(F_0)/\QQ)$ where $\tau_\bullet\colon\zeta_3\mapsto\zeta_3^\bullet$, and we let $F_1=F_2\coloneqq\QQ(\zeta_9)$ have $\{\sigma_1,\ldots,\sigma_8\}=\op{Gal}(\QQ(\zeta_9)/\QQ)$ has $\sigma_\bullet\colon\zeta_9\mapsto\zeta_9^\bullet$.
		\begin{itemize}
			\item On $C_0$, we look at the $\mu_9$-eigenbasis of $\mathrm H^{10}$ to conclude that our signature has $\Phi_0(\tau_1)=1$ and $\Phi_0(\tau_2)$.
			\item On $C_1$, we look at the $\mu_9$-eigenbasis of $\mathrm H^{10}$ to conclude that our signature is
			\[\Phi_1(\sigma_i)=\begin{cases}
				0 & \text{if }i\in\{5,7,8\}, \\
				1 & \text{if }i\in\{1,2,4\}.
			\end{cases}\]
			One can check that $\Phi_1$ satisfies the check of \Cref{rem:simple-by-type}, proving that $A_1$ is simple.
			\item On $A_2$, we take the remaining differentials from $A$ to find that our signature is
			\[\Phi_2(\sigma_i)=\begin{cases}
				0 & \text{if }i\in\{4,7,8\}, \\
				1 & \text{if }i\in\{1,2,5\}.
			\end{cases}\]
			Again, one checks that $\Phi_2$ satisfies the check of \Cref{rem:simple-by-type}
		\end{itemize}

		\item At this point, we recognize that our signatures are the same as in \Cref{prop:special-fermat-st-1} up to swapping $\Phi_1$ and $\Phi_2$. Thus, up to some reordering of letters, the exact same computation goes through. Let's provide the result.
		
		To be explicit, we give $\mathrm H^1_{\mathrm B}(A,L)=\mathrm H^1_{\mathrm B}(C_0,L)\oplus\mathrm H^1_{\mathrm B}(A_1,L)\oplus\mathrm H^1_{\mathrm B}(A_2,L)$ a basis
		\[\{u_1,u_2,v_1,v_2,v_4,v_5,v_7,v_8,w_1,w_2,w_4,w_5,w_7,w_8\},\]
		where the subscript partially indicates the $F$-eigenvalue, where $F\coloneqq F_0\times F_1\times F_2$. Then we set $L\coloneqq\QQ(\zeta_9)$, and we see $(\mathrm T_F)_L\subseteq\op{GL}\left(\mathrm H^1_{\mathrm B}(A,L)\right)$ embeds as
		\[\left\{\op{diag}(\mu_1,\mu_2,\lambda_1,\lambda_2,\lambda_4,\lambda_5,\lambda_7,\lambda_8,\kappa_1,\kappa_2,\kappa_4,\kappa_5,\kappa_7,\kappa_8):\mu_\bullet,\kappa_\bullet,\lambda_\bullet\in\mathbb G_{m,L}\right\}.\]
		With this choice of lettering, the equations that end up cutting out $\op{MT}(A)_L\subseteq(\mathrm T_F)_L$ are exactly the same, so $\op{MT}(A)_L\cong\mathbb G_{m,L}^4$ via the cocharacters $(\kappa_1,\kappa_2,\kappa_4,\kappa_8)$.

		One is now able to compute $G_\ell^1(A)$ in the case where $\ell$ splits completely in $K\coloneqq K_A^{\mathrm{conn}}$. One finds the exact same equations via the same computation, so we find $G_\ell^1(A_K)\subseteq\op{GL}_{14}$ is given by
		\[\left\{\op{diag}\left(\frac{\kappa_2}{\kappa_1\kappa_4},\frac{\kappa_1\kappa_4}{\kappa_2},\kappa_4^{-1},\kappa_1,\kappa_2,\kappa_2^{-1},\kappa_1^{-1},\kappa_4,\kappa_1,\kappa_2,\kappa_4,\kappa_4^{-1},\kappa_2^{-1},\kappa_1^{-1}\right):\kappa_\bullet\in\mathbb G_{m,\QQ_\ell}\right\}.\]
		Base-changing to $\CC$ and taking a maximal compact subgroup, we find $\op{ST}(A_K)$ is
		\[\left\{\op{diag}\left(\frac{\kappa_2}{\kappa_1\kappa_4},\frac{\kappa_1\kappa_4}{\kappa_2},\kappa_4^{-1},\kappa_1,\kappa_2,\kappa_2^{-1},\kappa_1^{-1},\kappa_4,\kappa_1,\kappa_2,\kappa_4,\kappa_4^{-1},\kappa_2^{-1},\kappa_1^{-1}\right):\kappa_\bullet\in\mathrm U_1\right\},\]
		as required.
		\qedhere
	\end{enumerate}
\end{proof}
% work out y^9 = x(x-1)(x-lambda) for both generic and some special lambda

\subsection{Moment Statistics}
In this subsection, we explain how to numerically verify the Sato--Tate conjecture (\Cref{conj:ast}). Fix an abelian variety $A$ of dimension $g$ defined over a number field $K$, and choose a prime $\ell$ and embedding $\iota\colon\QQ_\ell\into\CC$; for example, this allows us to define the usual $\ell$-adic representation $\rho_\ell\colon\op{Gal}(\ov K/K)\to\op{GL}\left(\mathrm H^1_{\mathrm{\acute et}}(A_{\ov K},\QQ_\ell)\right)$.

The main idea is that the map sending $g\in\op{ST}(A)$ to the characteristic polynomial of $g\in\op{GL}_{2g}(\CC)$ is well-defined up to conjugacy classes, so it defines a (continuous) map $\op{Conj}(\op{ST}(A))\to\CC^{2g+1}$, where $\CC^{2g+1}$ simply lists out the coefficients of the characteristic polynomial. In this way, we can push the Haar measure on $\op{ST}(A)$ all the way to $\CC^{2g+1}$ to compute what the distribution of the characteristic polynomial will be.

Of course, in practice, it may be difficult to compute the characteristic polynomial of
\[\left[\frac1{\sqrt{\op N(\mf p)}}\iota\rho_\ell(\mathrm{Frob}_{\mf p})\right]\in\op{Conj}(\op{ST}(A))\]
for some prime $\mf p$ of $K$ such that $A$ has good reduction at $\mf p$. For our application, we will only be interested in superelliptic curves, for which this can be computed in SageMath \cite{abcmt-cyclic-cover}. To help out the computation a bit more, we make two quick remarks.
\begin{remark}
	Let $P(T)$ be the characteristic polynomial of $\mathrm{Frob}_{\mf p}$ acting on $\mathrm H^1_{\mathrm{\acute et}}(A_{\ov{\mathbb F_{\mf p}}},\QQ_\ell)$. Then we remark that $P(1)$ has a geometric interpretation as $\#A(\FF_{\mf p})$.
\end{remark}
\begin{remark} \label{rem:only-use-split-complete-st}
	It suffices to only consider primes $\mf p$ which are totally split in $K$ because such primes have density $1$. This is helpful because primes that split $\mf p$ completely have residue fields isomorphic to $\FF_p$ where $p\in\ZZ$ is the prime sitting below $\mf p$, so we are frequently able to reduce the computation to something only involving integral coefficients.
\end{remark}
As before, let's begin with some elliptic curve examples. Here, we note that the characteristic polynomial of $\frac1{\op N(\mf p)}\iota\rho_\ell(\mathrm{Frob}_{\mf p})$ will have degree $2$, with leading coefficient $1$, and the condition on the multiplier (from \Cref{prop:frob-multiplier}) implies that the constant coefficient is $1$. Thus, we see that the only interesting coefficient of the characteristic polynomial is given by the trace.
\begin{lemma} \label{lem:measure-conj-su2}
	The map $\tr\colon\op{Conj}({\op{SU}_2})\to[-2,2]$ is a homeomorphism, and the pushforward of the normalized Haar measure of $\op{SU}_2$ onto $\op{Conj}({\op{SU}_2})=[-2,2]$ is given by the semicircle measure $\frac1{2\pi}\sqrt{4-t^2}\,dt$.
\end{lemma}
\begin{proof}
	We show the claims separately.
	\begin{enumerate}
		\item We show that $\tr\colon\op{Conj}({\op{SU}_2})\to[-2,2]$ is a well-defined homeomorphism. Note that $\tr\colon\op{Conj}({\op{SU}_2})\to\CC$ is continuous, and all spaces in sight are compact and Hausdorff, so it is enough to check that $\tr$ is a bijection.
		
		A priori, $\tr$ is only defined as a map $\tr\colon\op{Conj}({\op{SU}_2})\to\CC$. To begin, we note that any element of $\op{SU}_2$ is diagonalizable by a unitary matrix, and the corresponding diagonal matrix must then look like $\op{diag}(\lambda,\ov\lambda)$ where $\left|\lambda\right|^2=1$. By writing $\lambda=e^{i\theta}$, we see that the trace of this element is $2\cos\theta$, so we see that $\tr\colon\op{Conj}({\op{SU}_2})\to[-2,2]$ is a well-defined surjection.

		It remains to check that $\tr$ is injective. Because each conjugacy class is represented by a diagonal matrix, it is enough to check that $g_1\coloneqq\op{diag}(\lambda_1,\ov\lambda_1)$ and $g_2\coloneqq\op{diag}(\lambda_2,\ov\lambda_2)$ have $\tr g_1=\tr g_2$ only if $g_1$ and $g_2$ are conjugate. Well, write $\lambda_\bullet=e^{i\theta_\bullet}$, and then we see that
		\[2\cos\theta_1=2\cos\theta_2,\]
		which implies that $\{\pm\theta_1\}=\{\pm\theta_2\}$, so $\{\lambda_1,\ov\lambda_1\}=\{\lambda_2,\ov\lambda_2\}$. We now do casework: if $\lambda_1=\lambda_2$, then we see that $g_1=g_2$ on the nose; otherwise, $\lambda_1=\ov\lambda_2$, and we see that
		\[\begin{bmatrix}
			& 1 \\
			-1
		\end{bmatrix}\begin{bmatrix}
			\lambda_1 \\ & \ov\lambda_1
		\end{bmatrix}\begin{bmatrix}
			& -1 \\ 1
		\end{bmatrix}=\begin{bmatrix}
			\lambda_2 \\ & \ov\lambda_2
		\end{bmatrix},\]
		so $g_1$ is conjugate to $g_2$.

		\item We now compute the required measures. A linear algebra argument with the condition $gg^\dagger=1_2$ shows that any element of $\op{SU}_2$ can be written uniquely in the form
		\[\begin{bmatrix}
			\alpha & -\ov\beta \\
			\beta & \ov\alpha
		\end{bmatrix}\]
		where $\left|\alpha\right|^2+\left|\beta\right|^2=1$. In this way, we see that $\op{SU}_2$ is isomorphic to the unit group of the quaternions $\mathbb H$, so $\op{SU}_2$ is diffeomorphic to $S^3$ and inherits a Haar measure by pullback. Explicitly, one finds that $\op{SU}_2$ inherits an action on $S^3$ by rotations, so the Lebesgue measure on $S^3$ is invariant under the group. Note that we have yet to normalize the Haar mesure on $\op{SU}_2$.

		We would now like to compute the volume of $\op{SU}_2$ with given trace $t$. Writing $\alpha=a+bi$ and $\beta=c+di$, we see that we are forcing $a=\frac12t$, which then requires the remaining coordinates to live in a sphere of radius $\sqrt{1-\frac14t^2}$. Thus, we see that our normalized Haar measure is
		\[\frac{\sqrt{1-\frac14t^2}\,dt}{\int_{-2}^2\sqrt{1-\frac14t^2}\,dt}.\]
		A quick substitution with $t=2\cos\theta$ in the bottom integral reveals that it equals $\pi$, whereupon we find that the desired measure is $\frac1{2\pi}\sqrt{4-t^2}\,dt$ after some rearranging.
		\qedhere
	\end{enumerate}
\end{proof}
\begin{remark} \label{rem:better-su2-haar-measure}
	In the sequel, it is occasionally more convenient to identify $\op{Con}(\mathrm{SU}_2)$ with the collection of diagonal matrices $\op{diag}\left(e^{i\theta},e^{-i\theta}\right)$ where $\theta\in[0,\pi)$. Then we see that the trace is $2\cos\theta$, so we produce a measure of $\frac2\pi\sin^2\theta\,d\theta$ on $[0,\pi)$.
\end{remark}
\begin{example}[no complex multiplication] \label{ex:ec-no-cm-measure}
	We continue with the elliptic curve $E\colon y^2=x^3+x+1$ over $\QQ$ studied in \Cref{ex:ec-no-cm-st}. Then we recall that $\op{ST}(E)=\op{SU}_2$, so we may use the computation of \Cref{lem:measure-conj-su2} to see that the Sato--Tate conjecture (\Cref{conj:st}) implies that the values
	\[\left\{\tr\frac1{\sqrt{\op N(\mf p)}}\iota\rho_\ell(\mathrm{Frob}_{\mf p})\right\}_{\mf p\text{ prime}}\]
	equidistribute according to the semicircle measure $\frac1{2\pi}\sqrt{4-t^2}\,dt$ on $[-2,2]$.
\end{example}
\begin{example}[complex multiplication] \label{ex:cm-ec-st-measure}
	We continue with the elliptic curve $E\colon y^2=x^3+1$ over $\QQ(\zeta_3)$ studied in \Cref{ex:cm-ec-st}. Then we recall that $\op{ST}(E)\cong\mathrm U_1$ embedded as $z\mapsto\op{diag}(z,\ov z)$. We may write $\mathrm U_1$ as $\mathrm U_1=\left\{e^{i\theta}:\theta\in[0,2\pi)\right\}$, so we can equip this group with the normalized Haar measure $\frac1{2\pi}\,d\theta$. (The map $e^{i\theta}\mapsto\theta$ is a homeomorphism away from a set of measure $0$.) Noting the trace of $\op{diag}\left(e^{i\theta},e^{-i\theta}\right)$ is $2\cos\theta$, we see the Sato--Tate conjecture (\Cref{conj:st}) implies that the values
	\[\left\{\tr\frac1{\sqrt{\op N(\mf p)}}\iota\rho_\ell(\mathrm{Frob}_{\mf p})\right\}_{\mf p\text{ prime}}\]
	equidistribute according to the measure $\frac1\pi\cdot\frac1{\sqrt{4-t^2}}\,dt$ on $[-2,2]$.
\end{example}
\begin{example}[potential complex multiplication] \label{ex:pot-cm-ec-st-measure}
	We continue with the elliptic curve $E\colon y^2=x^3+1$ over $\QQ(\zeta_3)$ studied in \Cref{ex:pot-cm-ec-st}. Then we recall that $\op{ST}(E)\cong\mathrm U_1\rtimes S_2$, where $\mathrm U_1\subseteq\op{GL}_{2,\CC}$ is embedded as $z\mapsto\op{diag}(z,\ov z)$, and $S_2=\{1,w\}$ acts by switching the coordinates. Again, we give $\mathrm U_1=\left\{e^{i\theta}:\theta\in[0,2\pi)\right\}$ the normalized Haar measure $\frac1{2\pi}\,d\theta$, so $\mathrm U_1\rtimes S_2$ gets the normalized Haar measure $\frac1{4\pi}\,d\theta$. For $u=\op{diag}\left(e^{i\theta},e^{-i\theta}\right)\in U$, we note that the trace of $(u,1)\in\mathrm U_1\rtimes S_2$ is simply $2\cos\theta$ while the trace of $(u,w)\in\mathrm U_1\rtimes S_2$ vanishes. Thus, we see the Sato--Tate conjecture (\Cref{conj:st}) implies that the values
	\[\left\{\tr\frac1{\sqrt{\op N(\mf p)}}\iota\rho_\ell(\mathrm{Frob}_{\mf p})\right\}_{\mf p\text{ prime}}\]
	equidistribute according to the measure $\frac1{2\pi}\cdot\frac1{\sqrt{4-t^2}}\,dt+\frac12\delta_0\,dt$ on $[-2,2]$. Here, $\delta_0$ refers to the $\delta$-distribution concentrated at $0$.
\end{example}
We now return to the Jacobian of (the normalization of the proper curve with affine chart) $y^9=x(x-1)(x-\lambda)$. It will be helpful to take products of Haar measures in the sequel. The following result is an easier form of \cite[Proposition~1.5.6]{de-harmonic-analysis}.
\begin{lemma} \label{lem:product-haar-measure}
	Fix a locally compact topological group $G$. Choose closed subgroups $H,K\subseteq G$ such that $G=HK$ and $K\subseteq C_G(H)$. Letting $dh$ and $dg$ be left Haar measures on $H$ and $K$, respectively, we find that $dk\,dh$ is a left Haar measure on $G$.
\end{lemma}
\begin{proof}
	We are tasked with showing that the integral
	\[\int_H\int_Kf(hk)\,dk\,dh\]
	is left-invariant for $G$. It is left-invariant for $H$ with no content, so it suffices to show the same for $K$. This follows after some manipulation because $K$ commutes with $H$.
\end{proof}
\begin{remark}
	In fact, \cite[Proposition~1.5.6]{de-harmonic-analysis} shows something much stronger: one can replace the strong group-theoretic condition that $K\subseteq C_G(H)$ with merely that $K$ is compact. In fact, a careful reading of the proof there reveals that we may even replace the condition that $K$ is compact with merely having $H\cap K$ compact and $\Delta_G|_K=1$, where $\Delta_G$ is the modular function on $G$.
\end{remark}
Here is our application.
\begin{proposition} \label{prop:generic-fermat-st-measure}
	Let $A$ be the Jacobian of the normalization of the proper curve with affine chart $y^9=x(x-1)(x-\lambda)$, where $\lambda$ lives in a number field. Suppose that $A$ does not have complex multiplication. We compute a Haar measure on $\op{ST}(A_K)$ whenever $K$ contains $K_A^{\mathrm{conn}}$.
\end{proposition}
\begin{proof}
	The Sato--Tate computation of \Cref{prop:generic-fermat-st} (combined with the conjugacy class computation of \Cref{lem:measure-conj-su2}) reveals that an element of $\op{Conj}(\op{ST}(A))$ can be written as
	\begin{align*}
		&\op{diag}\Bigg(\begin{bmatrix}
			e^{i\alpha_0} \\ & e^{-i\alpha_0}
		\end{bmatrix},\begin{bmatrix}
			e^{i\alpha_1+i\theta_1} \\ & e^{i\alpha_1-i\theta_1}
		\end{bmatrix},\begin{bmatrix}
			e^{i\alpha_1+i\alpha_4+i\theta_2} \\ & e^{i\alpha_1+i\alpha_4-i\theta_2}
		\end{bmatrix},\begin{bmatrix}
			e^{i\alpha_4+i\theta_4} \\ & e^{i\alpha_4-i\theta_4}
		\end{bmatrix}, \\
		&\qquad\begin{bmatrix}
			e^{-i\alpha_4+i\theta_4} \\ & e^{-i\alpha_4-i\theta_4}
		\end{bmatrix},\begin{bmatrix}
			e^{-i\alpha_1-i\alpha_4+i\theta_2} \\ & e^{-i\alpha_1-i\alpha_4-i\theta_2}
		\end{bmatrix},\begin{bmatrix}
			e^{-i\alpha_1+i\theta_1} \\ & e^{-i\alpha_1-i\theta_1}
		\end{bmatrix}\Bigg)
	\end{align*}
	where $\alpha_\bullet\in[0,2\pi)$ and $\theta_\bullet\in[0,\pi)$. Technically, the map $(\alpha_\bullet,\theta_\bullet)\colon[0,2\pi)^4\times[0,\pi)^3\to\op{Conj}(\op{ST}(A))$ is the finite-to-one because $Z(\op{ST}(A))^\circ\cap\op{ST}(A)^{\mathrm{der}}$ is finite, but this will make no effect on our computations as long as we normalize to have total volume $1$ and only integrate against genuine functions on $\op{Conj}(\op{ST}(A))$.
	
	Anyway, we see that the trace is given by
	\begin{align*}
		&2\cos\alpha_0+2\cos(\alpha_1+\theta_1)+2\cos(\alpha_1-\theta_1)+2\cos(\alpha_1+\alpha_4+\theta_2)+2\cos(\alpha_1+\alpha_4-\theta_2) \\
		&\qquad+2\cos(\alpha_4+\theta_4)+2\cos(\alpha_4-\theta_4).
	\end{align*}
	We finish by remarking that \Cref{lem:product-haar-measure} gives our Haar measure as
	\[\frac1{(2\pi)^3}\,d\alpha_0\,d\alpha_1\,d\alpha_4\cdot\frac1{\pi^2}\left(2\sin^2\theta_1\cdot2\sin^2\theta_2\cdot2\sin^2\theta_4\right)d\theta_1\,d\theta_2\,d\theta_4,\]
	which is what we wanted. (Note we used \Cref{rem:better-su2-haar-measure} for the Haar measure on $\op{SU}_2$.)
\end{proof}
\begin{proposition} \label{prop:special-fermat-st-measure-1}
	Let $A$ be the Jacobian of the normalization of the proper curve with affine chart $y^9=x^3-1$. Suppose that $A$ does not have complex multiplication. We compute a Haar measure on $\op{ST}(A_K)$ whenever $K$ contains $K_A^{\mathrm{conn}}$.
\end{proposition}
\begin{proof}
	The Sato--Tate computation of \Cref{prop:special-fermat-st-1} reveals that an element of $\op{Conj}(\op{ST}(A))$ can be written as
	\begin{align*}
		&\op{diag}\left(e^{i\alpha_2-i\alpha_1-\alpha_4},e^{i\alpha_1+i\alpha_4-i\alpha_2},e^{-i\alpha_4},e^{i\alpha_1},e^{i\alpha_2},e^{-\alpha_2},e^{-\alpha_1},e^{i\alpha_4},e^{i\alpha_1},e^{i\alpha_2},e^{i\alpha_4},e^{-i\alpha_4},e^{-i\alpha_2},e^{-i\alpha_1}\right)
	\end{align*}
	where $\alpha_\bullet\in[0,2\pi)$. For example, we see that the trace is given by
	\begin{align*}
		&2\cos\cos(\alpha_1-\alpha_2+\alpha_4)+4\cos\alpha_1+4\cos\alpha_2+4\cos\alpha_4
	\end{align*}
	We finish by remarking that \Cref{lem:product-haar-measure} gives our Haar measure as
	\[\frac1{(2\pi)^3}\,d\alpha_1\,d\alpha_2\,d\alpha_4,\]
	which is what we wanted.
\end{proof}
\begin{remark}
	As remarked at the end of the proof of \Cref{prop:special-fermat-st-2}, we can run the exact same computation with working the curve given by $y^9=x\left(x^2+1\right)$ because the resulting Sato--Tate group is the same up to reordering the basis.
\end{remark}
\begin{remark}
	For the previous examples, there are more interesting coefficients in the characteristic polynomial than merely the trace. Hoever, they are rather lengthy to write down, so we have chosen not to.
\end{remark}
It still remains to explain how we numerically verify the Sato--Tate conjecture. The idea is that we can try to compute
\[\tr\frac1{\sqrt{\op N(\mf p)}}\iota\rho_\ell(\mathrm{Frob}_{\mf p})\]
for various primes $\mf p$ and then compare it with what is expected from
\[\int_{\op{Conj}(\op{ST}(A))}\tr g\,dg,\]
where $dg$ refers to the pushforward of the Haar measure from $\op{Conj}(\op{ST}(A))$. One usually expects the above integral to vanish, so one can either look at other coefficients of the characteristic polynomial or at powers of $\tr g$. In the sequel, we will compute with only powers of $\tr g$ for simplicity, but we do remark that one can typically recover the other coefficients via a combination of Vieta's formulae and Newton's sums.

As usual, let's begin with elliptic curves. Here, explicit formulae are possible.
\begin{example}[no complex multiplication]
	We continue with the elliptic curve $E\colon y^2=x^3+x+1$ over $\QQ$ studied in \Cref{ex:ec-no-cm-st,ex:ec-no-cm-measure}. Fix some integer $m\ge0$. Using the given Haar measure (from \Cref{rem:better-su2-haar-measure}), we find that one expects the average of $\left\{\left(\tr\frac1{\sqrt{\op N(\mf p)}}\iota\rho_\ell(\mathrm{Frob}_{\mf p})\right)^m\right\}_{\mf p\text{ prime}}$ to be
	\[\int_0^\pi(2\cos\theta)^m\frac2\pi\sin^2\theta\,d\theta=\begin{cases}
		\frac1{m/2+1}\binom{m}{m/2} & \text{if }m\text{ is even}, \\
		0 & \text{if }m\text{ is odd},
	\end{cases}\]
	where the last equality is verified by expanding $2\cos\theta=e^{i\theta}+e^{-i\theta}$ and $4\sin^2\theta=2-e^{2i\theta}-e^{-2i\theta}$.
\end{example}
\begin{example}[complex multiplication]
	We continue with the elliptic curve $E\colon y^2=x^3+1$ over $\QQ(\zeta_3)$ studied in \Cref{ex:cm-ec-st,ex:cm-ec-st-measure}. Fix some integer $m\ge0$. Using the given Haar measure, we find that one expects the average of $\left\{\left(\tr\frac1{\sqrt{\op N(\mf p)}}\iota\rho_\ell(\mathrm{Frob}_{\mf p})\right)^m\right\}_{\mf p\text{ prime}}$ to be
	\[\int_0^{2\pi}(2\cos\theta)^m\frac1{2\pi}\,d\theta=\begin{cases}
		\binom{m}{m/2} & \text{if }m\text{ is even}, \\
		0 & \text{if }m\text{ is odd},
	\end{cases}\]
	where the last equality is verified by expanding $2\cos\theta=e^{i\theta}+e^{-i\theta}$.
\end{example}
\begin{example}[complex multiplication]
	We continue with the elliptic curve $E\colon y^2=x^3+1$ over $\QQ$ studied in \Cref{ex:pot-cm-ec-st,ex:pot-cm-ec-st-measure}. Fix some integer $m\ge0$. Using the given Haar measure, we find that one expects the average of $\left\{\left(\tr\frac1{\sqrt{\op N(\mf p)}}\iota\rho_\ell(\mathrm{Frob}_{\mf p})\right)^m\right\}_{\mf p\text{ prime}}$ to be
	\[\int_0^{2\pi}(2\cos\theta)^m\frac1{4\pi}\,d\theta=\begin{cases}
		\frac12\binom{m}{m/2} & \text{if }m\text{ is even}, \\
		0 & \text{if }m\text{ is odd},
	\end{cases}\]
	where the last equality is verified by expanding $2\cos\theta=e^{i\theta}+e^{-i\theta}$.
\end{example}
We now return to $y^9=x(x-1)(x-\lambda)$. Here, we do not attempt to give explicit formulae, but we list the first few expected values, which were computed using SageMath.
\begin{example}
	Let $A$ be the Jacobian of the normalization of the proper curve with affine chart $y^9=x(x-1)(x-10)$. SageMath can verify that $A$ does not have complex multiplication. For $m\in\{0,1,\ldots,6\}$, we use \Cref{prop:generic-fermat-st-measure} to find that we expect the aveage of $\left(\tr\frac1{\sqrt{\op N(\mf p)}}\iota\rho_\ell(\mathrm{Frob}_{\mf p})\right)^m$ as $\mf p$ varies over primes $K$ (for $K$ containing $K_A^{\mathrm{conn}}$) to be as follows.
	\[\begin{array}{c|cccccccc}
		m & 0 & 1 & 2 & 3 & 4 & 5 & 6 \\\hline
		\text{expected} & 1 & 0 & 8 & 0 & 186 & 0 & 7160 \\
		\text{actual} & 1.0 & 0.0 & 7.8 & 0.2 & 180 & 16 & 6400
	\end{array}\]
	Here, the ``actual'' amounts have been rounded to two significant digits, and they were computed by averaging over primes $p<216289$ which were $1\pmod9$; the condition $p\equiv1\pmod9$ corresponds to splitting completely in $\QQ(\zeta_9)$ (see \Cref{rem:only-use-split-complete-st}). These ``actual'' amounts suggest that $K_A^{\mathrm{conn}}=\QQ(\zeta_9)$, a fact which we will verify in the next chapter.
\end{example}
\begin{example}
	Let $A$ be the Jacobian of the normalization of the proper curve with affine chart $y^9=x^3-1$, where $\lambda$ lives in a number field. For $m\in\{0,1,\ldots,6\}$, we use \Cref{prop:special-fermat-st-measure-1} to find that we expect the aveage of $\left(\tr\frac1{\sqrt{\op N(\mf p)}}\iota\rho_\ell(\mathrm{Frob}_{\mf p})\right)^m$ as $\mf p$ varies over primes $K$ (for $K$ containing $K_A^{\mathrm{conn}}$) to be as follows.
	\[\begin{array}{c|cccccccc}
		m & 0 & 1 & 2 & 3 & 4 & 5 & 6 \\\hline
		\text{expected} & 1 & 0 & 26 & 0 & 2118 & 0 & 239300 \\
		\text{actual} & 1.0 & 0.0 & 25 & 6.0 & 2000 & 890 & 220000
	\end{array}\]
	Here, the ``actual'' amounts have been rounded to two significant digits, and they were computed by averaging over primes $p<100000$ which were $1\pmod9$; the condition $p\equiv1\pmod9$ corresponds to splitting completely in $\QQ(\zeta_9)$ (see \Cref{rem:only-use-split-complete-st}). These ``actual'' amounts suggest that $K_A^{\mathrm{conn}}=\QQ(\zeta_9)$, a fact which we will verify in the next chapter.
\end{example}
\begin{remark}
	If one runs the same computation as in the previous example with $y^9=x\left(x^2+1\right)$, one should further restrict primes past $p\equiv1\pmod9$ in order to see the correct moment statistics. This is because now $K_A^{\mathrm{conn}}\ne\QQ(\zeta_9)$.
\end{remark}

\section{The Utility of \texorpdfstring{$L$-Functions}{ L-Functions}}
In this section, we will explain how $L$-functions are used in analytic number theory. Before delving into the main content of this section, we give a rough indication of what an $L$-function is, though we will wait to explain why we care. One generally expects an $L$-function to have a Dirichlet series
\[L(s)=\sum_{n=1}^\infty\frac{b_n}{n^s}\]
which converges in some region $\{s\in\CC:\Re s>\sigma\}$, where $\sigma$ is a real number. (We may call $\sigma$ the ``abscissa'' of convergence.) In this situation, one may find that $\sigma$ to is a pole of $L(s)$ (though not always), but we usually expect $L(s)$ to admit a meromorphic continuation beyond $\{s\in\CC:\Re s>\sigma\}$.

Another important feature is that $L$-functions frequently come with ``Euler products'' that look like
\[L(s)=\prod_pL_p(s),\]
where the ``Euler factor'' $L_p(s)$ is a rational function in $p^{-s}$. We will be mostly interested in non-vanishing and holomorphy of our $L$-functions, and these properties tend to be insensitive to adjusting finitely many Euler factors. Thus, we pick up the following notation.
\begin{notation}
	Given two infinite products $\prod_{p}a_p$ and $\prod_pb_p$, we write
	\[\prod_pa_p\doteq\prod_pb_p\]
	if and only if the two products are equal up to a finite number of nonzero terms.
\end{notation}

\subsection{The Prime Number Theorem}
To prove an equidistribution result, one needs to end up proving some natural density results. For a natural density result, one needs to be able to count a total in order to estimate the denominator. Thus, for \Cref{conj:st}, we will need to count the number of primes. As such, in this subsection, we will pick up some tools from analytic number theory, and then we will prove the prime number theorem as an application. Our exposition is very standard; for example, all arguments are results can be found in \cite[Chapter~3]{murty-analytic-nt}.

Formally, the prime number theorem states that
\[\sum_{p\le x}1\sim\frac x{\log x}.\]
% We begin by remarking that one can combinatorially get ``pretty close.''
% \begin{lemma}[Chebychev]
% 	For $x>0$, the number of primes less than or equal to $x$ is $O(x/\log x)$.
% \end{lemma}
% \begin{proof}
%
% \end{proof}
Now, even though we are interested in counting primes, it is easier to prove a result of the form
\[\sum_{p\le x}\log p\sim x\]
because the right-hand side is simpler (roughly speaking). Quickly, we give names to our ``prime-counting'' functions of interest.
\begin{definition}
	For $x>0$, define $\pi(x)$ as the number of primes $p\le x$, and define
	\[\psi(x)\coloneqq\sum_{\substack{p\text{ prime},k>0\\p^k\le x}}\log p.\]
	For brevity, we let $\Lambda(n)$ be $\log p$ if $n$ is a power of a prime $p$ and $0$ otherwise; then $\psi(x)=\sum_{n\le x}\Lambda(n)$.
\end{definition}
It is easier to estimate $\psi$ than $\pi$, but their estimates can be shown to be equivalent. To explain this, we use Abel summation.
\begin{proposition}[Abel summation] \label{prop:abel-sum}
	Choose a sequence of complex numbers $\{b_n\}_{n\ge1}$, and set $B(x)\coloneqq\sum_{n\le x}b_n$. For any continuously differentiable $f\colon[0,\infty)\to\CC$, we have
	\[\sum_{a\le n\le x}b_nf(n)=B(x)f(x)-\int_1^xB(t)f'(t)\,dt.\]
\end{proposition}
\begin{proof}
	The main idea is to write $b_n=B(n)-B(n-1)$, so telescoping shows
	\[\sum_{n\le x}b_nf(n)=B(\floor x)f(\floor x)-\sum_{n<\floor x}B(n)(f(n+1)-f(n)).\]
	Now, $f(n+1)-f(n)=\int_n^{n+1}f'(t)\,dt$, so the sum collapses into the integral
	\[\sum_{n\le x}b_nf(n)=B(\floor x)f(\floor x)-\int_1^{\floor x}B(t)f'(t)\,dt.\]
	It remains to move from $\floor x$ to $x$, for which we note that $B(t)=B(\floor x)$ for $t\in[\floor x,x]$, so
	\[B(x)f(x)-B(\floor x)f(\floor x)=\int_{\floor x}^xB(t)f'(t)\,dt,\]
	thereby completing the proof.
\end{proof}
\begin{corollary} \label{cor:pnt-by-chebychev}
	If $\psi(x)\sim x$, then $\pi(x)\sim x/\log x$.
\end{corollary}
\begin{proof}
	Given $\psi(x)\sim x$, we begin by claiming $\sum_{p\le x}\log p\sim x$. Indeed,
	\[\Bigg|\psi(x)-\sum_{p\le x}\log p\Bigg|=\sum_{\substack{p\text{ prime},k>1\\p^k\le x}}\log p.\]
	We bound this sum unintelligently: it is
	\[\sum_{k=2}^{\log_2x}\sum_{p\le x^{1/k}}\log p\le(\log_2x)(\sqrt x\log x),\]
	which is $o(x)$, and the claim follows.

	We now show $\pi(x)\sim x/\log x$. This requires Abel summation in the form of \Cref{prop:abel-sum}. Indeed, we see $\pi(x)$ equals
	\[\sum_{n\le x}1_{\text{is prime}}(n)\log n\cdot\frac1{\log n}=\frac1{\log x}\sum_{p\le x}\log p+\int_2^x\Bigg(\sum_{p\le x}\log p\Bigg)\frac1{t(\log t)^2}\,dt.\]
	Thus, it remains to show that the integral is $o(x/\log x)$. Well, $\sum_{p\le x}\log p\sim x$, so it is enough to show that the intgral $\int_2^x(\log t)^{-2}\,dt$ is $o(x/\log x)$. Well, for $x$ large, we see that
	\[\int_2^{\sqrt x}\frac1{(\log t)^2}\,dt+\int_{\sqrt x}^x\frac1{(\log t)^2}\,dt\le\sqrt x+\frac{x}{(\log\sqrt x)^2},\]
	which is manifestly $o(x/\log x)$.
\end{proof}
\begin{remark}
	In fact, one can reverse the application of \Cref{prop:abel-sum} to show the reverse implication, but we will not need this.
\end{remark}
We will spend the rest of our time trying to show that $\psi(x)\sim x$. We will use a weak form of the Weiner--Ikehara theorem to prove this from some analytic properties of the Riemann zeta function. As such, we spend some time working towards the Weiner--Ikehara theorem. Our approach follows \cite{newman-pnt} and uses the following Tauberian theorem.
\begin{theorem}[Newman] \label{thm:newman-simple-tauber}
	Let $f\colon[0,\infty)\to\CC$ be a bounded and piecewise continuous function, and let $F(s)\coloneqq\int_{\RR^+}f(t)e^{-st}\,dt$ denote the Laplace transform. Suppose that $F(s)$ admits an analytic continuation to the half-plane $\{s\in\CC:\op{Re}s\ge0\}$. Then the integral
	\[\int_{\RR^+}f(t)\,dt\]
	converges and equals $F(0)$.
\end{theorem}
\begin{proof}
	In order to estimate with convergent integrals, for any $T>0$, we define the function $F_T\colon\CC\to\CC$
	\[F_T(s)\coloneqq\int_0^Tf(t)e^{-st}\,dt.\]
	We quickly remark that $F$ is analytic on $\{s\in\CC:\op{Re}s>0\}$ for free because boundedness of $f$ implies that the integral converges in this region; similarly, we note that $F_T$ is automatically entire for any $T>0$.

	Our goal is to show that $F_T(0)\to F(0)$ as $T\to\infty$. We will estimate $\left|F(0)-F_T(0)\right|$ via some clever contour integration. Fix some $R>0$, which will eventually tend to $\infty$. Then we note that compactness of the interval $\{bi:-R\le b\le R\}$ implies that there is $\delta>0$ such that the analytic continuation of $F$ extends to an open set containing the box $\{a+bi:a\ge-\delta,-R\le b\le R\}$. We now let $\gamma$ denote the following contour, oriented counterclockwise.
	\begin{center}
		\begin{asy}
			size(5cm);
			real delta=0.3;
			draw((-0.9,0)--(1.3,0), gray);
			draw((0,-1.3)--(0,1.3), gray);
			draw(arc((0,0),(0,-1),(0,1)), linewidth(1.1));
			draw((0,1)--(-delta,1)--(-delta,-1)--(0,-1), linewidth(1.1));
			draw((0,0)--dir(-55));
			dot(dir(-55));
			label("$R$", dir(-55)/2, ENE);
			label("$\delta$", (-delta/2,1), N);
			label("$\gamma$",dir(45),NE);
		\end{asy}
	\end{center}
	We also let $\gamma_+$ and $\gamma_-$ denote the parts in the right-half and left-half planes, respectively. Now, the main trick is to note that
	\[F(0)-F_T(0)=\frac1{2\pi i}\int_\gamma\frac{F(s)-F_T(s)}s\cdot e^{sT}\left(1+\frac{s^2}{R^2}\right)\,ds\]
	by the Cauchy integral formula. (The magic will come from the strange factor $e^{sT}\left(1+s^2/R^2\right)$.) We now estimate this integral as (in order) $T\to\infty$, $\delta\to0$, and $R\to\infty$.
	\begin{itemize}
		\item We estimate the integral on $\gamma_+$. This can be done directly. On one hand, expanding out the integral reveals
		\[\left|F(s)-F_T(s)\right|\le\norm f_\infty\cdot\frac{e^{-T\Re s}}{\op{Re}s}.\]
		On the other hand, we note $s/R$ is on the unit circle, so
		\[\left|\frac{e^{st}}s\left(1+\frac{s^2}{R^2}\right)\right|\le\frac{e^{T\Re s}}{R}\cdot2\Re(s/R).\]
		Combining estimates, we bound our integral by
		\[\left|F(0)-F_T(0)\right|\le\frac{\norm f_\infty}{R},\]
		which vanishes as $R\to\infty$, as required.
		\item To estimate the integral on $\gamma_-$, we split the integral into a sum of integrals of $F$ and $F_T$ separately. In this point, we bound the integral of $F_T$. Here, $F_T$ is entire, we may replace the contour $\gamma_-$ with a semicircle of radius $R$ in the left-half plane. Proceeding as in the above point, we note that
		\[\left|F_T(s)\right|\le\norm f_\infty\cdot\frac{e^{-T\Re s}}{-\Re s}\]
		by expanding out the integral, and then estimating $e^{st}\left(1+s^2/R^2\right)$ as before yields
		\[\left|\frac1{2\pi i}\int_{\gamma_-}\frac{F_T(s)}s\cdot e^{sT}\left(1+\frac{s^2}{R^2}\right)\,ds\right|\le\frac{\norm f_\infty}R,\]
		which again vanishes as $R\to\infty$.
		\item It remains to bound the integral of $F$ over $\gamma_-$. This will require some care. We will split the estimates into the horizontal and vertical pieces. Throughout, $R$ and $\delta$ remain fixed, and we will only send $T\to\infty$; in particular, $F$ is bounded in the region of interest, so we may ignore its contribution.
		\begin{itemize}
			\item On the horizontal pieces, for $\delta>0$ small enough, we may still find that our integrand is on the order of $e^{T\Re s}\cdot 2\Re s$, as in the first point. However, we note that the function $x\mapsto xe^{-x}$ on $\RR^+$ achieves its maximum at $(1,1/e)$, so with $\Re s<0$, we see that our integrand is bounded by $e^{-1}/T$. To complete our estimate, we send $T\to\infty$.
			\item On the vertical piece, for $\delta>0$ small enough, we note
			\[\left|\frac{e^{sT}}s\left(1+\frac{s^2}{R^2}\right)\right|\le\frac{3e^{-\delta T}}\delta.\]
			Sending $T\to\infty$ causes this piece to vanish.
			\qedhere
		\end{itemize}
	\end{itemize}
\end{proof}
We are now ready to prove our weakened Weiner--Ikehara theorem. We follow \cite[Theorem~2]{vatwani-wi-tauber}.
\begin{theorem}[Weiner--Ikehara] \label{thm:wi}
	Choose a sequence of nonnegative real numbers $\{b_n\}_{n\ge1}$, and set $L(s)\coloneqq\sum_{n\ge1}b_nn^{-s}$ and $B(x)\coloneqq\sum_{n\le x}b_n$. Suppose the following.
	\begin{listroman}
		\item The series $L(s)$ converges absolutely for $\Re s>1$.
		\item The function $L(s)$ admits a meromorphic continuation to $\Re s=1$ and has no poles except possibly a simple pole at $s=1$ with residue $c$.
		\item We have $B(x)=O(x)$.
	\end{listroman}
	Then $B(x)=cx+o(x)$.
\end{theorem}
\begin{proof}
	% For psychological reasons, we note that dividing all $b_n$s by $c$ allows us to take $c=1$.
	There are two steps.
	\begin{enumerate}
		\item By \Cref{prop:abel-sum}, we see that
		\[L(s)=s\int_1^\infty B(t)t^{-s-1}\,dt\]
		holds for $\Re s>1$. Now, the idea is to apply \Cref{thm:newman-simple-tauber} to the integral
		\[\int_0^\infty\frac{B(e^{t})-ce^{t}}{e^{t}}e^{-st}\,dt=\frac{L(s+1)}{s+1}-\frac cs,\]
		where the equality follows from the previous one after the substitutions $s\mapsto s+1$ and $t\mapsto e^t$. Notably, we are allowed to apply \Cref{thm:newman-simple-tauber} because one already knows that the function $e^{-t}B\left(e^t\right)-c$ is bounded by (iii), and the right-hand side provides the required analytic continuation. Thus, we are told that
		\[\int_0^\infty\frac{B(e^{t})-ce^{t}}{e^{t}}\,dt=\int_1^\infty\frac{B(t)-ct}{t^2}\,dt\]
		converges.
		\item We are now ready to conclude. We must show that $B(x)/x\to1$ as $x\to\infty$. Suppose for the sake of contradiction this is not the case; then either $\limsup_{x\to\infty} B(x)/x>c$ or $\liminf_{x\to\infty} B(x)/x<c$. We handle the case $\limsup_{x\to\infty} B(x)/x>c$ because the other case is similar. In this case, there is $\varepsilon>0$ and an infinite sequence $\{x_i\}_{i\ge1}$ tending to infinity such that $B(x_i)/x_i>c(1+\varepsilon)$ for all $i\ge1$. For any such $x_i$, we see that
		\[\int_{x_i}^{(1+\varepsilon) x_i}\frac{B(t)-ct}{t^2}\,dt\ge\int_{x_i}^{(1+\varepsilon) x_i}\frac{(c+\varepsilon) x_i-ct}{t^2}\,dt.\]
		Upon a change of variables, we see this integral equals $\int_1^{1+\varepsilon}(c(1+\varepsilon)-ct)t^{-2}\,dt$, which is some nonzero constant not depending on $x_i$. Because we can let the $x_i$ tend to infinity, we conclude that the integral $\int_1^\infty(B(t)-ct)t^{-2}\,dt$ cannot converge! This is our required contradiction.
		\qedhere
	\end{enumerate}
\end{proof}
\begin{remark}
	Note that $L$ is by definition real on the real axis (when the series converges), which implies that the residue $c$ must be real because the residue equals the limit of $sL(s)$ as $s\to1^+$.
\end{remark}
\begin{remark}
	The hypothesis (c) in the statement of \Cref{thm:wi} is not necessary, but one requires a somewhat more technical proof.
\end{remark}
We will now apply \Cref{thm:wi} to show $\psi(x)\sim x$. Because (iii) of \Cref{thm:wi} is unrelated to the other two conditions, we handle it first. The argument is combinatorial.
\begin{lemma}[Chebychev] \label{lem:cheby-prime-bound}
	We have $\psi(x)=O(x)$.
\end{lemma}
\begin{proof}
	Arguing as in \Cref{cor:pnt-by-chebychev}, it is enough to show that $\sum_{p\le x}\log p=O(x)$. We proceed in steps.
	\begin{enumerate}
		\item For any $n\ge0$, we claim that $\sum_{n<p\le2n}\log p<2n\log2$. The idea is to consider $\binom{2n}n$. By expanding out its prime factorization, we note that $\binom{2n}n$ has each prime factor $p$ in the range $n<p\le2n$, so $\log\binom{2n}n\ge\sum_{n<p\le2n}\log p$. On the other hand, the binomial theorem requires $\binom{2n}n<(1+1)^{2n}$, so $\log\binom{2n}n<2n\log2$, as required.
		\item For any $\nu\ge0$, we claim that $\sum_{p\le2^\nu}\log p<2^{\nu+1}\log2$. Indeed, this sum is
		\[\sum_{k=0}^{\nu-1}\Bigg(\sum_{2^k<p\le 2^{k+1}}\log p\Bigg)\le\sum_{k=0}^{\nu-1}2^{k+1}\log2\]
		by the previous step, from which the claim follows.
		\item We complete the proof. For any $x>1$, we may find $\nu\ge0$ such that $2^\nu\le x<2^{\nu+1}$. Then $\sum_{p\le x}\log p$ is bounded by $2^{\nu+2}\log2$ by the previous step, but this is in turn bounded by $4x\log2$, so we are done.
		\qedhere
	\end{enumerate}
\end{proof}
For (i) of \Cref{thm:wi}, we must explain the relevance of the Riemann $\zeta$-function to our argument.
\begin{defihelper}[Riemann $\zeta$-function] \nirindex{Riemann zeta function@Riemann $\zeta$-function}
	We define the \textit{Riemann $\zeta$-function} by
	\[\zeta(s)\coloneqq\sum_{n=1}^\infty\frac1{n^s}.\]
\end{defihelper}
\begin{lemma} \label{lem:dlog-zeta}
	For $s$ such that $\Re s>1$, we have $\zeta(s)\ne0$ and
	\[\frac{\zeta'}\zeta(s)=-\sum_{n=1}^\infty\frac{\Lambda(n)}{n^s}.\]
	This series also converges absolutely for $\Re s>1$.
\end{lemma}
\begin{proof}
	Unique prime factorization produces the Euler product
	\[\zeta(s)=\prod_p\frac1{1-p^{-s}},\]
	so taking logarithms implies
	\[\log\zeta(s)=\sum_p-\log\left(1-p^{-s}\right).\]
	Using the Taylor expansion of $\log(1-x)$, we find that
	\[\log\zeta(s)=\sum_p\sum_{k=1}^\infty\frac{1}{kp^{ks}}.\]
	The claimed equality would now follow by taking the derivative with respect to $s$, but of course, we must know that $\log\zeta(s)$ is an analytic function to be able to do this. Well, we will actually show that the right-hand side is absolutely convergent, which we note then implies $\zeta(s)\ne0$. To check absolute convergence, we may rearrange our sum, so we sum over $k$. The $k=1$ term is bounded by $\zeta(\Re s)$, which is finite. For the remaining terms, we bound our sum in magnitude by
	\[\sum_{n=1}^\infty\sum_{k=2}^\infty\frac1{n^{k}}=\sum_{n=1}^\infty\frac{1/n^2}{1-1/n}.\]
	The summand is $\frac1{n(n-1)}$, so the entire sum converges.
\end{proof}
Thus, the function $L(s)$ arising from trying to show $\psi(x)\sim x$ is simply $\zeta'(s)/\zeta(s)$. It remains to show the required facts about meromorphic continuation for (ii). We begin by showing that $\zeta$ continues.
\begin{lemma} \label{lem:zeta-meromorphic-continue}
	The function $\zeta(s)$ admits a meromorphic continuation to $\Re s>0$ with no poles except a simple pole at $s=1$ with residue $1$.
\end{lemma}
\begin{proof}
	We use Abel summation. By \Cref{prop:abel-sum}, we see that
	\[\zeta(s)=s\int_1^\infty\floor tt^{-s-1}\,dt.\]
	Now, we write $\floor t=t-\{t\}$ to see
	\[\zeta(s)=\frac s{s-1}-s\int_1^\infty\{t\}t^{-s-1}\,dt.\]
	The listed claims will follow once we show that the reminaing integral $I(s)$ is analytic on $\Re s>0$. Well, we see
	\[\left|I(s)\right|\le\int_1^\infty\frac{1}{t^{\Re s+1}}\,dt=\frac1{\Re s},\]
	so the integral is always finite, so the integral is analytic because the integrand is.\footnote{This point techincally requires some care because one needs to apply some kind of dominated convergence theorem as in \cite{mattner-diff-under-integral}. Our proof actually shows that $I(s)$ is analytic on any region $\{s:\Re s>\sigma\}$ for any $\sigma>0$, from which $I(s)$ being analytic on $\{s:\Re s>0\}$ follows by taking unions.}
\end{proof}
% \begin{remark}
% 	We take a moment to explain that one can now remove the requirement $c>0$ from \Cref{thm:wi}: indeed, even if $c\le0$, then one can replace $b_n$ with $b_n+m$ for some large $m$, hence replacing $L(s)$ with $L(s)+m\zeta(s)$. Then theorem applies to $L(s)+m\zeta(s)$ if $m$ is large enough to give $c+m>0$, and then the conclusion for $L(s)+m\zeta(s)$ implies the conclusion for the original sequence.
% \end{remark}
Thus, the check (ii) of \Cref{thm:wi} amounts to the following non-vanishing result.
\begin{proposition} \label{prop:zeta-nonvanish}
	If $s\in\CC$ has $\Re s=1$, then $\zeta(s)\ne0$.
\end{proposition}
\begin{proof}
	The following proof is tricky. We proceed in steps, following \cite[Section~3.2]{murty-analytic-nt}.
	\begin{enumerate}
		\item For $\sigma>1$ and $t\in\RR$, we claim that
		\[\Re\log\zeta(\sigma+it)\stackrel?=\sum_{n=2}^\infty\frac{\Lambda(n)\cos(t\log n)}{n^\sigma\log n}.\]
		Well, the argument of \Cref{lem:dlog-zeta} (equivalently, integrating the statement) shows that
		\[\log\zeta(s)=\sum_p\sum_{k=1}^\infty\frac1{kp^{ks}},\]
		where $s=\sigma+it$. This sum absolutely converges (as shown in \Cref{lem:dlog-zeta}), so we may view it as a sum over prime-powers $n=p^k$, in which case we see that the summand is $\Lambda(n)n^{-s}/\log n$. Thus, we see that
		\[\log\zeta(s)=\sum_{n=2}^\infty\frac{\Lambda(n)}{n^\sigma\log n}\cdot n^{-it}.\]
		We conclude by noting that $\Re n^{-it}=\cos(t\log n)$.
		\item For $\sigma>1$ and $t\in\RR$, we claim that
		\[\left|\zeta(\sigma)^3\zeta(\sigma+it)^4\zeta(\sigma+2it)\right|\stackrel?\ge1.\]
		Well, by taking logarithms, it is enough to show that
		\[3\Re\log\zeta(\sigma)+4\Re\log\zeta(\sigma+it)+\Re\log\zeta(\sigma+2it)\stackrel?\ge0.\]
		By the previous step, we see that it is enough to check that
		\[3+4\cos\theta+\cos2\theta\ge0\]
		for any $\theta\in\RR$. This amounts to mimizing the function $4\cos\theta+\cos2\theta$; taking the derivative reveals that minima will occur when $\sin x=0$ or $\cos x=1$, so $x$ is a multiple of $\pi$. Thus, we complete this step by noting that the above inequality holds when $x$ is a multiple of $\pi$.
		\item We conclude the proof. Fix some nonzero real number $t$, and we would like to show that $\zeta(1+it)\ne0$. Well, suppose for the sake of contradiction that $\zeta(1+it)=0$. Then
		\[\lim_{\sigma\to1^+}\zeta(\sigma)^3\zeta(\sigma+it)^4\zeta(\sigma+2it)=0\]
		because the order of the zero at $\sigma=0$ is at least $-3+4+0>0$. This contradicts the previous step, so we are done.
		\qedhere
	\end{enumerate}
\end{proof}
We are now ready to prove the Prime number theorem.
\begin{theorem}[Prime number] \label{thm:prime}
	We have $\pi(x)\sim x/\log x$.
\end{theorem}
\begin{proof}
	It only remains to synthesize the discussion from this subsection. By \Cref{cor:pnt-by-chebychev}, it is enough to show $\psi(x)\sim x$. For this, we will use \Cref{thm:wi} applied to the sequence $\{\Lambda(n)\}_{n\ge1}$, for which \Cref{lem:dlog-zeta} explains makes the Dirichlet series equal to $-\zeta'(s)/\zeta(s)$. It remains to check the three conditions in \Cref{thm:wi}.
	\begin{listroman}
		\item The absolute convergence of $-\zeta'(s)/\zeta(s)$ follows because $\Lambda(n)=O(n^\varepsilon)$ for any $\varepsilon>0$, so the series converges absolutely and uniformly on compacts on any region $\{s\in\CC:\Re s>\varepsilon\}$ for any $\varepsilon>0$.
		\item Because $\zeta(s)$ is nonzero on $\{s:\Re s=1\}$, we conclude that $-\zeta'(s)/\zeta(s)$ admits a meromorphic continuation to this line. We already know that we are defined everywhere except at $s=1$, and we see that having $\zeta$ have a simple pole with reside $1$ at $s=1$ implies the same for $-\zeta'(s)/\zeta(s)$ by expanding out a Taylor series at $s=1$.
		\item Lastly, we see $\psi(x)=O(x)$ by \Cref{lem:cheby-prime-bound}.
		\qedhere
	\end{listroman}
\end{proof}

\subsection{The Prime Ideal Theorem}
In the sequel, we will want to count not just rational primes but also for number fields, so we want to extend \Cref{thm:prime} to number fields. The method remains the same, though we will not give a complete proof now because showing the required meromorphic continuation is harder. Our exposition loosely follows \cite[Sections~7.4 and~7.7]{rv-fourier-analysis-number-fields}, which in turn follows \cite{heilbronn-zeta}.

Here are our prime-counting functions.
\begin{definition}
	Fix a number field $K$. For $x>0$, define $\pi_K(x)$ as the number of prime ideals $\mf p$ with $\op N\mf p\le x$. Now, define $\Lambda_K$ as a function on the ideals of $\OO_K$ by
	\[\Lambda_K(I)\coloneqq\begin{cases}
		\log\op N\mf p & \text{if }I=\mf p^k\text{ for }k\ge1, \\
		0 & \text{else},
	\end{cases}\]
	and we set $\psi_K(x)\coloneqq\sum_{\op N(I)\le x}\Lambda_K(I)$.
\end{definition}
This time around, the relevant $L$-function for the Weiner--Ikehara theorem is as follows.
\begin{definition}[Dedekind zeta function]
	Fix a number field $K$. Then we define the \textit{Dedekind $\zeta$-function} as
	\[\zeta_K(s)\coloneqq\sum_{I\subseteq\OO_K}\frac1{\op N(I)^s}.\]
\end{definition}
\begin{remark}
	As in \Cref{lem:dlog-zeta}, we note that one has an Euler product
	\[\zeta_K(s)=\prod_{\mf p\text{ prime}}\frac1{1-\op N\mf p^{-s}}.\]
\end{remark}
It will later be convenient to ``twist'' our Dedekind zeta function slightly.
\begin{defihelper}[Hecke $L$-function] \nirindex{Hecke L-function@Hecke $L$-function}
	Fix a number field $K$ and a continuous character $\chi\colon K^\times\backslash\AA_K^\times\to\CC^\times$. Factoring $\chi=\prod_v\chi_v$ as a product over places of $K$, we define the \textit{Hecke $L$-function} as $L(\chi)\coloneqq\prod_{\mf p}(1-\chi_{\mf p}(\mf p))^{-1}$, where
	\[\chi_{\mf p}(\mf p)\coloneqq\begin{cases}
		\chi_{\mf p}(\varpi_{\mf p}) & \text{if }\chi_{\mf p}|_{\OO_{\mf p}^\times}=1, \\
		0 & \text{else},
	\end{cases}\]
	where $\varpi_{\mf p}\in\mf p$ is a uniformizer.
	We may call the former case ``unramified'' and the latter case ``ramified.'' If $\chi$ is a unitary character (i.e., $\im\chi\subseteq S^1$), then we may also write $L(s,\chi)\coloneqq L\left(\chi\left|\cdot\right|^s\right)$.
\end{defihelper}
\begin{remark} \label{rem:hecke-euler-prod}
	By expanding out $(1-\chi_{\mf p}(\mf p))^{-1}=\sum_{k=0}^\infty\chi_{\mf p}(\mf p)^k$, we see that one can recover a ``Dirichlet series'' expansion for $L(s,\chi)$ in the form
	\[L(s,\chi)=\sum_{I\subseteq\OO_K}\frac{\chi(I)}{\op N(I)^s}\]
	for suitably defined $\chi(I)$ (depending on its prime factorization).
\end{remark}
\begin{example}
	If $\chi$ is the trivial character, then we recover the Dedekind $\zeta$-function.
\end{example}
\begin{example}
	Take $K=\QQ$. Given a character $\chi\colon(\ZZ/n\ZZ)^\times\to\CC^\times$, we abuse notation and lift $\chi$ to a character $K^\times\backslash\AA_K^\times\to\CC^\times$ via the composition
	\[\QQ^\times\backslash\AA_\QQ^\times=\RR^+\times\prod_p\ZZ_p^\times\onto\prod_p\ZZ_p^\times\onto(\ZZ/n\ZZ)^\times\stackrel\chi\to\CC^\times.\]
	Upon expanding out the Euler product, we find
	\[L(s,\chi)=\sum_{n=1}^\infty\frac{\chi(n)}{n^s}.\]
\end{example}
We begin by stating part of the required analytic check.
\begin{lemma} \label{lem:hecke-abs-conv}
	Fix a number field $K$ and a continuous unitary character $\chi\colon K^\times\backslash\AA_K^\times\to\CC^\times$. Then $L(s,\chi)$ converges absolutely and is nonzero for $s$ such that $\Re s>1$.
\end{lemma}
\begin{proof}
	We will instead show that
	\[\log L(s,\chi)=\sum_{\mf p}-\log\left(1-\chi_{\mf p}(\mf p)\op N\mf p^{-s}\right)\]
	absolutely converges when $\Re s>1$. (Some formal business involving Euler products can then show that the Dirichlet series described in \Cref{rem:hecke-euler-prod} also converges absolutely.) Using the Taylor expansion, our sum is
	\[\log L(s,\chi)=\sum_{\mf p}\sum_{k\ge1}\frac{\chi_{\mf p}(\mf p)^k}{k\op N\mf p^{ks}}.\]
	Now, to check absolute convergence, we see that may replace $\left|\chi_{\mf p}(\mf p)^k\right|\in\{0,1\}$ with $1$, essentially reducing to the case where $\chi=1$.

	We now find a way to reduce to the case for $K=\QQ$, where the result follows from the argument of \Cref{lem:dlog-zeta}. Well, for each prime $\mf p$, we see that $\op N\mf p\ge p$ where $p$ is the prime lying over $\mf p$. Further, there are at most $[K:\QQ]$ primes of $K$ sitting above $p$, so we see that
	\[\left|\log L(s,\chi)\right|\le[K:\QQ]\sum_{p}\sum_{k\ge1}\frac{1}{kp^{k\Re s}}.\]
	We now have reduced to the situation in \Cref{lem:dlog-zeta}, so we are done.
\end{proof}
\begin{remark} \label{rem:dlog-zeta-k}
	Term-by-term differentiation shows that the Dirichlet series defining $-L'(s,\chi)/L(s,\chi)$ continues to be absolutely convergent for $s$ satisfying $\Re s>1$. In particular, we see that
	\[-\frac{\zeta_K'(s)}{\zeta_K(s)}=\sum_{I\subseteq\OO_K}\frac{\Lambda_K(I)}{\op N(I)^s}.\]
\end{remark}
This time around, one lacks the integration trick done in \Cref{lem:zeta-meromorphic-continue}. The proof is significantly more involved, so we merely state the result we need.
\begin{theorem}[Hecke] \label{thm:hecke-continue}
	Fix a number field $K$ and a continuous unitary character $\chi\colon K^\times\backslash\AA_K^\times\to\CC^\times$. Then $L(s,\chi)$ admits a meromorphic continuation to $\{s:\Re s>0\}$. Further, $L(s,\chi)$ has no poles except a simple pole when $\chi\left|\cdot\right|^s$ is trivial on all unramified primes.
\end{theorem}
\begin{proof}
	It is possible to prove an analytic continuation to $\{s:\Re s=1\}$ ``combinatorially,'' essentially by counting ideals of bounded norm; for example, see \cite[Section~11.2]{murty-alg-nt}. However, the best proofs of this result go through Tate's thesis \cite{tate-thesis}. See also \cite[Theorem~7-19]{rv-fourier-analysis-number-fields}.
\end{proof}
Because it is more within reach (and closer in flavor to the results we are interested in), we will prove the needed non-vanishing result.
\begin{proposition} \label{prop:hecke-nonvanish}
	Fix a number field $K$ and a continuous unitary character $\chi\colon K^\times\backslash\AA_K^\times\to\CC^\times$. If $s\in\CC$ has $\Re s=1$, then $L(s,\chi)\ne0$.
\end{proposition}
\begin{proof}
	Note that $L(s+it,\chi)=L\left(s,\chi\left|\cdot\right|^{it}\right)$, so we may twist $\chi$ in order to assume that $s=1$. Now, if $\chi$ is trivial on the finite adeles $(\AA_K^\infty)^\times$, then \Cref{thm:hecke-continue} explains that there is a pole, so there is nothing to do. We now admit two lengthy cases.
	There are two lengthy cases.
	\begin{itemize}
		\item Suppose that $\chi^2_{\mf p}$ is nontrivial on some unramified prime $\mf p$. In this case, we may proceed as in \Cref{prop:zeta-nonvanish}: for $\sigma>1$, an expansion as in \Cref{lem:hecke-abs-conv} finds that
		\[\Re\log L(\sigma,\chi)=\sum_{\mf p}\sum_{k\ge1}\frac{\cos(k\theta_{\mf p})}{\op N\mf p^{k\sigma}},\]
		where $\theta_{\mf p}\in\RR$ is chosen so that $\chi_\mf p(\mf p)=e^{i\theta_{\mf p}}$. But now the trigonmetric identity $3+4\cos\theta+\cos2\theta$ proven in \Cref{prop:zeta-nonvanish} verifies that
		\[\left|L(\sigma,1)^3L(\sigma,\chi)^4L(\sigma,\chi^2)\right|\gg1,\]
		where the implied constant comes from replacing the Euler product for $L(\sigma,1)$ with one with the correct Euler factors at ramified primes. We now send $\sigma\to0^+$ and see that having $L(\sigma)=0$ would force the entire quantity to vanish by pole-counting: we have a zero of order at least $-3+4+0>0$, where notably, the hypothesis implies that there is no pole at $L(1,\chi^2)$.

		\item Now suppose that $\chi^2$ is trivial on all unramified primes. The idea is to consider the Dirichlet series $L(s)\coloneqq\zeta_K(s)L(s,\chi)$, for which one can use the Dirichlet convolution to find equals
		\[L(s)=\sum_{I\subseteq\OO_K}\Bigg(\sum_{I=AB}\chi(B)\Bigg)\frac1{\op N(I)^s},\]
		for suitably defined $\chi(I)$. We are going to appeal to some somewhat difficult fact about Dirichlet series. To this end, we want some input from the coefficient $b(I)\coloneqq\sum_{I=AB}\chi(B)$. Multiplicativity reveals that
		\[b(I)=\prod_{\mf p}\left(1+\chi(\mf p)+\cdots+\chi(\mf p^{\nu_{\mf p}(I)}\right),\]
		and $\chi$ outputs to $\{-1,0,1\}$, so we see that $b(I)$ is a nonnegative integer always. Furthermore, $b(I)$ is nonzero when $I$ is a square (because each factor is nonzero), so we see that $L(s)\ge\zeta_K(2s)$. For example, the pole at $s=1$ for $\zeta_K(2s)$ then implies that $L(s)$'s abscissa of holomorphy cannot go past $\{s:\Re s=1/2\}$.

		Now, because $L(s)$ has all nonnegative coefficients, its abscissa of holomorphy agrees with its abscissa of absolute convergence \cite[Lemmas~7-29]{rv-fourier-analysis-number-fields}. Thus, if $L(s,\chi)$ has a zero at $s=1$, then $L(s)$ will succeed at being holomorphic at $s=1$, so the abscissa of holomorphy for $L(s)$ goes all the way to $\Re s=0$ by \Cref{thm:hecke-continue}. This contradicts the previous paragraph.
		\qedhere
	\end{itemize}
\end{proof}
At long last, we are ready to apply \Cref{thm:wi}.
\begin{theorem}[Prime ideal] \label{thm:prime-ideal}
	We have
	\[\{\mf p:\op N\mf p\le x\}\sim \frac x{\log x}.\]
\end{theorem}
\begin{proof}
	Arguing as in \Cref{cor:pnt-by-chebychev}, it is enough to check that the function
	\[\psi_K(x)\coloneqq\sum_{\substack{\mf p\text{ prime},k\ge1\\\op N\mf p^k\le x}}\log\op N\mf p\]
	satisfies $\psi_K(x)\sim x$, for which we use \Cref{thm:wi}. Now, \Cref{rem:dlog-zeta-k} explains that $-\zeta_K'/\zeta_K$ is the relevant Dirichlet series. We are now ready to run the checks of \Cref{thm:wi}.
	\begin{listroman}
		\item The absolute convergence of $-\zeta'(s)/\zeta(s)$ on $\{s:\Re s>1\}$ follows from \Cref{lem:hecke-abs-conv}.
		% , we must check that
		% \[\sum_{\op N(I)=n}\Lambda_K(I)\stackrel?=O(n^\varepsilon)\]
		% for any $\varepsilon>0$. For this, we may assume that $n$ is a prime-power $p^k$, in which case we see that each summand is $\log\op N\mf p$ where $\mf p$ is some prime sitting above $\mf p$, and the number of terms is bounded by the number of primes $\mf p$ sitting above $p$. Thus, we may our sum is at most $n=p^k$ by $[K:\QQ]\log p^k$.

		\item Note that $\zeta_K(s)$ continues to $\{s:\Re s=1\}$ by \Cref{thm:hecke-continue}, and it is nonvanishing by combining \Cref{lem:hecke-abs-conv} with \Cref{prop:hecke-nonvanish}. Thus, we achieve the continuation of $-\zeta_K'(s)/\zeta_K(s)$, and we can compute that the residue of its simple pole at $s=1$ is $1$.

		% This is truly difficult. To get the meromorphic continuation, one can proceed with a difficult but mostly elementary ideal-counting argument as in \cite[Theorem~11.1.5]{murty-alg-nt}. However, the best arguments factor through Tate's thesis \cite{tate-thesis}. We refer in particular to \cite[Theorem~7.28]{rv-fourier-analysis-number-fields} for the non-vanishing result.

		\item To check $\psi_K(x)=O(x)$, we claim that
		\[\sum_{\op N(I)\le x}\Lambda_K(I)\stackrel?\le\sum_{\substack{p\text{ prime},k\ge1\\p^k\le x}}[K:\QQ]\log p^k.\]
		Indeed, it is enough to only consider $I$ of the form $\mf p^k$; summing over the primes $p$ below $\mf p$, we may upper-bound $\Lambda_K(I)$ by $\log p^k$ and then maximize the number of terms in the sum by noting that there are at most $[K:\QQ]$ primes $\mf p$ above $p$ and bounding $\op N\mf p^k\le p^k$.

		Now, arguing as in \Cref{cor:pnt-by-chebychev}, one finds that $\psi_K(x)=O(x)$ now follows from $\psi(x)=O(x)$. Roughly speaking, the size of this sum is dominated by the $k=1$ term (what is left is $O\left(\sqrt x(\log x)^2\right)$), and the $k=1$ term is a constant multiple of $\psi(x)$, so we are done.
		\qedhere
	\end{listroman}
\end{proof}

\subsection{Equidistribution}
In this subsection, we will prove a few facts about equidistribution, following \cite[Section~2]{fite-intro-st} and \cite[Appendix to Chapter~I]{serre-l-adic-reps}. Although the term already appeals in the statement of our conjecture (\Cref{conj:st}), we go ahead and provide a suitable definition. We will assume some measure theory throughout, though we remark that our measures $\mu$ will all be Radon on compact Hausdorff spaces $X$, so they may be thought of as continuous linear functionals on $C(X)$ by the Reisz representation theorem \cite[Theorem~7.2]{folland-real-analysis}, where $C(X)$ denotes the space of complex continuous functions on $X$.
\begin{definition}[equidistributed]
	Fix a compact Hausdorff space $X$ with a probability Radon measure $\mu$ (namely, $\mu(X)=1$). Then a sequence $\{x_n\}_{n\ge1}$ is \textit{equidistriubted} with respect to $\mu$ if and only if any $f\in C(X)$ has
	\[\lim_{N\to\infty}\frac1N\sum_{n=1}^Nf(x_i)=\int_Xf\,d\mu.\]
\end{definition}
\begin{remark}
	One may want to upgrade this definition from $f\in C(X)$ to $f\in L^1(X)$ or similar, but this is somewhat tricky: functions in $L^1(X)$ are well-defined up to a measure-zero subset, and it is frequently the case that countable subsets of $X$ are measure zero. Concretely, with $X=[0,1]$, we find that no countable sequence will equidistribute by testing against the function $f$ which indicates this sequence!
\end{remark}
% \begin{remark}
% 	Quickly, we note that $f\in L^2(X)$ implies $f\in L^1(X)$: one can replace $f\in L^2(X)$ with $\max\{\left|f\right|,1\}\in L^2(X)$ (note $X$ is a finite measure space!), and then we see that $f\le f^2$ always, so $f^2\in L^1(X)$ implies $f\in L^1(X)$.
% \end{remark}
The definition has been chosen to be quite strong, but this makes it difficult to check. As such, we pick up the following lemma.
\begin{lemma} \label{lem:equi-by-dense}
	Fix a compact Hausdorff space $X$ with a probability Radon measure $\mu$. The following are equivalent for a sequence $\{x_n\}_{n\ge1}$.
	\begin{listroman}
		\item The sequence $\{x_n\}_{n\ge1}$ equidistributes.
		\item Suppose that $F\subseteq C(X)$ is a subset of functions such that linear combinations of functions in $F$ forms a dense subspace of $C(X)$. Then for any $f\in F$, we have
		\[\lim_{N\to\infty}\frac1N\sum_{n=1}^Nf(x_i)=\int_Xf\,d\mu.\]
	\end{listroman}
\end{lemma}
\begin{proof}
	Of course (i) implies (ii) because $F\subseteq C(X)$. For the reverse inclusion, let $V\subseteq C(X)$ denote the subset for which the conclusion holds. We know $F\subseteq V$, and we would like to show that $V=L^1(X)$. Certainly $V$ is a subspace, and by the hypothesis of $F$, we see that $V$ is a dense subspace of $L^1(X)$. Thus, for any $f\in C(X)$, we fix some $\varepsilon>0$, and we may find $g_\varepsilon\in V$ such that $\norm{f-g_\varepsilon}_\infty<\varepsilon$. Then
	\begin{align*}
		\left|\lim_{N\to\infty}\frac1N\sum_{n=1}^Nf(x_i)-\int_Xf\,d\mu\right| &\le \left|\lim_{N\to\infty}\frac1N\sum_{n=1}^Ng_\varepsilon(x_i)-\int_Xg_\varepsilon\,d\mu\right| \\
		&\qquad+\left|\lim_{N\to\infty}\frac1N\sum_{n=1}^N(f-g_\varepsilon)(x_i)\right|+\left|\int_X(f-g_\varepsilon)\,d\mu\right|.
	\end{align*}
	The rightmost term vanishes because $g\in V$, and the remaining terms are bounded by $2\varepsilon$, which goes to $0$ we send $\varepsilon\to0^+$.
\end{proof}
In the sequel, we will be interested in the case where $X=\op{Conj}(G)$ where $G$ is some compact Hausdorff topological group; here $X$ is given the quotient topology induced by the canonical projection $G\onto X$. We quickly note that $X$ is certainly compact, and $X$ is Hausdorff because $G$ is normal (and conjugacy classes are closed because they are images of certain continuous maps $G\to G$). We now note that Fourier analysis can detect equidistribution.
\begin{lemma} \label{lem:equi-by-chars}
	Fix a compact Hausdorff topological group $G$ with probability Haar measure $\mu$, and set $X\coloneqq\op{Conj}(X)$. The following are equivalent for a sequence $\{x_n\}_{n\ge1}$ of $X$.
	\begin{listroman}
		\item The sequence $\{x_n\}_{n\ge1}$ equidistributes.
		\item For any nontrivial finite-dimensional complex irreducible continuous representation $\rho$, one has
		\[\lim_{N\to\infty}\frac1N\sum_{n=1}^N\tr\rho(x_i)=0.\]
	\end{listroman}
\end{lemma}
\begin{proof}
	Quickly, we note that (ii) has $\tr\rho(x_i)$ well-defined because the character of a representation is well-defined up to conjugacy. Now (i) implies (ii) is immediate because $({\tr}\circ\rho)\colon X\to\CC$ is a continuous function.
	
	For (ii) implies (i), we use \Cref{lem:equi-by-dense}. By (ii) above, we see that the conclusion of (ii) in \Cref{lem:equi-by-dense} holds for each of the nontrivial irreducible characters ${\tr}\circ\rho$ of $G$ because
	\[\int_G\rho\,d\mu=0\]
	by the nontriviality of $\rho$. Additionally, we note that the conclusion of (ii) in  \Cref{lem:equi-by-dense} also holds for the trivial character because then everything in sight is $1$. Thus, it remains to check that irreducible characters of $G$ form a dense subset of $C(X)$. In fact, characters are dense in $L^2(G)$ by (a corollary to) the Peter--Weyl theorem \cite[Proposition~5.23]{folland-harmonic-analysis}, so we are done.
\end{proof}
\begin{remark}
	Of course, one may replace the application of the Peter--Weyl theorem when it is easier to prove. For example, if $G$ is a finite abelian group, then the relevant Fourier analysis is much easier to prove.
\end{remark}
\begin{example}
	Consider the compact abelian group $G=\RR/\ZZ$ so that $G=X$. We claim that the sequence $\{n\alpha\}_{n\ge0}$ equidistributes in $G$ for any irrational $\alpha\in\RR$.
	
	Quickly, we note that the representations of $G$ are one-dimensional because $G$ is abelian. Further, we claim they all take the form $t\mapsto e^{2\pi imt}$ for $m\in\ZZ$: indeed, any character of $G$ must lift to a character $\RR\to\CC^\times$, but it must land in $S^1$ because $G$ is compact, so our character further lifts to a homomomorphism $\RR\to\RR$. Continuous homomomorphisms $\RR\to\RR$ are just scalars, so the claim follows upon ensuring that the induced map $\RR\to S^1$ has $\ZZ$ in its kernel.

	To conclude the proof, it is now enough to compute that any nonzero $m$ makes
	\[\sum_{n=0}^Ne^{2\pi imn\alpha}=\frac{e^{2\pi im(N+1)\alpha}-1}{e^{2\pi im\alpha}-1},\]
	which is $O_m(1)$ and hence $o_m(N)$.
\end{example}
As in the example, we remark that the condition (ii) may also be read as
\[\sum_{n=1}^N\tr\rho(x_i)=o(N),\]
so it is the sort of thing that one may hope to prove using the Weiner--Ikehara theorem (\Cref{thm:wi}). We explain the application as follows.
\begin{proposition}[Serre] \label{prop:equi-by-l-func}
	Fix a compact Hausdorff topological group $G$ with probability Haar measure $\mu$, and set $X\coloneqq\op{Conj}(X)$. Further, fix a number field $K$, and order the set of finite places $\mf p$ by norm (breaking ties arbitrarily), and let $\{x_{\mf p}\}_{\mf p}$ be a sequence in $X$. Now, for each finite-dimensional complex continuous representation $\rho$ of $G$, define the $L$-function
	\[L(s,\rho)\coloneqq\prod_{\mf p}\frac1{\det\left(1-\rho(x_{\mf p})\op N\mf p^{-s}\right)},\]
	and suppose that $L(s,\rho)$ admits a non-vanishing holomorphic analytic continuation to the line $\{s:\Re s=1\}$ for each nontrivial irreducible $\rho$. Then the sequence $\{x_\mf p\}_{\mf p}$ equidistributes in $G$.
\end{proposition}
\begin{proof}
	We apply \Cref{lem:equi-by-chars}. Using \Cref{thm:prime-ideal} to count the number of prime ideals $\mf p$ of norm less than some bound, we see that we need
	\[\sum_{\op N\mf p\le x}\tr\rho(x_\mf p)\stackrel?=o_\rho\left(\frac x{\log x}\right)\]
	for all nontrivial irreducible complex representations $\rho$ of $G$. We go ahead and fix such a representation $\rho$; set $d\coloneqq\dim\rho$ for brevity. We proceed in steps.
	\begin{enumerate}
		\item As in \Cref{thm:prime}, the idea is to apply the Weiner--Ikehara theorem to the logarithmic derivative $L(s,\rho)$. The correct ``twisted'' prime-counting function is a little involved, so we postpone its computation for a moment. Instead, let's go ahead and compute $-L'(s,\rho)/L(s,\rho)$. For each $\mf p$, let $\{\lambda_{\mf p1},\ldots,\lambda_{\mf pd}\}$ denote the eigenvalues of $\rho(x_\mf p)$ (counted with multiplicity), so we see that
		\[\log\left(\det\left(1-\rho(x_\mf p)\op N\mf p^{-s}\right)\right)=\sum_{i=1}^d\log\left(1-\lambda_{\mf pi}\op N\mf p^{-s}\right),\]
		so taking the logarithmic derivative as in \Cref{lem:dlog-zeta} of $L(s,\rho)$ yields
		\[-\frac{L'(s,\rho)}{L(s,\rho)}=\sum_{\mf p}\sum_{k\ge1}\sum_{i=1}^{d}\frac{\lambda_{\mf pi}^k\log\op N\mf p}{\op N\mf p^{ks}}.\]
		Thus, we see that the correct weights are given by
		\[\Lambda_\rho(I)\coloneqq\begin{cases}
			\sum_{i=1}^d\lambda_{\mf pi}^k\log\op N\mf p & \text{if }I=\mf p^k\text{ and }k\ge1, \\
			0 & \text{else}.
		\end{cases}\]
		In particular, $-L'(s,\rho)/L(s,\rho)=\sum_{I\subseteq\OO_K}\Lambda_\rho(I)/\op N(I)^s$; this sum is purely formal, in the sense that one side makes sense as soon as the other does. Do note that $\Lambda_\rho(\mf p)=\tr\rho(x_\mf p)\log\op N\mf p$ for each prime $\mf p$. Also, note 
		
		\item We now see that arguing as in \Cref{cor:pnt-by-chebychev} shows that it will be enough to check that
		\[\sum_{\substack{I\subseteq\OO_K\\\op N(I)\le x}}\Lambda_\rho(I)\stackrel?=o_\rho\left(x\right).\]
		This is somewhat involved, so we will provide some detail. Well, we group this sum as
		\[\sum_{\substack{\mf p\text{ prime},k>1\\\op Np^k\le x}}\Lambda_\rho\left(\mf p^k\right).\]
		We now have two observations.
		\begin{itemize}
			\item We note we may discard the terms with $k\ge2$. Because $G$ is compact, the eigenvalues $\lambda_{\mf pi}$ are all roots of unity, so the sum $\sum_{i=1}^d\lambda_{\mf pi}^k$ is $O_\rho(1)$, so we may ignore its contribution. Now, for each prime $\mf p$, we may rudely bound $\Lambda_\rho\left(\mf p^k\right)$ as $\log p^{[K:\QQ]k}$, where $p$ is the prime under $\mf p$. On the other hand, the number of primes $\mf p$ with $\op N\mf p$ can be na\"ively bounded by $[K:\QQ]$, so we will do so. Thus, we see that our contribution totals to
			\[\]
			\[[K:\QQ]^2\sum_{k=2}^{\log_2x}\sum_{p\le x^{1/k}}\log p\le[K:\QQ]^2(\log_2x)(\sqrt x\log x)\]
			as in \Cref{cor:pnt-by-chebychev}. We conclude that our hypothesis is equivalent to
			\[\sum_{\op N\mf p\le x}\Lambda_\rho(\mf p)\stackrel?=o_\rho(x).\]
			\item We now use Abel summation in the form of \Cref{prop:abel-sum} to see
			\[\sum_{\op N\mf p\le x}\tr\rho(x_\mf p)=\frac1{\log x}\sum_{\op N\mf p\le x}\Lambda_\rho(\mf p)+\int_2^x\Bigg(\sum_{\op N\mf p\le x}\Lambda_\rho(x)\Bigg)\frac1{t(\log t)^2}\,dt\]
			(Technically, we should stratify the sum over terms of given norm before applying Abel summation.) The left term in the right-hand side is now $o(x/\log x)$ by the hypothesis, and the right term is $o(x/\log x)$ as argued in \Cref{cor:pnt-by-chebychev}.
		\end{itemize}

		\item We are now ready to complete the proof using \Cref{thm:wi}. Here are our checks.
		\begin{listroman}
			\item It is enough to check that
			\[\sum_{\op N(I)=n}\Lambda_\rho(I)=O_\rho(n^\varepsilon)\]
			for each $\varepsilon>0$. We may assume that $I$ is a prime-power $\mf p^k$. As in the previous step, we see that the contribution from $\sum_{i=1}^d\lambda_{\mf pi}^k\log\op N\mf p$ is $O_\rho(1)$ is $O_\rho(1)$, so it has no effect. We now argue as in \Cref{thm:prime-ideal}: the number of $I$ with $I=\mf p^k$ is bounded by $[K:\QQ]$, and they only contribute $\log\op N\mf p=O(\log n)$. The result follows.
			\item This follows immediately from the hypothesis on $L(s,\rho)$.
			\item From \Cref{thm:prime-ideal}, we already know that
			\[\sum_{\op N(I)\le x}\Lambda_K(x)=O(x).\]
			The previous step explains that the contribution $\sum_{i=1}^d\lambda_{\mf pi}^k\log\op N\mf p$ is $O_\rho(1)$, so we conclude.
			\qedhere
		\end{listroman}
	\end{enumerate}
\end{proof}
\begin{remark} \label{rem:equi-l-func-easy-range}
	Essentially the same proof as in (i) of step 3 above shows that $\log L(s,\rho)$ converges absolutely in the region $\{s:\Re s>1\}$, so $L(s,\rho)$ converges absolutely and is nonzero. Indeed, one merely needs to re-weight the Dirichlet series coefficient $\sum_{\op N(I)=n}\Lambda_\rho(I)$ to undo the derivative, effectively removing a $\log n$ factor.
\end{remark}

\subsection{The Chebotarev Density Theorem}
We now give a standard application of \Cref{prop:equi-by-l-func}, to the Chebotarev desnity theorem. For any Galois extension $L/K$ of number fields, our goal is to show that the Frobenius conjugacy classes $\op{Frob}_{\mf p}$ equidistribute in $\op{Conj}(\op{Gal}(L/K))$. In light of \Cref{prop:equi-by-l-func}, we see that we are interested in the following $L$-functions.
\begin{defihelper}[Artin $L$-function] \nirindex{Artin L-function@Artin $L$-function}
	For a number field $K$, let $\rho\colon\op{Gal}(\ov K/K)\to\op{GL}(V)$ be a finite-dimen\-sional complex representation. Then we define the \textit{Artin $L$-function}
	\[L(s,\rho)\coloneqq\prod_{\mf p}\frac1{\det\left(1-\rho(\mathrm{Frob}_{\mf p})\op N\mf p^{-s}\vert V^{I_{\mf p}}\right)},\]
	where $I_{\mf p}\subseteq\op{Gal}(\ov K/K)$ denotes the inertia subgroup of $\mf p$.
\end{defihelper}
\begin{remark}
	Let us explain this factor. Formally, one should fix a prime $\mf P$ of $\ov K$ living above $\mf p$ (alternatively, one could choose a compatible system of primes for every subfield of $\ov K$), and then $I_{\mf p}$ and $\op{Frob}_{\mf p}$ mean $I_{\mf P}$ and $\mathrm{Frob}_{\mf P}$, respectively. Let's check that this definition is independent of the choice of $\mf P$: any other prime living above $\mf p$ looks like $g\mf P$ for some $g\in\op{Gal}(\ov K/K)$. Then $I_{g\mf P}=gI_{\mf P}g^{-1}$ and $\mathrm{Frob}_{g\mf P}=g\mathrm{Frob}_{\mf P}g^{-1}$. Thus, we see that $v\mapsto\rho(g)v$ sends $V^{I_{\mf P}}\to V^{I_{g\mf P}}$ and sends the action of $\mathrm{Frob}_{\mf P}$ to the action of $\mathrm{Frob}_{g\mf P}$. As such, the characteristic polynomials must be equal.
\end{remark}
\begin{example} \label{ex:artin-gives-dedekind}
	Taking $\rho$ to be the trivial representation, we find that $L(s,1)$ and $\zeta_K(s)$ are equal to a finite number of Euler factors. Recall that we may write $L(s,1)=\zeta_K(s)$.
\end{example}
Before going any further, we state some helpful facts about Artin $L$-functions.
\begin{lemma} \label{lem:artin-finite-image}
	For a number field $K$, let $\rho\colon\op{Gal}(\ov K/K)\to\op{GL}(V)$ be a finite-dimensional complex representation. Then $\ker\rho$ is open, and $\rho$ has finite image.
\end{lemma}
\begin{proof}
	We have two steps.
	\begin{enumerate}
		\item We show the following ``no small subgroups'' result: we claim that there is an open neighborhood $U\subseteq\op{GL}(V)$ of the identity which does not contain any nontrivial subgroup. Indeed, recall that $\exp\colon\mf{gl}(V)\to\op{GL}(V)$ is a local diffeomorphism; say that it is a diffeomorphism on some bounded open subset $U_1\subseteq\mf{gl}(V)$, and then set $U\coloneqq\exp\left(\frac12U_1\right)$.
		
		Now, suppose for the sake of contradiction that $U$ contains a subgroup $H\subseteq\op{GL}(V)$. Then note that any $\exp(x)\in H$ for $x\in\frac12U_1$ must have $\exp(2x)$ in $H$ and hence in $U$, so $2x\in\frac12U_1$ as well; this shows that $\frac12U_1$ is unbounded, which is a contradiction.

		\item We complete the proof. Choose an open neighborhood $U\subseteq\op{GL}(V)$ of the identity as in the previous step. Then $\rho^{-1}(U)\subseteq\op{Gal}(\ov K/K)$ is an open subset, but the profinite topology of $\op{Gal}(\ov K/K)$ promises that this open subset contains an open subgroup $H\subseteq\op{Gal}(\ov K/K)$. Then $\rho(H)\subseteq U$ is a subgroup, which must be trivial, so we conclude that $H\subseteq\ker\rho$. Now, $H$ is a subgroup of finite index, so we conclude the same is true for $\ker\rho$.
		\qedhere
	\end{enumerate}
\end{proof}
\begin{lemma}[additive] \label{lem:artin-add}
	For a number field $K$, let $\rho_1$ and $\rho_2$ be finite-dimensional complex representations of $\op{Gal}(\ov K/K)$. Then $L(s,\rho_1\oplus\rho_2)=L(s,\rho_1)L(s,\rho_2)$.
\end{lemma}
\begin{proof}
	This follows because, for any $g\in G$, the characteristic polynomial of $(\rho_1\oplus\rho_2)(g)$ is the product of the characteristic polynomials of $\rho_1(g)$ and $\rho_2(g)$.
\end{proof}
% \begin{lemma}[inflation]
% 	Fix a Galois extension $M/K$ of number fields, and let $L$ be a subextension. Given a finite-dimensional representation $\rho$ of $\op{Gal}(L/K)$, let $\widetilde\rho$ be the representation of $\op{Gal}(M/K)$ induced by the quotient $\op{Gal}(M/K)\onto\op{Gal}(L/K)$. Then
% 	\[L(s,\rho)=L(s,\widetilde\rho).\]
% \end{lemma}
% \begin{proof}
% 	We essentially equate Euler factors over a rational prime $p$; in fact, we may as well equate Euler factors over a prime $\mf p$ of $K$. Then the two Euler factors are equal by definition.
% 	% Because we are only interested in $\doteq$, we may assume that $\mf p$ is unramified in $M$. Then the two Euler factors are equal by definition.
% \end{proof}
% \begin{remark}
% 	If we had bothered to define 
% \end{remark}
\begin{lemma}[induction] \label{lem:artin-ind}
	Fix a finite extension $L/K$ of number fields. Given a finite-dimensional complex representation $\rho\colon\op{Gal}(\ov K/L)\to\op{GL}(V)$, we have
	\[L(s,\rho)=L\left(s,\op{Ind}_{\op{Gal}(\ov K/L)}^{\op{Gal}(\ov K/K)}\rho\right).\]
\end{lemma}
\begin{proof}
	We follow \cite[Proposition~VII.10.4(iv)]{neukirch-alg-nt}. Once again, we equate Euler factors over a prime $\mf p$ of $K$. For psychological reasons, we come down to finite extensions. By \Cref{lem:artin-finite-image}, we may find a finite Galois extension $M$ of $K$ extending $L$ such that $\op{Gal}(M/L)$ is in the kernel of $\rho$. Then we may replace all instances of $\ov K$ with $M$ without changing the value of the $L$-function; for example, $\rho$ is certainly well-defined throughout.
	
	Now, for brevity, set $G\coloneqq\op{Gal}(M/K)$ and $H\coloneqq\op{Gal}(M/L)$, and let $\widetilde\rho\coloneqq\op{Ind}_H^G\rho$ denote the induction; further, set $V_\rho\coloneqq V$ and $V_{\widetilde\rho}\coloneqq\op{Ind}_H^GV$ for clarity. We want to show that
	\[\frac1{\det\left(1-\widetilde\rho(\mathrm{Frob}_{\mf p})\op N\mf p^{-s}\vert V_{\widetilde\rho}^{I_{\mf p}}\right)}\stackrel?=\prod_{\mf q\mid\mf p}\frac1{\det\left(1-\rho(\mathrm{Frob}_{\mf q})\op N\mf q^{-s}\vert V_{\rho}^{I_{\mf q}}\right)},\]
	where $\mf q$ varies over primes of $L$ lying over $\mf p$. Note that these inertia subgroups can now be brought down to automorphisms of $M$. We now proceed in steps.
	\begin{enumerate}
		\item We begin with a special case. Suppose that there is a single prime $\mf P$ of $M$ above $\mf p$, and set $\mf q\coloneqq\mf P\cap L$. In this case, $G=D_{\mf P}$, and we would like to show that
		\[\det\left(1-\widetilde\rho(\mathrm{Frob}_{\mf P})T\vert V_{\widetilde\rho}^{I_{\mf P}}\right)=\det\left(1-\rho(\mathrm{Frob}_{\mf P})^{[G:H]}T^{[G:H]}\vert V_{\rho}^{I_{\mf P}}\right),\]
		where $T$ is a formal variable replacing $\op N\mf p^{-s}$. (Note that $\op N\mf q=\op N\mf p^{[G:H]}$.) Note that we may as well replace $L/K$ with $M/L$, effectively allowing us to assume that $H$ is trivial.
		
		For psychological reasons, we explain how to reduce to the case where $I_{\mf P}$ is trivial by adjusting the representations. On one hand, we'd like to replace $V_\rho$ with $V_\rho^{H\cap I_{\mf P}}$. On the other hand, note that $\left(\op{Ind}_H^G\rho\right)^{I_{\mf P}}$ can be descended to $\op{Ind}_{H/(H\cap I_{\mf P})}^{G/I_{\mf P}}V_\rho^{H\cap I_{\mf P}}$: a function $f\colon G\to V$ succeeds at being invariant under $I_{\mf P}$ if and only if it descends to a function on $G/I_{\mf P}$, and we see that we must restrict outputs to $V^{H\cap I_{\mf P}}$ because $h\in H\cap I_{\mf P}$ will have $f(x)=f(xh)=\rho(h)f(x)$. Thus, by taking the quotient by $I_{\mf P}$ everywhere, we may assume that it is trivial.

		Now, $D_{\mf P}$ has become cyclic of order $f\coloneqq f(\mf P/\mf p)$ generated by the Frobenius, so we will be able to compute $\op{Ind}_1^G\rho$ relatively easily. Indeed, view $V_{\widetilde\rho}$ as the vector space $V^{\oplus f}$ by sending the function $f$ to the $f$-tuple $\left(f(\mathrm{Frob}_{\mf P}^i)\right)_{i=0}^{f-1}$. Then we see that $\mathrm{Frob}_{\mf P}$ acts on $V^{\oplus f}$ by
		\[(v_0,v_1,\ldots,v_{f-2},v_{f-1})=\left(\rho(\mathrm{Frob}_{\mf P})^fv_{f-1},v_0,\ldots,v_{f-3},v_{f-2}\right).\]
		We may now compute the determinant of $1-\widetilde\rho(\mathrm{Frob}_{\mf P})T$ by commuting the determinant of the matrix
		\[\begin{bmatrix}
			1 & -T & 0 & \cdots & 0 & 0 \\
			0 & 1 & -T & \cdots & 0 & 0 \\
			0 & 0 & 1 & \cdots & 0 & 0 \\
			\vdots & \vdots & \ddots & \vdots & \vdots \\
			0 & 0 & 0 & \cdots & 1 & -T \\
			-\rho(\mathrm{Frob}_{\mf P})^fT & 0 & 0 & \cdots & 0 & 1
		\end{bmatrix},\]
		which we see is $\det\left(1-\rho(\mathrm{Frob}_{\mf P})^fT^f\right)$ after some row-reduction.

		\item We now return to the general case for the remainder of the proof. All decomposition, inertial, and Frobenius elements will be taken over $\mf p$ unless otherwise specified. We begin by computing the action of $\widetilde\rho$. The idea is to use Mackey theory. Indeed, for fixed prime $\mf P$ of $M$ above $\mf p$, we are only interested in the action of $D_{\mf P}$ on $\op{Ind}_H^G\rho$, so we note there is an isomorphism
		\[\op{Res}^G_{D_{\mf P}}\op{Ind}_H^G\rho\stackrel?\cong\bigoplus_{g\in H\backslash G/D_{\mf P}}\op{Ind}_{D_{\mf P}\cap g^{-1}Hg}^{D_{\mf P}}\rho_g,\]
		where $\rho_g\left(d\right)=\rho\left(gdg^{-1}\right)$. Let's quickly explain this. There is a forward map sending a function $f\colon G\to V$ to the tuple of functions $(f_g)_g$ where $f_g\colon D_{\mf P}\to V$ is defined by $f_g(x)\coloneqq f\left(xg\right)$. There is also a backward map sending the tuple $(f_g)_g$ to the function $f\colon G\to V$ given by $f(hgd)\coloneqq\rho(h)f_g(d)$. These maps are $G$-invariant and can be checked to be $D_{\mf P}$-invariant, so we have our isomorphism.

		Thus, we see that
		\[\det\left(1-\widetilde\rho\left(\mathrm{Frob}_{\mf P}\right)\op N\mf p^{-s}\vert V_{\widetilde\rho}^{I_{\mf P}}\right)=\prod_{g\in H\backslash G/D_{\mf P}}\det\left(1-\mathrm{Frob}_{\mf P}\op N\mf p^{-s}\vert (\op{Ind}^{D_{\mf P}}_{D_{\mf P}\cap g^{-1}Hg}{\rho_g})^{I_{\mf P}}\right).\]
		Undoing conjugation by $g$, we can rewrite this as
		\[\det\left(1-\widetilde\rho\left(\mathrm{Frob}_{\mf P}\right)\op N\mf p^{-s}\vert V_{\widetilde\rho}^{I_{\mf P}}\right)=\prod_{g\in H\backslash G/D_{\mf P}}\det\left(1-\mathrm{Frob}_{g\mf P}\op N\mf p^{-s}\vert (\op{Ind}^{D_{g\mf P}}_{D_{g\mf P}\cap H}\rho)^{I_{g\mf P}}\right).\]

		\item We translate the product using some group theory. For this, we need to enumerate the primes of $L$ above $\mf p$. Note $\op{Gal}(M/K)$ acts transitively on the set of primes of $M$ above $\mf p$, so $g\mapsto g\mf P$ defines a bijection from $G/D_{\mf P}$ to this set of primes. Then restricting to $L$, we see that $g\mapsto (g\mf P\cap L)$ is a surjective map from $G/D_{\mf P}$ to the set of primes in $L$ above $\mf p$; this map descends to $H\backslash G/D_{\mf P}$, where we claim that it actually defines a bijection. Indeed, $(g\mf P\cap L)=(g'\mf P\cap L)$ implies that $g\mf P$ and $g'\mf P$ are both primes of $M$ sitting above the same prime of $L$, so there is $h\in\op{Gal}(M/L)$ such tthat $hg\mf P=g'\mf P$, which implies $hgD_{\mf P}=g'D_{\mf P}$.

		Thus, we see that
		\[\prod_{\mf q\mid\mf p}\det\left(1-\rho(\mathrm{Frob}_{\mf q})\op N\mf q^{-s}\vert V_{\rho}^{I_{\mf q}}\right)=\prod_{g\in H\backslash G/D_{\mf P}}\det\left(1-\rho(\mathrm{Frob}_{g\mf P})^{f_g}\op N\mf p^{-f_gs}\vert V_{\rho}^{I_{g\mf P}}\right),\]
		where $f_g=f(g\mf P/(g\mf P\cap L))=[D_{g\mf P}:D_{g\mf P}\cap H]$ is the required inertial degree.
		% While we're here, we note that $f(g\mf P/(g\mf P\cap L))=\#(D_{g\mf P}\cap H)$, so $\op N(g\mf P\cap L)=\op N\mf p^{[D_{g\mf P}:D_{g\mf P}\cap H]}$.

		\item We are now ready to complete the proof. In light of the previous two steps, we would like to show that any $\mf P'$ of $M$ above $\mf p$ has
		\[\det\left(1-\mathrm{Frob}_{\mf P'}T\vert (\op{Ind}^{D_{\mf P'}}_{D_{\mf P'}\cap H}\rho)^{I_{\mf P'}}\right)=\det\left(1-\rho(\mathrm{Frob}_{\mf P'})^{[D_{\mf P'}:D_{g\mf P'}\cap H]}T^{[D_{\mf P'}:D_{g\mf P'}\cap H]}\vert V_{\rho}^{I_{\mf P'}}\right),\]
		where $T$ is a formal variable replacing $\op N\mf p^{-s}$.
		Now, we note that we may define $K'\coloneqq M^{D_{\mf P'}}$ and $L'\coloneqq M^{D_{\mf P'}\cap H}$, whereupon we see that $\mf P'$ is the only prime above of $M$ the prime $\mf p'\coloneqq\mf P'\cap K'$ in $K'$. The above equality then follows from the special case in the first step applied to the extension $L'/K'$.
		\qedhere
	\end{enumerate}
\end{proof}
\begin{remark} \label{rem:mackey}
	Given subgroups $D\subseteq H\subseteq G$ and a representation $\rho$ of $H$, the above proof used the fact that
	\[\op{Res}^G_D\op{Ind}^G_H\rho\cong\bigoplus_{\eta\in H\backslash G/D}\op{Ind}^D_{D\cap \eta^{-1}H\eta}\op{Ind}^D_{D\cap \eta^{-1}H\eta}\rho_\eta,\]
	where $\rho_\eta(d)\coloneqq\rho(\eta d\eta^{-1})$. This fact is remarkably useful.
\end{remark}
\begin{example}
	Let $L/K$ be a Galois extension of number fields with Galois group $G$. Then $\op{Ind}_{\op{Gal}(\ov K/L)}^{\op{Gal}(\ov K/K)}1$ is the regular representation of $G$, so by decomposing the regular representation into irreducible representations and using \Cref{lem:artin-add,lem:artin-ind}, we find
	\[\zeta_L(s)=\prod_{\rho\in\op{IrRep}(G)}L(s,\rho)^{\dim\rho},\]
	where $\op{IrRep}(G)$ refers to the set of irreducible representations of $G$.
\end{example}
% \begin{remark}
% 	The proof of \Cref{prop:equi-by-l-func} showed that
% 	\[\log L(s,\rho)=\sum_{\mf p}\sum_{k\ge1}\sum_{i=1}^{\dim\rho}\frac{\lambda{\mf pi}^k\log\op N\mf p}{k\op N\mf p^{ks}}\]
% \end{remark}
In light of \Cref{prop:equi-by-l-func}, we need to show that nontrivial irreducible $\rho$ give $L(s,\rho)$ a non-vanishing holomorphic continuation to the line $\{s:\Re s=1\}$. The rough idea is to use the Brauer induction theorem to reduce to the abelian case, and then the abelian case can be turned over to Hecke $L$-functions by class field theory.

Thus, we begin with the abelian case. As promised, this is essentially class field theory.
\begin{proposition} \label{prop:langlands-gl-1}
	Fix a number field $K$, and let $\rho\colon\op{Gal}(\ov K/K)\to\CC^\times$ be a continuous character. Then there is a continuous unitary character $\chi\colon K^\times\backslash\AA_K^\times\to\CC^\times$ such that
	\[L(s,\rho)=L(s,\chi)\]
	for $s$ such that $\Re s>1$.
\end{proposition}
\begin{proof}
	The main point is that global class field theory in the form of \cite[Theorem~5.3]{milne-cft} provides an isomorphism
	\[\widehat{K^\times\backslash\AA_K^\times}\cong\op{Gal}(\ov K/K)^{\mathrm{ab}}.\]
	With this in mind as a guide, we construct the character $\chi$. Because the target of $\rho$ is abelian, we see that $\rho$ factors through $\op{Gal}(\ov K/K)^{\mathrm{ab}}=\op{Gal}(K^{\mathrm{ab}}/K)$. For convenience, we recall from \Cref{lem:artin-finite-image} that $\rho$ descends to a representation of $\op{Gal}(L/K)$ for some minimal finite Galois extension $L/K$, and once again, we find that $\op{Gal}(L/K)$ is abelian. Thus, we may define $\chi$ as the composite
	\[K^\times\backslash\AA_K^\times\onto K^\times\op N_{L/K}(\AA_L^\times)\backslash\AA_K^\times\cong\op{Gal}(L/K)\stackrel\rho\to\CC^\times,\]
	where the isomorphism is given by global class field theory \cite[Theorem~5.3]{milne-cft}; explicitly, on finite primes $\mf p$ of $K$ unramified in $L$, it is trivial on $\OO_{\mf p}^\times\subseteq\AA_K^\times$ and sends a uniformizer $\varpi_{\mf p}\in\OO_{\mf p}$ to $\mathrm{Frob}_{\mf p}\in\op{Gal}(L/K)$. By construction, $\chi$ is a continuous character, and it is unitary because $\rho$ must output to $S^1$ by the compactness of $\op{Gal}(\ov K/K)$.

	We now compare the Euler factors of $L(s,\rho)$ and $L(s,\chi)$ at a prime $\mf p$ of $K$. There are two cases.
	\begin{itemize}
		\item Suppose that $\mf p$ is a prime unramified in $L/K$. Then we see that
		\[\det\left(1-\rho(\mathrm{Frob}_{\mf p})\op N\mf p^{-s}\mid\CC\right)=1-\chi_{\mf p}(\varpi_{\mf p})\op N\mf p^{-s}\]
		by construction of $\chi$ (and properties of the global class field theory map), so we are done.
		\item Suppose that $\mf p$ is a prime ramified in $L/K$. On one hand, $\rho$ is nontrivial on $I_{\mf p}\subseteq\op{Gal}(L/K)$, so $\CC^{I_{\mf p}}$ must be zero-dimensional, so the Euler factor of $L(s,\rho)$ is $1$. On the other hand, we note that $\op N_{L/K}(\AA_L^\times)$ does not contain $\OO_{\mf p}^\times$ by a computation of norm subgroups, so $\chi$ is nontrivial on $\OO_{\mf p}^\times$ by tracking through the global class field theory isomorphism, so the Euler factor of $L(s,\chi)$ is also $1$.
		\qedhere
	\end{itemize}
\end{proof}
\begin{remark}
	Because a Dirichlet series is uniquely determined by its coefficients, we see that the character $\chi$ is uniquely determined by $\rho$. However, this is not a bijection: the disagreement between the topologies of $K^\times\backslash\AA_K^\times$ and $\op{Gal}(\ov K/K)^{\mathrm{ab}}$ means that there are many more continuous unitary characters $K^\times\backslash\AA_K^\times\to\CC^\times$.
\end{remark}
\begin{corollary} \label{cor:abelian-artin-nonvanish}
	Fix a number field $K$, and let $\rho\colon\op{Gal}(\ov K/K)\to\CC^\times$ be a nontrivial continuous character. Then $L(s,\rho)$ admits a nonvanishing holomorphic continuation to $\{s:\Re s=1\}$.
\end{corollary}
\begin{proof}
	Note $L(s,\rho)$ is already holomorphic and nonvanishing on $\{s:\Re s>0\}$ by \Cref{rem:equi-l-func-easy-range}. Now, construct the continuous unitary character $\chi\colon K^\times\backslash\AA_K^\times\to\CC^\times$ as in \Cref{prop:langlands-gl-1} so that $L(s,\chi)=L(s,\rho)$. The nonvanishing now follows from \Cref{prop:hecke-nonvanish}. Lastly, the continuation follows from \Cref{thm:hecke-continue} as soon as we check that $\chi\left|\cdot\right|^{1+it}$ is never trivial on all unramified primes. This follows by the nontriviality of $\rho$, which requires there to be an unramified prime $\mf p$ where $\rho(\mathrm{Frob}_{\mf p})\ne1$; this corresponds to the needed fact about $\chi$.
\end{proof}
We are now in a position to prove equidistribution of Frobenius elements in $\op{Gal}(K^{\mathrm{ab}}/K)$, from which one can prove the general case by a clever reduction argument. However, we will be honest to our discussion of equidistribution and prove nonvanishing holomorphic continuation to $\{s:\Re s=1\}$ for $L(s,\rho)$ for all nontrivial irreducible continuous representations $\rho$.

We begin with the meromorphic continuation. The idea is to write $\rho$ as a ``linear combination'' of inductions of characters. Then the result will follow from the abelian case combined with our properties about $L$-functions. One almost achieves the full holomorphic nonvanishing as well, but it would be technically possible to see the trivial character in our linear combination, thus possibly introducing a pole or zero.

Of course, it does not a priori make sense to talk about linear combination of representations, so we must pass to their linearization: characters. Thus, we will want to define the Artin $L$-function of a class function. To motivate, use \Cref{lem:artin-finite-image} to descend $\rho$ to some representation $\op{Gal}(L/K)\to\CC^\times$. For some $g\in\op{Gal}(L/K)$, we let $\lambda_1,\ldots,\lambda_d$ denote the eigenvalues of $g$ (with algebraic multiplicities), so we see that
\[\log\left(\det(1-\rho(g)T)^{-1}\right)=\sum_{i=1}^d-\log(1-\lambda_iT).\]
Now, expanding out the Taylor series reveals that
\[\frac1{\det(1-\rho(g)T)}=\exp\Bigg(\sum_{k=1}^\infty\frac{\tr\rho\left(g^k\right)T^k}k\Bigg).\]
We are now ready to make the following definition.
\begin{defihelper}[Artin $L$-function] \nirindex{Artin L-function@Artin $L$-function}
	Fix a Galois extension $L/K$ of number fields with Galois group $G$. For a class function $\chi\colon G\to\CC$, we define the \textit{Artin $L$-function} as
	\[L(s,\chi)\coloneqq\prod_{\mf p\text{ unr.}}\exp\Bigg(\sum_{k=1}^\infty\frac{\chi(\mathrm{Frob}_{\mf p}^k)}{k\op N\mf p^{-s}}\Bigg),\]
	where the product is taken over primes of $K$ unramified in $L$.
\end{defihelper}
\begin{example} \label{ex:artin-l-func-rep-to-char}
	The discussion preceding the definition shows that $L(s,\rho)\doteq L(s,{\tr}\circ\rho)$ for any finite-dimensional complex representation $\rho\colon\op{Gal}(L/K)\to\op{GL}(V)$.
\end{example}
\begin{remark}
	A notable defect of this definition is that we have not defined our Euler factors at ramified primes. This will cause us to use some $\doteq$s in the sequel; this is no issue because finitely many Euler factors will not change holomorphy or nonvanishing.
\end{remark}
Here are the standard properties of these $L$-functions, which are carried over from our previous discussion.
\begin{lemma} \label{lem:artin-class-basic}
	Fix a Galois extension $M/K$ of number fields with Galois group $G$.
	\begin{listalph}
		\item If $\chi\colon G\to\CC$ is a class function, then $L(s,\chi)$ converges absolutely to a nonvanishing holomorphic function in the region $\{s:\Re s>1\}$.
		\item Additive: if $\chi_1,\chi_2\colon G\to\CC$ are class functions, then $L(s,\chi_1+\chi_2)=L(s,\chi_1)L(s,\chi_2)$.
		\item Inflation: let $L/K$ be a Galois subextension such that $\op{Gal}(M/L)=H$. If $\chi\colon G/H\to\CC$ is a class function, then $L(s,\chi)\doteq L(s,\widetilde\chi)$, where $\widetilde\chi\colon G\to\CC$ is the induced class function.
		% \item Induction: let $L/K$ be a subextension such that $H\coloneqq\op{Gal}(M/L)$. For a class function $\chi\colon H\to\CC$, we have $L(s,\chi)=L(s,\op{Ind}_H^G\chi)$.
	\end{listalph}
\end{lemma}
\begin{proof}
	Here, (a) follows as in \Cref{rem:equi-l-func-easy-range} by noting that the series expansion for $\log L(s,\chi)$ absolutely converges to a finite value; notably, $G$ is finite, so $\chi$ is bounded, so it does not meaningfully contribute. Continuing, (b) follows by a direct expansion of the Euler product, and (c) follows because the Euler factors are exactly the same for any prime $\mf p$ of $K$ unramified in $M$ (and hence also unramified in $K$).
	% It is possible to prove (d) directly, but we elect not to. Note that the function $\chi\mapsto L(s,\chi)$ is additive by (b), so we use the fact (from the representation theory of finite groups) that any class function can be written as a $\CC$-linear combination of the characters ${\tr}\circ\rho$ for genuine representations of $\rho$.
\end{proof}
The suitable analogue of \Cref{lem:artin-ind} on induction remains true, but we will not need it in the full generality of complex class functions. However, we do need to know how to induct character.
\begin{notation}
	Fix a subgroup $H$ of a finite group $G$. Given a class function $\chi\colon H\to\CC$, define the induced class function
	\[\op{Ind}_H^G\chi(g)\coloneqq\frac1{\left|H\right|}\sum_{\substack{\eta\in G\\\eta g\eta^{-1}\in H}}\chi\left(\eta g\eta^{-1}\right).\]
\end{notation}
\begin{lemma}
	Fix a subgroup $H$ of a finite group $G$. Given a finite-dimensional representation $\rho\colon H\to\op{GL}(V)$, then we check that ${\tr}\circ\op{Ind}_H^G\rho=\op{Ind}_H^G({\tr}\circ\rho)$.
\end{lemma}
\begin{proof}
	We will use many of the same tricks appearing in \Cref{lem:artin-ind}. Fix some $g\in G$, and we would like to check the result at $g$. We proceed in steps.
	\begin{enumerate}
		\item We begin with the special case where $G$ is cyclic and generated by $g$. If $H=G$, there is nothing to do. Otherwise, if $H\ne G$, then $\op{Ind}^G_H({\tr\circ\rho})(g)$ is an empty, so we must show $\tr\op{Ind}_H^G\rho(g)$ vanishes. Well, view elements $\op{Ind}_H^GV$ as sequences of vectors $\{v_{Hg'}\}$ indexed by $H\backslash G$, and then we see that $\op{Ind}_G^H\rho(g)$ acts by a (generalized) permutation matrix which is a sum of nontrivial cycles of length $[G:H]$. Thus, this operator has no trace.
		\item We now show the general case. By \Cref{rem:mackey}, we see that
		\[\op{Res}^G_{\langle g\rangle}\op{Res}^G_H\rho\cong\bigoplus_{\eta\in H\backslash G/\langle g\rangle}\op{Ind}^{\langle g\rangle}_{\langle g\rangle\cap\eta^{-1}H\eta}\rho_\eta,\]
		where $\rho_\eta(g')\coloneqq\rho\left(\eta g'\eta^{-1}\right)$. Thus, we see that
		\[\tr\op{Ind}_H^G\rho(g)=\sum_{\eta\in H\backslash G/\langle g\rangle}\tr\op{Ind}_{\langle g\rangle\cap\eta^{-1}H\eta}^{\langle g\rangle}\rho_\eta\left(g\right).\]
		Now, by the previous case, we see that terms vanish as long as $g\notin\eta^{-1}H\eta$; on the other hand, if $g\in\eta^{-1}H\eta$, then we get a contribution of $\tr\rho\left(\eta g\eta^{-1}\right)$, so we see
		\[\tr\op{Ind}_H^G\rho(g)=\sum_{\substack{\eta\in H\backslash G/\langle g\rangle\\\eta g\eta^{-1}\in H}}\tr\rho\left(\eta g\eta^{-1}\right).\]
		The result now follows by replacing the sum over $H\backslash G/\langle g\rangle$ with a sum over $G$.
		\qedhere
	\end{enumerate}
\end{proof}
In order to allow us to stop talking about $L$-functions as quickly as possible, let's go ahead and explicate the inductive approach to meromorphic continuation via Brauer's theorem. We begin with the following non-standard definition.
\begin{definition}[Brauer]
	Fix a finite group $G$. Then $G$ is \textit{Brauer} if and only if, for any finite-dimensional complex irreducible representation $\rho$, there is a sequence of pairs $\{(a_i,H_i,\psi_i)\}_{i=1}^n$ where $a_i\in\ZZ$ and $H_i\subseteq G$ is a subgroup and $\psi_i\colon H_i\to\CC^\times$ is a one-dimensional representation such that
	\[{\tr}\circ\rho=\sum_{i=1}^na_i\op{Ind}_{H_i}^G\psi_i.\]
\end{definition}
\begin{lemma} \label{lem:brauer-to-artin}
	Fix a Galois extension $L/K$ of number fields with Galois group $G$. Suppose that $G$ is Brauer. For any finite-dimensional complex representaion $\rho$ of $G$, the function $L(s,\rho)$ admits a meromorphic continuation to $\{s:\Re s=1\}$ with no poles or zeroes except possibly a pole or zero at $s=1$.
\end{lemma}
\begin{proof}
	By the additivity of \Cref{lem:artin-add}, we may assume that $\rho$ is irreducible. By \Cref{ex:artin-l-func-rep-to-char}, it is enough to check the result for $L(s,{\tr}\circ\rho)$. Because $G$ is Brauer, we receive an expansion ${\tr}\circ\rho=\sum_{i=1}^n\op{Ind}_{H_i}^G\psi_i$ of ${\tr}\circ\rho$ into a $\ZZ$-linear combination of inductions of characters, which implies that
	\[L(s,{\tr}\circ\rho)=\prod_{i=1}^nL\left(s,\op{Ind}_{H_i}^G\psi_i\right)^{a_i}\]
	by \Cref{lem:artin-class-basic}. By \Cref{ex:artin-l-func-rep-to-char}, we may now think of each $L(s,\op{Ind}_{H_i}^G\psi_i)$ as an Artin $L$-function of a representation (up to finitely many Euler factors), so \Cref{lem:artin-ind} tells us that this $L$-function is $L(s,\psi_i)$.
	
	The result now essentially follows from \Cref{cor:abelian-artin-nonvanish}, which tells us each nontrivial $\psi_i$ grants a nonvanishing holomorphic continuation of $L(s,\psi_i)$ to $\{s:\Re s\ge1\}$. Note the same is true for trivial $\psi_i$ except at the point $s=1$ where we find a pole in $L(s,\psi_i)$ because this is a Dedekind $\zeta$-function by \Cref{ex:artin-gives-dedekind}; see \Cref{thm:hecke-continue,prop:hecke-nonvanish}. Taking the appropriate product of these contributions proves the statement.
\end{proof}
Thus, we will achieve our meromorphic continuation as soon as we check that all finite groups are Brauer; we will complete the nonvanishing later by a careful analysis of $s=1$.

Our current goal is to prove Brauer's theorem that all finite groups are Brauer; our exposition follows \cite[Chapter~10]{serre-rep-theory}. We begin by creating a large supply of Brauer groups.
\begin{lemma} \label{lem:nilpotent-is-brauer}
	Let $G$ be a finite nilpotent group. Then $G$ is Brauer.
\end{lemma}
\begin{proof}
	We induct on $\left|G\right|$. For our base case, we note that if $G$ is already abelian (for example, $\left|G\right|=1$), then there is nothing to do because all irreducible representations are already one-dimensional.

	Thus, for our induction, we may assume that $G$ is nonabelian, and we fix some complex irreducible representation $\rho\colon G\to\op{GL}(V)$ of $G$. Because taking induction commutes with taking quotients, we may replace $G$ with $G/\ker\rho$, effectively allowing us to assume that $\rho$ is injective. We will show directly that $\rho$ can be induced from a character, which will complete the proof; we proceed in steps.
	\begin{enumerate}
		\item We claim that there is an abelian normal subgroup $N\subseteq G$ strictly containing $Z(G)$. This follows quickly because $G$ is nilpotent: because $G$ is nonabelian and nilpotent, we see that $G/Z(G)$ is nontrivial and has nontrivial center, so we let $N\subseteq G$ be the pre-image of the center. Then $N$ strictly contains $Z(G)$ and is normal because it is the pre-image of a normal subgroup along a surjective homomorphism.

		\item We now decompose $\op{Res}^G_N\rho$ into irreducibles as
		\[\op{Res}^G_N\rho=\bigoplus_{\psi\in\op{Hom}(N,\CC^\times)}V^\psi,\]
		where $V^\psi\subseteq V$ denotes the $\psi$-eigenvectors of $V$. (The sum is over the characters of $N$; this decomposition exists because $N$ is abelian.) Now, because $N\subseteq G$ is normal, we know that each of the spaces $\rho(g)V^\psi\subseteq V$ continues to be $N$-invariant and in fact will be $N$-isotypic. Thus, we see that $G$ acts on the collection $\{V^\psi\}_\psi$, and it must act transitively because the span of the $G$-orbit of some $V^\psi$ will be a $G$-subrepresentation of the irreducible representation $\rho$.

		\item We claim that $\op{Res}^G_N\rho$ is not isotypic. This is by the construction of $N$: this would imply that $N$ acts by scalars on $V$, thereby implying that $\rho(N)$ commutes with $\rho(G)$, thereby giving $N\subseteq Z(G)$ because $\rho$ is faithful. This contradicts the construction of $N$ as strictly containing $Z(G)$.

		\item We now complete the proof. Choose some $\psi_0\in\op{Hom}(N,\CC^\times)$, and let $G_0\subseteq G$ be the stabilizer of the action given in the second step. Then $\rho$ restricts to a representation $\rho_0\colon G_0\to\op{GL}(V_0)$ where $V_0\coloneqq V^{\psi_0}$.
		
		Now, we claim that $\rho=\op{Ind}_{G_0}^G\rho_0$, which will complete the proof because $G_0$ is a strictly smaller nilpotent group than $G$. Well, for the isomorphism, view $\op{Ind}_{G_0}^G\rho_0$ as $\CC[G]\otimes_{\CC[G_0]}\rho_0$, and then define the map $\op{Ind}_{G_0}^G\rho_0\to\rho$ by sending $g\otimes v_0$ to $gv_0$.
		\qedhere
	\end{enumerate}
\end{proof}
Thus, to show that any group $G$ is Brauer, one may simply show that any character for an irreducible complex representation is a $\ZZ$-linear combination of ones induced from nilpotent subgroups. Now that we are working with more general characters than one-dimensional ones, we pick up the following notation.
\begin{definition}[virtual character]
	Fix a finite group $G$. Then we let $R(G)$ denote the free $\ZZ$-module of class functions $G\to\CC$ generated by the characters ${\tr}\circ\rho$ as $\rho$ varies over finite-dimensional complex representations of $G$. One frequently calls $R(G)$ the \textit{ring of virtual characters}.
\end{definition}
\begin{remark}
	By taking tensor products of representations, we see that $R(G)$ is a subring of the set of functions $G\to\CC$. By induction and restriction of representations, we see that $\op{Res}^G_H$ and $\op{Ind}^G_H$ induce ring homomorphisms $R(G)\to R(H)$ and $R(H)\to R(G)$, respectively.
\end{remark}
Thus, to check that a group $G$ is Brauer, it will be enough to show that the map
\[\op{Ind}\colon\bigoplus_{\substack{H\subseteq G\\H\text{ Brauer}}}R(H)\to R(G)\]
is surjective, for any element of one of the $R(H)$s can be expanded into a sum of characters induced from linear characters. For example, we will eventually show that one can restrict this direct sum to nilpotent subgroups.
\begin{remark}
	While we're here, we remark that one can check the surjectivity of this map after tensoring with any free $\ZZ$-module because this essentially takes both sides to a finite power. In particular, in the sequel, we will frequently work with $R(G)_{\ZZ[\zeta_n]}$ where $n=\left|G\right|$, which is conveneint because the functions in $R(G)$ output to the ring $\ZZ[\zeta_n]$. (Indeed, for any $g\in G$ and representation $\rho$, because $g^n=1$, the eigenvalues of $g$ are all $n$th roots of unity, so $\tr\rho(g)\in\ZZ[\zeta_n]$.)
\end{remark}
Most of our work in eventually proving that all finite groups are Brauer will come from a construction of many characters. We begin with a couple preliminary lemmas.
\begin{lemma} \label{lem:divisible-char-is-induced}
	Fix a finite group $G$ of order $n$, and choose a class function $f\colon G\to\ZZ[\zeta_n]$. Then $nf$ is in the image of the map
	\[\op{Ind}\colon\bigoplus_{\substack{H\subseteq G\\H\text{ cyclic}}}R(H)_{\ZZ[\zeta_n]}\to R(G)_{\ZZ[\zeta_n]}.\]
\end{lemma}
\begin{proof}
	The proof has two steps.
	\begin{enumerate}
		\item We show that $n$ is in the image of the given map. For each cyclic subgroup $H\subseteq G$, define $\theta_H\colon H\to\ZZ$ as $\left|H\right|$ times the indicator function of generating $H$. Then we claim that
		\[n\stackrel?=\sum_{\substack{H\subseteq G\\H\text{ cyclic}}}\op{Ind}_H^G\theta_H.\]
		Well, for any $g\in G$, we begin by computing $\op{Ind}_H^G\theta_H(g)$ as
		\[\frac1{\left|H\right|}\sum_{\substack{\eta\in G\\\eta g\eta^{-1}\in H}}\theta_H\left(\eta g\eta^{-1}\right)=\left|\{\eta\in G:\eta g\eta^{-1}\text{ generates }H\}\right|.\]
		Now, upon summing over all $H$, we see that each $\eta g\eta^{-1}$ surely generates exactly one cyclic subgroup $H$, so the claim follows.
		\item We complete the proof. By the previous step, we see that $nf$ equals
		\[\Bigg(\sum_{\substack{H\subseteq G\\H\text{ cyclic}}}\op{Ind}_H^G\theta_H\Bigg)f=\sum_{\substack{H\subseteq G\\H\text{ cyclic}}}\op{Ind}_H^G(\theta_Hf|_H),\]
		so we will be done as soon as we check that $\theta_Hf|_H\in R(H)_{\ZZ[\zeta_n]}$. Well, because $H$ is cyclic, orthogonality of characters permits to merely check that $\langle\theta_Hf|_H,\psi\rangle\in\ZZ[\zeta_n]$ for any character $\psi\colon H\to\CC^\times$; however, this follows by a direct expansion of the inner product because $\psi$ outputs to $\ZZ[\zeta_n]$ and $f|_H$ outputs to $\left|H\right|\ZZ[\zeta_n]$.
		\qedhere
	\end{enumerate}
\end{proof}
For the next lemma, we need a piece of notation.
\begin{notation}
	Fix a finite group $G$ of order $n$, and fix a prime $p$. Choose $g\in G$, whose order we write as $\op{ord}(g)=mp^\nu$ where $p\nmid m$. Then we may find integers $x$ and $y$ such that $xm+yp^\nu=1$. Now, for any $g\in G$, we define $g_p\coloneqq g^{xm}$ (which has prime-power order) and $g_p'\coloneqq g^{yp^\nu}$ (which has order coprime to $p$) so that $g=g_pg_p'$.
\end{notation}
\begin{lemma} \label{lem:mod-p-char-uses-primary-part}
	Fix a finite group $G$ of order $n$. For any class function $f\colon G\to\ZZ[\zeta_n]$ in $R(G)_{\ZZ[\zeta_n]}$, we have
	\[f(g)\equiv f(g_p')\pmod {p\ZZ[\zeta_n]}\]
	for any $g\in G$ and prime $p$.
\end{lemma}
\begin{proof}
	Because we are only interested in the values of $f$ on powers of $g$, we may as well work with $f|_{\langle g\rangle}$. Now, because $\langle g\rangle$, we may write $f|_{\langle g\rangle}$ as $\ZZ[\zeta_n]$-linear combination of linear characters $\langle g\rangle\to\CC^\times$. Notably, the conclusion is $\ZZ[\zeta_n]$-linear in $f$, so we may as well assume that $f|_{\langle g\rangle}$ is a linear character $\langle g\rangle\to\CC^\times$.

	Now, recall that $g_p'$ is $g^{yp^\nu}$ where the order of $g$ equals $mp^\nu$ for $p\nmid m$ and $x,y\in\ZZ$ satisfy $xm+yp^\nu=1$. Thus, $f(g)$ will be an $mp^\nu$th root of unity, so it will be enough to check that
	\[\zeta\equiv\zeta^{yp^\nu}\pmod{p\zeta[\zeta]},\]
	where $\zeta$ is a primitive $mp^\nu$th root of unity. Well, by the Frobenius automorphism, it is enough to check that sufficiently large $p$th powers of both sides are equal. For this, note that $p^\nu\equiv(1+y)p^\nu\pmod{mp^\nu}$, so it is enough to take $p^\nu$th powers.
\end{proof}
Now is as good a time as any to begin our main argument.
\begin{theorem}[Brauer] \label{thm:brauer}
	Let $G$ be a finite group. Then $G$ is Brauer.
\end{theorem}
\begin{proof}
	Let $n$ be the order of $n$. The idea is to show that the map
	\[\op{Ind}_{\ZZ[\zeta_n]}\colon\bigoplus_{\substack{H\subseteq G\\H\text{ nilpotent}}}R(H)_{\ZZ[\zeta_n]}\to R(G)_{\ZZ[\zeta_n]}\]
	is surjective, which completes the proof. Namely, one can undo the base-change by $\ZZ[\zeta_n]$ because $\ZZ[\zeta_n]$ is a free $\ZZ$-algebra of finite rank; then one merely notes that any complex irreducible representation $\rho$ of $G$ can be written as a linear combination of inductions $R(H)$ for nilpotent subgroups $H\subseteq G$, but anything in $R(H)$ is induced from a linear character by \Cref{lem:nilpotent-is-brauer}. In fact, we will find that we may merely consider $H$ which are the product of a cyclic group and a $p$-group.
	
	As always, we proceed in steps.
	\begin{enumerate}
		\item To ground ourselves, we note that it is enough to check that $1$ is in the image of $\op{Ind}_{\ZZ[\zeta_n]}$. Indeed, it is then enough to check that the image of $\op{Ind}_{\ZZ[\zeta_n]}$ is an ideal, for which it is enough to check that $\op{Ind}_H^GR(H)\subseteq R(G)$ is an ideal for any subgroup $H\subseteq G$. Well, for any $f_H\in R(H)$ and $f_G\in R(G)$, we see that $f_G\op{Ind}_H^Gf_H=\op{Ind}_H^G(f_G|_Hf_H)$.

		Our proof will eventually build a small supply of constant functions in the image of $\op{Ind}_{\ZZ[\zeta_n]}$, which will produce the constant function $1$ by taking suitable linear combinations.

		\item We proceed with the key construction. Fix a prime $p$, and choose $x\in G$ of order coprime to $p$. Then we claim that there is $f\colon G\to\ZZ$ in the image of $\op{Ind}_{\ZZ[\zeta_n]}$ such that $f(x)\not\equiv0\pmod p$ while $f(y)=0$ of $y$ has order coprime to $p$ and is not conjugate to $x$.

		In fact, we will induce $f$ directly from the subgroup $H=\langle x\rangle\times P$, where $P$ is a Sylow $p$-subgroup of the centralizer $C(x)\subseteq G$. (Note that $H$ is nilpotent because it is the product of nilpotent groups. Also, $H$ is in fact a subgroup because $\langle x\rangle$ has cardinality coprime to $p$, thus making the induced map $\langle x\rangle\times P\to G$ an injective homomorphism.) We now define $f_H\colon H\to G$ by
		\[f_H\left(x^iy\right)\coloneqq\begin{cases}
			\left|\langle x\rangle\right| & \text{if }x^i=x, \\
			0 & \text{else},
		\end{cases}\]
		for any $x^i\in\langle x\rangle$ and $y\in P$. We quickly check that $f_H\in R(H)$: note that $f_H=f_H\circ\op{pr}_{\langle x\rangle}$, so it is enough to check that $f_H|_{\langle x\rangle}$, which follows from \Cref{lem:divisible-char-is-induced}
		
		It remains to check that $f\coloneqq\op{Ind}_H^Gf_H$ satisfies the required conditions. For example, of course $f$ is in the image of $\op{Ind}_{\ZZ[\zeta_n]}$ and defines a function $G\to\ZZ$. Before doing anything else, we remark on the condition $\eta g\eta^{-1}\in H$ for $g,\eta\in G$. Namely, if $g$ has order coprime to $p$, then $\eta g\eta^{-1}\in H$ continues to have order coprime to $p$; thus, by writing it out as $x^iy$ for $y\in P$, we find that we must have $\eta g\eta^{-1}\in\langle x\rangle$. In particular, to have $f_H\left(\eta g\eta^{-1}\right)\ne0$, we must have $\eta g\eta^{-1}=x$ on the nose!
		\begin{itemize}
			\item Using the previous paragraph, we compute $f(x)$ as
			\[\frac1{\left|\langle x\rangle\right|\cdot\left|P\right|}\sum_{\substack{\eta\in G\\\eta x\eta^{-1}=x}}\left|\langle x\rangle\right|.\]
			This sum is now $\left|C(x)\right|/\left|P\right|$, which is coprime to $p$ because $P\subseteq C(x)$ is a Sylow $p$-subgroup.
			\item Again using the paragraph preceding our checks, we see that any $g$ of order coprime to $p$ must have $g$ conjugate to $x$ in order for the sum $\op{Ind}_H^Gf_H(g)$ to have any nonzero terms. We conclude that $f(g)=0$ when $g$ has order coprime to $p$ but is not conjugate to $x$.
		\end{itemize}

		\item Fix a prime $p$. Then we claim that there is $f\colon G\to\ZZ$ in the image of $\op{Ind}_{\ZZ[\zeta_n]}$ such that $p\nmid f(x)$ for all $x\in G$. Quickly, we note that \Cref{lem:mod-p-char-uses-primary-part} allows us to merely check the conclusion for $x\in G$ of order coprime to $p$.

		Now, let $X\subseteq G$ be a set of representatives of the conjugacy classes of the elements of $G$ with order coprime to $p$. Then for each $x\in X$, we construct $f_x\colon G\to\ZZ$ in the image of $\op{Ind}_{\ZZ[\zeta_n]}$ via the previous step. Then we define
		\[f\coloneqq\sum_{x\in X}f_x.\]
		We now check that $f$ works. Certainly $f$ is in the image of $\op{Ind}_{\ZZ[\zeta_n]}$. Further, the construction of the $f_x$s means that any $y\in G$ of order coprime to $p$ will produce a nonzero contribution$\pmod p$ at exactly one summand (namely, the $x\in X$ conjugate to $y$).

		\item We complete the proof. For each prime $p$, we factor $n=mp^\nu$ where $p\nmid m$; then we claim that $m$ is in the image of $\op{Ind}_{\ZZ[\zeta_n]}$. By letting $p$ vary over the prime factors of $n$, this allows us to conclude that $1$ is in the image of $\op{Ind}_{\ZZ[\zeta_n]}$ by taking $\ZZ$-linear combinations, thereby completing the proof.

		Now fix a prime $p$. The previous step provides $f\colon G\to\ZZ$ such that $f(x)\not\equiv0\pmod p$ for all $x\in G$. By replacing $f$ with a suitably large power (which we may do because the image of $\op{Ind}_{\ZZ[\zeta_n]}$ is an ideal), we may achieve that $f\equiv1\pmod{p^\nu}$ for all $x\in G$. Then $mf-m$ is a class function $G\to\ZZ$ with values divisible by $n$, so \Cref{lem:divisible-char-is-induced} tells us it is in the image of $\op{Ind}_{\ZZ[\zeta_n]}$. We are now allowed to conclude $m$ is in the image of $\op{Ind}_{\ZZ[\zeta_n]}$.
		\qedhere
	\end{enumerate}
\end{proof}

We are now done checking for our meromorphic continuation. It remains to verify our holomorphy and nonvanishing on $\{s:\Re s=1\}$. Recall from \Cref{lem:brauer-to-artin} that we only care about $s=1$. Following \cite[Section~11.4]{murty-alg-nt}, we pick up the following item.
\begin{definition}[Heilbronn character]
	Fix a Galois extension $L/K$ of number fields with Galois group $G$. For a finite-dimensional complex representation $\rho\colon G\to\op{GL}(V)$, we write $n(\rho)$ for the order of the pole of $L(s,\rho)$ at $s=1$. Then we define the \textit{Heilbronn character} $\theta_G$ of $G$ by
	\[\theta_G\coloneqq\sum_{\rho\in\op{IrRep}(G)}n(\rho)({\tr}\circ\rho),\]
	where the sum is over irreducible representations $\rho$ of $G$.
\end{definition}
% \begin{remark}
% 	Technically, the notation $L(s,\rho)$ is a little ambiguous because it could refer to the Artin $L$-function attached to the representation $\op{Gal}(L/K)\to\op{GL}(V)$ or the inflated representation $\op{Gal}(\ov K/K)\to\op{GL}(V)$. Luckily, $n(\rho)$ is the same for both
% \end{remark}
\begin{remark} \label{rem:use-heilbronn}
	Of course, we expect to have $\theta_G=1$. Indeed, by the orthogonality of characters, we see that $\theta_G=1$ is equivalent to having $n(\rho)=0$ for all nontrivial irreducible representations $\rho$ of $G$. But now we recall that $n(\rho)=0$ is equivalent to holomorphy and nonvanishing of $L(s,\rho)$ at $s=1$.
\end{remark}
The utility we will get out of $\theta_G$ is that it will let us efficiently reduce to subgroups.
\begin{lemma}[Heilbronn--Stark] \label{lem:restrict-heilbronn}
	Fix a Galois extension $L/K$ of number fields with Galois group $G$, and choose a subgroup $H\subseteq G$. Then $\theta_G|_H=\theta_H$.
\end{lemma}
\begin{proof}
	This follows from Frobenius reciprocity. By the orthogonality of characters, it is enough to check that $\langle\theta_G|_H,\sigma\rangle=n(\sigma)$ for any irreducible representation $\sigma$ of $H$. We do this in two steps.
	\begin{enumerate}
		\item For any representation $\rho_0$ of $G$, we claim that $n(\rho_0)=\langle\theta_G,{\tr}\circ\rho_0\rangle$. Indeed, upon expanding $\rho_0$ into a sum of irreducible representations as $\rho_0=\bigoplus_\rho\rho^{\nu_\rho}$, we see that $L(s,\rho_0)=\prod_\rho L(s,\rho)^{\nu_\rho}$ by \Cref{lem:artin-add}, so
		\[n(\rho_0)=\sum_{\rho\in\op{IrRep}(G)}\nu_\rho n(\rho),\]
		so we complete this step upon noticing $\nu_\rho=\langle\rho_0,\rho\rangle$.
		\item We complete the proof. By Frobenius reciprocity, we see that $\langle\theta_G|_H,\sigma\rangle$ equals $\left\langle\theta_G,\op{Ind}_H^G\sigma\right\rangle$. But the previous step tells us that this equals $n(\op{Ind}_H^G\sigma)$, which we note equals $n(\sigma)$ because $L(s,\op{Ind}_H^G\sigma)=L(s,\sigma)$ by \Cref{lem:artin-ind}.
		\qedhere
	\end{enumerate}
\end{proof}
\begin{proposition} \label{prop:artin-nonvanish}
	Fix a number field $K$, and let $\rho\colon\op{Gal}(\ov K/K)\to\op{GL}(V)$ be a nontrivial irreducible finite-dimensional complex representation. Then $L(s,\rho)$ is holomorphic and nonvanishing at $s=1$.
\end{proposition}
\begin{proof}
	By \Cref{lem:artin-finite-image}, there is a finite Galois extension $L$ of $K$ with Galois group $G$ such that $\rho$ descends to a representation of $G$. Then \Cref{rem:use-heilbronn} explains that it is enough to check that $\theta_G=1$. We will do this by computing $\langle\theta_G,\theta_G\rangle$ in two ways.
	\begin{itemize}
		\item On one hand, by the orthogonality of characters, this equals
		\[\sum_{\rho_0\in\op{IrRep}(G)}n(\rho)^2.\]
		Because the trivial character $1$ has $n(1)=1$ already by \Cref{thm:hecke-continue}, we see $1$ is in the support of $\theta_G$, so $\langle\theta_G,\theta_G\rangle=1$ if and only if $n(\rho)=0$ for all nontrivial irreducible representations $\rho$ of $G$.
		\item On the other hand, using \Cref{lem:restrict-heilbronn}, we see $\langle\theta_G,\theta_G\rangle$ satisfies
		\[\langle\theta_G,\theta_G\rangle=\frac1{\left|G\right|}\sum_{g\in G}\theta_{\langle g\rangle}(g).\]
		However, we already know that $\theta_{\langle g\rangle}=1$ because $\langle g\rangle$ is abelian by using \Cref{rem:use-heilbronn} with \Cref{cor:abelian-artin-nonvanish}. Thus, $\langle\theta_G,\theta_G\rangle=1$.
	\end{itemize}
	Combining the above two points completes the proof.
\end{proof}
At long last, we may prove the Chebotarev density theorem.
\begin{theorem}[Chebotarev density]
	Fix a number field $K$. For each prime $\mf p$ of $K$, choose a prime $\mf P$ of $\ov K$ above $\mf p$, and let $x_{\mf p}$ be the conjugacy class of $\op{Frob}_{\mf P}$ in $\op{Gal}(\ov K/K)$. Then the sequence $\{x_{\mf p}\}_{\mf p}$ equidistributes in $\op{Conj}(\op{Gal}(\ov K/K))$.
\end{theorem}
\begin{proof}
	By \Cref{prop:equi-by-l-func}, it is enough to check that the $L$-functions $L(s,\rho)$ have nonvanishing holomorphic continuation to $\{s:\Re s\ge1\}$ for each nontrivial complex irreducible representation $\rho$ of $\op{Gal}(\ov K/K)$. Well, fix some such $\rho$. By \Cref{lem:artin-finite-image}, we can find a finite Galois extension $L$ of $K$ with Galois group $G$ such that $\rho$ descends to $\op{Gal}(L/K)$. Now, $G$ is Brauer by \Cref{thm:brauer}, so \Cref{lem:brauer-to-artin} provides a meromorphic continuation to $\{s:\Re s\ge1\}$ which is holomorphic and nonvanishing for $s\ne1$. Lastly, we get the result for $s=1$ by \Cref{prop:artin-nonvanish}.
\end{proof}
% elliptic curves
% y^9 = x(x-1)(x-lambda) first few moments

% CM + Chebotarev does not seem to give potential CM
% the problem is that ST is requiring equidistribution of some very strange composite, and I am quite unconvinced that it is continuous (namely, the non-canonical embedding Q_l to C is discontinuous)
% this explains why johansson works harder

\end{document}