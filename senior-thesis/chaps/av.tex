% !TEX root = ../thesis.tex

\documentclass[../thesis.tex]{subfiles}

\begin{document}

\chapter{Abelian Varieties} \label{chap:av}

In this chapter, we gather together all the results about abelian varieties we need. Many of the results in the earlier sections discussed here can be found in any reasonable text on abelian varieties such as \cite{mumford-abelian-varieties,milne-av,egm-av}. Results in the later sections are more specialized, and we will provide references when appropriate. Ultimately, our goal is to define $\ell$-adic monodromy groups, explain why one might care about them, and indicate how one might compute them.

\section{Definitions and Constructions}
In this section, we set up the theory of abelian varieties rather quickly. We will usually only indicate proofs that work in the complex analytic situation because the general theory usually requires intricate algebraic geometry.

\subsection{Starting Notions}
Let's begin with a definition.
\begin{definition}[abelian variety] \nirindex{abelian scheme}
	Fix a ground scheme $S$. An \textit{abelian scheme} $A$ over $S$ is a smooth projective geometrically integral group scheme over $S$. An \textit{abelian variety} $A$ is an abelian scheme over a field.
\end{definition}
\begin{remark}
	Throughout, we will work with abelian varieties instead of abelian schemes as much as possible. However, one should be aware that many of the results generalize.
\end{remark}
Here, a group variety refers to a group object in the category of varieties over $K$.
\begin{remark}
	With quite a bit of work, one can weaken the hypotheses of being an abelian variety quite significantly. For example, arguments involving group varieties are able to show that being connected and geometrically reduced implies geometrically integral, and it is a theorem that one can replace projectivity with properness. See \cite[Remark~0H2U]{stacks} for details.
\end{remark}
Here are the starting examples.
\begin{example}[elliptic curves] \label{ex:ec}
	Any (smooth) cubic equation cuts out a genus-$1$ curve in $\PP^2$. If the curve has points defined over $K$, this defines an elliptic curve, which can be shown to be an abelian variety. The interesting part comes from defining the group structure. One way to do this is to show that the map $E\to\op{Pic}^0_{E/K}$ given by $x\mapsto[x]-[\infty]$ is an isomorphism of schemes and then give $E$ the group structure induced by $\op{Pic}^0_{E/K}$. (Here, $\op{Pic}^0_{E/K}$ is the moduli space of line bundles over $E$ of degree $0$. Smoothness of the curve makes this in bijection with divisors of degree $0$.)
\end{example}
\begin{example} \label{ex:complex-av}
	Fix a positive integer $g\ge0$. If $\Lambda\subseteq\CC^g$ is a polarizable sublattice, then $\CC^g/\Lambda$ defines an abelian variety over $\CC$. Here, polarizable means that there is an alternating map $\varphi\colon\Lambda\times\Lambda\to\ZZ$ such that the pairing
	\[\langle x,y\rangle\coloneqq\psi_\RR(x,iy)\]
	on $\Lambda_\RR$ is symmetric and positive-definite. (As worked out in \cite[Section~I.2]{milne-cm}, this is equivalent data to a polarization on the Hodge structure $\Lambda=\mathrm H_1^{\mathrm B}(A,\ZZ)$.) The requirement of polarizability is used to show that the quotient $\CC^g/\Lambda$ is actually projective; see \cite[Section~3,~Theorem]{mumford-abelian-varieties}.
\end{example}
It is notable that we have not required our abelian varieties $A$ to actually be abelian even though (notably) both examples above are abelian. Indeed, abelian varieties are always abelian groups, which follows from an argument using the Rigidity theorem. We will not give this argument in full because we will not use it, but we state a useful corollary.
\begin{proposition} \label{prop:av-map-is-homo}
	Let $\varphi\colon A\to B$ be a smooth map of abelian varieties over a field $K$. Then $\varphi$ is the composition of a homomorphism and a translation.
\end{proposition}
\begin{proof}
	By composing with a translation, we may assume that $\varphi(0)=0$. Then one applies the Rigidity theorem to the map $\widetilde\varphi\colon A\times A\to B$ defined by
	\[\widetilde\varphi(a,a')\coloneqq\varphi(a+a')-\varphi(a)-\varphi(a')\]
	to find that $\widetilde\varphi$ is constantly $0$, completing the proof. See \cite[Corollary~I.1.2]{milne-av} for details.
\end{proof}
\begin{corollary}
	The group law on an abelian variety $A$ is commutative.
\end{corollary}
\begin{proof}
	The inversion map $i\colon A\to A$ on an abelian variety sends the identity to itself, so \Cref{prop:av-map-is-homo} tells us that $i$ must be a homomorphism. It follows that the group law is commutative.
\end{proof}
In particular, we find that morphisms between abelian varieties are rather strutured: we are allowed to basically only ever consider homomorphisms!

It will turn out that considering abelian varieties up to isomorphism is too strong for most purposes, so we introduce the following definition.
\begin{definition}[isogeny]
	A morphism $\varphi\colon A\to B$ of abelian varieties over a field $K$ is an \textit{isogeny} if and only if it is a homomorphism satisfying any one of the following equivalent conditions.
	\begin{listalph}
		\item $\varphi$ is surjective with finite kernel.
		\item $\dim A=\dim B$, and $\varphi$ is surjective.
		\item $\dim A=\dim B$, and $\varphi$ has finite kernel.
		\item $\varphi$ is finite, flat, and surjective.
	\end{listalph}
	The \textit{degree} of the isogeny is $\#\ker\varphi$ (thought of as a group scheme).
\end{definition}
\begin{remark}
	Let's briefly indicate why (a)--(d) above are equivalent; see \cite[Proposition~7.1]{milne-av} for details. A spreading out argument combined with the homogeneity of abelian varieties implies that
	\[\dim B=\dim A+\dim\varphi^{-1}(\{b\})\]
	for any $b$ in the image of $\varphi$; this gives the equivalence of (a)--(c). Of course (d) implies (a) (one only needs the finiteness and surjectivity); to show (a) implies (d), we note flatness follows by ``miracle flatness'' because all fibers have equal dimension, and finiteness follows because finite kernel upgrades to quasi-finiteness.
\end{remark}
Intuitively, an isogeny is a ``squishy isomorphism.''
\begin{example}
	Any dominant morphism of elliptic curves sending the identity to the identity is an iso\-geny.
\end{example}
\begin{example}
	In the complex analytic setting, an isogeny of two abelian varieties $A=\CC^g/\Lambda$ and $B=\CC^g/\Lambda'$ amounts (up to change of basis) an inclusion of lattices $\Lambda'\subseteq\Lambda$.
\end{example}
\begin{example}
	Fix any abelian variety $A$. For any nonzero integer $n$, the multiplication-by-$n$ endomorphism $[n]_A\colon A\to A$ is an isogeny. To see this, note that it is enough to check that $A[n]\coloneqq\ker[n]_A$ is finite. In the complex analytic situation where $A=\CC^g/\Lambda$, this follows because $\frac1n\Lambda/\Lambda$ is finite; in general, one must show that $A[n]\coloneqq\ker[n]_A$ is zero-dimensional, which is somewhat tricky. See \cite[Lemma~0BFG]{stacks} for details. We remark that one can compute $\deg[n]_A=d^{2\dim A}$, which is again not so hard to see in the complex analytic situation.
\end{example}
Motivated by the complex analytic setting (and the ``squishy isomorphism'' intuition), one might hope that one can recover weak-ish inverses for isogenies. This turns into an important property of abelian varieties.
\begin{lemma} \label{lem:dual-isogeny}
	Fix an isogeny $\varphi\colon A\to B$ of abelian varieties of degree $d$. Then there exists an ``inverse isogeny'' $\beta\colon B\to A$ such that
	\[\begin{cases}
		\alpha\circ\beta=[d]_B, \\
		\beta\circ\alpha=[d]_A.
	\end{cases}\]
\end{lemma}
\begin{proof}
	By some theory regrading group scheme quotients, it is enough to check that $\varphi$ factors through $[d]_A$, which holds because $\ker\varphi$ has order $d$ as a group scheme and thus vanishes under $[d]_A$.
\end{proof}
\begin{remark}
	As usual, we remark that the above lemma is easier to see in the complex analytic situation, but the key point of trying to factor through $[d]_A$ remains the same.
\end{remark}
\Cref{lem:dual-isogeny} motivates the following definition, and it codifies our intuition viewing isogenies as squishy isomorphisms.
\begin{definition}[isogeny category]
	Fix a field $K$. We define the \textit{isogeny category} of abelian varieties over $K$ as having objects which are abelian varieties over $K$, and a morphism $A\to B$ in the isogeny category is an element of $\op{Hom}_K(A,B)_\QQ$.
\end{definition}
We close our discussion of isogenies with one last remark on the size of kernels.
\begin{remark} \label{rem:count-fiber-separable}
	If $\varphi\colon X\to Y$ is a finite separable morphism of varieties, then a spreading out argument shows that the number of geometric points in a general fiber of $\varphi$ equals the degree of $\varphi$. Applied to isogenies, the homogeneity of abelian varieties is able to show that the number of geometric points in the fiber of any separable isogeny equals the degree.
\end{remark}
\begin{example} \label{ex:count-torsion-av}
	Here is an application of \Cref{rem:count-fiber-separable}: if $\op{char}K\nmid n$, then one can show that $A[n]$ has $n^{2\dim A}$ geometric points. Again, this is not so hard to see in the complex analytic setting. The hypothesis $\op{char}K\nmid n$ is needed to show that $[n]_A$ is separable; in general, the argument is trickier and can (for example) use some intersection theory \cite[Theorem~I.7.2]{milne-av}.
\end{example}
Now that we have a reasonable category, one can ask for decompositions. Here is the relevant result and definition.
\begin{theorem}[Poincar\'e reducibility] \label{thm:poincare-reducibility}
	Fix an abelian subvariety $B$ of an abelian variety $A$ defined over a field $K$. Then there is another abelian subvariety $B'\subseteq A$ such that the multiplication map induces an isogeny $B\times B'\to A$.
\end{theorem}
\begin{proof}
	As usual, we argue only in the complex analytic case. Here write $A=V/\Lambda$ for complex affine space $V$, and we find that $B=W/(\Lambda\cap W)$ for some subspace $W\subseteq V$. Now, the polarization induces a Hermitian form on $V$, so we can define $W'\coloneqq W^\perp$ so that $B'\coloneqq W'/(\Lambda\cap W')$ will do the trick. For more details, see \cite[Theorem~2.12]{milne-cm} for more details.
\end{proof}
\begin{definition}[simple]
	Fix a field $K$. An abelian variety $A$ over $K$ is \textit{simple} if and only if it is irreducible in the isogeny category.
\end{definition}
\begin{remark}
	\Cref{thm:poincare-reducibility} implies that any abelian variety can be decomposed uniquely into a product of simple abelian varieties, of course up to isogeny and permutation of factors.
\end{remark}

\subsection{The Jacobian}
In this thesis, the abelian varieties of interest to us will be Jacobians. There are a few approaches to their definition, which we will not show are equivalent, but we refer to \cite[Chapter~III]{milne-av} for details. The most direct definition is as a moduli space.
\begin{definition}[Jacobian]
	Fix a smooth proper curve $C$ over a field $K$ such that $C(K)$ is nonempty. Then the \textit{Jacobian} $\op{Jac}C$ is the group variety $\op{Pic}^0_{C/K}$, where $\op{Pic}^0_{C/K}$ is the moduli space of line bundles on $C$ with degree $0$.
\end{definition}
\begin{remark}
	We will not check that we have defined an abelian variety, nor that we have even defined a scheme. There are interesting questions regarding the representability of moduli spaces, which we are omitting a discussion of. Milne provides a reasonably direct construction in \cite[Section~III.1]{milne-av}, but we should remark that one expects representability to be true in a broader context. In particular, there are formal ways to check (say) properness of $\op{Pic}^0_{C/K}$, from which it does follow that we have defined an abelian variety.
\end{remark}
\begin{remark}
	One can actually weaken the smoothness assumption on $C$ to merely being ``compact type.'' This is occasionally helpful when dealing with moduli spaces because it allows us to work a little within the boundary of the moduli space of curves.
\end{remark}
\begin{remark}
	Notably, \Cref{ex:ec} tells us that the Jacobian of a curve is $E$ itself.
\end{remark}
Note that the assumption $C(K)\ne\emp$ allows us to choose some point $\infty\in C(K)$ and then define a map $C(K)\to\op{Jac}C$ by $p\mapsto[p]-[\infty]$. This map turns out to be a regular closed embedding \cite[Proposition~2.3]{milne-av}. It is psychologically grounding to see that this map is universal in some sense.
\begin{proposition}
	Fix a smooth proper curve $C$ over a field $K$ such that $C(K)\ne\emp$. Choose $\infty\in C(K)$, and consider the map $\iota\colon C\to\op{Jac}C$ given by $\iota(p)\coloneqq[p]-[\infty]$. For any abelian variety $A$ over $K$ and smooth map $\varphi\colon C\to A$ such that $\varphi(\infty)=0$, there exists a unique map $\widetilde\varphi\colon\op{Jac}C\to A$ making the following diagram commute.
	% https://q.uiver.app/#q=WzAsMyxbMCwwLCJDIl0sWzEsMCwiXFxvcHtKYWN9QyJdLFsxLDEsIkEiXSxbMCwxLCJcXGlvdGEiXSxbMCwyLCJcXHZhcnBoaSIsMl0sWzEsMiwiXFx3aWRldGlsZGVcXHZhcnBoaSIsMCx7InN0eWxlIjp7ImJvZHkiOnsibmFtZSI6ImRhc2hlZCJ9fX1dXQ==&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
	\[\begin{tikzcd}
		C & {\op{Jac}C} \\
		& A
		\arrow["\iota", from=1-1, to=1-2]
		\arrow["\varphi"', from=1-1, to=2-2]
		\arrow["{\widetilde\varphi}", dashed, from=1-2, to=2-2]
	\end{tikzcd}\]
\end{proposition}
\begin{proof}
	We will not need this, so we won't even point in a direction of a proof. We refer to \cite[Proposition~III.6.1]{milne-av}.
\end{proof}
It is worthwhile to provide a complex analytic construction of the Jacobian. Given a curve $C$, line bundles are in bijection with divisor classes, and divisor classes of degree $0$ can all be written in the form $\sum_{i=1}^k([P_i]-[Q_i])$ for some points $P_1,Q_1,\ldots,P_k,Q_k\in C(\CC)$. One can take such a divisor and define a linear functional on $\mathrm H^1(C,\Omega^1_C)$ by
\[\omega\mapsto\sum_{i=1}^k\int_{Q_i}^{P_i}\omega.\]
The construction of this linear functional is not technically well-defined up to divisor class; instead, one can check that changing the divisor class adjusts the linear functional exactly by the choice of a cycle in $\mathrm H_1^{\mathrm B}(C,\ZZ)$ embedded into $\mathrm H^1(C,\Omega^1_C)^\lor$ via the integration pairing. In this one way, one finds that
\[\op{Jac}C(\CC)=\frac{\mathrm H^1(C,\Omega^1_C)^\lor}{\mathrm H_1^{\mathrm B}(C,\ZZ)}.\]
In particular, we have realized $\op{Jac}C$ explicitly as a complex affine space modulo some lattice, exactly as in \Cref{ex:complex-av}. (One sees that $\op{rank}_\ZZ\mathrm H_1^{\mathrm B}(C,\ZZ)=\dim_\RR\mathrm H^1(C,\Omega^1_C)^\lor$ by the Betti-to-de~Rham comparison isomorphism.) This construction makes it apparent that
\[\mathrm H_1^{\mathrm B}(\op{Jac}C(\CC),\ZZ)\cong\mathrm H_1^{\mathrm B}(C,\ZZ).\]
This is in fact a general property.
\begin{proposition} \label{prop:embed-cohom}
	Fix a smooth proper curve $C$ over a field $K$ such that $C(K)\ne\emp$. Choose $\infty\in C(K)$, and consider the map $\iota\colon C\to\op{Jac}C$ given by $\iota(p)\coloneqq[p]-[\infty]$. Then the induced map
	\[\iota^*\colon\mathrm H^1(\op{Jac}C)\to\mathrm H^1(C)\]
	is an isomorphism, where $\mathrm H$ is any of the Weil cohomology theories of \cref{sec:review-cohom}.
\end{proposition}
\begin{proof}
	The proof requires analyzing each cohomology theory individually. Above we outlined the proof when $\mathrm H$ is Betti cohomology, and we note that the result follows for de~Rham cohomology by the comparison isomorphism.
\end{proof}
\begin{corollary}
	Fix a smooth proper curve $C$ over a field $K$ such that $C(K)\ne\emp$. Then $\dim\op{Jac}C$ equals the genus of the curve $C$.
\end{corollary}
\begin{proof}
	Again, this is easy to see in the complex analytic case from the explicit construction. In general, one can read off the dimension of an abelian variety $A$ from $\dim\mathrm H^1(A)$ and then apply \Cref{prop:embed-cohom}.
\end{proof}

\subsection{The Dual}
Even though we will technically not need it, we take a moment to discuss duality and polarizations of abelian varieties; we do want to understand these notions so that we can make sense of the Weil pairing. Motivated by the utility of the Picard group in defining the Jacobian, we make the following definition.
\begin{definition}[dual abelian variety]
	Fix an abelian variety $A$ over a field $K$. Then we define the \textit{dual abelian variety} $A^\lor$ as the group scheme $\op{Pic}^\circ_{A/K}$ over $K$.
\end{definition}
\begin{remark}
	As usual, we will not check that $A^\lor$ is an abelian variety or even a scheme, but it is. (The ingredients that go into these arguments will not be relevant for us.) We refer to \cite[Chapter~6]{egm-av} for these arguments, in addition to the useful fact that $\dim A=\dim A^\lor$.
\end{remark}
% \begin{remark}
% 	Note that $A^\lor$ is not the full moduli space of line bundles. In computations, one typically shows that $A^\lor$ is instead a moduli space of rigidified line bundles: for a test $F$-scheme $T$, a point in $A^\lor(T)$ is a line bundle $\mc L$ on $A\times T$
% \end{remark}
\begin{remark} \label{rem:dual-torus}
	It is worthwhile to note that, in the complex analytic situation, there already is a notion of a dual abelian variety. If $A=V/\Lambda$ is an abelian variety, then $A^\lor=V^*/\Lambda^*$, where $V^*$ is the vector space of conjugation-semilinear functionals $V^*\to\CC$, and $\Lambda^*$ consists of the functionals which are integral on $\Lambda$. It is rather tricky to explain how this definition relates to the one above, so we will not do so and instead refer to \cite[Section~4]{rosen-av-over-c}.
\end{remark}
It is worth our time to explain why this is called duality. To begin, there is a duality for morphisms.
\begin{lemma}
	Fix a homomorphism $f\colon A\to B$ of abelian varieties over a field $K$. Then there is a dual homomorphism $f^\lor\colon B^\lor\to A^\lor$.
\end{lemma}
\begin{proof}
	We define the homomorphism on geometric points. Then a point of $B^\lor(\ov K)$ is a line bundle $\mc L$ on $B_{\ov K}$, which we can pull back to a line bundle $f^*\mc L$ on $A_{\ov K}$, which is a point of $A^\lor(\ov K)$.
\end{proof}
\begin{lemma}
	Fix an abelian variety $A$ over a field $K$. Then there is a canonical isomorphism $A\to A^{\lor\lor}$.
\end{lemma}
\begin{proof}
	We sketch the construction of the map and refer to \cite[Theorem~7.9]{egm-av} for details. Because $A^\lor$ is a moduli space of line bundles, there is a universal Poincar\'e line bundle $\mc P_A$ on $A\times A^\lor$. Unravelling the definition of $A^\lor$, we see that morphisms $S\to A^\lor$ correspond to line bundles on $A\times S$. Turning this around, we thus see that we can view $\mc P_A$ as a family of line bundles on $A^\lor$ parameterized by $A$ and thus providing a map $A\to A^{\lor\lor}$. This map is the required isomorphism.
\end{proof}
Most of the utility one achieves from the dual is that it allows us to the complex-analytic notion of a polarization into algebraic geometry. As in \Cref{rem:dual-torus}, we view $A=V/\Lambda$ as a complex torus, and the dual abelian variety $A^\lor$ can be realized concretely as some $V^*/\Lambda^*$. Now, a polarization of $A$ refers to a polarization of $\Lambda=\mathrm H_1^{\mathrm B}(A,\ZZ)$, which as mentioned in \Cref{ex:complex-av} has equivalent data to an alternating form $\psi\colon\Lambda\otimes\Lambda\to\ZZ$ such that the bilinear form
\[\langle x,y\rangle\coloneqq\psi_\RR(x,iy)\]
on $\Lambda_\RR$ is symmetric and positive-definite. But now we see that this choice of $\psi$ determines a map $A\to A^\lor$ given by $v\mapsto\psi(v,\cdot)$.

Thus, we would like our polarizations some kind of map $A\to A^\lor$. However, we need to keep track of all the adjectives that $\psi$ had in order to make this an honest definition. For example, perhaps we want to keep track of the constraint that $\psi$ is alternating. To do so, we use cohomology. We will shortly explain in \Cref{prop:cohom-ring-av} that the cup product provides an isomorphism $\land^2\mathrm H^1(A,\ZZ)\to\mathrm H^2(A,\ZZ)$, which induces an isomorphism
\[\op{Hom}_\ZZ\left(\land^2\Lambda,\ZZ\right)\cong\mathrm H^2(A,\ZZ)\]
upon taking duals. Thus, $\psi$ being an alternating form can be traced backed to it coming from a class in $\mathrm H^2(A,\ZZ)$.

Continuing, perhaps we want to keep track of the constaint that $\langle\cdot,\cdot\rangle$ is symmetric. This is equivalent to having $\psi_\RR(ix,iy)=\psi(x,y)$, which turns out to be equivalent to $\psi_\CC\in\mathrm H^2(A,\CC)$ living in the $(1,1)$ component. Well, it turns out that the exponential short exact sequence
\[0\to\ZZ\stackrel{2\pi i}\to\OO_A\stackrel{\exp}\to\OO_A^\times\to0\]
induces a (first Chern class) map $c_1\colon\mathrm H^1(A,\OO_A^\times)\to\mathrm H^2(A,\ZZ)$, which is an isomorphism onto the $(1,1)$ component. Thus, the condition that $\langle\cdot,\cdot\rangle$ is symmetric can be traced back to $\psi_\CC$ coming from a class in $\mathrm H^1(A,\OO_A^\times)$, which has equivalent data to a line bundle $\mc L$.

Lastly, it turns out that positive-definiteness of $\langle\cdot,\cdot\rangle$ corresponds to the $\mc L$ being ample. On the other hand, given a line bundle $\mc L$ on $A$, we remark that there already is a natural way to construct a map $A\to A^\lor$ from a line bundle. This gives our definition.
\begin{definition}[polariaztion]
	Fix an abelian variety $A$ over a field $K$. A \textit{polarization} is a morphism $\varphi\colon A\to A^\lor$ such that there is an ample line bundle $\mc L$ on $A_{\ov K}$ giving the equality
	\[\varphi(x)=t_x^*\mc L\otimes\mc L^{-1}\]
	for any $x\in A_{\ov K}$. We say that $\varphi$ is \textit{principal} if and only if it is an isomorphism, and we say that $A$ is a \textit{pricipally polarized}.
\end{definition}
\begin{remark}
	It turns out that the construction of the above map does correspond to the map $A\to A^\lor$ defined complex-analytically.
\end{remark}
\begin{remark}
	It turns out that polarizations are isogenies.
\end{remark}
\begin{remark} \label{rem:polarize-endos-av}
	Here is the sort of thing that one can do with this definition. One may also want to define a Rosati involution on $\op{End}(A)_\QQ$, analogous to the Rosati involution on polarized Hodge structures. Well, given a (principal) polarization $\varphi\colon A\to A^\lor$, we can define a Rosati involution $(\cdot)^\dagger$ on $\op{End}(A)_\QQ$ by sending any $f\in\op{End}(A)_\QQ$ to
	\[f^\dagger\coloneqq \varphi^{-1}\circ f^\lor\circ\varphi.\]
	If $\lambda$ is a principal polarization, then this Rosati involution descends to $\op{End}(A)$. One can check that $(\cdot)^\dagger$ continues to be a positive anti-involution, but it is not easy; see for example \cite[Theorem~12.26]{egm-av}. This allows us to apply the Albert classification \Cref{thm:albert-classification} to our situation.
\end{remark}
\begin{example}
	For any smooth proper curve $C$ such that $C(K)\ne\emp$, it turns out that the Jacobian $\op{Jac}C$ is principally polarized. It is not too hard to describe the line bundle which gives the polarization: let $\iota\colon C\to\op{Jac}(C)$ be an embedding given be one of the points in $C(K)$, and then the line bundle is given by the divisor
	\[\underbrace{f(C)+\cdots+f(C)}_{g-1},\]
	where $g$ is the genus of $C$. See \cite[Theorem~14.23]{egm-av} or \cite[Theorem~6.6]{milne-av} for more details.
\end{example}
Analogous to the complex-analytic setting $A=V/\Lambda$, we may still want to be able to define an alternating form on $\Lambda=\mathrm H_1^{\mathrm B}(A,\ZZ)$. We will achieve a satisfying version of this in \Cref{lem:weil-pairing-h1}, but for now, let us point that this is not immediately obvious how to do this because we currently have no analogue for $\Lambda$ in the general setting. However, we note that the alternating form $\Lambda$ is able to induce an alternating form on $V$, and we can access a dense subset of $V$ by taking torsion. Thus, for now, we will aim to provide a pairing
\[A[n](K^{\mathrm{sep}})\times A[n](K^{\mathrm{sep}})\to \ZZ/n\ZZ\]
for each integer $n$ such that $\op{char}K\nmid n$. Unwinding how we took a polarization to a map $A\to A^\lor$, we note that we may as well define the above map using a polarization $\varphi\colon A\to A^\lor$ by instead defining a pairing
\[A[n](K^{\mathrm{sep}})\times A^\lor[n](K^{\mathrm{sep}})\to \ZZ/n\ZZ\]
and then pre-composing with $A\to A^\lor$. More generally, given an isogeny $f\colon A\to B$, we will be able to show that there is a perfect pairing
\[(\ker f)\times(\ker f^\lor)\to\mathbb G_m,\]
upon which we find the desired pairing by taking $f=[n]_A$ and taking $K^{\mathrm{sep}}$-points.
\begin{proposition}[Weil pairing] \label{prop:weil-pairing}
	Fix an isogeny $f\colon A\to B$ of abelian varieties over $K$. Then there is a perfect pairing
	\[(\ker f)\times(\ker f^\lor)\to\mathbb G_m.\]
\end{proposition}
\begin{proof}
	We provide an explicit construction of the pairing on $K^{\mathrm{sep}}$-points, but we will not check that it is perfect, for which we refer to \cite[Theorem~8.1.3]{conrad-av}. Select $x\in(\ker f)(K^{\mathrm{sep}})$ and $y^\lor\in(\ker f^\lor)(K^{\mathrm{sep}})$. The point $y^\lor$ corresponds to a line bundle $\mc L$ on $B^\lor_{K^{\mathrm{sep}}}$. Being in the kernel of $f$ grants a trivialization $\sigma\colon f^*\mc L\to\OO_{A_{K^{\mathrm{sep}}}}$, which is unique up to a scalar. Now, note that $t_a^*f^*\mc L=f^*t_{f(a)}^*\mc L=f^*\mc L$ because $a\in\ker f$, so there is another trivialization of $f^*\mc L$ given by $t_a^*\beta\colon\mc L\to\OO_{A_{K^{\mathrm{sep}}}}$. We now define our Weil pairing as $t_a^*\beta\circ\beta^{-1}$, which we realize as an element of $\mathbb G_m(K^{\mathrm{sep}})$ by noting that $t_a^*\beta\circ\beta^{-1}$ is an automorphism of $\OO_{A_{K^{\mathrm{sep}}}}$ and is therefore a scalar.
\end{proof}
\begin{corollary} \label{cor:weil-pairing-torsion}
	Fix an abelian variety $A$ over a field $K$, and let $\varphi\colon A\to A^\lor$. For each positive integer $n$, there is a Galois-invariant perfect symplectic pairing
	\[e_\varphi\colon A[n](K^{\mathrm{sep}})\times A[n](K^{\mathrm{sep}})\to\mu_n.\]
	Furthermore, for any positive integer $m$, the following diagram commutes.
	% https://q.uiver.app/#q=WzAsNixbMCwxLCJBW25dKEZee1xcbWF0aHJte3NlcH19KSJdLFsxLDEsIkFbbl0oRl57XFxtYXRocm17c2VwfX0pIl0sWzAsMCwiQVtubV0oRl57XFxtYXRocm17c2VwfX0pIl0sWzEsMCwiQVtubV0oRl57XFxtYXRocm17c2VwfX0pIl0sWzIsMCwiXFxtdV97bW59Il0sWzIsMSwiXFxtdV9uIl0sWzIsMCwibSIsMl0sWzMsMSwibSIsMl0sWzIsMywiXFx0aW1lcyIsMSx7InN0eWxlIjp7ImJvZHkiOnsibmFtZSI6Im5vbmUifSwiaGVhZCI6eyJuYW1lIjoibm9uZSJ9fX1dLFswLDEsIlxcdGltZXMiLDEseyJzdHlsZSI6eyJib2R5Ijp7Im5hbWUiOiJub25lIn0sImhlYWQiOnsibmFtZSI6Im5vbmUifX19XSxbMyw0LCJlX1xcdmFycGhpIl0sWzEsNSwiZV9cXHZhcnBoaSJdLFs0LDUsIm0iXV0=&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
	\[\begin{tikzcd}
		{A[nm](K^{\mathrm{sep}})} & {A[nm](K^{\mathrm{sep}})} & {\mu_{mn}} \\
		{A[n](K^{\mathrm{sep}})} & {A[n](K^{\mathrm{sep}})} & {\mu_n}
		\arrow["\times"{description}, draw=none, from=1-1, to=1-2]
		\arrow["m"', from=1-1, to=2-1]
		\arrow["{e_\varphi}", from=1-2, to=1-3]
		\arrow["m"', from=1-2, to=2-2]
		\arrow["m", from=1-3, to=2-3]
		\arrow["\times"{description}, draw=none, from=2-1, to=2-2]
		\arrow["{e_\varphi}", from=2-2, to=2-3]
	\end{tikzcd}\]
\end{corollary}
\begin{proof}
	We described above how to construct the pairing from the one given in \Cref{prop:weil-pairing} by setting $f=[n]_A$ and then using the polarization $\varphi$. The remaining properties of $e_\varphi$ (such as Galois-invariance) can be checked using the explicit construction given in \Cref{prop:weil-pairing}.
\end{proof}

\subsection{Applying Hodge Theory}
We now explain the utility of \cref{chap:hodge} to our application. Here is the main result.
\begin{theorem}[Riemann] \label{thm:riemann}
	The functor $A\mapsto\mathrm H^1_{\mathrm B}(A,\QQ)$ provides an equivalence of categories between the isogeny category of abelian varieties defined over $\CC$ and the category of polarizable $\QQ$-Hodge structures $V$ such that $V_\CC=V^{0,1}\oplus V^{1,0}$.
\end{theorem}
\begin{proof}
	Writing $A=\CC^g/\Lambda$ for a polarizable lattice $\Lambda$, we see that the given functor takes $A$ to $\Lambda\otimes_\ZZ\QQ$. It is thus not hard to see that this functor is fully faithful. To see that it is essentially surjective, we begin with any polarizable $\QQ$-Hodge structure $V$ and find a polarizable sublattice $\Lambda$ in order to produce the desired abelian variety $A/\Lambda$. Admittedly, most of the work for this theorem was already done in \Cref{ex:av-polarizable-hs} when we showed that the previous sentence actually gives an abelian variety!
\end{proof}
The moral of the story is that we can keep track of abelian varieties $A$ over $\CC$ by only keeping track of their Hodge structures $\mathrm H^1_{\mathrm B}(A,\QQ)$. With this in mind, we allow ourselves the following notation.
\begin{notation}
	Fix an abelian variety $A$ over $\CC$. Then we define the \textit{Mumford--Tate group} of $A$ to be
	\[\op{MT}(A)\coloneqq\op{MT}\left(\mathrm H^1_{\mathrm B}(A,\QQ)\right).\]
	We define $\op{Hg}(A)$ and $\op L(A)$ similarly.
\end{notation}
Here is the main corollary of \Cref{thm:riemann} that we will want.
\begin{corollary} \label{cor:mt-fixes-av-endos}
	Fix an abelian variety $A$ over $\CC$. Then the natural map
	\[\op{End}_\CC(A)\otimes_\ZZ\QQ\to\op{End}_{\QQ}\left(\mathrm H^1_{\mathrm B}(A,\QQ)\right)^{\op{MT}(A)}\]
	is an isomorphism.
\end{corollary}
\begin{proof}
	By \Cref{lem:mt-hg-fixes-endos}, we see that the right-hand side is simply $\op{End}_{\op{HS}}\left(\mathrm H^1_{\mathrm B}(A,\QQ)\right)$. The result now follows from \Cref{thm:riemann}.
\end{proof}
As another aside, we go ahead and restate the Albert classification (\Cref{thm:albert-classification}) for our abelian varieties.
\begin{proposition} \label{prop:albert-av}
	Fix a simple abelian variety $A$ of dimension $g$, defined over a field $K$ of characteristic $0$, and set $D\coloneqq\op{End}_K(A)_\QQ$ and $F\coloneqq Z(D)$. Letting $(\cdot)^\dagger$ be the Rosati involution on $D$, we also let $F^\dagger$ be the $(\cdot)^\dagger$-invariants of $F$. Further, set $d\coloneqq\sqrt{[D:F]}$ and $e\coloneqq[F:\QQ]$ and $e_0\coloneqq[F^\dagger:\QQ]$. Then we have the following table of restrictions on $(g,d,e,e_0)$.
	\begin{center}
		\begin{tabular}{cccc}
			Type & $e$ & $d$ & Restriction \\\hline
			I & $e_0$ & $1$ & $e\mid g$ \\
			II & $e_0$ & $2$ & $2e\mid g$ \\
			III & $e_0$ & $2$ & $2e\mid g$ \\
			IV & $2e_0$ & $d$ & $e_0d^2\mid g$
		\end{tabular}
	\end{center}
\end{proposition}
\begin{proof}
	Recall that $D$ is amenable to the Albert classification as discussed in \Cref{rem:polarize-endos-av}. The middle two columns follow from the discussion of the various types; for example, in Type I, we see $d=1$ because $D=F$, and $e=e_0$ because $F$ is totally real. To receive the dimension restrictions, we note that some descent argument allows us to reduce to the case where $K=\CC$, where we receive an inclusion $D\subseteq\op{End}(\mathrm H^1_{\mathrm B}(A,\QQ))$ by \Cref{thm:riemann}.\footnote{It is still possible to get an inclusion like this in general. It requires a discussion of the $\ell$-adic representations, which we engage in later.} This is an inclusion of division $\QQ$-algebras, so we see that $\dim_\QQ D\mid 2g$; this implies
	\[d^2e\mid2g,\]
	which rearranges into the required restrictions.
\end{proof}
\begin{remark}
	The requirement that $\op{char}F=0$ is necessary in the table; the restrictions are somewhat different (and weaker!) in positive characteristic.
\end{remark}
While we're here, we state the main theorem of \cite{deligne-hodge} on absolutely Hodge cycles.
\begin{theorem}[Deligne]
	Fix an abelian vareity $A$ defined over a number field $K$. Then all Hodge classes on $A$ are absolutely Hodge.
\end{theorem}
We will not attempt a proof of this result, but we will remark that \Cref{thm:principle-b} allows us to reduce this result to the case of abelian varieties with many endomorphisms, which is more amenable. There is still much work to be done!

\subsection{Complex Multiplication}
Even though it is not strictly necessary for our exposition, we take a moment to discuss some theory surrounding complex multiplication. We refer to \cite{milne-cm} throughout for more details. The relevance of this discussion to us mostly arises because we have defined analogous notions in \cref{subsec:signature,subsec:reflex}.

Intuitively, complex multiplication simply means that an abelian variety has many endomorphisms. To explain this properly, we note that the endomorphism algebra of a simple abelian variety $A$ is a division $\QQ$-algebra described in \Cref{prop:albert-av}; if we drop the assumption that $A$ is simple, then it could be a product of matrix algebras of such division $\QQ$-algebras. This motivates the following definition to properly account for such matrix algebras.
\begin{definition}[reduced degree]
	Write a semisimple algebra $D$ over a field $K$ as a product $D_1\times\cdots\times D_k$ of simple algebras. Then we define the \textit{reduced degree} as
	\[[D:K]_{\mathrm{red}}\coloneqq\sum_{i=1}^k\sqrt{[D_i:F_i]}\cdot[D_i:K],\]
	where $F_i\coloneqq Z(B_i)$ for each $i$
\end{definition}
\begin{remark}
	It is not technically obvious that $[D_i:F_i]$ is a square, but this follows from the theory of central simple algebras. Roughly speaking, one can show that $D_i\otimes\overline{D_i}\cong M_n(\overline{D_i})$ for some $n\ge0$, from which the result follows; see \cite[Corollary~IV.2.16]{milne-cft}.
\end{remark}
\begin{remark} \label{rem:upper-bound-reduced-deg}
	Given an inclusion $B\subseteq\op{End}_K(V)$, one receives a bound
	\[[B:K]_{\mathrm{red}}\le[V:K].\]
	Roughly speaking, this follows by breaking up $B$ into simple pieces (which are matrix algebras of division algebras) and then looking for these pieces in $\op{End}_K(V)$. See \cite[Proposition~I.1.2]{milne-cm}
\end{remark}
In light of the previous remark, we are now able to make a definition.
\begin{definition}[complex multiplication]
	Fix an abelian variety $A$ over a field $K$. Then $A$ has \textit{complex multiplication over $K$} if and only if
	\[[\op{End}_K(A)_\QQ:\QQ]_{\mathrm{red}}=2\dim A.\]
\end{definition}
Namely, we see that $2\dim A$ is as large as possible by \Cref{rem:upper-bound-reduced-deg}, by taking $V$ to be $\mathrm H^1$ for some Weil cohomology $\mathrm H$.\footnote{Outside the complex-analytic case, it may look like one wants to use the $\ell$-adic result \Cref{thm:faltings} over a general field. However, it turns out to be enough to merely achieve the injectivity of the map \Cref{thm:faltings}, which is easier.}
\begin{remark} \label{rem:red-deg-is-additive}
	The key benefit of the reduced degree is that it is additive: given abelian varieties $A$ and $A'$, we claim
	\[[\op{End}(A\oplus A')_\QQ:\QQ]_{\mathrm{red}}\stackrel?=[\op{End}(A)_\QQ:\QQ]_{\mathrm{red}}+[\op{End}(A')_\QQ:\QQ]_{\mathrm{red}}.\]
	Indeed, by breaking everything into simple pieces, we may assume that $A$ and $A'$ are both powers of a simple abelian variety. If they are powers of different simple abelian varieties, then this is a direct computation. Otherwise, they are powers of the same simple abelian variety, in which case all central simple algebras in sight are matrix algebras over the same division algebra, and the result follows by another computation.
\end{remark}
\begin{remark}
	A computation with \Cref{prop:albert-av} shows that a simple abelian variety $A$ has complex multiplication only in Type IV when $d=1$; i.e., we require $\op{End}_K(A)$ to be a CM field. Combining this with \Cref{rem:red-deg-is-additive}, we find that an abelian variety $A$ has complex multiplication if and only if each of its factors does.
\end{remark}
\begin{remark} \label{rem:cm-large-field}
	If an abelian variety $A$ with complex multiplication is a sum of non-isomorphic simple abelian varieties, then its endomorphism algebra is simply a product of CM fields. In general, one can show that it is still the case that any abelian variety $A$ with complex multiplication has a CM algebra of degree $2\dim A$ contained in its endomorphism algebra. However, this requires a little structure theory of semisimple algebras; see \cite[Proposition~3.6]{milne-cm}.
\end{remark}
Complex multiplication places strong constraints on the Mumford--Tate group.
\begin{proposition} \label{prop:cm-is-mt-torus}
	Fix an abelian variety $A$ over $\CC$. Then $A$ has complex multiplication if and only if $\op{MT}(A)$ is a torus.
\end{proposition}
\begin{proof}
	We show the two implications separately.
	\begin{itemize}
		\item In one direction, if $A$ has complex multiplication, then \Cref{rem:cm-large-field} grants a CM algebra $E\subseteq\op{End}_\CC(A)_\QQ$ with $[E:\QQ]=2\dim A$. Then $\mathrm H^1_{\mathrm B}(A,\QQ)$ is a free module over $E$ of rank $1$, so we see that $\op{GL}_F\left(\mathrm H^1_{\mathrm B}(A,\QQ)\right)$ is isomorphic to $\mathrm T_F$. We conclude by \Cref{lem:mt-commutes-with-endo}.
		\item In the other direction, suppose $\op{MT}(A)$ is a torus. Find a maximal torus $T$ containing $\op{MT}(A)$. Then \Cref{cor:mt-fixes-av-endos} tells us that
		\[\op{End}_\CC(A)_\QQ=\op{End}_\QQ\left(\mathrm H^1_{\mathrm B}(A,\QQ)\right)^{\op{MT}(A)},\]
		which then contains $\op{End}_\QQ\left(\mathrm H^1_{\mathrm B}(A,\QQ)\right)^T$. However, the latter is a commutative semisimple $\QQ$-algebra of dimension $2g$: it suffices to check this after base-changing to $\CC$, whereupon we may identify $T$ with the diagonal torus, from which the claim follows. This completes the proof.
		\qedhere
	\end{itemize}
\end{proof}
One benefit of complex multiplication is that it lets move difficult geometric questions into combinatorial ones. To see this, we need to define the following combinatorial gadget.
\begin{definition}
	Fix an abelian variety $A$ with complex multiplication defined over $\CC$. Choose a CM algebra $E\subseteq\op{End}_\CC(A)_\QQ$ with $\dim E=2\dim A$. Then we define the \textit{CM type} of $A$ to be the CM signature $(E,\Phi)$ given by \Cref{lem:hodge-to-signature}. Note that $\mathrm H^1_{\mathrm B}(A,\QQ)$ is then a one-dimensional $E$-vector space, so $\im\Phi\subseteq\{0,1\}$, so we can realize $\Phi$ as a subset of $\op{Hom}(E,\CC)$.
\end{definition}
\begin{remark}
	Note that we are not requiring $E=Z(\op{End}_\CC(A)_\QQ)$, though this is automatically the case when the simple components of $A$ all have multiplicity $1$. Of course, there still is a CM signature coming from the case $E=Z(\op{End}_\CC(A)_\QQ)$.
\end{remark}
\begin{remark}
	There is a still a way to recover the CM type even when $A$ is not defined over $\CC$. For example, one can note that $\mathrm H^{10}$ is supposed to be the Lie algebra $\op{Lie}A$, so one can instead recover $\Phi$ from the $E$-action on $\op{Lie}A$.
\end{remark}
\begin{remark} \label{rem:simple-by-type}
	One can read the simplicity of $A$ off of the CM type $(E,\Phi)$. To begin, one needs $E$ to be a field for $A$ to be simple. Now that $E$ is a field, we know that $A\sim B^r$ where $B$ is an abelian variety with complx multiplication; say that it has CM type $(E',\Phi')$. Then the Hodge structure on $A$ is determined by the Hodge structure on $B$. Tracking this through as in \cite[Theorem~3.6]{lang-cm} shows that $A$ is simple if and only if any Galois extension $L/\QQ$ of $E$ has that
	\[\{\sigma\in\op{Gal}(L/\QQ):\Phi\sigma=\Phi\}=\op{Gal}(L/E),\]
	where $\Phi$ is being suitably thought of as an element of $\ZZ[\op{Hom}(E,L)]$.
\end{remark}
\begin{remark} \label{rem:cm-by-type}
	It turns out that there is (essentially) exactly one abelian variety with CM type $(E,\Phi)$, up to isogeny over the algebraic closure. See \cite[Proposition~3.12]{milne-cm}.
\end{remark}
\Cref{rem:cm-by-type} tells us that we are basically allowed to only pay attention to the CM type in the theory of complex multiplication.

\section{The \texorpdfstring{$\ell$}{l}-Adic Representation}
In this subsection, we now define the $\ell$-adic representation and give some of its basic properties.

\subsection{The Construction}
A priori, an abelian variety $A$ gives rise to many $\ell$-adic Galois representations via each of its cohomology groups $\mathrm H^\bullet_{\mathrm{\acute et}}(A_{K^{\mathrm{sep}}},\QQ_\ell)$. However, it turns out that we are allowed to only care about one of them.
\begin{proposition} \label{prop:cohom-ring-av}
	Fix an abelian variety $A$ over a field $K$, and let $\mathrm H$ be a Weil cohomology theory. Then the cup product defines an isomorphism between the exterior algebra $\land\mathrm H^1(A)$ and the cohomology ring $\mathrm H^*(A)$.
\end{proposition}
\begin{proof}
	In the complex analytic case, we proceed as in \cite[Proposition~2.6]{milne-cm}. Write $A=\CC^g/\Lambda$ for a lattice $\Lambda$. Fixing some index $p$, we will show that the cup product defines an isomorphism
	\[\land^p\mathrm H^1_{\mathrm B}(A,\ZZ)\to\mathrm H^p_{\mathrm B}(A,\ZZ).\]
	Well, we note that $A$ is homeomorphic to $\left(S^1\right)^{2g}$, so the K\"unneth formula allows us to reduce the question to $S^1$, where the result is true by a direct computation. In the general case, one notes that the group structure on $A$ induces a Hopf bialgebra structure on both $\land\mathrm H^1(A)$ and $\mathrm H^*(A)$; then one can appeal to some structure theory to deduce the equality. See \cite[Corollary~6.13]{egm-av} or more precisely \cite[Corollary~13.32]{egm-av}.
\end{proof}
Thus, in $\ell$-adic cohomology (where $\op{char}K\nmid\ell$ in $K$), we see that one can understand all cohomology groups of $A$ by merely understanding $\mathrm H^1_{\mathrm{\acute et}}(A_{K^{\mathrm{sep}}},\ZZ_\ell)$. Analogous to the complex analytic case, we will be able to work with the dual ``homology group'' more concretely.

Let's spend some time giving a more elementary description of $\mathrm H^1_{\mathrm{\acute et}}(A_{K^{\mathrm{sep}}},\ZZ_\ell)^\lor$. We refer to \cite[Corollary~10.38]{egm-av} and the surrounding discussion for more details. We will do this by passing to the fundamental group. In particular, note that there is a Galois-invariant isomorphism
\[\mathrm H^1(A_{K^{\mathrm{sep}}},\ZZ_\ell)\cong\op{Hom}\left(\pi_1(A_{K^{\mathrm{sep}}},a),\ZZ_\ell\right),\]
where $a\in A(K^{\mathrm{sep}})$ is some basepoint. We will go ahead and choose $a=0$.
\begin{remark}
	Let's take a moment to explain this isomorphism. By taking limits, it is enough to show this isomorphism with $\ZZ_\ell$ replaced by $\mu_n$ where $\op{char}K\nmid n$. Then one knows that $\mathrm H^1(A_{K^{\mathrm{sep}}},\mu_n)$ is in bijection with Galois coverings with Galois group $\mu_n$ by using the short exact sequence
	\[1\to\mu_n\to\mathbb G_m\stackrel n\to\mathbb G_m\to1.\]
	This completes the proof upon unravelling the definition of $\pi_1$ on the right-hand side.
\end{remark}
We now use the fact that $A$ is an abelian variety to compute $\pi_1(A_{K^{\mathrm{sep}}},0)$: one can show that any \'etale covering of $A$ is still an abelian variety and hence is an isogeny onto $A$ (for suitable choice of group law). Thus, \Cref{lem:dual-isogeny} promises that the multiplication-by-$n$ maps $[n]_A\colon A\to A$ provide a cofinal sequence of Galois \'etale coverings of $A$ (at least when $\op{char}K\nmid n$), allowing us to compute that the $\ell$-part of $\pi_1(A_{K^{\mathrm{sep}}},0)$ equals
\[\limit A\left[\ell^\bullet\right](K^{\mathrm{sep}}).\]
In conclusion, we see that $\mathrm H^1(A_{K^{\mathrm{sep}}},\ZZ_\ell)$ is naturally isomorphic to
\[\left(\limit A\left[\ell^\bullet\right](K^{\mathrm{sep}})\right)^\lor\]
as Galois representations. We are now allowed to define the Tate module.
\begin{definition}[Tate module]
	Fix an abelian variety $A$ over a field $K$, and suppose $\ell$ is a prime such that $\op{char}K\nmid\ell$. Then we define the $\ell$-adic Tate module as
	\[T_\ell A\coloneqq\limit A\left[\ell^\bullet\right](K^{\mathrm{sep}}),\]
	and we define the rational $\ell$-adic Tate module as $V_\ell A\coloneqq T_\ell A\otimes_\ZZ\QQ$.
\end{definition}
\begin{remark}
	Intuitively, $T_\ell A$ should be thought of as an $\ell$-adic stand-in for $\mathrm H_1(A)$.
\end{remark}
The discussion above suggesets that $T_\ell A$ should be a free $\ZZ_\ell$-module of rank $2$. Let's check this directly. By taking limits, it is enough to show the following.
\begin{lemma}
	Fix an abelian variety $A$ over a field $K$, and suppose $\ell$ is a prime such that $\op{char}K\nmid\ell$. For each $\nu\ge0$, there is a group isomorphism
	\[A\left[\ell^\nu\right](K^{\mathrm{sep}})\cong\ZZ/\ell^{2\nu\dim A}\ZZ.\]
\end{lemma}
\begin{proof}
	The two groups have the same size by \Cref{ex:count-torsion-av}, so the result follows for $\nu\in\{0,1\}$ automatically. For $\nu\ge2$, we induct using the short exact sequence
	\[0\to A[\ell](K^{\mathrm{sep}})\to A\left[\ell^{\nu+1}\right](K^{\mathrm{sep}})\stackrel\ell\to A\left[\ell^\nu\right](K^{\mathrm{sep}})\to0\]
	and some cardinality arguments. For example, one can finish by applying the classification of finite abelian groups.
\end{proof}
One benefit of a more concrete object is that it is easier to work with directly. For example, we can now find a perfect pairing on $\mathrm H^1_{\mathrm{\acute et}}(A_{K^{\mathrm{sep}}},\ZZ_\ell)$.
\begin{lemma} \label{lem:weil-pairing-h1}
	Fix an abelian variety $A$ over a field $K$, and suppose $\ell$ is a prime such that $\op{char}K\nmid\ell$. Choose a polarization $\varphi\colon A\to A^\lor$. Then the Weil pairing induces a Galois-invariant perfect symplectic pairing
	\[e_\varphi\colon\mathrm H^1_{\mathrm{\acute et}}(A_{K^{\mathrm{sep}}},\ZZ_\ell)\otimes_{\QQ_\ell} \mathrm H^1_{\mathrm{\acute et}}(A_{K^{\mathrm{sep}}},\ZZ_\ell)\to\ZZ_\ell(-1).\]
\end{lemma}
\begin{proof}
	By taking duals, it is enough to induce a Galois-invariant perfect symplectic pairing
	\[e_\varphi\colon T_\ell A\otimes_{\QQ_\ell}T_\ell A\to\ZZ_\ell(1).\]
	This follows by taking a limit of the Weil pairing given in \Cref{cor:weil-pairing-torsion}. Recall that $\ZZ_\ell(1)$ is the Galois representation $\limit\mu_{\ell^\bullet}$.
\end{proof}
One can also see the Galois action more explicitly: being careful about the Galois action on cohomology and the Tate module, we see that the induced Galois representation
\[\rho_\ell\colon\op{Gal}(K^{\mathrm{sep}}/K)\to\op{GL}(T_\ell A)\]
is simply given by the Galois action on the points in the limit $A\left[\ell^\bullet\right](K^{\mathrm{sep}})$.

\subsection{The \texorpdfstring{$\ell$}{l}-Adic Monodromy Group}
Now that we have a representation, we may as well define a monodromy group.
\begin{defihelper}[$\ell$-adic monodromy group] \nirindex{L-adic monodromy group@$\ell$-adic monodromy}
	Fix an abelian $A$ over a field $K$, and suppose $\ell$ is a prime such that $\op{char}K\nmid\ell$. Then the \textit{$\ell$-adic monodromy group} $G_\ell(A)$ is the smallest algebraic $\QQ_\ell$-group containing the image of the Galois representation
	\[\op{Gal}(K^{\mathrm{sep}}/K)\to\op{GL}\left(\mathrm H^1_{\mathrm{\acute et}}(A_{K^{\mathrm{sep}}},\QQ_\ell)\right).\]
\end{defihelper}
\begin{remark}
	By taking duals, we see that one produces an isomorphic Galois representation by working with $T_\ell A$ instead. Note that this dual is not very expensive: by using the Weil pairing of \Cref{lem:weil-pairing-h1}, we can remove the dual in exchange for a twist, writing
	\[\mathrm H^1_{\mathrm{\acute et}}(A_{K^{\mathrm{sep}}},\ZZ_\ell)\cong T_\ell A(-1).\]
\end{remark}
\begin{remark} \label{rem:k-conn-a}
	Unlike $\op{MT}(V)$ and $\op{Hg}(V)$, we do not expect $G_\ell(A)$ to be connected in general. However, being an algebraic $\QQ_\ell$-group, it will only have finitely many connected components. Thus, we see that the pre-image of $G_\ell(A)^\circ$ in $\op{Gal}(K^{\mathrm{sep}}/K)$ is an open subgroup of finite index, so there is a unique minimal field extension $K^{\mathrm{conn}}_A/K$ such that $G_\ell(A_{K^{\mathrm{conn}}_A})=G_\ell(A)^\circ$. Thus, our group becomes connected, only at the cost of a field extension.
\end{remark}
The interesting geometric objects arising from Hodge theory were the Hodge classes, which \Cref{rem:hodge-class-by-s} explains were exactly the vectors fixed by the group action. Analagously, we pick up the following definition.
\begin{definition}[Tate class]
	Fix an abelian $A$ over a field $K$, and suppose $\ell$ is a prime such that $\op{char}K\nmid\ell$. Then a \textit{Tate class} is a vector of some tensor construction
	\[\bigoplus_{i=1}^k\mathrm H^1_{\mathrm{\acute et}}(A_{K^{\mathrm{sep}}},\QQ_\ell)^{\otimes n_i}\otimes \mathrm H^1_{\mathrm{\acute et}}(A_{K^{\mathrm{sep}}},\QQ_\ell)^{\lor\otimes m_i}(p_i),\]
	where the $n_\bullet$s, $m_\bullet$s, and $p_\bullet$s are some nonnegative integers, fixed by the action of $\op{Gal}(K^{\mathrm{sep}}/K)$
\end{definition}
\begin{remark} \label{rem:tate-class-by-monodromy}
	We remark as in \Cref{cor:hodge-classes-by-mt} that a vector $v$ as above is a Tate class if and only if it is fixed by the indcued action by $G_\ell(A)$. Indeed, the subset of $\op{GL}\left(\mathrm H^1_{\mathrm{\acute et}}(A_{K^{\mathrm{sep}}},\QQ_\ell)\right)$ fixing $v$ is some algebraic $\QQ_\ell$-subgroup, so if it contains the image of $\op{Gal}\left(K^{\mathrm{sep}}/K\right)$, then it contains $G_\ell(A)$. We also take a moment to note that \Cref{prop:reductive-group-by-invariants} explains that one can now cut out $G_\ell(A)$ by requiring it to hold all the Tate classes invariant, as discussed in \Cref{cor:mt-by-classes}.
\end{remark}
Analogous to \Cref{conj:hodge}, one has a Tate class, which we will only state for abelian varieties.
\begin{conj}[Tate] \label{conj:tate}
	Fix an abelian variety $A$ over a number field $K$, and fix a prime number $\ell$. Then any Tate class can be written as a $\QQ_\ell$-linear combination of classes arising from algebraic subvarieties of powers of $A$.
\end{conj}
\begin{remark}
	Of course, there are Tate classes and there is a Tate conjecture for more general varieties.
\end{remark}
We conclude this section with a few bounds on the $\ell$-adic monodromy group, analogous to the discussion for Mumford--Tate groups in \cref{subsec:mt-class-bounds}. Let's begin with endomorphisms.
\begin{lemma} \label{lem:l-adic-monodromy-commutes-with-endo}
	Fix an abelian variety $A$ over a field $K$, and suppose $\ell$ is a prime such that $\op{char}K\nmid\ell$. Set $D\coloneqq\op{End}_K(A)\otimes_\ZZ\QQ$. Then
	\[G_\ell(A)\subseteq\left\{g\in\op{GL}\left(\mathrm H^1_{\mathrm{\acute et}}(A_{K^{\mathrm{sep}}},\QQ_\ell)\right):g\circ d=d\circ g\text{ for all }d\in D\right\}.\]
\end{lemma}
\begin{proof}
	We proceed as in \Cref{lem:mt-commutes-with-endo}. The right-hand group is an algebraic $\QQ_\ell$-group, so it suffices to check that it contains the image of $\op{Gal}(K^{\mathrm{sep}}/K)$. Well, for any $g\in\op{Gal}(K^{\mathrm{sep}}/K)$, we see that
	\[g\circ d=d\circ g\]
	is an equality which holds on the level of endomorphisms of $A$ because $d$ is defined over $K$ (which $g$ fixes).
\end{proof}
\begin{lemma} \label{lem:l-adic-monodromy-commutes-polarization}
	Fix an abelian variety $A$ over a field $K$, and suppose $\ell$ is a prime such that $\op{char}K\nmid\ell$. Choose a polarization $\varphi\colon A\to A^\lor$. Then there is a perfect symplectic pairing $e_\varphi$ such that
	\[G_\ell(A)\subseteq\left\{g\in\op{GL}\left(\mathrm H^1_{\mathrm{\acute et}}(A_{K^{\mathrm{sep}}},\QQ_\ell)\right):e_\varphi(gv\otimes gw)=\lambda(g)e_\varphi(v\otimes w)\text{ for fixed }\lambda(g)\in\QQ_\ell\right\}.\]
\end{lemma}
\begin{proof}
	We proceed as in \Cref{lem:mt-commutes-polarization}. The right-hand group is an algebraic $\QQ_\ell$-group, so it suffices to check that it contains the image of $\op{Gal}(K^{\mathrm{sep}}/K)$. Well, for any $g\in\op{Gal}(K^{\mathrm{sep}}/K)$, we see that
	\[e_\varphi(gv\otimes gw)=ge_\varphi(v\otimes w)\]
	by the Galois-invariance of \Cref{lem:weil-pairing-h1}. Now, we note that $\op{Gal}(K^{\mathrm{sep}}/K)$ acts on $\QQ_\ell(-1)$ through the cyclotomic character, so the right-hand side equals a scalar $\lambda(g)$ times $e_\varphi(v\otimes w)$, so we are done.
\end{proof}
\begin{remark}
	There are of course alternate proofs of \Cref{lem:l-adic-monodromy-commutes-with-endo,lem:l-adic-monodromy-commutes-polarization} by finding Tate classes and then appealing to \Cref{rem:tate-class-by-monodromy}. One uses the same classes constructed in the alternate proofs of \Cref{lem:mt-commutes-with-endo,lem:mt-commutes-polarization}.
\end{remark}
Lastly, we would like to recover the bound of \Cref{cor:mt-fixes-av-endos} on endomorphisms, sharpening \Cref{lem:l-adic-monodromy-commutes-with-endo}. However, the proof is not so easy: the proof of \Cref{cor:mt-fixes-av-endos} had to translate endomorphisms of the Hodge structure back to endomorphisms of the abelian variety via \Cref{thm:riemann}. Recovering the equivalence of \Cref{thm:riemann} is rather difficult: this result is due to Faltings \cite[Theorem~3]{faltings-mordell}, in his proof of Mordell's conjecture.
\begin{theorem}[Faltings] \label{thm:faltings}
	Fix an abelian variety $A$ over a number field $K$, and suppose $\ell$ is a prime. Then the induced map
	\[\op{End}_K(A)\otimes_\ZZ\QQ_\ell\to\op{End}_{\op{Gal}(\ov K/K)}\left(\mathrm H^1_{\mathrm{\acute et}}(A_{\ov K},\QQ_\ell)\right)\]
	is an isomorphism.
\end{theorem}
We will definitely not attempt to summarize a proof here, but we will remark that it is not even totally obvious that this map is injective! Speaking from experience, this makes for a reasonable topic for a final term paper in a first course in algebraic geometry.
\begin{remark} \label{rem:faltings-is-tate-conj}
	Via the isomorphism
	\[\op{End}_{\QQ_\ell}\left(\mathrm H^1_{\mathrm{\acute et}}(A_{\ov K},\QQ_\ell)\right)\cong\mathrm H^1_{\mathrm{\acute et}}(A_{\ov K},\QQ_\ell)\otimes\mathrm H^1_{\mathrm{\acute et}}(A_{\ov K},\QQ_\ell)^\lor,\]
	we see that \Cref{thm:faltings} can be viewed as asserting that all the Tate classes in the above space arise from endomorphisms of $A$. This verifies \Cref{conj:tate}.
\end{remark}
\begin{remark}
	We have snuck in the hypothesis that $K$ is a number field into the statement of \Cref{thm:faltings}. It is also true for finite fields, where it is due to Tate \cite{tate-endomorphisms}. However, it is not expected to be true in general!
\end{remark}
We are now able to provide a satisfying analogue to \Cref{lem:mt-hg-fixes-endos}.
\begin{corollary} \label{cor:l-adic-fixes-endos}
	Fix an abelian variety $A$ over a number field $K$, and suppose $\ell$ is a prime. Then the natural map
	\[\op{End}_K(A)\otimes_\ZZ\QQ_\ell\to\op{End}_{G_\ell(A)}\left(\mathrm H^1_{\mathrm{\acute et}}(A_{\ov K},\QQ_\ell)\right)\]
	is an isomorphism.
\end{corollary}
\begin{proof}
	\Cref{rem:faltings-is-tate-conj} explains that the endomorphisms of $A$ are exactly the Tate classes, so the result follows from the discussion in \Cref{rem:tate-class-by-monodromy}.
\end{proof}
\begin{remark} \label{rem:cm-is-l-adic-torus}
	The above corollary allows us to prove the following analogue of \Cref{prop:cm-is-mt-torus} (by the same proof!): $A$ has CM defined over a number field $K$ if and only if $G_\ell(A)$ is a torus.
\end{remark}
While we're here, we remark on another property of $G_\ell(A)$ due to Faltings.
\begin{theorem}[Faltings] \label{thm:monodromy-reductive}
	Fix an abelian variety $A$ over a number field $K$, and suppose $\ell$ is a prime. Then $G_\ell(A)$ is reductive.
\end{theorem}
\begin{proof}
	By \cite[Corollary~19.18]{milne-alg-groups}, it is enough to find a faithful semisimple representation of $G_\ell(A)$. As in \Cref{lem:mt-hg-reductive}, we see that the inclusion
	\[G_\ell(A)\subseteq\op{GL}\left(\mathrm H^1_{\mathrm{\acute et}}(A_{\ov K},\QQ_\ell)\right)\]
	is semisimple by \cite[Theorem~3]{faltings-mordell}, so we are done.
\end{proof}
\begin{remark} \label{rem:frob-semisimple}
	Over finite fields, Tate \cite{tate-endomorphisms} has proven that the Galois representation $\mathrm H^1_{\mathrm{\acute et}}(A_{\ov{\FF_q}},\QQ_\ell)$ is semisimple. Because the Galois group is (topologically) generated by the Frobenius, this amounts to checking that the endomorphism $\op{Frob}_q$ has semisimple action.
\end{remark}
To finish up our discussion of computational tools for $G_\ell(A)$, we repeat the results \Cref{lem:product-of-hg,lem:hg-isotypic} for our new context. Their proofs are exactly the same, replacing $\mathbb U$ (or $\mathbb S$) with $\op{Gal}(\ov F/F)$ and then making the same minimality arguments for our monodromy groups.
\begin{lemma} \label{lem:product-of-monodromy}
	Fix abelian varieties $A_1,\ldots,A_k$ over a field $F$.
	\begin{listalph}
		\item The subgroup
		\[G_\ell(A_1\times\cdots\times A_k)\subseteq\op{GL}(\mathrm H^1_{\mathrm{\acute et}}((A_1\times\cdots\times A_k)_{F^{\mathrm{sep}}},\QQ_\ell))\]
		is contained in $G_\ell(A_1)\times\cdots\times G_\ell(A_k)$.
		\item For each $i$, the projection map $\op{pr}_i\colon G_\ell(A_1\times\cdots\times A_k)\to G_\ell(A_i)$ is surjective.
	\end{listalph}
\end{lemma}
\begin{lemma} \label{lem:monodromy-isotypic}
	Fix abelian varieties $A_1,\ldots,A_k$ over a field $F$, and let $m_1,\ldots,m_k\ge1$ be positive integers. Then the diagonal embeddings $\Delta_i\colon\op{GL}\left(\mathrm H^1_{\mathrm{\acute et}}(A_{i,F^{\mathrm{sep}}},\QQ_\ell)\right)\to\op{GL}\left(\mathrm H^1_{\mathrm{\acute et}}(A_{i,F^{\mathrm{sep}}}^{m_i},\QQ_\ell)\right)$ induce an isomorphism
	\[G_\ell(A_1\times\cdots\times A_k)\to G_\ell\left(A_1^{m_1}\times\cdots\times A_k^{m_k}\right).\]
\end{lemma}
% main theorem of cm?

\subsection{The Mumford--Tate Conjecture}
Over the next two subsections, we will explain some tools used to compute $G_\ell(A)$. In this subsection, we will discuss $G_\ell(A)^\circ$. Suppose that $A$ is defined a number field $K$.

A motivic perspective would have us hope that all the monodromy groups attached to $A$ are essentially the same. However, as explained in \Cref{rem:k-conn-a}, we only expect $G_\ell(A)$ to be connected after an extension $K$. Thus, for example, one can only hope that $\op{MT}(A)$ knows about $G_\ell(A)^\circ$. We may now state the following conjecture.
\begin{conj}[Mumford--Tate] \label{conj:mt}
	Fix an abelian variety $A$ over a number field $K$. For all primes $\ell$, we have
	\[\op{MT}(A)_{\QQ_\ell}=G_\ell(A)^\circ\]
	as subgroups of $\op{GL}\left(\mathrm H^1_{\mathrm{\acute et}}(A,\QQ_\ell)\right)$. Here, $\op{MT}(A)$ is embedded into this group by the Betti-to-\'etale comparison isomorphism.
\end{conj}
Our work in \cref{chap:hodge} provides many tools for computing $\op{MT}(A)$, so \Cref{conj:mt} would allow us to translate this knowledge into a computation of $G_\ell(A)^\circ$.

Even though \Cref{conj:mt} is not fully proven, there is a lot known. Let's review a small amount. For example, both groups are reductive by \Cref{lem:mt-hg-reductive} and \Cref{thm:monodromy-reductive}. Additionally, \Cref{thm:faltings} provides a suitable analogue of \Cref{thm:riemann}, telling us that both groups $\op{MT}(A)$ and $G_\ell(A)$ cut out endomorphisms in $\op{End}(A)$.

As a philosophical check, one can show that $G_\ell(A)^\circ$ ``contains'' the Hodge structure morphism; the following result is due to Sen \cite[Theorem~1]{sen-operator}.
\begin{theorem}[Sen] \label{thm:sen-operator}
	Fix an abelian variety $A$ over a number field $K$. Define the operator $\Phi$ as acting by mutltiplication-by-$i$ on each eigenspace
	\[\mathrm H^1_{\mathrm{\acute et}}(A_{\ov K},\QQ_\ell)_{\CC_\ell}(i),\]
	where the $(i)$th eigenspace acts by $i$th power of the cyclotomic character. Then $\op{Lie}G_\ell(A)^\circ$ is the smallest Lie algebra containing $\Phi$.
\end{theorem}
Continuing, one inclusion of \Cref{conj:mt} is known, due to Deligne \cite[Corollary~6.2]{deligne-hodge}.
\begin{theorem}[Deligne]
	Fix an abelian variety $A$ over a number field $K$. For all primes $\ell$, we have
	\[G_\ell(A)^\circ\subseteq\op{MT}(A)_{\QQ_\ell}.\]
\end{theorem}
In particular, it becomes enough to compare numerical invariants of the two groups (such as rank) to argue for an equality. For example, the following independence result is due to Larsen and Pink \cite[Theorem~4.3]{larsen-pink-l-independence}.
\begin{theorem}[Larsen--Pink] \label{thm:lp-mtc-independence}
	Fix an abelian variety $A$ over a number field $K$. If $\op{MT}(A)_{\QQ_\ell}=G_\ell(A)^\circ$ holds for any prime $\ell$, then it holds for all primes $\ell$.
\end{theorem}
One even knows that the centers of the groups coincide, due to Vaisu \cite[Theorem~1.3.1]{vaisu-mt-conjecture}.
\begin{theorem}[Vaisu] \label{thm:mtc-torus}
	Fix an abelian variety $A$ over a number field $K$. For each prime $\ell$, we have
	\[Z(\op{MT}(A))^\circ_{\QQ_\ell}=Z(G_\ell(A))^\circ.\]
\end{theorem}
Vaisu \cite{vaisu-mt-conjecture} has in fact shown quite a bit about the Mumford--Tate conjecture; see in particular \cite[Theorem~1.3.4]{vaisu-mt-conjecture}.

Much is known about products, especially products with restricted endomorphism types. For example, \Cref{thm:mtc-torus} immediately implies the Mumford--Tate conjecture for abelian varieties with complex multiplication by combiing with \Cref{prop:cm-is-mt-torus} and \Cref{rem:cm-is-l-adic-torus}.
\begin{remark} \label{rem:mtc-cm}
	In fact, the Mumford--Tate conjecture for abelian varieties with complex multiplication is much older: it is originally due to Pohlmann \cite[Theorem~4]{pohlmann-mumford-tate-cm}, but Ribet in \cite{ribet-review-of-l-adic} has pointed out that the result is a corollary of results due to Shimura and Tanimaya \cite{shimura-taniyama-cm}, and \cite{yu-mumford-tate-cm} has recently explicated this argument.\todo{Include proof if include CM theorem}
\end{remark}
Continuing, by combining \cite{ichikawa-alg-groups-av,lombardo-ell-adic-product}, one is able to compute both $\op{MT}(A)$ and $G_\ell(A)^\circ$ for many abelian varieties of Types I--III and control contributions coming from Type IV; this permits a proof of the Mumford--Tate conjecture for products of abelian varieties of dimension at most $3$. More generally, the following result is due to Commelin \cite[Theorem~1.2]{commelin-mtc-products}.
\begin{theorem}[Commelin]
	Fix abelian varieties $A$ and $B$ over a number field $K$. If the Mumford--Tate conjecture holds for both $A$ and $B$, then it holds for $A\times B$.
\end{theorem}
To give a taste for how some of these results are proven, we show the following, which follows from \cite[Theorem~1.3.4]{vaisu-mt-conjecture}.
\begin{proposition} \label{prop:mtc-reldim-2}
	Fix a geometrically simple abelian variety $A$ over a number field $K$. Suppose that $F=Z(\op{End}_{\ov K}(A)$ equals a CM field such that $\dim A=\dim F$. Letting $\Phi$ be the corresponding signature, we further suppose that $\Phi(\sigma)=1$ for exactly two $\sigma\in\Sigma_F$. Then we claim the Mumford--Tate conjecture holds for $A$, and
	\[\op{Hg}(A)^{\mathrm{der}}=\op L(A)^{\mathrm{der}}.\]
\end{proposition}
\begin{proof}
	For special $\ell$, we will actually compute $\op{MT}(A)^{\mathrm{der}}$ and $G_\ell(A)^{\circ,\mathrm{der}}$ ``simultaneously'' to show that they are equal to the suitable version of $\op{GSp}_F(\varphi)^{\mathrm{der}}$ or $\op{GSp}_F(e_\varphi)^{\mathrm{der}}$. By adding in what we know about the centers from \Cref{thm:mtc-torus} (and the independence of $\ell$ given in \Cref{thm:lp-mtc-independence}), the Mumford--Tate conjecture follows for $A$. The outline is to base-change to $\CC$, where the Lie algebra of $\op L(A)^{\mathrm{der}}$ becomes a product of $\mf{sl}_2(\CC)$s, from which we can appeal to \Cref{lem:mz-product}.

	Before beginning the computation, we set up some notation. In practice, it will be convenient to only write down the computation for $\op{MT}(A)^{\mathrm{der}}$, but we will indicate along the way the changes that need to be made for $G_\ell(A)^{\circ,\mathrm{der}}$. Now, for brevity, set $V\coloneqq\mathrm H^1_{\mathrm B}(A,\QQ)$ so that $\op{Hg}(A)=\op{Hg}(V)$ and $\op L(A)=\op L(V)$; we remark that $V$ is a free module over $F$ of rank $2$.

	Continuing with the set-up, we recall some part of the computation from \Cref{lem:lefschetz-type-iv-1}. Fix a polarization $\varphi$ on $V$. Then let $\rho_{1},\ldots,\rho_{e_0}$ be the embeddings of $F_i^\dagger$ into a Galois closure $E^\dagger$, which is the totally real subfield of the Galois closure $E$ of $F$. Then we admit a decomposition
	\[V_{E^\dagger}=V_1\oplus\cdots\oplus V_{e_0}\]
	so that
	\[\op L(V)_{E^\dagger}=\op{Sp}_{F\otimes_{\rho_{1}}E^\dagger}(\varphi|_{V_{1}})\times\cdots\times\op{Sp}_{F\otimes_{\rho_{e_{0}}}E^\dagger}(\varphi|_{V_{e_{0}}}).\]
	% Thus, \Cref{lem:lefschetz-sums} allows us to expand
	% \[\op L(V)_{E^\dagger}=op{Sp}_{F_i\otimes_{\rho_{i1}}E^\dagger}(\varphi|_{V_{1}})\times\cdots\times\op{Sp}_{F_i\otimes_{\rho_{ie_{0i}}}E^\dagger}(\varphi|_{V_{ie_{0i}}}).\]
	We now also recall from \Cref{lem:lefschetz-type-iv-1} that each $\op{Sp}_{F\otimes_{\rho_{i}}E^\dagger}(\varphi|_{V_{i}})_E$ is isomorphic to $\op{GL}_2(E)$; in particular, this group is connected. In particular, to achieve this decomposition, we diagonalize the induced action of $E$ on $V_i$ and then projects onto one of the eigenspaces.

	Now, we would like to show that the inclusion
	\[\op{Hg}(V)_E^{\mathrm{der}}\subseteq\op{Sp}_{F\otimes_{\rho_{1}}E^\dagger}(\varphi|_{V_{1}})_E\times\cdots\times\op{Sp}_{F\otimes_{\rho_{e_{0}}}E^\dagger}(\varphi|_{V_{e_{0}}})_E\]
	is an isomorphism, where the last group is embedded in $\op{GL}(V)_E$. All groups involved are connected, so we may check this inclusion on the level of the Lie algebra, so we would like for the inclusion
	\[\op{Lie}\op{Hg}(V)_E^{\mathrm{der}}\subseteq\op{Sp}_{F\otimes_{\rho_{1}}E^\dagger}(\varphi|_{V_{1}})_E\times\cdots\times\op{Sp}_{F\otimes_{\rho_{e_{0}}}E^\dagger}(\varphi|_{V_{e_{0}}})_E\]
	is surjective. For this, we use \Cref{lem:mz-product}. Here are our checks; for brevity, set $\mf{hg}(V)\coloneqq\op{Lie}\op{Hg}(V)_E$, and let $\mf{sl}_2(E)_{i}$ be the factor $\op{Lie}\op{Sp}_{F\otimes_{\rho_{i}}E^\dagger}(\varphi|_{V_{i}})_E^{\mathrm{der}}$, which we note is isomorphic to $\mf{sl}_2(E)$.
	\begin{listroman}
		\item We claim that $\mf{hg}(V)^{\mathrm{der}}$ surjects onto $\mf{sl}_2(E)_{i}$, which we note is nonzero and simple. Because the $\mf{hg}(V)$ is semisimple, its image in $\mf{sl}_2(E)_{i}$ continues to be reductive.
		
		Now, reductive subgroups of $\mf{sl}_2(E)$ are either tori of all of $\mf{sl}_2(E)$, so we merely need to check that the image cannot be a torus. If the image in some $\mf{sl}_2(E)_{i}$ is a torus, then because the Galois action $\op{Gal}(E/\QQ)$ permutes the decomposition of $V$ into $\{V_{i}\}_i$ (but will fix $\op{Hg}(V)$), so we see that the image in $\mf{sl}_2(E)_{i}$ will continue to be a torus for all $i$. Explicitly, we note that the image of $\op{Hg}(V)$ in $\op{Sp}_{F\otimes_{\rho_{i}}E^\dagger}(\varphi|_{V_{i}})_E$ needs to be preserved under $\op{Gal}(E/\QQ)$, so if the projection is commutative in one factor, then it is commutative in all factors because the $\QQ$-points are dense. %\todo{There is no Galois action. This doesn't make sense.}
		% But then we note that $\op{Hg}(V)$ projects onto $\op{Hg}(V_i)$ by \Cref{lem:product-of-hg}, which then has an inclusion into $\op L(V_i)_E=\prod_j\op{Sp}_{F_i\otimes_{\rho_{ij}}E^\dagger}(\varphi|_{V_{ij}})_E$, where we see it must have commutative image by the preceding paragraph.
		In particular, $\op{Hg}(V)$ must be a torus, so $A$ has complex multiplication by \Cref{prop:cm-is-mt-torus}, which is a contradiction to its definition.

		\item The first point of (ii) is automatic from the construction. The second point follows because all the $\mf{sl}_2(E)_{i}$s include as the standard representation into $\mf{gl}(V_{i})$.
		
		For the last point, we use the Galois action together with the hypothesis on the signature. Arguing as in the proof of \Cref{lem:mz-product}, it is really enough to check the $(V_i)_E$s are non-isomorphic as $\mf{hg}(V)^{\mathrm{der}}_E$-modules. To make sense of the signature, we choose an embedding $\varepsilon\colon E\to\CC$, and then \Cref{lem:hodge-to-signature} grants a signature $\Phi_\varepsilon$ from the decomposition of $V_\varepsilon$ into $F\otimes_\varepsilon\CC$-eigenspaces: explicitly, for each embedding $\sigma\in\op{Hom}(F,E)$, we find
		\[\Phi_\varepsilon(\sigma)=\dim (V_\sigma)_\varepsilon^{1,0},\]
		where $(\cdot)^{1,0}$ signifies that we are taking the eigenspace where $i\in\CC$ acts by $i^{-1}$. However, the choice of a different embedding $\varepsilon$ will permute the $V_\sigma$s in sight.

		To explain how the signature is now used, we note that if $\{\Phi_\varepsilon(\sigma),\Phi_\varepsilon(\ov\sigma)\}\ne\{\Phi_\varepsilon(\tau),\Phi_\varepsilon(\ov\tau)\}$ for two embeddings $\sigma,\tau\in\op{Hom}(F,E)$ where $\rho_i=\sigma|_{F^\dagger}$ and $\rho_j=\tau|_{F^\dagger}$, then we must have $V_i\not\cong V_j$ as $\mf{hg}(V)^{\mathrm{der}}_\varepsilon$-modules. Indeed, unwrapping the definition of the signature, we know that the projection of $\mf{hg}(V)_\RR$ (where the embedding $E^\dagger\into\RR$ is given by the restriction of $\varepsilon$) into $\mf{gl}_4(\RR)$ is
		\[\mf{so}(\Phi_\varepsilon(\sigma),\Phi_\varepsilon(\ov\sigma)).\]
		To see this, note that this a semisimple algebra of the correct rank, so it is enough remark that the image of $\mf{hg}(V)^{\mathrm{der}}$ must land in the above Lie subalgebra by tracking the action of $h(i)$. (One should use \Cref{thm:sen-operator} in the $\ell$-adic computation.) Thus, we are now able to remark that $\mf{so}(\Phi_\varepsilon(\sigma),\Phi_\varepsilon(\ov\sigma))\not\cong\mf{so}(\Phi_\varepsilon(\tau),\Phi_\varepsilon(\ov\tau))$.

		To complete the proof, we note that there exists exactly one pair $\{\sigma_0,\ov\sigma_0\}$ of embeddings $F\into\CC$ such that $\Phi_\varepsilon(\sigma_0)=\Phi_\varepsilon(\ov\sigma_0)=1$. Thus, for any two distinct embeddings $\sigma,\tau\in\op{Hom}(F,E)$, we can choose $\varepsilon$ so that $\varepsilon\sigma=\sigma_0$ but $\varepsilon\tau\ne\sigma_0$ and apply the previous paragraph.
		\qedhere
	\end{listroman}
	% Similarly, we write $V_i\coloneqq\mathrm H^1_{\mathrm B}(A_i,\QQ)$ for each $i$. Recall that $\op{Hg}(V)\subseteq\op{L}(V)$ by \Cref{lem:mt-commutes-polarization} (the $\ell$-adic case uses \Cref{lem:l-adic-monodromy-commutes-polarization}). Thus, to achieve the equality of the derived subgroups, it is enough to achieve the equality after base-changing to an algebraic closure.
	% \begin{enumerate}
	% 	\item We would like 
	% \end{enumerate}
	%
	% In practice, it will be convenient to only write down the computation for $\op{MT}(A)^{\mathrm{der}}$, but we will indicate along the way the changes that need to be made for $G_\ell(A)^{\circ,\mathrm{der}}$. Quickly, we note that we may assume that the $A_\bullet$s are pairwise non-isomorphic because all groups involved are immune to adding a factor which already appears (see \Cref{lem:hg-isotypic} for $\op{MT}$, \Cref{lem:lefschetz-sums} for $\op L$, and \Cref{lem:monodromy-isotypic} for $G_\ell$).
	%
	% Now, for brevity, set $V\coloneqq\mathrm H^1_{\mathrm B}(A,\QQ)$ so that $\op{MT}(A)=\op{MT}(V)$ and $\op L(A)=\op L(V)$; we remark that $V$ is a free module over $F\coloneqq F_1\times\cdots\times F_k$ of rank $2$. Similarly, we set $V_i\coloneqq\mathrm H^1_{\mathrm B}(A_i,\QQ)$. Recall that $\op{MT}(V)\subseteq\op{L}(V)$ by \Cref{lem:mt-commutes-polarization} (the $\ell$-adic case uses \Cref{lem:l-adic-monodromy-commutes-polarization}). Thus, to achieve the equality of the derived subgroups, it is enough to achieve the equality after base-changing to an algebraic closure.
\end{proof}
\begin{remark}
	This argument is inspired by \cite[Remark~1.9.4]{zarhin-hg-k3}, where ``changing the embedding'' is used similarly to conclude that the Hodge group is large.
\end{remark}
% proof of MT for CM?
% proof of MT for type iv rel dim 2 (cite equality of centers)

\subsection{Computing \texorpdfstring{$\ell$}{l}-Adic Monodromy} \label{subsec:compute-gl-from-gl0}
The previous subsection explains that one expects to be able to compute $G_\ell(A)^\circ=\op{MT}(A)$. We now explain how to use a computation of $G_\ell(A)^\circ$ to compute $G_\ell(A)$ in full. The idea is to use the Galois action on Tate classes. Our exposition follows \cite[Sections~8.1--8.2]{ggl-fermat}. We begin with some notation.
\begin{notation} \label{not:tate-classes}
	Fix an abelian variety $A$ defined over a field $K$, and let $\ell$ be a prime such that $\op{char}K\nmid\ell$. We will write $V\coloneqq\mathrm H^1_{\acute et}(A_{\ov K},\QQ_\ell)$. For each $n\ge0$, we define $W_n$ to be the spce of Tate classes in the $n$th tensor power, writing
	\[W_n\coloneqq\left(V^{\otimes n}\otimes V^{\lor\otimes n}\right)^{G_\ell(A)^\circ}.\]
	% For any subset $S$ of nonnegative integers, we write $W_S\coloneqq\bigoplus_{n\in S}W_n$.
	We also write $W\coloneqq\bigoplus_{n\ge0}W_n$ for brevity.
\end{notation}
\begin{remark}
	Because $A$ is an abelian variety, one has a polarization $V\otimes V\to\QQ_\ell(1)$, so we see that one can replace $W_n$ with
	\[\left(V^{\otimes 2n}(n)\right)^{G_\ell(A)^\circ}.\]
\end{remark}
Roughly speaking, the point is that the spaces $W_\bullet$ of Tate classes are able to keep track of $G_\ell(A)^\circ$.
\begin{lemma} \label{lem:monodromy-fixes-tate-classes}
	Fix an abelian variety $A$ defined over a field $K$, and let $\ell$ be a prime such that $\op{char}K\nmid\ell$, and define $V$ and $W_\bullet$ as in \Cref{not:tate-classes}.
	\begin{listalph}
		\item If $G\subseteq\op{GL}\left(\mathrm H^1_{\mathrm{\acute et}}(A_{\ov K},\QQ_\ell)\right)$ fixes $W$, then $G\subseteq G_\ell(A)^\circ$.
		\item There is a finite-dimensional subspace $W'\subseteq W$ such that $G\subseteq\op{GL}\left(\mathrm H^1_{\mathrm{\acute et}}(A_{\ov K},\QQ_\ell)\right)$ fixes $W'$ if and only if $G\subseteq G_\ell(A)^\circ$.
	\end{listalph}
\end{lemma}
\begin{proof}
	This essentially follows from \Cref{prop:reductive-group-by-invariants}.
	\begin{listalph}
		\item Recall $G_\ell(A)^\circ$ is reductive by \Cref{thm:monodromy-reductive}. Thus, by \Cref{prop:reductive-group-by-invariants}, we know that if $G\subseteq\op{GL}(V)$ fixes every $G_\ell(A)^\circ$-invariant in any
		\[\bigoplus_{i=1}^k\left(V^{\otimes m_i}\otimes V^{\lor\otimes n_i}\right),\]
		then $G\subseteq G_\ell(A)^\circ$. However, we claim that all $G_\ell(A)^\circ$-invariants in the above space can be found in $W$, which will complete the proof. Indeed, by \Cref{thm:mtc-torus}, we see that the scalars $\mathbb G_{m,\QQ_\ell}$ can be found in $G_\ell(A)^\circ$; however, these scalars act by the character $z\mapsto z^{m_i-n_i}$ on $V^{\otimes m_i}\otimes V^{\lor\otimes n_i}$, so any $G_\ell(A)^\circ$-invariant subspace must then have $m_i=n_i$.
		\item The above argument provides countably many equations (in the form of invariant tensors) which cut out $G_\ell(A)^\circ$. However, any algebraic subgroup of $\op{GL}(V)$ will be cut out by finitely many equations, so we can choose $W'$ to be the span of any such subset of finitely many defining equations.
		\qedhere
	\end{listalph}
\end{proof}
\begin{remark}
	The proof of (b) in fact gives an effective way to compute the subspace $W'$: simply write down enough tensor elements to cut out $G_\ell(A)^\circ\subseteq\op{GL}\left(V\right)$.
\end{remark}
We would now like to upgrade from $G_\ell(A)^\circ$ to $G_\ell(A)$.
\begin{lemma} \label{lem:monodromy-preserves-tate-classes}
	Fix an abelian variety $A$ defined over a field $K$, and let $\ell$ be a prime such that $\op{char}K\nmid\ell$, and define $V$ and $W_\bullet$ as in \Cref{not:tate-classes}. For each $n\ge0$, the subspace $W_n$ is stabilized by $G_\ell(A)$.
\end{lemma}
\begin{proof}
	We already know that $G_\ell(A)^\circ$ acts trivially on $W_n$, so this will follow purely formally from the fact that $G_\ell(A)^\circ$ is a normal subgroup of $G_\ell(A)$.
	% As usual, set $V\coloneqq\mathrm H^1_{\mathrm{\acute et}}(A_{\ov K},\QQ_\ell)$ for brevity.

	We would like to show that each $g\in G_\ell(A)$ stabilizes $W_n$. Well, $W_n$ exactly consists of the $G_\ell(A)^\circ$-invariants inside $V^{\otimes n}\otimes V^{\lor\otimes n}$, so it suffices to show that $gW_n$ is stabilized by $G_\ell(A)^\circ$. Well, for any $g_0\in G_\ell(A)^\circ$, we see that
	\[g_0gW_n=g\cdot g^{-1}g_0gW_n,\]
	so we conclude by noting that $g^{-1}g_0g\in G_\ell(A)^\circ$ because $G_\ell(A)^\circ\subseteq G_\ell(A)$ is a normal subgroup.
\end{proof}
Combining the above two lemmas, we see that we get a faithful representation
\[G_\ell(A)/G_\ell(A)^\circ\to\op{GL}(W).\]
This faithful representation allows us to compute $G_\ell(A)$: we are looking for elements of $\op{GL}\left(\mathrm H^1_{\mathrm{\acute et}}(A_{\ov K},\QQ_\ell)\right)$ which produce the automorphisms of $W$ seen in the image of the above faithful representation. Tracking through this sort of reasoning produces our main result.
\begin{proposition} \label{prop:galois-computes-monodromy}
	Fix an abelian variety $A$ defined over a field $K$, and let $\ell$ be a prime such that $\op{char}K\nmid\ell$, and define $V$ and $W_\bullet$ as in \Cref{not:tate-classes}.
	% Choose a subspace $W'$ of $W$ such that $W'$ is stable under the action of $G_\ell(A)$, but the induced representation of $G_\ell(A)/G_\ell(A)^\circ$ is faithful.
	Then $G_\ell(A)$ equals the group
	\[\bigcup_{\sigma\in\op{Gal}(\ov K/K)}\left\{g\in\op{GL}\left(V\right):g|_W=\sigma|_W\right\}.\]
	In fact, each set in the union is a connected component of $G_\ell(A)$.
\end{proposition}
\begin{proof}
	We begin by noting that $\op{Gal}(\ov K/K)$ does in fact preserve $W$: indeed, one has a composite
	\[\op{Gal}(\ov K/K)\to G_\ell(A)\to\op{GL}(W),\]
	where the first map is well-defined by the definition of $G_\ell(A)$, and the second map is well-defined by summing \Cref{lem:monodromy-preserves-tate-classes}.

	Now, we have two inclusions to show.
	% As usual, set $V\coloneqq\op{GL}\left(\mathrm H^1_{\mathrm{\acute et}}(A_{\ov K},\QQ_\ell)\right)$.
	\begin{itemize}
		\item Suppose $g\in G_\ell(A)$. Then we must find $\sigma\in\op{Gal}(\ov\QQ/\QQ)$ such that $g|_W=\sigma|_W$. Well, $G_\ell(A)$ is by definition the Zariski closure of the image of $\op{Gal}(\ov K/K)$ in $\op{GL}(V)$, so the open subset $gG_\ell(A)^\circ$ of $G_\ell(A)$ must contain $\sigma|_V$ for some $\sigma\in\op{Gal}(\ov K/K)$. Now, $G_\ell(A)^\circ$ acts trivially on $W$, so we see that $g|_W=\sigma|_W$.
		\item Suppose $g\in\op{GL}(V)$ satisfies $g|_W=\sigma|_W$. Then we would like to show that $g\in G_\ell(A)$. The argument in the previous point grants $g_0\in G_\ell(A)$ such that $g_0|_V=\sigma|_V$, so in particular, $g|_W=g_0|_W$. Thus, $gg_0^{-1}$ acts trivially on $W$, so $gg_0^{-1}\in G_\ell(A)^\circ$, so it follows that $g\in G_\ell(A)$.
	\end{itemize}
	Lastly, it remains to discuss connected components. Well, note that $g,g'\in G_\ell(A)$ live in the same connected component if and only if $g'g^{-1}\in G_\ell(A)$, which is equivalent to $g'g^{-1}$ acting trivially on $W$, which is equivalent to $gG_\ell(A)^\circ=g'G_\ell(A)^\circ$.
\end{proof}
\begin{remark} \label{rem:galois-computes-monodromy-finite}
	A careful reading of the above proof shows that we only needed the following facts about $W$: it is stable under $G_\ell(A)$, and $g\in\op{GL}\left(V\right)$ lives in $G_\ell(A)^\circ$ if and only if it fixes $W$. Thus, we see that we can replace $W$ with any $G_\ell(A)$-subrepresentation $W'\subseteq W$ which cuts out $G_\ell(A)^\circ$ in the sense of \Cref{lem:monodromy-preserves-tate-classes}. This allows us to make $W'$ quite small (e.g., finite-dimensional).
\end{remark}
\begin{remark}
	It is worth comparing \Cref{prop:galois-computes-monodromy} with the twisted Lefschetz group, defined in \cite[Definition~5.2]{bk-algebraic-st}. Roughly speaking, the twisted Lefschetz group is simply the construction of \Cref{prop:galois-computes-monodromy} with $W$ replaced by the subspace of $W$ generated by endomorphisms and the polarization; see \cite[Remark~8.3.5]{ggl-fermat} for precise discussion of the relation. In this way, one expects the twisted Lefschetz group to equal $G_\ell(A)$ in generic cases, but \Cref{rem:galois-computes-monodromy-finite} explains that one may need to remember more Hodge classes in exceptional cases.
\end{remark}
\Cref{prop:galois-computes-monodromy} suggests that one can find representatives of each connected component in $G_\ell(A)$ by looping over all $\sigma\in\op{Gal}(\ov K/K)$ and finding some $g\in\op{GL}(V)$ such that $g|_W=\sigma|_W$. This is currently not so computable because $\op{Gal}(\ov K/K)$ is an infinite group, and $W$ is an infinite-dimensional vector space. \Cref{rem:galois-computes-monodromy-finite} explains how to replace $W$ with a finite-dimensional subrepresentation, so it remains to explain how to reduce $\op{Gal}(\ov K/K)$ to a finite quotient.
\begin{definition}[connected monodromy field]
	Fix an abelian variety $A$ defined over a field $K$, and let $\ell$ be a prime such that $\op{char}K\nmid\ell$. Then we define the \textit{connected monodromy field} $K_A^{\mathrm{conn}}$ so that the open subgroup $\op{Gal}(\ov K/K_A^{\mathrm{conn}})$ is the pre-image of the connected component $G_\ell(A)^\circ$ in the Galois representation
	\[\op{Gal}(\ov K/K)\to\op{GL}\left(\mathrm H^1_{\mathrm{\acute et}}(A_{\ov K},\QQ_\ell)\right).\]
\end{definition}
\begin{remark}
	Note that such a field $K_A^{\mathrm{conn}}$ exists and is finite over $K$ by Galois theory: note $G_\ell(A)^\circ\subseteq G_\ell(A)$ is a finite-index subgroup (because the quotient is a discrete algebraic group), so the pre-image $U\subseteq\op{Gal}(\ov K/K)$ of $G_\ell(A)^\circ$ similarly must be open and finite index and hence closed and finite index.
\end{remark}
Thus, we see that the Galois reprentation to $\op{GL}(W)$ factors through the finite group $\op{Gal}(K_A^{\mathrm{conn}}/K)$. In this way, we are able to reduce the computation suggested by \Cref{prop:galois-computes-monodromy} from the infinite group $\op{Gal}(\ov K/K)$ to the finite quotient $\op{Gal}(K_A^{\mathrm{conn}}/K)$.
\begin{remark}
	Let's describe how one might compute $K_A^{\mathrm{conn}}$ in practice. BY combining the definition of $K_A^{\mathrm{conn}}$ with \Cref{lem:monodromy-fixes-tate-classes}, we see that $\op{Gal}(\ov K/K_A^{\mathrm{conn}})$ is the kernel of the representation
	\[\op{Gal}(\ov K/K)\to\op{GL}(W),\]
	so one could imagine computing the open subgroup $\op{Gal}(\ov K/K_A^{\mathrm{conn}})$ by computing the above representation. As usual, we remark that \Cref{lem:monodromy-fixes-tate-classes} allows us to replace $W$ with a finite-dimensional subrepresentation $W'$ ``cutting out'' $G_\ell(A)^\circ$.
\end{remark}
% spaces of tate classes
% S8.2 of GGL

\section{The Sato--Tate Conjecture}
Now that we have a good handle on monodromy groups, we describe one of their applications: the Sato--Tate conjecture. These notions are not central for the results we want to prove, so we will be somewhat sketchy throughout.

\subsection{The Weil Conjectures}
Roughly speaking, the Sato--Tate conjecture is about counting points on an abelian variety $A$ over finite fields $\FF_q$ as $q$ varies. In this subsection, we will briefly describe the Weil conjectures because they explain why these point-counts ought to be related to cohomology; these conjectures are now theorems due to Deligne \cite{deligne-weil-1,deligne-weil-2}.
\begin{theorem}[Weil conjectures] \label{thm:weil-conj}
	Fix a smooth projective variety $X$ over a finite field $\FF_q$ of dimension $n$. Consider the formal power series.
	\[\zeta_X(T)\coloneqq\exp\Bigg(\sum_{r=1}^\infty\#X\left(\FF_{q^r}\right)\frac{T^r}r\Bigg)\]
	\begin{listalph}
		\item Rationality: one can write
		\[\zeta_X(T)=\frac{P_1(T)\cdots P_{2n-1}(T)}{P_2(T)\cdots P_{2n}(T)}\]
		for polynomials $P_\bullet(T)\in 1+T\ZZ[T]$.
		\item Riemann hypothesis: the roots of the polynomial $P_\bullet(T)$ are complex numbers with roots of magnitude $q^{-\bullet/2}$.
		% \item Betti numbers: suppose $X$ is the reduction of a smooth projective variety $\mc X$ defined over a number ring $\OO_K$. Then $\deg P_\bullet=\dim_\CC\mathrm H_{\mathrm B}^\bullet(\mc X(\CC),\CC)$.
	\end{listalph}
\end{theorem}
It is worth explaining a bit of the proof of these conjectures for abelian varieties. Our exposition is an abbreviated form of the exposition in (say) \cite[Chapter~II]{milne-av}.

Fix an abelian variety $A$ of dimension $g$ over a finite field $\FF_q$. The main point is to find a way to compute $\#A(\FF_q)$, and then \Cref{thm:weil-conj} will follow. Viewing $A(\FF_q)$ is the set of fixed (geometric) points of the Frobenius endomorphism $\op{Frob}_q\colon A\to A$, one would like to use the Lefschetz fixed point formula to conclude. In particular, we should be able to read off the value of $\#A(\FF_q)$ from a suitably defined characteristic polynomial of $\mathrm{Frob}_{\mf p}$.

To be explicit, one finds that the characteristic polynomial $P(T)$ of $\mathrm{Frob}_{\mf p}$ acting on $\mathrm H^1_{\mathrm{\acute et}}(A_{\ov{\FF_q}},\QQ_\ell)$ satisfies
\[P(1)=\#A(\FF_q).\]
Thus, by factoring $P(T)=\prod_{i=1}^{2g}(T-\alpha_i)$, one finds that
\[\#A(\FF_{q^r})=\prod_{i=1}^{2g}\left(1-\alpha_i^r\right),\]
which proves the rationality conjecture of \Cref{thm:weil-conj} after some manipulation. In brief, one finds that $P(T)=P_1(T)$, and in general, the polynomial $P_i(T)$ has roots given by multiplying $i$ of the roots in the set $\{\alpha_1,\ldots,\alpha_{2g}\}$ together.
\begin{remark}
	Comparing the previous paragaph with the proof of the rationality conjecture from the Lefschetz trace formula
	\[\#A(\FF_q)=\sum_{i=0}^{2g}(-1)^i\tr\left(\mathrm{Frob}_q\mid\mathrm H^i_{\mathrm{\acute et}}(A_{\overline{\FF_q}},\QQ_\ell)\right),\]
	one sees that what allows us to recover all the polynomials $P_\bullet(T)$ from merely $P_1(T)$ is that the higher cohomology of $A$ is generated by the cohomology in degree $1$ by \Cref{prop:cohom-ring-av}.
\end{remark}
It remains to prove the Riemann hypothesis conjecture of \Cref{thm:weil-conj}. This amounts to checking that the roots of $P(T)$ have magnitude $1/\sqrt p$, which eventually corresponds to the following fact.
\begin{proposition} \label{prop:frob-multiplier}
	Fix an abelian variety $A$ over a finite field $\FF_q$, and consider the induced Frobenius endomorphism $\mathrm{Frob}_q$. Then
	\[\mathrm{Frob}_q\circ\mathrm{Frob}_q^\dagger=[q]_A.\]
\end{proposition}
\begin{proof}
	Proving this requires more tools than we would like to introduce at this time, so we refer to \cite[Lemma~III.1.2]{milne-av}.
\end{proof}

\subsection{The Sato--Tate Group}
In this section, we will define the Sato--Tate group and state the Sato--Tate conjecture. Our exposition loosely follows \cite{sutherland-sato-tate}. Fix an abelian variety $A$ defined over a number field $K$, and choose a prime $\ell$. We also let $\rho_\ell\colon\op{Gal}(\ov K/K)\to\op{GL}\left(\mathrm H^1_{\mathrm{\acute et}}(A_{\ov K},\QQ_\ell)\right)$ denote the associated Galois representation.

Intuitively, the Sato--Tate conjecture asserts that the Frobenius elements $\rho_\ell(\mathrm{Frob}_{\mf p})$ equidistribute in $G_\ell(A)$ as $\mf p$ varies over the maximal ideals of $\OO_K$. This conjecture does not make sense verbatim, so we will have to work a bit to write down something formal. Consider the following points.
\begin{itemize}
	\item To begin, we note that $\mathrm{Frob}_{\mf p}$ only makes sense as a conjugacy class, and it only makes sense as a conjugacy class when $\rho_\ell$ vanishes on the relevant inertia subgroup of $\op{Gal}(\ov K/K)$.
	
	Two remarks are thus in order. First, to vanish on the inertia subgroup, we must exclude a finite set of primes $\mf p$ where $A$ has bad reduction. (We are using the N\'eron--Ogg--Shafarevich criterion \cite[Theorem~5]{bosch-neron-models}.) Second, we will simply regard $\rho_\ell(\mathrm{Frob}_{\mf p})$ as a conjugacy class as well. Thus, we really want to say that conjugacy classes equidistribute in a suitable space of conjugacy classes.

	\item It turns out that $\rho_\ell(\mathrm{Frob}_{\mf p})$ is not a totally random element of $G_\ell(A)$. Indeed, by \Cref{prop:frob-multiplier}, we see that the multiplier of $\mathrm{Frob}_{\mf p}$ acting on $\mathrm H^1_{\mathrm{\acute et}}(A_{\ov K},\QQ_\ell)$ equals $\op N(\mf p)$. Thus, we would like to rescale $\mathrm{Frob}_{\mf p}$ back down by $1/\sqrt{\op N(\mf p)}$.
	
	Once again, this requires two remarks. First, after rescaling, we will be working in the smaller subgroup
	\[G_\ell^1(A)\coloneqq G_\ell(A)\cap\op{Sp}(e_\varphi),\]
	where $\varphi$ is a choice of polarization on $A$. Second, the rescaling cannot happen in $\QQ_\ell$ because $\QQ_\ell$ does not have enough square roots. As such, we must choose an embedding $\iota\colon\QQ_\ell\into\CC$, allowing us to consider the elements $\frac1{\sqrt{\op N(\mf p)}}\iota\rho_\ell(\mathrm{Frob}_{\mf p})$ in the complex Lie group $G_\ell^1(A)_\iota(\CC)$.\footnote{Another reason for passing to $\CC$ is that groups in $\CC$ have access to a good measure theory.}

	\item Another piece of structure to keep track of is that $\rho_\ell(\mathrm{Frob}_{\mf p})$ is semisimple, as discussed in \Cref{rem:frob-semisimple}. This means that the subgroup topological generated by $\frac1{\sqrt{\op N(\mf p)}}\iota\rho_\ell(\mathrm{Frob}_{\mf p})$ (which we now see has all eigenvalues equal to $1$ after the normalization in the previous step) will be compact! A standard result in the structure theory of complex Lie groups is that they have maximal compact subgroups unique up to conjugacy, so one can find an element in our conjugacy class $\frac1{\sqrt{\op N(\mf p)}}\iota\rho_\ell(\mathrm{Frob}_{\mf p})$ in any given maximal compact subgroup of $G_\ell^1(A)_\iota(\CC)$.
\end{itemize}
With the above preparations, we are now ready to state the Sato--Tate conjecture.
\begin{definition}[Sato--Tate group]
	Fix an abelian variety $A$ defined over a number field $K$, and choose a prime $\ell$ and an embedding $\iota\colon\QQ_\ell\into\CC$. Then we define the \textit{Sato--Tate group} $\op{ST}(A)$ to be a maximal compact subgroup of the complex Lie group $G_\ell^1(A)_\iota$, where $G_\ell^1(A)$ is the subset of $G_\ell(A)$ with multiplier equal to $1$.
\end{definition}
\begin{conj}[Sato--Tate] \label{conj:st}
	Fix an abelian variety $A$ defined over a number field $K$, and choose a prime $\ell$ and an embedding $\iota\colon\QQ_\ell\into\CC$. For each nonzero prime ideal $\mf p$ of $K$ such that $A$ has good reduction at $\mf p$, choose the conjugacy class $x_{\mf p}\in\op{Conj}(\op{ST}(A))$ containing the conjugacy class $\frac1{\sqrt{\op N(\mf p)}}\iota\rho_\ell(\mathrm{Frob}_{\mf p})$. Then the conjugacy classes $\{x_{\mf p}\}$ equidistribute with respect to the pushforward of the Haar measure along $\op{ST}(A)\to\op{Conj}(\op{ST}(A))$.
\end{conj}
The relevance of the Sato--Tate conjecture for us is that it will let us numerically check that we have the correct $\ell$-adic monodromy group; precisely how this is done will be explained in the subsequent subsections.

We will spend the rest of the present subsection making some remarks about \Cref{conj:st}.
\begin{remark}
	Not much is known about \Cref{conj:st}. Roughly speaking, all known proofs prove something akin to modularity for not just the Galois representation attached to $A$ but also its symmetric powers (and maybe more!).
	\begin{itemize}
		\item If $A$ has complex multiplication, then this essentially follows from the Fundamental theorem of complex multiplication.
		\item For elliptic curves, the state of the art is \cite{bgtt-potential-automorphy,bgdht-potential-automorphy-2}, where the Sato--Tate conjecture is proven for elliptic curves over totally real and CM fields.
		\item These potential automorphy techniques were extended to some classes of abelian varieties by Johansson in \cite[Theorem~1]{johansson-sato-tate}.
	\end{itemize}
\end{remark}
One obnoxious defect of \Cref{conj:st} is that we must make choices regarding $\ell$ and $\iota$. The choice $\iota$ is not so egregious because everything ought to descend to something algebraic, but it is quite unclear that $\op{ST}(A)$ and even $G_\ell^1(A)$ does not depend crucially on $\ell$. One expects $G_\ell(A)^\circ$ to not depend on $\ell$ by the Mumford--Tate conjecture (\Cref{conj:mt}). The relevant conjecture for the full group $G_\ell(A)$ is the Algebraic Sato--Tate conjecture \cite[Conjecture~2.1]{bk-algebraic-st}.
\begin{conj}[Algebraic Sato--Tate] \label{conj:ast}
	Fix an abelian variety $A$ defined over a number field $K$. Then there exists an algerbaic subgroup $\op{AST}(A)\subseteq\op{GL}_{2g}(\QQ)$ such that
	\[\op{AST}(A)_{\QQ_\ell}=G_\ell^1(A)\]
	for all primes $\ell$.
\end{conj}
This conjecture, being similar in spirit to the Mumford--Tate conjecture, has quite a bit known. For example, Banaszak and Kedlaya have shown this conjecture for products of abelian varieties of dimensions at most $3$ \cite[Theorem~6.11]{bk-algebraic-st}. Roughly speaking, their proof boils down to the fact that one has $\op{Hg}(A)=\op L(A)^\circ$ in these small dimensions, which permits a direct computation of $\op{AST}(A)$ along the lines of \Cref{prop:galois-computes-monodromy} (see \Cref{rem:galois-computes-monodromy-finite}).

Remarkably, Farf\'an and Commelin have shown that the Algebraic Sato--Tate conjecture implies the Mumford--Tate conjecture in \cite{farfan-commelin-mtc-astc}.
\begin{theorem}[Farf\'an--Commelin] \label{thm:mtc-implies-astc}
	Fix an abelian variety $A$ defined over a number field $K$. If $A$ satisfies the Mumford--Tate conjecture (\Cref{conj:mt}) that $G_\ell(A)^\circ=\op{MT}(A)$ for all primes $\ell$, then $A$ satisfies the Algebraic Sato--Tate conjecture (\Cref{conj:ast}) that there exists an algebraic group $\op{AST}(A)\subseteq\op{GL}_{2g}(\QQ)$ such that $\op{AST}(A)_{\QQ_\ell}=G_\ell^1(A)$ for all primes $\ell$.
\end{theorem}
\begin{proof}
	The proof requires a discussion of Tannakian formalism, so we will not include it. We remark that they actually prove that the Mumford--Tate conjecture is equivalent to a more refined version of the Algebraic Sato--Tate conjecture with $\op{AST}(A)$ equal to the ``motivic Galois group'' of $A$.\todo{Include proof if include abelian motives}
\end{proof}

% define the sato--tate group
% state the conjecture
% discuss some of what is known
% mtc implies astc?

\subsection{Some Examples}
In this subsection, we compute some basic Sato--Tate groups. The general outline is to compute the Hodge or Mumford--Tate groups first, check the Mumford--Tate conjecture to get $G_\ell^\circ$, and then compute some Galois action to get $G_\ell$. We begin with some elliptic curves.
\begin{example}[no complex multiplication] \label{ex:ec-no-cm-st}
	Consider the elliptic curve $E\colon y^2=x^3+x+1$ over $\QQ$. One can compute that $\op{End}_\CC(E)=\ZZ$, so $E$ does not have complex multiplication. Thus, $\op{Hg}(E)\subseteq\op{SL}_{2,\QQ}$ needs to be a connected reductive subgroup which is not a torus (see \Cref{prop:cm-is-mt-torus}); however, the only Lie subalgebras of $\mf{sl}_2(\CC)$ are either commutative or all of $\mf{sl}_2(\CC)$, so we conclude that $\op{Hg}(E)=\op{SL}_{2,\QQ}$. Thus, $\op{MT}(E)=\op{GL}_{2,\QQ}$.
	
	The same computation (with \Cref{rem:cm-is-l-adic-torus}) allows us to conclude that $G_\ell(E)=\op{GL}_{2,\QQ_\ell}$ for all primes $\ell$, thus proving the Mumford--Tate conjecture (\Cref{conj:mt}) in this case. We thus find $G_\ell^1(E)=\op{SL}_{2,\QQ_\ell}$, so upon choosing $\iota\colon\QQ_\ell\into\CC$, we see that $G_\ell^1(E)_\iota=\op{SL}_{2,\CC}$, so choosing a maximal compact subgroup finds $\op{ST}(E)=\op{SU}_2$.
\end{example}
\begin{example}[complex multiplication] \label{ex:cm-ec-st}
	Consider the elliptic curve $E\colon y^2=x^3+1$ over $\QQ(\zeta_3)$. Then we see that $\op{End}_\CC(E)=\ZZ[\zeta_3]$, where $\zeta_3$ acts by $(x,y)\mapsto(\zeta_3x,y)$, so $E$ has complex multiplication. Thus, $\op{Hg}(E)\subseteq\op{SL}_{2,\QQ(\zeta_3)}$ is a torus (by \Cref{prop:cm-is-mt-torus}), but it cannot be trivial (by \Cref{cor:mt-fixes-av-endos}), so we conclude that $\op{Hg}(E)$ is the diagonal torus of $\op{SL}_{2,\QQ(\zeta_3)}$.

	For primes $\ell$ which split completely in $\QQ(\zeta_3)$, the same computation (with \Cref{rem:cm-is-l-adic-torus} and \Cref{cor:l-adic-fixes-endos}) where $\ell$ splits completely in $\QQ_\ell$ reveals $G_\ell(E)=\mathbb G_{m,\QQ_\ell}^2$ equals the diagonal torus in $\op{GL}_{2,\QQ(\zeta_3)}$, proving the Mumford--Tate conjecture (\Cref{conj:mt}) in this case. We thus find $G_\ell^1(E)\cong\mathbb G_{m,\QQ_\ell}$, so upon choosing $\iota\colon\QQ_\ell\into\CC$, we see that $G_\ell^1(E)\cong\mathbb G_{m,\QQ_\ell}$, so choosing a maximal compact subgroup finds $\op{ST}(E)\cong\op U_1$.
\end{example}
\begin{example}[potential complex multiplication] \label{ex:pot-cm-ec-st}
	Consider the elliptic curve $E\colon y^2=x^3+1$ but now over $\QQ$. \Cref{ex:cm-ec-st} computed that $\op{MT}(E)\cong\mathbb G_{m,\QQ}$ and $G_\ell(E)^\circ=\mathbb G_{m,\QQ_\ell}$ (for primes $\ell\equiv1\pmod3$). In this case, we see that there are endomorphisms not defined over $\QQ$ and hence not fixed by $\op{Gal}(\ov\QQ/\QQ)$, so $K_E^{\mathrm{conn}}\ne\QQ$; instead, these endomorphisms are defined over $K_E^{\mathrm{conn}}=\QQ(\zeta_3)$. We thus see that $G_\ell(E)\subseteq\op{GL}_{2,\QQ_\ell}$ normalizes its index-$2$ subgroup $G_\ell(E)^\circ$ (which is the diagonal torus), so $G_\ell(E)$ must be the diagonal torus together with the nontrivial Weyl element in $\op{GL}_{2,\QQ_\ell}$, which we write as $\mathbb G_{m,\QQ_\ell}^2\rtimes S_2$. We thus find $G_\ell^1(E)\cong\mathbb G_{m,\QQ_\ell}\rtimes S_2$, so $\op{ST}(E)\cong\mathrm U_1\rtimes S_2$.
\end{example}
\begin{remark}
	In the above example, we appealed to the fact that the only elements normalizing the diagonal torus are the Weyl elements, which is a bit ad-hoc and will not work in higher dimensions. Roughly speaking, \Cref{prop:galois-computes-monodromy} provides the machine which works in higher dimensions, where we know that the Galois representation now factors through $\op{Gal}(\QQ(\zeta_3)/\QQ)$, and we are allowed to replace $W$ with merely $W_1\oplus W_2$, which can be computed to be generated by the endomorphisms and polarization.
\end{remark}
We take a moment to remark that the above examples generalize to work with all elliptic curves, doing casework on having no complex multiplication, complex multiplication, and potential complex multiplication.

We now introduce the main example of the present thesis.
\begin{proposition} \label{prop:generic-fermat-st}
	Fix $\lambda\in\CC\setminus\{0,1\}$, and define $A$ to be the Jacobian of the normalization of the proper curve $C$ with affine chart $y^9=x(x-1)(x-\lambda)$. If $A$ does not have complex multiplication, then
	\[\begin{cases}
		\op{MT}(A)^{\mathrm{der}}_\CC\cong\op{SL}_2(\CC)^3 \\
		Z(\op{MT}(A))^\circ_\CC\cong\mathbb G_m^4.
	\end{cases}\]
	We use this to compute $\op{ST}(A_K)$ if $\lambda\in K$ and $K$ contains $K_A^{\mathrm{conn}}$.
\end{proposition}
\begin{proof}
	We proceed in steps.
	\begin{enumerate}
		\item To begin, we do some prelimarinary algebraic geometry, along the lines of \cite[Section~1]{moonen-special-cyclic-cover}. The curve $C$ comes equipped with a natural map $x\colon C\to\PP^1$, with Galois with cyclic Galois group $\mu_9$, where $\mu_9$ acts on $C$ by multiplication of the $y$-coordinate. As such, a computation with the Riemann--Hurwitz formula reveals that the genus is $g=7$, so $\dim A=7$. From here, we can find the differentials
		\[\left\{\frac{dx}{y^4},\frac{dx}{y^5},\frac{dx}{y^6},\frac{dx}{y^7},\frac{dx}{y^8},\frac{x\,dx}{y^7},\frac{x\,dx}{y^8}\right\}\]
		are all holomorphic on $C$, and they are linearly independent, so we see that this is a basis of the space of differentials in $\mathrm H^0(C,\Omega^1_{C/\CC})=\mathrm H^0(A,\Omega^1_{A/\CC})$. We remark that the above is also an eigenbasis for the induced $\mu_9$-action on $\mathrm H^0(A,\Omega^1_{A/\CC})$.

		\item We decompose $A$ into pieces. Note that $C$ projects onto the elliptic curve $C_0\colon y^3=x(x-1)(x-\lambda)$ via the map $(x,y)\mapsto\left(x,y^3\right)$, so $C_0$ is a factor of $A$. One can see that the basis of differentials of $C_0$ is given by $dx/y^2$, which pulls back to the differential $dx/y^6$ on $A$. In this way, we see that the quotient $A_1\coloneqq A/C_0$ will have $\mathrm H^0(A_1,\Omega^1_{A_1/\CC})$ have a basis given by
		\[\left\{\frac{dx}{y^4},\frac{dx}{y^5},\frac{dx}{y^7},\frac{dx}{y^8},\frac{x\,dx}{y^7},\frac{x\,dx}{y^8}\right\}.\]
		Note that we do not yet know if $A_1$ is simple!

		\item We compute some endomorphism algebras. Note $C_0$ has $\mu_3\subseteq\op{Aut}(C_0)$ where $\zeta_3$ acts by multiplication on the $y$-coordinate, so $C_0$ has complex multiplication by $F_0\coloneqq\QQ(\zeta_3)$.

		We conclude this step by showing that $A_1$ is simple. This will follow from the fact that $A$ does not have complex multiplication. Note the $\mu_9$-action on $A$ fixes $C_0$ (we can be seen on the level of the Hodge structure), so it must also fix $A_1$, so we see $\QQ(\zeta_9)\subseteq\op{End}_\CC(A_1)_\QQ$. Thus, $A_1$ contains an isotypic component $B^r$ (where $B$ is simple) such that
		\[\QQ(\zeta_9)\subseteq\op{End}_\CC(B^r)=M_r\left(\op{End}_\CC(\mathrm H^1_{\mathrm B}(B,\CC))\right).\]
		As such, we set $D\coloneqq\op{End}_\CC(B)$ and $F\coloneqq Z(D)$ so that $d\coloneqq\sqrt{[D:F]}$ and $e\coloneqq[F:\QQ]$ satisfy $6\mid rde$ (because $\QQ(\zeta_9)$ is contained in a maximal subfield of $M_r(D)$) and $r^2d^2e\le2\dim A_1=12$. If we had $r^2d^2e=12$, then $A_1$ would have complex multiplication, which contradicts the fact that $A$ does not have complex multiplication. Thus, we must instead have $rde=r^2d^2e=6$, which implies that $r=d=1$ and so $A_1=B$ with $\op{End}_\CC(A_1)$ given exactly by $F_1\coloneqq\QQ(\zeta_9)$.

		\item We compute some signatures. We begin with $C_0$. Letting $\tau_i\in\op{Gal}(\QQ(\zeta_3)/\QQ)$ be given by $\tau_i(\zeta_3)\coloneqq\zeta_3^i$ for $i\in\{1,2\}$, we see that the signature $\Phi_0\colon\op{Gal}(\QQ(\zeta_3)/\QQ)\to\ZZ_{\ge0}$ of $E_0$ is thus given by $\Phi_0(\tau_1)=1$ and $\Phi_0(\tau_2)=0$ because the second step provided an (eigen)basis of $\mathrm H^{10}(C_0)=\mathrm H^0(C_0,\Omega^1_{C_0/\CC})$.

		We next consider $A_1$. The second step provided a basis of $\mathrm H^{10}(A_1)=\mathrm H^0(A_1,\Omega^1_{A_1/\CC})$. As such, we define $\sigma_i\in\op{Gal}(\QQ(\zeta_9)/\QQ)$ to be the automorphism given by $\sigma_i(\zeta_9)\coloneqq\zeta_9^i$ for $i\in\{1,2,4,5,7,8\}$, and we are able to compute that our signature $\Phi_1\colon\op{Gal}(\QQ(\zeta_9)/\QQ)\to\ZZ_{\ge0}$ is given by
		\[\Phi(\sigma_i)=\begin{cases}
			0 & \text{if }i\in\{7,8\}, \\
			1 & \text{if }i\in\{4,5\}, \\
			2 & \text{if }i\in\{1,2\}.
		\end{cases}\]

		\item We compute $\op{MT}(A)^{\mathrm{der}}$; note that this equals $\op{Hg}(A)^{\mathrm{der}}$ by \Cref{lem:mt-by-hg}. By \Cref{lem:product-of-hg}, we have an inclusion
		\[\op{Hg}(A)\to\op{Hg}(C_0)\oplus\op{Hg}(A_1)\]
		which surjects onto each factor. Now, $C_0$ has complex multiplication, so $\op{Hg}(C_0)$ is a torus by \Cref{prop:cm-is-mt-torus}, so $\op{Hg}(A)^{\mathrm{der}}$ has trivial projection onto $\op{Hg}(C_0)$. We conclude that the above inclusion upgrades into an isomorphism $\op{Hg}(A)^{\mathrm{der}}\to\op{Hg}(A_1)^{\mathrm{der}}$.
		
		To compute $\op{Hg}(A_1)^{\mathrm{der}}$, we use \Cref{prop:mtc-reldim-2} to see that this equals $\op L(A_1)^{\mathrm{der}}$, so we complete this step by noting that $\op L(A_1)^{\mathrm{der}}_\CC\cong\op{SL}_2(\CC)^3$ by the computation in \Cref{lem:lefschetz-type-iv-1}.

		\item We compute $Z(\op{MT}(A))^\circ_\CC$. We use \Cref{prop:z-mt-as-reflex-monodromy} and in particular the discussion following the proof. Indeed, set $L\coloneqq\QQ(\zeta_9)$, which we note is a Galois extension of $\QQ$ containing $F_0F_1$. Then we note that $Z(\op{MT}(A))^\circ\subseteq\mathrm T_F$, where $F\coloneqq F_0\times F_1$ has $(\mathrm T_F)_L$ embedded into $\op{GL}\left(\mathrm H^1_{\mathrm B}(A,L)\right)$ as a subtorus of the diagonal torus. Explicitly, we can choose an $F$-eigenbasis of $\mathrm H^1_{\mathrm B}(A,L)=\mathrm H^1_{\mathrm B}(C_0,L)\oplus\mathrm H^1_{\mathrm B}(A_1,L)$ as
		\[\{u_1,u_2,v_1,v_1',v_2,v_2',v_4,v_4',v_5,v_5',v_7,v_7',v_8,v_8'\},\]
		where the subscript partially indicates the $F$-eigenvalue. Then we see that $(\op T_F)_L\subseteq\op{GL}\left(\mathrm H^1_{\mathrm B}(A,L)\right)$ embeds as
		\[\left\{\op{diag}(\mu_1,\mu_2,\lambda_1,\lambda_1,\lambda_2,\lambda_2,\lambda_4,\lambda_4,\lambda_5,\lambda_5,\lambda_7,\lambda_7,\lambda_8,\lambda_8):\mu_\bullet,\lambda_\bullet\in\mathbb G_{m,L}\right\}.\]
		The discussion following \Cref{prop:z-mt-as-reflex-monodromy} explains that equations cutting out $Z(\op{MT}(A))^\circ_L\subseteq(\mathrm T_F)_L$ can be viewed as elements of the kernel of the map
		\[\mathrm X^*\left(({\op N_{\Phi_0^*}},{\op N_{\Phi_1^*}})\right)\colon\mathrm X^*(\mathrm T_F)\to\mathrm X^*(\mathrm T_L).\]
		Using the established bases for these lattices, we see that our map can be written as the matrix
		\[\begin{blockarray}{ccc|cccccccc}
			& \mu_1 & \mu_2 & \lambda_1 & \lambda_2 & \lambda_4 & \lambda_5 & \lambda_7 & \lambda_8 \\
			\begin{block}{c[cc|cccccccc]}
				\sigma_1 & 1 & 0 & 2 & 2 & 1 & 1 & 0 & 0 \\
				\sigma_2 & 0 & 1 & 1 & 2 & 2 & 0 & 0 & 1 \\
				\sigma_4 & 1 & 0 & 0 & 1 & 2 & 0 & 1 & 2 \\
				\sigma_5 & 0 & 1 & 2 & 1 & 0 & 2 & 1 & 0 \\
				\sigma_7 & 1 & 0 & 1 & 0 & 0 & 2 & 2 & 1 \\
				\sigma_8 & 0 & 1 & 0 & 0 & 1 & 1 & 2 & 2 \\
			\end{block}
		\end{blockarray}.\]
		Then one can compute a basis of the kernel of the matrix, which tells us that $Z(\op{MT}(A))^\circ_L\subseteq(\mathrm T_F)_L$ is cut out by the equations
		\begin{align*}
			\lambda_1\lambda_8 &= \lambda_2\lambda_7, \\
			\lambda_1\lambda_8 &= \lambda_4\lambda_5, \\
			\mu_1\mu_2\lambda_7 &= \lambda_5\lambda_8, \\
			\lambda_1\lambda_4\lambda_7 &= \lambda_2\lambda_5\lambda_8.
		\end{align*}
		Thus, we see that $Z(\op{MT}(A))^\circ_\CC\cong\mathbb G_{m,\CC}^4$ with isomorphism given by the cocharacters $(\mu_1,\lambda_1,\lambda_4,\lambda_8)$.

		\item We use the previous steps to compute $G_\ell^1(A)$ when $\ell$ splits completely in $K_A^{\mathrm{conn}}$. Recall we notably know the Mumford--Tate conjecture that $G_\ell(A)^\circ=\op{MT}(A)_{\QQ_\ell}$ by \Cref{prop:mtc-reldim-2}. Thus, we choose $\ell$ to split completely in $K_A^{\mathrm{conn}}$ so that $\QQ(\zeta_9)\subseteq\QQ_\ell$, allowing us to engage in the diagonalization of the previous step. For example, the computation in \Cref{lem:lefschetz-type-iv-1} reveals that the isomorphism between $\op L(A)^{\mathrm{der}}$ and $\op{SL}_2^3$ is defined over $L$ (indeed, one merely needs to be able to take $L$-eigenspaces), so we find that
		\[G_\ell(A)^{\mathrm{der}}=\left\{\op{diag}\left(1_2,g_1,g_2,g_4,g_4^{-\intercal},g_2^{-\intercal},g_1^{-\intercal}\right):g_1,g_2,g_3\in\op{SL}_{2,\QQ_\ell}\right\}.\]
		Continuing, we add in the equation $\det g=1$ to the equations cutting out $Z(G_\ell(A_L))^\circ\subseteq(\mathrm T_F)_{\QQ_\ell}$ given in the previous step. This reveals that $Z\left(G_\ell^1(A_L)\right)^\circ\subseteq(\mathrm T_F)_{\QQ_\ell}$ is cut out by the equations
		\begin{align*}
			\mu_1\mu_2 &= 1, \\
			\lambda_1\lambda_8 &= 1, \\
			\lambda_2\lambda_7 &= 1, \\
			\lambda_4\lambda_5 &= 1, \\
			\lambda_2 &= \lambda_1\lambda_4.
		\end{align*}
		In particular, we see that $Z\left(G_\ell^1(A)\right)^\circ\cong\mathbb G_{m,\QQ_\ell}^3$ given by the cocharacters $(\mu_1,\lambda_1,\lambda_4)$. In total, we find $G_\ell^1(A)\subseteq\op{GL}_{14,\QQ_\ell}$ equals
		\[\left\{\op{diag}\left(\mu_1,\mu_1^{-1},\lambda_1g_1,\lambda_1\lambda_4g_2,\lambda_4g_4,\lambda_4^{-1}g_4^{-\intercal},\lambda_1^{-1}\lambda_4^{-1}g_2^{-\intercal},\lambda_1^{-1}g_1^{-\intercal}\right):\mu_\bullet,\lambda_\bullet\in\mathbb G_{m,\QQ_\ell},g_\bullet\in\op{SL}_{2,\QQ_\ell}\right\}.\]

		\item At last, we compute $\op{ST}(A_K)$ where $K$ contains $K_A^{\mathrm{conn}}$. By \Cref{thm:mtc-implies-astc}, we see that $\op{ST}(A)$ does not depend on the choice $\ell$, so we may as well choose $\ell$ to split completely in $K_A^{\mathrm{conn}}$. Then we simply base-change the result of the previous step to $\CC$, and then we may take maximal compact subgroups to see $\op{ST}$ is
		\[\left\{\op{diag}\left(\mu_1,\mu_1^{-1},\lambda_1g_1,\lambda_1\lambda_4g_2,\lambda_4g_4,\lambda_4^{-1}g_4^{-\intercal},\lambda_1^{-1}\lambda_4^{-1}g_2^{-\intercal},\lambda_1^{-1}g_1^{-\intercal}\right):\mu_\bullet,\lambda_\bullet\in\mathrm U_1,g_\bullet\in\mathrm{SU}_{2}\right\}.\]
		(It is not too hard to see that the product of maximal compact subgroups continues to be a maximal compact subgroup.) This completes the computation.
		\qedhere
	\end{enumerate}
\end{proof}
\begin{remark}
	Note that $\op MT(A)\ne\op L(A)$ because the centers are different! This continues to be visible in the Sato--Tate group: the first four equations $\mu_1\mu_2=\lambda_1\lambda_8=\lambda_2\lambda_7=\lambda_4\lambda_5=1$ can be explained by the polarization (see \Cref{lem:hg-center-in-u-torus}), but the last equation $\lambda_2=\lambda_1\lambda_4$ corresponds to an exceptional Hodge class not generated by endomorphisms or the polarization.
\end{remark}
The hypothesis that $A$ fails to have CM is necessary, as we will see in the following two examples.
\begin{proposition} \label{prop:special-fermat-st-1}
	Define $A$ to be the Jacobian of the proper curve $C$ with affine chart $y^9=x^3-1$. Then $\op{MT}(A)_\CC$ is a torus isomorphic to $\mathbb G_{m,\CC}^4$. We use this to compute $\op{ST}(A_K)$ where $K$ contains $K_A^{\mathrm{conn}}$.
\end{proposition}
\begin{proof}
	We proceed in steps, following \Cref{prop:generic-fermat-st}.
	\begin{enumerate}
		\item To begin, we once again note that $C$ has genus $7$, so $A$ has dimension $7$, and we have a basis of holomorpic differentials given by
		\[\left\{\frac{dx}{y^4},\frac{dx}{y^5},\frac{dx}{y^6},\frac{dx}{y^7},\frac{dx}{y^8},\frac{x\,dx}{y^7},\frac{x\,dx}{y^8}\right\}.\]
		This time around, we see that $\mu_3\times\mu_9$ acts on $C$ by coordinate-wise multiplication on $(x,y)\in C$.

		\item We decompose $A$ into pieces.
		\begin{itemize}
			\item Note $C$ projects onto $C_0\colon y^3=x^3-1$ by $(x,y)\mapsto\left(x,y^3\right)$. (This is the quotient of $C$ by $\mu_3\times1$.) We see that $C_0$ is an elliptic curve, and it has complex multiplicatino by $\mu_3$; for example, $\mu_3$ can act by multiplication on $y$. One can compute that $C_0$ has a basis of holomorphic differentials given by $dx/y^2$, which pulls back to the differential $dx/y^6$ on $C$.

			\item Note $C$ projects onto the proper curve $C_1$ with affine chart $y^9=x^3(x-1)$ by $(x,y)\mapsto\left(x^3,xy\right)$, so $A$ has $A_1\coloneqq\op{Jac}C_1$ as a factor.\footnote{Technically, we should take normalizations everywhere. We will omit these normalizations.} (This is the quotient of $C$ by $\mu_3\subseteq\mu_3\times\mu_9$ embedded by $\zeta\mapsto\left(\zeta,\ov\zeta\right)$.) One can compute that $C_1$ is genus $3$ using the Riemann--Hurwitz formula, and then we can compute that it has a basis of holomorphic differentials given by $\left\{x^2\,dx/y^8,x^2\,dx/y^7,x\,dx/y^5\right\}$, which pull back to the differentials $\left\{dx/y^8,x\,dx/y^7,dx/y^5\right\}$ on $C$ (up to a scalar).

			Note that $C_1$ has an action by $\mu_9$ by multiplying on the $y$-coordinate, so $\QQ(\zeta_9)\subseteq\op{End}_\CC(A_1)_\QQ$. However, $\dim A_1=3$, so we see that $A_1$ has complex multiplication. We will check that $A_1$ is simple shortly.

			\item Note $C$ projects onto the proper curve $C_2$ with affine chart $y^9=x^6(x-1)$ by $(x,y)\mapsto\left(x^3,x^2y\right)$, so $A$ has $A_2\coloneqq\op{Jac}C_2$ as a factor. (This is the quotient of $C$ by $\mu_3\subseteq\mu_3\times\mu_9$ embedded by $\zeta\mapsto\left(\zeta,\zeta\right)$.) One can compute that $C_2$ has genus $3$ using the Riemann--Hurwitz formula, and then we can compute that it has a basis of holomorphic differentials given by $\left\{x^5\,dx/y^8,x^4\,dx/y^7,x^2\,dx/y^4\right\}$, which pull back to the differentials $\left\{x\,dx/y^8,dx/y^7,dx/y^4\right\}$ on $C$ (up to a scalar).

			Note that $C_2$ has an action by $\mu_9$ by multiplying on the $y$-coordinate, so $\QQ(\zeta_9)\subseteq\op{End}_\CC(A_2)_\QQ$. However, $\dim A_2=3$, so we see that $A_2$ has complex multiplication. We will check that $A_2$ is simple shortly.
		\end{itemize}
		We spend a moment checking that $A$ is isogenous to $C_0\times A_1\times A_2$. The above computations have provided a map $C_0\times A_1\times A_2\to A$, so it is enough to check that this is an isomorphism after base-changing to $\CC$. The computations above have shown that this map provides an isomorphism
		\[\mathrm H^0\left(A,\Omega^1_{A/\CC}\right)\to\mathrm H^0\left(C_0,\Omega^1_{C_0/\CC}\right)\oplus\mathrm H^0\left(A_1,\Omega^1_{A_1/\CC}\right)\oplus\mathrm H^0\left(A_2,\Omega^1_{A_2/\CC}\right).\]
		(We take a moment to remark that the right-hand side is even a decomposition of $\mathrm H^0\left(A,\Omega^1_{A/\CC}\right)$ into $\mu_3$-eigenspaces!) This corresponds to an isomorphism on one piece of the Hodge structure, which we note upgrades to an isomorphism of Hodge structures because the relevant Hodge structures are concentrated in $(0,1)$ and $(1,0)$, which are complex conjugates. We conclude that $A$ is isogenous to $C_0\times A_1\times A_2$ by \Cref{thm:riemann}.

		\item We compute some signatures. For our notation, we let $F_0\coloneqq\QQ(\zeta_3)$ have the embeddings $\{\tau_1,\tau_2\}$, where $\tau_\bullet\in\op{Gal}(F_0/\QQ)$ sends $\zeta_3\mapsto\zeta_3^\bullet$; similarly, we let $F_1=F_2\coloneqq\QQ(\zeta_9)$ have the embeddings $\{\sigma_1,\sigma_2,\sigma_4,\sigma_5,\sigma_7,\sigma_8\}$ where $\sigma_\bullet\in\op{Gal}(\QQ(\zeta_9)/\QQ)$ sends $\zeta_9\mapsto\zeta_9^\bullet$. Here are our signatures.
		\begin{itemize}
			\item On $C_0$, we see that $\mathrm H^{10}$ is spanned by $dx/y^2$, so with $\mu_3$ acting on $y$, we get the signature $\Phi_0(\tau_1)=1$ and $\Phi_0(\tau_2)=0$.

			\item On $C_1$, we see that $\mathrm H^{10}$ has basis given by $\left\{x^2\,dx/y^8,x^2\,dx/y^7,x\,dx/y^5\right\}$. Thus, with $\mu_9$ acting on $y$, we get the signature
			\[\Phi_1(\sigma_i)=\begin{cases}
				0 & \text{if }i\in\{5,7,8\}, \\
				1 & \text{if }i\in\{1,2,4\}.
			\end{cases}\]
			One can check that $\Phi_1$ satisfies the check of \Cref{rem:simple-by-type}, proving that $A_1$ is simple.
			
			\item On $C_1$, we see that $\mathrm H^{10}$ has basis given by $\left\{x\,dx/y^8,dx/y^7,dx/y^4\right\}$. Thus, with $\mu_9$ acting on $y$, we get the signature
			\[\Phi_2(\sigma_i)=\begin{cases}
				0 & \text{if }i\in\{4,7,8\}, \\
				1 & \text{if }i\in\{1,2,5\}.
			\end{cases}\]
			One can check that $\Phi_2$ satisfies the check of \Cref{rem:simple-by-type}, proving that $A_1$ is simple.
		\end{itemize}
		The above computation allows us to conclude that we have decomposed $A$ into simple abelian varieties with complex multiplication.

		\item We compute $\op{MT}(A)_\CC$. Because $A$ has complex multiplication, we see that $\op{MT}(A)$ is a torus by \Cref{prop:cm-is-mt-torus} embedded in $\mathrm T_F$, where $F\coloneqq F_0\times F_1\times F_2$. As such, we may use \Cref{prop:z-mt-as-reflex-monodromy} and the surrounding discussion following the proof to compute equations cutting out $\op{MT}(A)\subseteq\mathrm T_F$. In particular, set $L\coloneqq\QQ(\zeta_9)$, which we note is a Galois extension of $\QQ$ containing $F_0F_1F_2$. Then we note that $\mathrm H^1_{\mathrm B}(A,L)=\mathrm H^1_{\mathrm B}(C_0,L)\oplus\mathrm H^1_{\mathrm B}(A_1,L)\oplus\mathrm H^1_{\mathrm B}(A_2,L)$ can be given a basis
		\[\{u_1,u_2,v_1,v_2,v_4,v_5,v_7,v_8,w_1,w_2,w_4,w_5,w_7,w_8\},\]
		where the subscript partially indicates the $F$-eigenvalue. Then we see that $(\mathrm T_F)_L\subseteq\op{GL}\left(\mathrm H^1_{\mathrm B}(A,L)\right)$ embeds as
		\[\left\{\op{diag}(\mu_1,\mu_2,\lambda_1,\lambda_2,\lambda_4,\lambda_5,\lambda_7,\lambda_8,\kappa_1,\kappa_2,\kappa_4,\kappa_5,\kappa_7,\kappa_8):\mu_\bullet,\lambda_\bullet,\kappa_\bullet\in\mathbb G_{m,L}\right\}.\]
		The discussion following \Cref{prop:z-mt-as-reflex-monodromy} explains that equations cutting out $Z(\op{MT}(A))^\circ_L\subseteq(\mathrm T_F)_L$ can be viewed as elements of the kernel of the map
		\[\mathrm X^*\left(({\op N_{\Phi_0^*}},{\op N_{\Phi_1^*}},{\op N_{\Phi_2^*}})\right)\colon\mathrm X^*(\mathrm T_F)\to\mathrm X^*(T_L).\]
		Using the established bases for these lattices, we see that our map can be written as the matrix
		\[\begin{blockarray}{ccc|cccccc|cccccc}
			& \mu_1 & \mu_2 & \lambda_1 & \lambda_2 & \lambda_4 & \lambda_5 & \lambda_7 & \lambda_8 & \kappa_1 & \kappa_2 & \kappa_4 & \kappa_5 & \kappa_7 & \kappa_8 \\
			\begin{block}{c[cc|cccccc|cccccc]}
				\sigma_1 & 1 & 0 & 1 & 1 & 1 & 0 & 0 & 0 & 1 & 1 & 0 & 1 & 0 & 0 \\
				\sigma_2 & 0 & 1 & 0 & 1 & 1 & 0 & 0 & 1 & 1 & 1 & 1 & 0 & 0 & 0 \\
				\sigma_4 & 1 & 0 & 1 & 1 & 0 & 1 & 0 & 0 & 1 & 0 & 0 & 1 & 1 & 0 \\
				\sigma_5 & 0 & 1 & 1 & 1 & 0 & 1 & 0 & 0 & 1 & 0 & 0 & 1 & 1 & 0 \\
				\sigma_7 & 1 & 0 & 1 & 0 & 0 & 1 & 1 & 0 & 0 & 0 & 0 & 1 & 1 & 1 \\
				\sigma_8 & 0 & 1 & 0 & 0 & 0 & 1 & 1 & 1 & 0 & 0 & 1 & 0 & 1 & 1 \\
			\end{block}
		\end{blockarray}.\]
		Then one can compute a basis of the kernel of the matrix, which tells us that $\op{MT}(A)_L\subseteq(\mathrm T_F)_L$ is cut out by the following equations. To begin, it turns out that $(A_1)_L$ and $(A_2)_L$ are isogenous, which we can see from the six equations
		\begin{align*}
			\lambda_1 &= \kappa_5, \\
			\lambda_2 &= \kappa_1, \\
			\lambda_4 &= \kappa_2, \\
			\lambda_5 &= \kappa_7, \\
			\lambda_7 &= \kappa_8, \\
			\lambda_8 &= \kappa_4.
		\end{align*}
		(Namely, these equations imply an isomorphism of $\op{MT}(A)$-representations $\mathrm H^1_{\mathrm B}(A_1,L)\cong\mathrm H^1_{\mathrm B}(A_2,L)$ and hence an isomorphism of Hodge structures, which gives the isogeny by \Cref{thm:riemann}.) Then there are the equations given by the polarization (via \Cref{lem:hg-center-in-u-torus})
		\begin{align*}
			\mu_1\mu_2 &= \kappa_1\kappa_8, \\
			\kappa_1\kappa_8 &= \kappa_2\kappa_7, \\
			\kappa_1\kappa_8 &= \kappa_4\kappa_5.
		\end{align*}
		Lastly, there is the exceptional equation
		\begin{align*}
			\mu_1\kappa_7 &= \kappa_5\kappa_8.
		\end{align*}
		In total, we find that $\op{MT}(A)_L$ is a torus isomorphic to $\mathbb G_{m,L}^4$ via the cocharacters $(\kappa_1,\kappa_2,\kappa_4,\kappa_8)$.

		\item We use the previous step to compute $G_\ell^1(A_K)$ when $\ell$ splits completely in $K\coloneqq K_A^{\mathrm{conn}}$. Recall that we know the Mumford--Tate conjecture that $G_\ell(A)^\circ=\op{MT}(A)_{G_\ell}$ by \Cref{rem:mtc-cm}. Thus, we choose $\ell$ to split completely in $K_A^{\mathrm{conn}}$ so that $L\subseteq\QQ_\ell$, allowing us to engage in the diagonalization of the previous step. Now, to compute $G_\ell^1(A_K)$ from $G_\ell(A_K)$, we simply need to add in the equation that the multipler is $1$. This reveals that $G_\ell^1(A_{K_A^{\mathrm{conn}}})\subseteq(\mathrm T_F)_{\QQ_\ell}$ is cut out by the following equations. As before, we have the six equations
		\begin{align*}
			\lambda_1 &= \kappa_5, \\
			\lambda_2 &= \kappa_1, \\
			\lambda_4 &= \kappa_2, \\
			\lambda_5 &= \kappa_7, \\
			\lambda_7 &= \kappa_8, \\
			\lambda_8 &= \kappa_4
		\end{align*}
		given by the isogeny $(A_1)_L\sim (A_2)_L$, and we have the equations given by the polarization
		\begin{align*}
			\mu_1\mu_2 &= 1, \\
			\kappa_1\kappa_8 &= 1, \\
			\kappa_2\kappa_7 &= 1, \\
			\kappa_4\kappa_5 &= 1.
		\end{align*}
		Lastly, there is still the exceptional equation
		\[\mu_1\kappa_7=\kappa_5\kappa_8.\]
		In total, we find that $G_\ell^1(A)$ is a torus isomorphic to $\mathbb G_{m,L}^3$ via the cocharacters $(\kappa_1,\kappa_2,\kappa_4)$. In total, we see $G_\ell^1(A_K)^\circ\subseteq\op{GL}_{14}$ is
		\[\left\{\op{diag}\left(\frac{\kappa_2}{\kappa_1\kappa_4},\frac{\kappa_1\kappa_4}{\kappa_2},\kappa_4^{-1},\kappa_1,\kappa_2,\kappa_2^{-1},\kappa_1^{-1},\kappa_4,\kappa_1,\kappa_2,\kappa_4,\kappa_4^{-1},\kappa_2^{-1},\kappa_1^{-1}\right):\kappa_\bullet\in\mathbb G_{m,\QQ_\ell}\right\}.\]

		\item At last, we compute $\op{ST}(A_K)$ where $K$ contains $K_A^{\mathrm{conn}}$. By \Cref{thm:mtc-implies-astc}, we see that $\op{ST}$ does not depend on the choice of $\ell$, so we may as well choose $\ell$ to split completely in $K_A^{\mathrm{conn}}$. Then we may simply base-change the result of the previous step to $\CC$, and then we may take maximal compact subgroups to see $\op{ST}$ is
		\[\left\{\op{diag}\left(\frac{\kappa_2}{\kappa_1\kappa_4},\frac{\kappa_1\kappa_4}{\kappa_2},\kappa_4^{-1},\kappa_1,\kappa_2,\kappa_2^{-1},\kappa_1^{-1},\kappa_4,\kappa_1,\kappa_2,\kappa_4,\kappa_4^{-1},\kappa_2^{-1},\kappa_1^{-1}\right):\kappa_\bullet\in\mathrm U_1\right\}.\]
		Once again, we remark that the product of maximal compact subgroups continues to be maximal compact.
		\qedhere
	\end{enumerate}
\end{proof}
\begin{proposition} \label{prop:special-fermat-st-2}
	Define $A$ to be the Jacobian of the proper curve $C$ with affine chart $y^9=x\left(x^2+1\right)$. Then $\op{MT}(A)_\CC$ is a torus isomorphic to $\mathbb G_{m,\CC}^4$. We use this to compute $\op{ST}(A_K)$ where $K$ contains $K_A^{\mathrm{conn}}$.
\end{proposition}
\begin{proof}
	This argument is essentially the same as \Cref{prop:special-fermat-st-1}, so we will be a bit briefer.
	\begin{enumerate}
		\item Once again, we see that $C$ has genus $7$, so $A$ has dimension $7$, and we have a basis of holomorphic differentials given by
		\[\left\{\frac{dx}{y^4},\frac{dx}{y^5},\frac{dx}{y^6},\frac{dx}{y^7},\frac{dx}{y^8},\frac{x\,dx}{y^7},\frac{x\,dx}{y^8}\right\}.\]
		This time around, we see that $\mu_{18}$ acts on $C$ by $\zeta_{18}\cdot(x,y)=(-x,-\zeta_9y)$.

		\item We decompose $A$ into pieces.
		\begin{itemize}
			\item As usual, $C_0$ projects onto $y^3=x\left(x^2+1\right)$ by $(x,y)\mapsto\left(x,y^3\right)$. (This is the quotient of $C$ by $\mu_3$.) The Riemann--Hurwitz formula yields that $C_0$ is an elliptic curve with complex multiplication by $\mu_3$ acting on the $y$-coordinate. We see that $C_0$ has a basis of holomorphic differentials given by $dx/y^2$, which pulls back to $dx/y^6$ ln $C$.

			\item Now, $C$ projects onto the proper curve $C_1$ with affine chart $y^9=x^5(x+1)$ by $(x,y)\mapsto\left(x^2,xy\right)$, so $A$ has $A_1\coloneqq\op{Jac}C_1$ as a factor. (This is the quotient of $C$ by $\mu_2$.) The Riemann--Hurwitz formula implies that $C_1$ has genus $3$, and then we can compute that it has a basis of holomorphic differentials given by $\left\{x^4\,dx/y^8,x^3\,dx/y^7,x^2\,dx/y^5\right\}$, which pulls back to $\left\{x\,dx/y^8,dx/y^7,dx/y^5\right\}$ on $C$ (up to scalar).

			Note that $C_1$ has an action by $\mu_9$ acting on the $y$-coordinate, so $\QQ(\zeta_9)\subseteq\op{End}_\CC(A_1)_\QQ$. We will check in the next step that $A_1$ is simple by computing its signature and applying \Cref{rem:simple-by-type}.
		\end{itemize}
		We can see on the level of differentials that the induced map $C_0\times A_1\to A$ is injective, so we let $A_2$ be the cokernel. In terms of Hodge structures, we can see from the computation that
		\[\mathrm H^1_{\mathrm B}(A,\QQ)=\mathrm H^1_{\mathrm B}(C_0,\QQ)\oplus\mathrm H^1_{\mathrm B}(A_1,\QQ)\oplus\mathrm H^1_{\mathrm B}(A_2,\QQ)\]
		is a decomposition of $\mu_{18}$-representations because the left two spaces on the right-hand side are stable under the $\mu_{18}$-action. We conclude that $\QQ(\zeta_9)\subseteq\op{End}_\CC(A_2)_\QQ$ as well.

		\item We compute some signatures. As before, we let $F_0\coloneqq\QQ(\zeta_3)$ have $\{\tau_1,\tau_2\}=\op{Gal}(\QQ(F_0)/\QQ)$ where $\tau_\bullet\colon\zeta_3\mapsto\zeta_3^\bullet$, and we let $F_1=F_2\coloneqq\QQ(\zeta_9)$ have $\{\sigma_1,\ldots,\sigma_8\}=\op{Gal}(\QQ(\zeta_9)/\QQ)$ has $\sigma_\bullet\colon\zeta_9\mapsto\zeta_9^\bullet$.
		\begin{itemize}
			\item On $C_0$, we look at the $\mu_9$-eigenbasis of $\mathrm H^{10}$ to conclude that our signature has $\Phi_0(\tau_1)=1$ and $\Phi_0(\tau_2)$.
			\item On $C_1$, we look at the $\mu_9$-eigenbasis of $\mathrm H^{10}$ to conclude that our signature is
			\[\Phi_1(\sigma_i)=\begin{cases}
				0 & \text{if }i\in\{4,7,8\}, \\
				1 & \text{if }i\in\{1,2,5\}.
			\end{cases}\]
			One can check that $\Phi_1$ satisfies the check of \Cref{rem:simple-by-type}, proving that $A_1$ is simple.
			\item On $A_2$, we take the remaining differentials from $A$ to find that our signature is
			\[\Phi_2(\sigma_i)=\begin{cases}
				0 & \text{if }i\in\{5,7,8\}, \\
				1 & \text{if }i\in\{1,2,4\}.
			\end{cases}\]
			Again, one checks that $\Phi_2$ satisfies the check of \Cref{rem:simple-by-type}
		\end{itemize}

		\item At this point, we recognize that our signatures are the same as in \Cref{prop:special-fermat-st-1} up to swapping $\Phi_1$ and $\Phi_2$. Thus, up to some reordering of letters, the exact same computation goes through. Let's provide the result.
		
		To be explicit, we give $\mathrm H^1_{\mathrm B}(A,L)=\mathrm H^1_{\mathrm B}(C_0,L)\oplus\mathrm H^1_{\mathrm B}(A_1,L)\oplus\mathrm H^1_{\mathrm B}(A_2,L)$ a basis
		\[\{u_1,u_2,v_1,v_2,v_4,v_5,v_7,v_8,w_1,w_2,w_4,w_5,w_7,w_8\},\]
		where the subscript partially indicates the $F$-eigenvalue, where $F\coloneqq F_0\times F_1\times F_2$. Then we set $L\coloneqq\QQ(\zeta_9)$, and we see $(\mathrm T_F)_L\subseteq\op{GL}\left(\mathrm H^1_{\mathrm B}(A,L)\right)$ embeds as
		\[\left\{\op{diag}(\mu_1,\mu_2,\kappa_1,\kappa_2,\kappa_4,\kappa_5,\kappa_7,\kappa_8,\lambda_1,\lambda_2,\lambda_4,\lambda_5,\lambda_7,\lambda_8):\mu_\bullet,\kappa_\bullet,\lambda_\bullet\in\mathbb G_{m,L}\right\}.\]
		With this choice of lettering, the equations that end up cutting out $\op{MT}(A)_L\subseteq(\mathrm T_F)_L$ are exactly the same, so $\op{MT}(A)_L\cong\mathbb G_{m,L}^4$ via the cocharacters $(\kappa_1,\kappa_2,\kappa_4,\kappa_8)$.

		One is now able to compute $G_\ell^1(A)$ in the case where $\ell$ splits completely in $K\coloneqq K_A^{\mathrm{conn}}$. One finds the exact same equations via the same computation, so we find $G_\ell^1(A_K)\subseteq\op{GL}_{14}$ is given by
		\[\left\{\op{diag}\left(\frac{\kappa_2}{\kappa_1\kappa_4},\frac{\kappa_1\kappa_4}{\kappa_2},\kappa_1,\kappa_2,\kappa_4,\kappa_4^{-1},\kappa_2^{-1},\kappa_1^{-1},\kappa_4^{-1},\kappa_1,\kappa_2,\kappa_2^{-1},\kappa_1^{-1},\kappa_4\right):\kappa_\bullet\in\mathbb G_{m,\QQ_\ell}\right\}.\]
		Base-changing to $\CC$ and taking a maximal compact subgroup, we find $\op{ST}(A_K)$ is
		\[\left\{\op{diag}\left(\frac{\kappa_2}{\kappa_1\kappa_4},\frac{\kappa_1\kappa_4}{\kappa_2},\kappa_1,\kappa_2,\kappa_4,\kappa_4^{-1},\kappa_2^{-1},\kappa_1^{-1},\kappa_4^{-1},\kappa_1,\kappa_2,\kappa_2^{-1},\kappa_1^{-1},\kappa_4\right):\kappa_\bullet\in\mathrm U_1\right\},\]
		as required.
		\qedhere
	\end{enumerate}
\end{proof}
% work out y^9 = x(x-1)(x-lambda) for both generic and some special lambda

\subsection{Moment Statistics}
In this subsection, we explain how to numerically verify the Sato--Tate conjecture (\Cref{conj:ast}). Fix an abelian variety $A$ of dimension $g$ defined over a number field $K$, and choose a prime $\ell$ and embedding $\iota\colon\QQ_\ell\into\CC$; for example, this allows us to define the usual $\ell$-adic representation $\rho_\ell\colon\op{Gal}(\ov K/K)\to\op{GL}\left(\mathrm H^1_{\mathrm{\acute et}}(A_{\ov K},\QQ_\ell)\right)$.

The main idea is that the map sending $g\in\op{ST}(A)$ to the characteristic polynomial of $g\in\op{GL}_{2g}(\CC)$ is well-defined up to conjugacy classes, so it defines a (continuous) map $\op{Conj}(\op{ST}(A))\to\CC^{2g+1}$, where $\CC^{2g+1}$ simply lists out the coefficients of the characteristic polynomial. In this way, we can push the Haar measure on $\op{ST}(A)$ all the way to $\CC^{2g+1}$ to compute what the distribution of the characteristic polynomial will be.

Of course, in practice, it may be difficult to compute the characteristic polynomial of
\[\left[\frac1{\sqrt{\op N(\mf p)}}\iota\rho_\ell(\mathrm{Frob}_{\mf p})\right]\in\op{Conj}(\op{ST}(A))\]
for some prime $\mf p$ of $K$ such that $A$ has good reduction at $\mf p$. For our application, we will only be interested in superelliptic curves, for which this can be computed in SageMath \cite{abcmt-cyclic-cover}. To help out the computation a bit more, we make two quick remarks.
\begin{remark}
	Let $P(T)$ be the characteristic polynomial of $\mathrm{Frob}_{\mf p}$ acting on $\mathrm H^1_{\mathrm{\acute et}}(A_{\ov{\mathbb F_{\mf p}}},\QQ_\ell)$. Then we remark that $P(1)$ has a geometric interpretation as $\#A(\FF_{\mf p})$.
\end{remark}
\begin{remark} \label{rem:only-use-split-complete-st}
	It suffices to only consider primes $\mf p$ which are totally split in $K$ because such primes have density $1$. This is helpful because primes that split $\mf p$ completely have residue fields isomorphic to $\FF_p$ where $p\in\ZZ$ is the prime sitting below $\mf p$, so we are frequently able to reduce the computation to something only involving integral coefficients.
\end{remark}
As before, let's begin with some elliptic curve examples. Here, we note that the characteristic polynomial of $\frac1{\op N(\mf p)}\iota\rho_\ell(\mathrm{Frob}_{\mf p})$ will have degree $2$, with leading coefficient $1$, and the condition on the multiplier (from \Cref{prop:frob-multiplier}) implies that the constant coefficient is $1$. Thus, we see that the only interesting coefficient of the characteristic polynomial is given by the trace.
\begin{lemma} \label{lem:measure-conj-su2}
	The map $\tr\colon\op{Conj}({\op{SU}_2})\to[-2,2]$ is a homeomorphism, and the pushforward of the normalized Haar measure of $\op{SU}_2$ onto $\op{Conj}({\op{SU}_2})=[-2,2]$ is given by the semicircle measure $\frac1{2\pi}\sqrt{4-t^2}\,dt$.
\end{lemma}
\begin{proof}
	We show the claims separately.
	\begin{enumerate}
		\item We show that $\tr\colon\op{Conj}({\op{SU}_2})\to[-2,2]$ is a well-defined homeomorphism. Note that $\tr\colon\op{Conj}({\op{SU}_2})\to\CC$ is continuous, and all spaces in sight are compact and Hausdorff, so it is enough to check that $\tr$ is a bijection.
		
		A priori, $\tr$ is only defined as a map $\tr\colon\op{Conj}({\op{SU}_2})\to\CC$. To begin, we note that any element of $\op{SU}_2$ is diagonalizable by a unitary matrix, and the corresponding diagonal matrix must then look like $\op{diag}(\lambda,\ov\lambda)$ where $\left|\lambda\right|^2=1$. By writing $\lambda=e^{i\theta}$, we see that the trace of this element is $2\cos\theta$, so we see that $\tr\colon\op{Conj}({\op{SU}_2})\to[-2,2]$ is a well-defined surjection.

		It remains to check that $\tr$ is injective. Because each conjugacy class is represented by a diagonal matrix, it is enough to check that $g_1\coloneqq\op{diag}(\lambda_1,\ov\lambda_1)$ and $g_2\coloneqq\op{diag}(\lambda_2,\ov\lambda_2)$ have $\tr g_1=\tr g_2$ only if $g_1$ and $g_2$ are conjugate. Well, write $\lambda_\bullet=e^{i\theta_\bullet}$, and then we see that
		\[2\cos\theta_1=2\cos\theta_2,\]
		which implies that $\{\pm\theta_1\}=\{\pm\theta_2\}$, so $\{\lambda_1,\ov\lambda_1\}=\{\lambda_2,\ov\lambda_2\}$. We now do casework: if $\lambda_1=\lambda_2$, then we see that $g_1=g_2$ on the nose; otherwise, $\lambda_1=\ov\lambda_2$, and we see that
		\[\begin{bmatrix}
			& 1 \\
			-1
		\end{bmatrix}\begin{bmatrix}
			\lambda_1 \\ & \ov\lambda_1
		\end{bmatrix}\begin{bmatrix}
			& -1 \\ 1
		\end{bmatrix}=\begin{bmatrix}
			\lambda_2 \\ & \ov\lambda_2
		\end{bmatrix},\]
		so $g_1$ is conjugate to $g_2$.

		\item We now compute the required measures. A linear algebra argument with the condition $gg^\dagger=1_2$ shows that any element of $\op{SU}_2$ can be written uniquely in the form
		\[\begin{bmatrix}
			\alpha & -\ov\beta \\
			\beta & \ov\alpha
		\end{bmatrix}\]
		where $\left|\alpha\right|^2+\left|\beta\right|^2=1$. In this way, we see that $\op{SU}_2$ is isomorphic to the unit group of the quaternions $\mathbb H$, so $\op{SU}_2$ is diffeomorphic to $S^3$ and inherits a Haar measure by pullback. Explicitly, one finds that $\op{SU}_2$ inherits an action on $S^3$ by rotations, so the Lebesgue measure on $S^3$ is invariant under the group. Note that we have yet to normalize the Haar mesure on $\op{SU}_2$.

		We would now like to compute the volume of $\op{SU}_2$ with given trace $t$. Writing $\alpha=a+bi$ and $\beta=c+di$, we see that we are forcing $a=\frac12t$, which then requires the remaining coordinates to live in a sphere of radius $\sqrt{1-\frac14t^2}$. Thus, we see that our normalized Haar measure is
		\[\frac{\sqrt{1-\frac14t^2}\,dt}{\int_{-2}^2\sqrt{1-\frac14t^2}\,dt}.\]
		A quick substitution with $t=2\cos\theta$ in the bottom integral reveals that it equals $\pi$, whereupon we find that the desired measure is $\frac1{2\pi}\sqrt{4-t^2}\,dt$ after some rearranging.
		\qedhere
	\end{enumerate}
\end{proof}
\begin{remark} \label{rem:better-su2-haar-measure}
	In the sequel, it is occasionally more convenient to identify $\op{Con}(\mathrm{SU}_2)$ with the collection of diagonal matrices $\op{diag}\left(e^{i\theta},e^{-i\theta}\right)$ where $\theta\in[0,\pi)$. Then we see that the trace is $2\cos\theta$, so we produce a measure of $\frac2\pi\sin^2\theta\,d\theta$ on $[0,\pi)$.
\end{remark}
\begin{example}[no complex multiplication] \label{ex:ec-no-cm-measure}
	We continue with the elliptic curve $E\colon y^2=x^3+x+1$ over $\QQ$ studied in \Cref{ex:ec-no-cm-st}. Then we recall that $\op{ST}(E)=\op{SU}_2$, so we may use the computation of \Cref{lem:measure-conj-su2} to see that the Sato--Tate conjecture (\Cref{conj:st}) implies that the values
	\[\left\{\tr\frac1{\sqrt{\op N(\mf p)}}\iota\rho_\ell(\mathrm{Frob}_{\mf p})\right\}_{\mf p\text{ prime}}\]
	equidistribute according to the semicircle measure $\frac1{2\pi}\sqrt{4-t^2}\,dt$ on $[-2,2]$.
\end{example}
\begin{example}[complex multiplication] \label{ex:cm-ec-st-measure}
	We continue with the elliptic curve $E\colon y^2=x^3+1$ over $\QQ(\zeta_3)$ studied in \Cref{ex:cm-ec-st}. Then we recall that $\op{ST}(E)\cong\mathrm U_1$ embedded as $z\mapsto\op{diag}(z,\ov z)$. We may write $\mathrm U_1$ as $\mathrm U_1=\left\{e^{i\theta}:\theta\in[0,2\pi)\right\}$, so we can equip this group with the normalized Haar measure $\frac1{2\pi}\,d\theta$. (The map $e^{i\theta}\mapsto\theta$ is a homeomorphism away from a set of measure $0$.) Noting the trace of $\op{diag}\left(e^{i\theta},e^{-i\theta}\right)$ is $2\cos\theta$, we see the Sato--Tate conjecture (\Cref{conj:st}) implies that the values
	\[\left\{\tr\frac1{\sqrt{\op N(\mf p)}}\iota\rho_\ell(\mathrm{Frob}_{\mf p})\right\}_{\mf p\text{ prime}}\]
	equidistribute according to the measure $\frac1\pi\cdot\frac1{\sqrt{4-t^2}}\,dt$ on $[-2,2]$.
\end{example}
\begin{example}[potential complex multiplication] \label{ex:pot-cm-ec-st-measure}
	We continue with the elliptic curve $E\colon y^2=x^3+1$ over $\QQ(\zeta_3)$ studied in \Cref{ex:pot-cm-ec-st}. Then we recall that $\op{ST}(E)\cong\mathrm U_1\rtimes S_2$, where $\mathrm U_1\subseteq\op{GL}_{2,\CC}$ is embedded as $z\mapsto\op{diag}(z,\ov z)$, and $S_2=\{1,w\}$ acts by switching the coordinates. Again, we give $\mathrm U_1=\left\{e^{i\theta}:\theta\in[0,2\pi)\right\}$ the normalized Haar measure $\frac1{2\pi}\,d\theta$, so $\mathrm U_1\rtimes S_2$ gets the normalized Haar measure $\frac1{4\pi}\,d\theta$. For $u=\op{diag}\left(e^{i\theta},e^{-i\theta}\right)\in U$, we note that the trace of $(u,1)\in\mathrm U_1\rtimes S_2$ is simply $2\cos\theta$ while the trace of $(u,w)\in\mathrm U_1\rtimes S_2$ vanishes. Thus, we see the Sato--Tate conjecture (\Cref{conj:st}) implies that the values
	\[\left\{\tr\frac1{\sqrt{\op N(\mf p)}}\iota\rho_\ell(\mathrm{Frob}_{\mf p})\right\}_{\mf p\text{ prime}}\]
	equidistribute according to the measure $\frac1{2\pi}\cdot\frac1{\sqrt{4-t^2}}\,dt+\frac12\delta_0\,dt$ on $[-2,2]$. Here, $\delta_0$ refers to the $\delta$-distribution concentrated at $0$.
\end{example}
We now return to the Jacobian of (the normalization of the proper curve with affine chart) $y^9=x(x-1)(x-\lambda)$. It will be helpful to take products of Haar measures in the sequel. The following result is an easier form of \cite[Proposition~1.5.6]{de-harmonic-analysis}.
\begin{lemma} \label{lem:product-haar-measure}
	Fix a locally compact topological group $G$. Suppose that there are closed subgroups $H,K\subseteq G$ such that $G=HK$ and $K\subseteq C_G(H)$. Letting $dh$ and $dg$ be left Haar measures on $H$ and $K$, respectively, we find that $dk\,dh$ is a left Haar measure on $G$.
\end{lemma}
\begin{proof}
	We are tasked with showing that the integral
	\[\int_H\int_Kf(hk)\,dk\,dh\]
	is left-invariant for $G$. It is left-invariant for $H$ with no content, so it suffices to show the same for $K$. This follows after some manipulation because $K$ commutes with $H$.
\end{proof}
\begin{remark}
	In fact, \cite[Proposition~1.5.6]{de-harmonic-analysis} shows something much stronger: one can replace the strong group-theoretic condition that $K\subseteq C_G(H)$ with merely that $K$ is compact. In fact, a careful reading of the proof there reveals that we may even replace the condition that $K$ is compact with merely having $H\cap K$ compact and $\Delta_G|_K=1$, where $\Delta_G$ is the modular function on $G$.
\end{remark}
Here is our application.
\begin{proposition} \label{prop:generic-fermat-st-measure}
	Let $A$ be the Jacobian of the normalization of the proper curve with affine chart $y^9=x(x-1)(x-\lambda)$, where $\lambda$ lives in a number field. Suppose that $A$ does not have complex multiplication. We compute a Haar measure on $\op{ST}(A_K)$ whenever $K$ contains $K_A^{\mathrm{conn}}$.
\end{proposition}
\begin{proof}
	The Sato--Tate computation of \Cref{prop:generic-fermat-st} (combined with the conjugacy class computation of \Cref{lem:measure-conj-su2}) reveals that an element of $\op{Conj}(\op{ST}(A))$ can be written as
	\begin{align*}
		&\op{diag}\Bigg(\begin{bmatrix}
			e^{i\alpha_0} \\ & e^{-i\alpha_0}
		\end{bmatrix},\begin{bmatrix}
			e^{i\alpha_1+i\theta_1} \\ & e^{i\alpha_1-i\theta_1}
		\end{bmatrix},\begin{bmatrix}
			e^{i\alpha_1+i\alpha_4+i\theta_2} \\ & e^{i\alpha_1+i\alpha_4-i\theta_2}
		\end{bmatrix},\begin{bmatrix}
			e^{i\alpha_4+i\theta_4} \\ & e^{i\alpha_4-i\theta_4}
		\end{bmatrix}, \\
		&\qquad\begin{bmatrix}
			e^{-i\alpha_4+i\theta_4} \\ & e^{-i\alpha_4-i\theta_4}
		\end{bmatrix},\begin{bmatrix}
			e^{-i\alpha_1-i\alpha_4+i\theta_2} \\ & e^{-i\alpha_1-i\alpha_4-i\theta_2}
		\end{bmatrix},\begin{bmatrix}
			e^{-i\alpha_1+i\theta_1} \\ & e^{-i\alpha_1-i\theta_1}
		\end{bmatrix}\Bigg)
	\end{align*}
	where $\alpha_\bullet\in[0,2\pi)$ and $\theta_\bullet\in[0,\pi)$. Technically, the map $(\alpha_\bullet,\theta_\bullet)\colon[0,2\pi)^4\times[0,\pi)^3\to\op{Conj}(\op{ST}(A))$ is the finite-to-one because $Z(\op{ST}(A))^\circ\cap\op{ST}(A)^{\mathrm{der}}$ is finite, but this will make no effect on our computations as long as we normalize to have total volume $1$ and only integrate against genuine functions on $\op{Conj}(\op{ST}(A))$.
	
	Anyway, we see that the trace is given by
	\begin{align*}
		&2\cos\alpha_0+2\cos(\alpha_1+\theta_1)+2\cos(\alpha_1-\theta_1)+2\cos(\alpha_1+\alpha_4+\theta_2)+2\cos(\alpha_1+\alpha_4-\theta_2) \\
		&\qquad+2\cos(\alpha_4+\theta_4)+2\cos(\alpha_4-\theta_4).
	\end{align*}
	We finish by remarking that \Cref{lem:product-haar-measure} gives our Haar measure as
	\[\frac1{(2\pi)^3}\,d\alpha_0\,d\alpha_1\,d\alpha_4\cdot\frac1{\pi^2}\left(2\sin^2\theta_1\cdot2\sin^2\theta_2\cdot2\sin^2\theta_4\right)d\theta_1\,d\theta_2\,d\theta_4,\]
	which is what we wanted. (Note we used \Cref{rem:better-su2-haar-measure} for the Haar measure on $\op{SU}_2$.)
\end{proof}
\begin{proposition} \label{prop:special-fermat-st-measure-1}
	Let $A$ be the Jacobian of the normalization of the proper curve with affine chart $y^9=x^3-1$. Suppose that $A$ does not have complex multiplication. We compute a Haar measure on $\op{ST}(A_K)$ whenever $K$ contains $K_A^{\mathrm{conn}}$.
\end{proposition}
\begin{proof}
	The Sato--Tate computation of \Cref{prop:special-fermat-st-1} reveals that an element of $\op{Conj}(\op{ST}(A))$ can be written as
	\begin{align*}
		&\op{diag}\left(e^{i\alpha_2-i\alpha_1-\alpha_4},e^{i\alpha_1+i\alpha_4-i\alpha_2},e^{-i\alpha_4},e^{i\alpha_1},e^{i\alpha_2},e^{-\alpha_2},e^{-\alpha_1},e^{i\alpha_4},e^{i\alpha_1},e^{i\alpha_2},e^{i\alpha_4},e^{-i\alpha_4},e^{-i\alpha_2},e^{-i\alpha_1}\right)
	\end{align*}
	where $\alpha_\bullet\in[0,2\pi)$. For example, we see that the trace is given by
	\begin{align*}
		&2\cos\cos(\alpha_1-\alpha_2+\alpha_4)+4\cos\alpha_1+4\cos\alpha_2+4\cos\alpha_4
	\end{align*}
	We finish by remarking that \Cref{lem:product-haar-measure} gives our Haar measure as
	\[\frac1{(2\pi)^3}\,d\alpha_1\,d\alpha_2\,d\alpha_4,\]
	which is what we wanted.
\end{proof}
\begin{remark}
	As remarked at the end of the proof of \Cref{prop:special-fermat-st-2}, we can run the exact same computation with working the curve given by $y^9=x\left(x^2+1\right)$ because the resulting Sato--Tate group is the same up to reordering the basis.
\end{remark}
\begin{remark}
	For the previous examples, there are more interesting coefficients in the characteristic polynomial than merely the trace. Hoever, they are rather lengthy to write down, so we have chosen not to.
\end{remark}
It still remains to explain how we numerically verify the Sato--Tate conjecture. The idea is that we can try to compute
\[\tr\frac1{\sqrt{\op N(\mf p)}}\iota\rho_\ell(\mathrm{Frob}_{\mf p})\]
for various primes $\mf p$ and then compare it with what is expected from
\[\int_{\op{Conj}(\op{ST}(A))}\tr g\,dg,\]
where $dg$ refers to the pushforward of the Haar measure from $\op{Conj}(\op{ST}(A))$. One usually expects the above integral to vanish, so one can either look at other coefficients of the characteristic polynomial or at powers of $\tr g$. In the sequel, we will compute with only powers of $\tr g$ for simplicity, but we do remark that one can typically recover the other coefficients via a combination of Vieta's formulae and Newton's sums.

As usual, let's begin with elliptic curves. Here, explicit formulae are possible.
\begin{example}[no complex multiplication]
	We continue with the elliptic curve $E\colon y^2=x^3+x+1$ over $\QQ$ studied in \Cref{ex:ec-no-cm-st,ex:ec-no-cm-measure}. Fix some integer $m\ge0$. Using the given Haar measure (from \Cref{rem:better-su2-haar-measure}), we find that one expects the average of $\left\{\left(\tr\frac1{\sqrt{\op N(\mf p)}}\iota\rho_\ell(\mathrm{Frob}_{\mf p})\right)^m\right\}_{\mf p\text{ prime}}$ to be
	\[\int_0^\pi(2\cos\theta)^m\frac2\pi\sin^2\theta\,d\theta=\begin{cases}
		\frac1{m/2+1}\binom{m}{m/2} & \text{if }m\text{ is even}, \\
		0 & \text{if }m\text{ is odd},
	\end{cases}\]
	where the last equality is verified by expanding $2\cos\theta=e^{i\theta}+e^{-i\theta}$ and $4\sin^2\theta=2-e^{2i\theta}-e^{-2i\theta}$.
\end{example}
\begin{example}[complex multiplication]
	We continue with the elliptic curve $E\colon y^2=x^3+1$ over $\QQ(\zeta_3)$ studied in \Cref{ex:cm-ec-st,ex:cm-ec-st-measure}. Fix some integer $m\ge0$. Using the given Haar measure, we find that one expects the average of $\left\{\left(\tr\frac1{\sqrt{\op N(\mf p)}}\iota\rho_\ell(\mathrm{Frob}_{\mf p})\right)^m\right\}_{\mf p\text{ prime}}$ to be
	\[\int_0^{2\pi}(2\cos\theta)^m\frac1{2\pi}\,d\theta=\begin{cases}
		\binom{m}{m/2} & \text{if }m\text{ is even}, \\
		0 & \text{if }m\text{ is odd},
	\end{cases}\]
	where the last equality is verified by expanding $2\cos\theta=e^{i\theta}+e^{-i\theta}$.
\end{example}
\begin{example}[complex multiplication]
	We continue with the elliptic curve $E\colon y^2=x^3+1$ over $\QQ$ studied in \Cref{ex:pot-cm-ec-st,ex:pot-cm-ec-st-measure}. Fix some integer $m\ge0$. Using the given Haar measure, we find that one expects the average of $\left\{\left(\tr\frac1{\sqrt{\op N(\mf p)}}\iota\rho_\ell(\mathrm{Frob}_{\mf p})\right)^m\right\}_{\mf p\text{ prime}}$ to be
	\[\int_0^{2\pi}(2\cos\theta)^m\frac1{4\pi}\,d\theta=\begin{cases}
		\frac12\binom{m}{m/2} & \text{if }m\text{ is even}, \\
		0 & \text{if }m\text{ is odd},
	\end{cases}\]
	where the last equality is verified by expanding $2\cos\theta=e^{i\theta}+e^{-i\theta}$.
\end{example}
We now return to $y^9=x(x-1)(x-\lambda)$. Here, we do not attempt to give explicit formulae, but we list the first few expected values, which were computed using SageMath.
\begin{example}
	Let $A$ be the Jacobian of the normalization of the proper curve with affine chart $y^9=x(x-1)(x-10)$. SageMath can verify that $A$ does not have complex multiplication. For $m\in\{0,1,\ldots,6\}$, we use \Cref{prop:generic-fermat-st-measure} to find that we expect the aveage of $\left(\tr\frac1{\sqrt{\op N(\mf p)}}\iota\rho_\ell(\mathrm{Frob}_{\mf p})\right)^m$ as $\mf p$ varies over primes $K$ (for $K$ containing $K_A^{\mathrm{conn}}$) to be as follows.
	\[\begin{array}{c|cccccccc}
		m & 0 & 1 & 2 & 3 & 4 & 5 & 6 \\\hline
		\text{expected} & 1 & 0 & 8 & 0 & 186 & 0 & 7160 \\
		\text{actual} & 1.0 & 0.0 & 7.8 & 0.2 & 180 & 16 & 6400
	\end{array}\]
	Here, the ``actual'' amounts have been rounded to two significant digits, and they were computed by averaging over primes $p<216289$ which were $1\pmod9$; the condition $p\equiv1\pmod9$ corresponds to splitting completely in $\QQ(\zeta_9)$ (see \Cref{rem:only-use-split-complete-st}). These ``actual'' amounts suggest that $K_A^{\mathrm{conn}}=\QQ(\zeta_9)$, a fact which we will verify in the next chapter.
\end{example}
\begin{example}
	Let $A$ be the Jacobian of the normalization of the proper curve with affine chart $y^9=x^3-1$, where $\lambda$ lives in a number field. For $m\in\{0,1,\ldots,6\}$, we use \Cref{prop:special-fermat-st-measure-1} to find that we expect the aveage of $\left(\tr\frac1{\sqrt{\op N(\mf p)}}\iota\rho_\ell(\mathrm{Frob}_{\mf p})\right)^m$ as $\mf p$ varies over primes $K$ (for $K$ containing $K_A^{\mathrm{conn}}$) to be as follows.
	\[\begin{array}{c|cccccccc}
		m & 0 & 1 & 2 & 3 & 4 & 5 & 6 \\\hline
		\text{expected} & 1 & 0 & 26 & 0 & 2118 & 0 & 239300 \\
		\text{actual} & 1.0 & 0.0 & 25 & 6.0 & 2000 & 890 & 220000
	\end{array}\]
	Here, the ``actual'' amounts have been rounded to two significant digits, and they were computed by averaging over primes $p<100000$ which were $1\pmod9$; the condition $p\equiv1\pmod9$ corresponds to splitting completely in $\QQ(\zeta_9)$ (see \Cref{rem:only-use-split-complete-st}). These ``actual'' amounts suggest that $K_A^{\mathrm{conn}}=\QQ(\zeta_9)$, a fact which we will verify in the next chapter.
\end{example}
\begin{remark}
	If one runs the same computation as in the previous example with $y^9=x\left(x^2+1\right)$, one should further restrict primes past $p\equiv1\pmod9$ in order to see the correct moment statistics. This is because now $K_A^{\mathrm{conn}}\ne\QQ(\zeta_9)$.
\end{remark}

% elliptic curves
% y^9 = x(x-1)(x-lambda) first few moments

\end{document}