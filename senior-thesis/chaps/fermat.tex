% !TEX root = ../thesis.tex

\documentclass[../thesis.tex]{subfiles}

\begin{document}

\chapter{The Fermat Curve} \label{chap:fermat}

\epigraph{Usually mathematicians have to shoot somebody to get this much publicity.}{---Thomas R. Nicely}

In ths chapter, we will study the Galois representation attached to the projective $\QQ$-curve $X^1_N\subseteq\PP^1_\QQ$ cut out by the equation
\[X_N\colon X^N+Y^N+Z^N=0,\]
where $N\ge3$ is some nonnegative integer. %\footnote{It is not difficult to relax the condition that $N$ is odd, but it introduces some casework in a couple places.}
For the rest of this chapter, we will fix $N$ and thus denote this curve by $X\subseteq\PP^1_\QQ$. %It is worthwhile to summarize the basic steps of the computation.\todo{}
% \begin{enumerate}
% 	\item 
% \end{enumerate}
% For this subsection, we define $\ell$ to be a prime which is totally split in $\QQ(\zeta)$. In the sequel, we may also ask for $\ell$ to be totally split in a larger number field, which we will specify when we need it.

\section{Homology and Cohomology}
The exposition of this section follows \cite[Sections~2 and~3]{otsubo-fermat}. We will spend this section setting up some notation and proving basic facts about how these objects relate to each other.

\subsection{The Group Action} \label{subsec:fermat-group-action}
Throughout, it will be helpful to note that the finite alegbraic $\QQ$-group
\[G_N\coloneqq\frac{\mu_N\times\mu_N\times\mu_N}{\Delta\mu_N}\]
acts on $X_N$; here, $\Delta\mu_N\subseteq\mu_N\times\mu_N\times\mu_N$ refers to the diagonally embedded copy of $\mu_N$. As with $X_N$, we will denote this group by $G$ for the rest of the chapter, and we will let $\zeta\coloneqq\zeta_N$ be a primitive $N$th root of unity.

Notably, the action map $G\times X\to X$ is defined over $\QQ$ even though $G(\QQ)$ is trivial. For brevity, we will denote elements of $G$ by $g_{[r:s:t]}\coloneqq\left[\zeta^r:\zeta^s:\zeta^t\right]$. We will also have occasion to study the character group $\widehat G\coloneqq\widehat G_N$, which we identify with
\[\widehat G_N=\left\{(a,b,c)\in(\ZZ/N\ZZ)^3:a+b+c=0\right\}.\]
Explicitly, given a triple $(a,b,c)$, we let $\alpha_{(a,b,c)}$ denote the corresponding character, which sends $g_{[r:s:t]}\mapsto\zeta^{ra+bs+tc}$.

In the sequel, we will have many vector spaces induced by $X$ via (co)homology, which therefore have a $G$-action by functoriality. With this in mind, we make the following definition.
\begin{definition}
	Given a $\QQ(\zeta)$-vector space $\mathrm{H}$ with a $G$-action, we define
	\[\mathrm{H}_\alpha\coloneqq\{v\in\mathrm{H}:g\cdot v=\alpha(g)v\}\]
	to be the $\alpha$-eigenspace for each $\alpha\in\widehat G$.
\end{definition}
One inconvenience of this definition is that the vector spaces $\mathrm H$ of interest are frequently defined over $\QQ$, but $\mathrm{H}_\alpha$ is not.

Thus, we note that some $\tau\in\op{Gal}(\overline\QQ/\QQ)$ acts on $\widehat G$ as follows: say $\tau(\zeta)=\zeta^u$ for some $u\in(\ZZ/N\ZZ)^\times$, and then
\[(\tau\alpha)([\zeta^r:\zeta^s:\zeta^t])=\alpha\left([\zeta^{u^{-1}r},\zeta^{u^{-1}s}:\zeta^{u^{-1}t}]\right),\]
so we see that $\tau\alpha=u^{-1}\alpha$, where the multiplication $u^{-1}\alpha$ is understood to happen where $\alpha$ is a triple in $(\ZZ/N\ZZ)^3$. With this in mind, given $\alpha\in\widehat G$, we let $[\alpha]\subseteq\widehat G$ be the collection of characters of the form $u\alpha$ as $u\in(\ZZ/N\ZZ)^\times$ varies; for example, $-\alpha\in[\alpha]$. The point of this discussion is that we are able to build a decomposition
\[\QQ[G]\cong\prod_{[\alpha]\in G/(\ZZ/N\ZZ)^\times}\QQ([\alpha]),\]
where $\QQ([\alpha])$ is the image of the map $\QQ[G]\to\CC$ given by the characters in $[\alpha]$. We are now ready to make the following definition.
\begin{definition}
	Given some $\QQ$-vector space $\mathrm H$ with a $G$-action, we are now ready to define
	\[\mathrm H_{[\alpha]}\coloneqq\Bigg\{v\in\mathrm H:v\otimes1\in\bigoplus_{\beta\in[\alpha]}(\mathrm H\otimes_\QQ\overline\QQ)_\alpha\Bigg\}.\]
\end{definition}
The discussion of the Galois action of the previous paragraph implies that $\mathrm H_{[\alpha]}$ is a generalized eigenspace of the $G$-action on $\mathrm H$. In particular, we find that $\mathrm H_{[\alpha]}\otimes\overline\QQ=\bigoplus_{\beta\in[\alpha]}\mathrm H_\beta$, so $\mathrm H=\bigoplus_{[\alpha]}\mathrm H_{[\alpha]}$.

\subsection{Differential Forms}
In this subsection, we will define a few differential forms. A reasonable reference for this subsection is \cite[Section~1.7]{lang-cm}. A computation with the Riemann--Hurwitz formula shows that the genus of $X$ is $\frac{(N-1)(N-2)}2$, so we know that there are many holomorphic differential forms. On the other hand, we know that the space of differential forms lives in $\mathrm H^1_{\mathrm{dR}}(X(\CC),\CC)$, which is equipped with a $G$-action. Anyway, we are now ready to define our differential form.
\begin{definition}
	Fix notation as above. For $a\in\ZZ/N\ZZ$, let $[a]$ be a representative in $\{0,1,\ldots,N-1\}$. For any $\alpha_{(a,b,c)}\in\widehat G$, we define the differential form
	\[\omega_{\alpha_{(a,b,c)}}\coloneqq x^{[a]}y^{[b]-N}\,\frac{dx}x\]
	in the affine patch $x^N+y^N+1=0$ of $X$. In the sequel, we may also denote this differential form by $\omega_{(a,b,c)}$.
\end{definition}
\begin{remark} \label{rem:omega-a-b-c-patches}
	Because $x^N+y^N+1=0$ implies $x^{N-1}\,dx=-y^{N-1}\,dy$, we also see that
	\[\omega_{(a,b,c)}=-x^{[a]-N}y^{[b]}\,\frac{dy}y.\]
	Further, we can pass to the affine patch $1+v^N+u^N=0$ of $X$ by substituting $(x,y)=(1/u,v/u)$, for which we note $d(1/u)/(1/u)=-du/u$ so that
	\[\omega_{(a,b,c)}=-u^{N-[a]-[b]}v^{[b]-N}\,\frac{du}u.\]
\end{remark}
\begin{remark} \label{rem:coleman-differentials}
	Following \cite[Section~VI]{coleman-g-k-formula}, we remark that it will be numerically convenient to work with a rational multiple of the $\omega_\bullet$s for some computations in the sequel. Namlely, we define $\nu_\alpha\coloneqq K(\alpha)\omega_{\alpha}$ when $\alpha=(a,b,c)$ has nonzero entries, where
	\[K(a,b,c)\coloneqq\begin{cases}
		\frac{N-[a]-[b]}N & \text{if }[a]+[b]>N, \\
		1 & \text{if }[a]+[b]<N.
	\end{cases}\]
\end{remark}
From \Cref{rem:omega-a-b-c-patches}, we see that $\omega_{(a,b,c)}$ always succeeds at being meromorphic with poles only at points of the form $[X:Y:0]$, and it is closed (i.e., has vanishing residues) if and only if $0\notin\{a,b,c\}$. Further, we see that $\omega_{(a,b,c)}$ succeeds at being holomorphic provided that we also have $[a]+[b]<N$, which we note is equivalent to $[a]+[b]+[c]=N$.

We have now provided $\frac{(N-1)(N-2)}2$ holomorphic differentials of $X$, so we would like to check that we have actually found a basis of $\mathrm H^0(X(\CC),\Omega^1_{X/\CC})$. Well, these differential forms are nonzero by construction,\footnote{Later, \Cref{rem:nonzero-form-period} will give another way to prove this via periods.} and they are linearly independent because they are all eigenvectors for the $G$-action.
\begin{lemma}
	Fix notation as above. For each $\alpha\in\widehat G$, the differential form $\omega_\alpha$ is an eigenvector for the $G$-action with eigenvalue $\alpha$.
\end{lemma}
\begin{proof}
	Say $\alpha=\alpha_{(a,b,c)}$ for some $a,b,c\in\ZZ/N\ZZ$. Then for any $g_{[r:s:0]}\in G$, we note
	\begin{align*}
		(g_{[r:s:0]})^*\omega_{(a,b,c)} &= (\zeta^rx)^{[a]}(\zeta^sy)^{[b]-N}\,\frac{d(\zeta^rx)}{(\zeta^rx)} \\
		&= \zeta^{ar+bs}\cdot x^{[a]}y^{[b]-N}\,\frac{dx}x \\
		&= \alpha_{(a,b,c)}(g_{[r:s:0]})\omega_{(a,b,c)}.
	\end{align*}
	The reason to $g_{[r:s:0]}$ in the above computation is that we need the $G$-action to stay in the affine patch of points of the form $[X:Y:1]$.
\end{proof}
\begin{remark} \label{rem:diagonalize-de-rham}
	Thus, we see that our differential forms must be linearly independent because they are eigenvectors with different eigenvalues. As such, we have constructed eigenbases of $\mathrm H^1_{\mathrm{dR}}(X(\CC),\CC)$ and $\mathrm H^0(X(\CC),\Omega^1_{X/\CC})$.
\end{remark}
While we're here, we compute the Poincar\'e pairing of our basis of differential forms. 
\begin{lemma} \label{lem:fermat-poincare-pairing}
	Fix notation as above. Choose $\alpha,\alpha'\in\widehat G$ such that $\alpha=(a,b,c)$ and $\alpha'=(a',b',c')$ have nonzero entries. Then the Poincar\'e pairing
	\[P\colon\mathrm H^1_{\mathrm{dR}}(X(\CC),\CC)\times\mathrm H^1_{\mathrm{dR}}(X(\CC),\CC)\to\CC\]
	given by $(\omega,\eta)\mapsto\frac1{2\pi i}\int_X(\omega\land\eta)$ sends $(\omega_\alpha,\omega_{\alpha'})$ to
	\[P(\omega_\alpha,\omega_{\alpha'})=\begin{cases}
		0 & \text{if }\alpha\ne-\alpha', \\
		(-1)^N\frac N{N-[a]-[b]} & \text{if }\alpha=-\alpha'.
	\end{cases}\]
\end{lemma}
\begin{proof}
	We use the Poincar\'e residue, which implies that
	\[P(\omega,\eta)=\sum_{x\in X(\CC)}\op{Res}_x\left(\eta\int\omega\right),\]
	where the sum is over poles, and $\int\omega$ refers to any choice of local primitive for $\omega$ in the neighborhood of $x$. To use this, we note that the computation of \Cref{rem:omega-a-b-c-patches} implies that $\omega_{\alpha}$ and $\omega_{\alpha'}$ can only have poles at the points $[1:-\zeta^s:0]$ for some $s\in\ZZ/N\ZZ$, and in this neighborhood, we may write
	\[\omega_\alpha=-u^{N-[a]-[b]}v^{[b]-N}\,\frac{du}u\]
	and similarly for $\omega_{\alpha'}$. In particular, we see that
	\[-\frac1{N-[a]-[b]}u^{N-[a]-[b]}v^{[b]-N}\]
	makes a reasonable primitive for $\omega_\alpha$, so the Poincar\'e residue yields
	\[P(\omega_\alpha,\omega_{\alpha'}) = \sum_{s\in\ZZ/N\ZZ}\op{Res}_{(-\zeta^s,0)}\left(-\frac1{N-[a]-[b]}u^{N-[a]-[b]}v^{[b]-N}\cdot-u^{N-[a']-[b']}v^{[b']-N}\,\frac{du}u\right).\]
	Now, if $\alpha\ne\alpha'$, then we see that we are computing the residues of some monomial times $du/u$, but the power of $u$ in the monomial is nonzero, so the residues all vanish. Lastly, we need to discuss what happens with $\alpha=-\alpha'$, where we see
	\begin{align*}
		P(\omega_\alpha,\omega_{-\alpha}) &= \sum_{s\in\ZZ/N\ZZ}\op{Res}_{(-\zeta^s,0)}\left(-\frac1{N-[a]-[b]}u^{N-[a]-[b]}v^{[b]-N}\cdot-u^{N-[-a]-[-b]}v^{[-b]-N}\,\frac{du}u\right) \\
		&= \sum_{s\in\ZZ/N\ZZ}\op{Res}_{(-\zeta^s,0)}\left(-\frac1{N-[a]-[b]}u^{N-[a]-[b]}v^{[b]-N}\cdot u^{[a]+[b]-N}v^{-[b]}\,\frac{du}u\right) \\
		&= \frac1{N-[a]-[b]}\sum_{s\in\ZZ/N\ZZ}\op{Res}_{(-\zeta^s,0)}\left(v^{-N}\,\frac{du}u\right) \\
		&= \frac1{N-[a]-[b]}\sum_{s\in\ZZ/N\ZZ}(-\zeta^s)^{-N} \\
		&= (-1)^N\frac N{N-[a]-[b]},
	\end{align*}
	as desired.
\end{proof}
\begin{remark} \label{rem:coleman-differentials-dual}
	Following \Cref{rem:coleman-differentials}, we see that $\alpha\in\widehat G$ with nonzero entries will have
	\[P(\nu_\alpha,\nu_{-\alpha})=(-1)^N\]
	because exactly one of $K(\alpha)$ or $K(-\alpha)$ will absorb the given rational constant. This is essentially the reason for working with the $\nu_\bullet$s instead of the $\omega_\bullet$s. 
\end{remark}

\subsection{Some Group Elements}
In this subsection, we define a few elements of $\QQ[G]$ which we will then use in the next subsection. We begin with the three elements
\[t\coloneqq\sum_{g\in G}g,\qquad v\coloneqq\sum_{s\in\ZZ/N\ZZ}g_{[0:s:0]},\qquad\text{and}\qquad h\coloneqq\sum_{r\in\ZZ/N\ZZ}g_{[r:0:0]}.\]
We take a moment to note that these elements satisfy the relations $tg=gt=t$ for any $g\in G$, and $t=hv=vh$, and $v^2=Nv$ and $h^2=Nh$. In the sequel, we will get a lot of mileage out of the idempotent
\[p\coloneqq\frac1{N^2}\sum_{r,s\in\ZZ/N\ZZ}(1-g_{[r:0:0]})(1-g_{[0:s:0]}).\]
Let's check that $p$ is idempotent.
\begin{lemma} \label{lem:}
	Fix notation as above.
	\begin{listalph}
		\item Then $p$ is idempotent.
		\item For any $r,s\in\ZZ/N\ZZ$, we have $(1-g_{[r:0:0]})(1-g_{[0:s:0]})p=(1-g_{[r:0:0]})(1-g_{[0:s:0]})$.
	\end{listalph}
\end{lemma}
\begin{proof}
	Both claims hinge upon the fact that a direct expansion of $(1-g_{[r:0:0]})(1-g_{[0:s:0]})$ implies
	\[p=\frac1{N^2}\left(N^2-Nh-Nv+t\right).\]
	We now show the claims separately.
	\begin{listalph}
		\item This is a direct computation: write
		\begin{align*}
			p^2 &= \frac1{N^4}\left(N^2-Nh-Nv+t\right)\left(N^2-Nh-Nv+t\right) \\
			&= \frac1{N^4}\left(N^4+N^2h^2+N^2v^2+t^2-2N^3h-2N^3v+2N^2t+N^2hv-2Nht-2Nvt\right) \\
			&= \frac1{N^4}\left(N^4+N^3h+N^3v+N^2t-2N^3h-2N^3v+2N^2t+N^2t-2N^2t-2N^2t\right) \\
			&= \frac1{N^4}\left(N^4-N^3h-N^3v+N^2t\right) \\
			&= p.
		\end{align*}
		\item We will compute as in (a): note $h(1-g_{[r:0:0]})=0$ and $v(1-g_{[0:s:0]})=0$, so
		\begin{align*}
			(1-g_{[r:0:0]})(1-g_{[0:s:0]})p &= (1-g_{[r:0:0]})(1-g_{[0:s:0]})\cdot\frac1{N^2}\left(N^2-Nh-Nv+hv\right) \\
			&= (1-g_{[r:0:0]})(1-g_{[0:s:0]})\cdot\frac{N^2}{N^2}+0+0+0 \\
			&= (1-g_{[r:0:0]})(1-g_{[0:s:0]}),
		\end{align*}
		as required.
		\qedhere
	\end{listalph}
\end{proof}

\subsection{Homology}
In this subsection, we will study $\mathrm H_1^{\mathrm B}(X(\CC),\QQ)$. By the end, we will define a $1$-cycle $\gamma\coloneqq\gamma_N$ such that $\mathrm H_1^{\mathrm B}(X(\CC),\QQ)=\QQ[G]\cdot[\gamma]$. Morally, this means that we can understand our homology by focusing on this one cycle.

To begin, we need some path in $X(\CC)$, so we define $\delta\colon[0,1]\to X(\CC)$ by
\[\delta(t)\coloneqq\left[t^{1/N}:(1-t)^{1/N}:\zeta_{2N}^{-1}\right].\]
Notably, $\delta(0)=[0:1:\zeta_{2N}^{-1}]$ and $\delta(1)=[1:0:\zeta_{2N}^{-1}]$, so $g=[\zeta^r:\zeta^s:1]$ has $g_*\delta(0)=[0:\zeta^s:\zeta_{2N}^{-1}]$ and $g_*\delta(1)=[\zeta^r:0:\zeta_{2N}^{-1}]$. The point of this computation is that we see
\[(1-g_{[r:0:0]}-g_{[0:s:0]}+g_{[r:s:0]})_*\delta\in\mathrm Z^{\mathrm B}_1(X(\CC),\QQ).\]
We are now ready to define $\gamma$.
\begin{definition}
	Fix notation (and in particular $\delta$) as above. Then we define
	\[\gamma\coloneqq\frac1{N^2}\sum_{r,s\in\ZZ/N\ZZ}(1-g_{[r:0:0]})(1-g_{[0:s:0]})_*\delta.\]
	Note $\gamma=p_*\delta$.
\end{definition}
The above computation shows that $\gamma\in\mathrm Z^{\mathrm B}_1(X(\CC),\QQ)$. We will want to know to its periods later. Note that the following result is essentially a special case of \cite[Lemma~7.12]{deligne-hodge}.
\begin{lemma} \label{lem:gamma-periods}
	Fix notation as above. Suppose $(a,b,c)\in(\ZZ/N\ZZ)^3$ has no nonzero entries. Then
	\[\int_\gamma\omega_{(a,b,c)} = \zeta_{2N}^{[a]+[b]-N}\frac{\Gamma\left(\frac{[a]}N\right)\Gamma\left(\frac{[b]}N\right)}{\Gamma\left(\frac{[a]}N+\frac{[b]}N\right)}.\]
\end{lemma}
\begin{proof}
	This is a direct computation. Denote the integral by $P(\gamma,\omega_{(a,b,c)})$. By adjunction, $\int_{p_*\delta}\omega_{(a,b,c)}=\int_\delta p^*\omega_{(a,b,c)}$. This allows us to compute
	\begin{align*}
		P(\gamma,\omega_{(a,b,c)}) &= \frac1{N^2}\int_\delta\sum_{r,s\in\ZZ/N\ZZ}(1-g_{[r:0:0]})(1-g_{[0:s:0]})^*\omega_{(a,b,c)} \\
		&= \frac1{N^2}\int_\delta\sum_{r,s\in\ZZ/N\ZZ}\left(1-\zeta^{ar}\right)\left(1-\zeta^{bs}\right)\omega_{(a,b,c)} \\
		&= \Bigg(\frac1{N^2}\sum_{r,s\in\ZZ/N\ZZ}\left(1-\zeta^{ar}\right)\left(1-\zeta^{bs}\right)\Bigg)\int_\delta\omega_{(a,b,c)} \\
		&= \Bigg(\frac1{N^2}\sum_{r,s\in\ZZ/N\ZZ}\left(1-\zeta^{ar}\right)\left(1-\zeta^{bs}\right)\Bigg)\zeta_{2N}^{[a]+[b]-N}\int_0^1t^{[a]/N}(1-t)^{[b]/N-1}\,\frac{dt}t.
	\end{align*}
	The last integral (famously) equals the Beta function, and it evaluates to $\Gamma\left(\frac{[a]}N\right)\Gamma\left(\frac{[b]}N\right)\Gamma\left(\frac{[a]+[b]}N\right)^{-1}$. We take a moment to check that
	\[\sum_{r,s\in\ZZ/N\ZZ}\left(1-\zeta^{ar}\right)\left(1-\zeta^{bs}\right)\stackrel?=N^2.\]
	Well, $\left(1-\zeta^{ar}\right)\left(1-\zeta^{bs}\right)=1-\zeta^{ar}-\zeta^{bs}+\zeta^{ar+bs}$, and because $a,b\ne0$, we see that summing over $r$ and $s$ causes the terms not equal to $1$ to vanish. Thus, we are left with $N^2$.
\end{proof}
\begin{remark} \label{rem:nonzero-form-period}
	Because the right-hand side is nonzero, \Cref{lem:gamma-periods} implies that the differential forms $\omega_{(a,b,c)}$ are nonzero.
\end{remark}
\begin{remark} \label{rem:coleman-periods}
	Following \Cref{rem:coleman-differentials}, it will be helpful to also compute $\int_\gamma\nu_{(a,b,c)}$. We claim that
	\[\int_\gamma\nu_{(a,b,c)}\stackrel?=(-1)^{\floor{([a]+[b])/N}}\zeta_{2N}^{[a]+[b]-N}\Gamma\left(\frac{[a]}N\right)\Gamma\left(\frac{[b]}N\right)\Gamma\left(\frac{[a+b]}N\right)^{-1}.\]
	We have two cases. If $[a]+[b]<N$, then $\nu_{(a,b,c)}=\omega_{(a,b,c)}$, so this is immediate from \Cref{lem:gamma-periods}. Otherwise, if $[a]+[b]>N$, then $\nu_{(a,b,c)}=\frac{N-[a]-[b]}{N}\omega_{(a,b,c)}$, so this follows from \Cref{lem:gamma-periods} as soon as we compute
	\[\frac{N-[a]-[b]}{N}\Gamma\left(\frac{[a]+[b]}N\right)^{-1}\stackrel?=-\Gamma\left(\frac{[a+b]}N\right)^{-1}.\]
	This follows because $\Gamma\left(\frac{[a]+[b]}N\right)=\frac{[a]+[b]-N}N\Gamma\left(\frac{[a+b]}N\right)$.
\end{remark}
We are now ready to show that $\mathrm H_1^{\mathrm B}(X(\CC),\QQ)=\QQ[G]\cdot[\gamma]$.
\begin{lemma}
	Fix notation as above. Then $\mathrm H_1^{\mathrm B}(X(\CC),\QQ)=\QQ[G]\cdot[\gamma]$.
\end{lemma}
\begin{proof}
	It is enough to show that $\mathrm H_1^{\mathrm B}(X(\CC),\CC)=\CC[G]\cdot[\gamma]$. Note that there is a canonical pairing
	\[\arraycolsep=1.4pt\begin{array}{ccc}
		\mathrm H_1^{\mathrm B}(X(\CC),\CC) \times \mathrm H^1_{\mathrm{dR}}(X(\CC),\CC) &\to& \CC \\
		(c,\omega) &\mapsto& \int_c\omega
	\end{array}\]
	which is perfect by the de~Rham theorem. We already have a basis $\{\omega_{(a,b,c)}\}_{a,b,c\ne0}$ of $\mathrm H^1_{\mathrm{dR}}(X(\CC),\CC)$, so we will find a dual basis for $\mathrm H_1^{\mathrm B}(X(\CC),\CC)$ inside $\CC[G]\cdot[\gamma]$. Well, for $g\in G$ and $\alpha\in\widehat G$, we see
	\[\int_{g^*\gamma}\omega_\alpha=\int_{\gamma}g^*\omega_\alpha\]
	equals $\alpha(g)P(\gamma,\omega_\alpha)$, where $P(\gamma,\omega_\alpha)\coloneqq\int_\gamma\omega_\alpha$ is the (nonzero!) period computed in \Cref{lem:gamma-periods}. With this in mind, we define
	\[c_\alpha\coloneqq\frac1{N^2P(\gamma,\omega_\alpha)}\sum_{g\in G}\alpha(g)^{-1}g^*[\gamma]\]
	for each $\alpha=\alpha_{(a,b,c)}$ with $a,b,c\ne0$. Then we see that $\int_{c_\alpha}\omega_\beta=1_{\alpha=\beta}$ by the orthogonality relations, so $\{c_\alpha\}$ is a dual basis of $\mathrm H_1^{\mathrm B}(X(\CC),\CC)$, and it lives in $\CC[G]\cdot[\gamma]$ by its construction.
\end{proof}

\section{Galois Action} \label{sec:fermat-galois-action}
We now use the notation set up in the previous section to write out the Galois action on the space of some absolute Hodge cycles attached to $X$. Roughly speaking, we will be interested in computing $\ell$-adic monodromy groups of (quotients of) $X$, which requires us to have some understanding of the Galois representation
\[\rho\colon\op{Gal}(\ov\QQ/\QQ)\to\op{GL}\left(\mathrm H^1_{\mathrm{\acute et}}(X_{\ov\QQ},\QQ_\ell)\right).\]
In particular, we recall from \cref{subsec:compute-gl-from-gl0} that it will really suffice to be able to compute the Galois action on cetain Tate classes living in
\[\mathrm H^1_{\mathrm{\acute et}}(X_{\ov\QQ},\QQ_\ell)^{\otimes p}\otimes\mathrm H^1_{\mathrm{\acute et}}(X_{\ov\QQ},\QQ_\ell)^{\lor\otimes p}\cong\mathrm H^1_{\mathrm{\acute et}}(X_{\ov\QQ},\QQ_\ell)^{\otimes2p}(p),\]
for some nonnegative index $p\ge0$, which is the main point of this section. In particular, the K\"unneth theorem tells us that we will be interested in the cohomology group $\mathrm H^{2p}_{\mathrm{\acute et}}(X^{2p}_{\ov\QQ},\QQ_\ell)(p)$.

Roughly speaking, the outline will be to pass to absolute Hodge cycles. Indeed, by the Mumford--Tate conjecture, one is able to correspond Tate classes to Hodge classes, and Hodge classes are known to be absolutely Hodge, and our construction of absolute Hodge cycles makes it clear how they should specialize to a Tate class. In this way, we find that we can attempt to compute Galois action on Tate classes by instead computing Galois action on absolute Hodge classes. This is useful because absolute Hodge cycles have a de Rham component, so we can run our computations on the de Rham component, which is the only place where we can hope to have a basis.

Throughout this section, $p$ is a nonnegative index. We take a moment to note that the action of $G$ on $X$ upgrades into an action of $G^{2p}$ on $X^{2p}$. Our exposition closely follows \cite[Subsection~8.5]{ggl-fermat}. As in \cref{subsec:fermat-group-action}, we will identify $\widehat G^{2p}$ with some subset of tuples in $(\ZZ/N\ZZ)^{6p}$. And for a vector space $\mathrm H$ defined over $\QQ(\zeta)$ (respectively, $\QQ$) and character $\alpha\in\widehat G^{2p}$, we define $\mathrm H_\alpha$ (respectively, $\mathrm H_{[\alpha]}$) as the corresponding $\alpha$-eigenspace (respectively, $[\alpha]$-generalized eigenspace). Then given a vector $v\in\mathrm H$, we may also write $v_\alpha$ for the component in $\mathrm H_\alpha$.

In the sequel, we will find utility out of the following two subsets of $\widehat G^{2p}$.
\begin{definition}
	Fix notation as above.
	\begin{itemize}
		\item We define the subset $\mf A^{2p}$ to be equal to the subset of $\alpha\in\widehat G^{2p}$ having nonzero entries as a tuple in $(\ZZ/N\ZZ)^{6p}$.
		\item We define the subset $\mf B^{2p}$ to be equal to the subset of $\alpha\in\mf A^{2p}$ such that $\alpha=(a_1,\ldots,a_{6p})$ satisfies
		\[\frac1N\sum_{i=1}^{6p}[ua_i]=3p\]
		for all $u\in(\ZZ/N\ZZ)^\times$.
	\end{itemize}
\end{definition}
Morally, the characters in $\mf A_{2p}$ correspond to basis vectors of $\mathrm H^1_{\mathrm{\acute et}}(X_{\ov\QQ},\QQ_\ell)^{\otimes p}$, and the characters in $\mc B_{2p}$ correspond to Hodge classes (see \Cref{prop:find-hodge-classes}).

\subsection{Hodge Cycles on \texorpdfstring{$X^{2p}$}{ X2p}} \label{subsec:classes-on-fermat-curve-power}
To understand the geometry of $X$, we will only be interested in tensor powers of $\mathrm H^1(X)$ (for a choice of cohomology theory $\mathrm H$), which by the K\"unneth formula embed as
\[\mathrm H^1(X)^{\otimes 2p}\subseteq\mathrm H^{2p}\left(X^{2p}\right).\]
When $\mathrm H$ is de Rham cohomology $\mathrm H_{\mathrm{dR}}$, we thus see we are interested in when the image of an element in $\mathrm H^1_{\mathrm{dR}}(X)^{\otimes p}$ succeeds at being a Hodge cycle. Well, note that the action of $G$ on $\mathrm H^1_{\mathrm{dR}}(X,\CC)$ extends to an action of $G^{2p}$ on $\mathrm H^1_{\mathrm{dR}}\left(X,\CC\right)^{\otimes2p}$. This action diagonalizes with one-dimensional eigenspaces by extending \Cref{rem:diagonalize-de-rham}. We will use properties of the diagonalization to read off when we have an element of bidegree $(p,p)$ in $\mathrm H^{2p}_{\mathrm{dR}}\left(X^{2p},\CC\right)$.

Following \cite[Proposition~7.6]{deligne-hodge}, it will be useful to have the following definition.
\begin{definition}[weight]
	Given a function $f\colon\ZZ/N\ZZ\to\CC$, we define its \textit{weight map} as the function $\langle f\rangle\colon(\ZZ/N\ZZ)^\times\to\CC$ defined by
	\[\langle f\rangle(u)\coloneqq\frac1N\sum_{a\in\ZZ/N\ZZ}f(ua)[a]\]
	For $p\ge0$, we note that we may identify $\widehat G^{2p}$ with a tuple in $(\ZZ/m\ZZ)^{2p}$, and then we define the \textit{weight} $\langle\alpha\rangle$ of a character $\alpha\in\widehat G^{2p}$ as $\langle1_\alpha\rangle(1)$, where $1_\alpha\colon\ZZ/N\ZZ\to\ZZ$ is the multiplicity of an element in $\ZZ/N\ZZ$ in the tuple $\alpha$. 
\end{definition}
\begin{remark} \label{rem:deg-by-weight-curve}
	The point of this definition is as follows: given $\alpha\in\widehat G$ with $\alpha=(a,b,c)$ having nonzero entries, we note that $\omega_{\alpha}$ has two possible cases.
	\begin{itemize}
		\item If $[a]+[b]+[c]=N$ so that $\langle\alpha\rangle=1$, then $\omega_{(a,b,c)}$ is holomorphic so that $\omega_{\alpha}\in\mathrm H^{10}(X)$.
		\item If $[a]+[b]+[c]=2N$ so that $\langle\alpha\rangle=2$, then $\omega_{\alpha}$ is not holomorphic so that $\omega_{\alpha}\in\mathrm H^{01}(X)$.
	\end{itemize}
	In all cases, we find $\omega_{\alpha}\in\mathrm H^{2-\langle\alpha\rangle,\langle\alpha\rangle-1}(X)$.
\end{remark}
\begin{remark}
	If $f$ is instead a function $f\colon\frac1N\ZZ/\ZZ\to\CC$, we may similarly define the weight by the formula
	\[\langle f\rangle(u)\coloneqq\sum_{a\in\frac1N\ZZ/\ZZ}f(ua)\langle a\rangle,\]
	where $\langle a\rangle$ now refers to the element in $[0,1)$ in the class of $a$.
\end{remark}
\begin{remark} \label{rem:a-2p-const-weight-is-b-2p}
	Suppose that $\alpha\in\mf A^{2p}$ has $1_\alpha$ of constant weight. Then we claim that $\langle\alpha\rangle=3p$. Indeed, we must have
	\[\frac1N\sum_{i=1}^{6p}[a_i]=\frac1N\sum_{i=1}^{6p}[-a_i],\]
	but $[-a_i]=N-a_i$ then forces the sum to equal $3p$.
\end{remark}
We now upgrade \Cref{rem:deg-by-weight-curve} to $\mathrm H^1_{\mathrm{dR}}(X,\CC)^{\otimes2p}$.
\begin{notation}
	Choose $\alpha\in\widehat G^{2p}$ as $\alpha=(\alpha_1,\ldots,\alpha_{2p})$ having nonzero entries. Then we set
	\[\omega_{\alpha}\coloneqq\omega_{\alpha_1}\otimes\cdots\otimes\omega_{\alpha_{2p}}.\]
	We define $\nu_\alpha$ similarly.
\end{notation}
\begin{lemma} \label{lem:deg-by-weight-curve-power}
	Choose $\alpha\in\widehat G^{2p}$ as $\alpha=(\alpha_1,\ldots,\alpha_{2p})$ having nonzero entries (i.e., $\alpha\in\mf A_{2p}$). Then $\omega_\alpha$ embedded in $\mathrm H^{2p}_{\mathrm{dR}}\left(X^{2p},\CC\right)$ is of bidegree $(4p-\langle\alpha\rangle,\langle\alpha\rangle-2p)$.
\end{lemma}
\begin{proof}
	Because the K\"unneth isomorphism upgrades to an isomorphism of Hodge structures, it is enough to note that $\omega_{\alpha_i}\in\mathrm H^{2-\langle\alpha_i\rangle,\langle\alpha_i\rangle-1}$ (see \Cref{rem:deg-by-weight-curve}) implies $\omega_\alpha$ has bidegree
	\[\Bigg(4p-\sum_{i=1}^{2p}\langle\alpha_i\rangle,\sum_{i=1}^{2p}\langle\alpha_i\rangle-2p\Bigg).\]
	The lemma follows because weight is additive.
\end{proof}
\begin{proposition} \label{prop:find-hodge-classes}
	Choose $\alpha\in\mf A^{2p}$. Then $\mathrm H_{\mathrm B}^{2p}\left(X^{2p}\right)_{[\alpha]}$ is one-dimensional over $\QQ([\alpha])$, and the following are equivalent.
	\begin{listalph}
		% \item $\mathrm H_{\mathrm B}^{2p}\left(X^{2p}\right)_{[\alpha]}$ has any nonzero Hodge classes.
		\item $\mathrm H_{\mathrm B}^{2p}\left(X^{2p}\right)_{[\alpha]}(p)$ consists entirely of Hodge classes.
		\item We have $\langle u\alpha\rangle=3p$ for all $u\in(\ZZ/N\ZZ)^\times$.
	\end{listalph}
\end{proposition}
\begin{proof}
	Expand $\alpha=(\alpha_1,\ldots,\alpha_{2p})$. We begin by embedding
	\[\mathrm H_{\mathrm B}^{2p}\left(X^{2p},\QQ\right)_{[\alpha]}\otimes_\QQ\CC=\bigoplus_{u\in(\ZZ/N\ZZ)^\times}\mathrm H_{\mathrm B}^{2p}\left(X^{2p},\CC\right)_{u\alpha}\]
	into
	\[\mathrm H_{\mathrm{dR}}^{2p}\left(X^{2p},\CC\right)=\bigoplus_{\substack{q_1,\ldots,q_{2p}\\q_1+\cdots+q_{2p}=2p}}\mathrm H_{\mathrm{dR}}^{q_1}(X,\CC)\otimes\cdots\otimes\mathrm H_{\mathrm{dR}}^{q_{2p}}(X,\CC),\]
	where this last equality holds by the K\"unneth isomorphism. Quickly, we reduce to the case where $q_1=\cdots=q_{2p}=1$: for each $u\in(\ZZ/N\ZZ)^\times$, we note that $u\alpha$ has nonzero entries. On the other hand, the $G$-action on $\mathrm H^0(X)=\CC$ is always trivial, so we note that if any of the $q_\bullet$s are not equal to $1$, then one of them must equal $0$, meaning that
	\[\left(\mathrm H_{\mathrm{dR}}^{q_1}(X,\CC)\otimes\cdots\otimes\mathrm H_{\mathrm{dR}}^{q_{2p}}(X,\CC)\right)_{u\alpha}=\mathrm H_{\mathrm{dR}}^{q_1}(X,\CC)_{u\alpha_1}\otimes\cdots\otimes\mathrm H_{\mathrm{dR}}^{q_{2p}}(X,\CC)_{u\alpha_{2p}}\]
	is the zero vector space. Thus, we see that
	\[\mathrm H^{2p}_{\mathrm{dR}}\left(X^{2p},\CC\right)_{[\alpha]}=\bigoplus_{u\in(\ZZ/N\ZZ)^\times}\left(\mathrm H^1_{\mathrm{dR}}(X,\CC)^{\otimes2p}\right)_{u\alpha}.\]
	The comparison isomorphism now implies that $\mathrm H_{\mathrm B}^{2p}\left(X^{2p},\QQ\right)_{[\alpha]}$ has dimension $[\QQ([\alpha]):\QQ]$ over $\QQ$ and thus one dimension over $\QQ([\alpha])$.
	
	It remains to show that (a) and (b) are equivalent. Well, the $\QQ$-vector space $\mathrm H_{\mathrm B}^{2p}\left(X^{2p},\QQ\right)_{[\alpha]}(p)$ will consist of Hodge classes if and only if $\left(\mathrm H^1_{\mathrm{dR}}(X,\CC)^{\otimes2p}\right)_{u\alpha}$ is of bidegree $(p,p)$, which is equivalent to $\langle u\alpha\rangle=3p$ by \Cref{lem:deg-by-weight-curve-power}.
\end{proof}

\subsection{An Absolute Hodge Cycle}
Thus far, we have access to classes $\omega_\alpha$, and we know how to compute their periods against the Betti cycle $\gamma$. We will be able to compute the Galois action on $\gamma$ because it already comes from a Betti cycle, but we then need to know how to translate this into a Galois action on the $\omega_\alpha$; importantly, note that $\omega_\alpha$s have no obvious Galois action, and indeed, they cannot because they may not even be defined over a number field. To do this, we need a way to put $\gamma$ and the $\omega_\alpha$ on the same footing; following \cite[Section~8.5]{ggl-fermat}, we use absolute Hodge classes.

For example, the machinery of cohomology tells us how to take $\gamma$ and then apply some cycle class maps to produce an absolute Hodge class. Let's be more explicit: we may pass the class $\gamma^{2p}\otimes(2\pi i)^{-p}$ through the maps
\[\mathrm H^{\mathrm B}_{2p}\left(X^{2p},\CC\right)(-p)\cong\mathrm H^{2p}_{\mathrm B}\left(X^{2p},\CC\right)(p)\subseteq\mathrm H^{2p}_\AA(X)(p),\]
where the last map is the cycle class map. In order to ensure that we output an absolute Hodge cycle, we apply \Cref{prop:find-hodge-classes}: we see that the generalized eigenspace for $[\alpha]$ contains all Hodge classes if and only if $\alpha\in\mf B^{2p}$, we simply define $\gamma^{2p}_{[\alpha]}\in\mathrm H^{\mathrm B}_{2p}\left(X^{2p},\QQ\right)$ to be the projection to the $[\alpha]$-component, and we now know that its image $\gamma^{2p}_{[\alpha],\mathrm{AH}}$ is a Hodge class, hence an absolute Hodge class by \Cref{thm:hodge-to-abs-hodge}.
\begin{remark} \label{rem:fermat-lift-hodge-to-abs-hodge}
	We remark that this last paragraph actually argues that the projection
	\[C^p_{\mathrm{AH}}(X)_{[\alpha]}\onto\mathrm H^{2p}_{\mathrm{dR}}\left(X^{2p},\CC\right)(p)_{[\alpha]}\]
	is an isomorphism for any $\alpha\in\mf B^{2p}$. In particular, both spaces are $1$-dimensional vector spaces over $\QQ([\alpha])$. %In this way, we can take any Hodge class $\omega_\alpha$ where $\alpha\in\mf B^{2P}$ (see \Cref{prop:find-hodge-classes}) and lift it to an absolute Hodge class $\omega_{\alpha,\mathrm{AH}}\in\mathrm H^{2p}_\AA\left(X^{2p}\right)(p)$.
\end{remark}
Perhaps we should check that $\gamma_{[\alpha],\mathrm{AH}}^{2p}$ is nonzero. Roughly speaking, we expect this to hold by the period computations of \Cref{lem:gamma-periods}.
\begin{proposition} \label{prop:fermat-abs-hodge-in-hodge-basis}
	Choose $\alpha\in\mf B^{2p}$. Then
	\[\pi_\infty\left(\gamma_{[\alpha],\mathrm{AH}}^{2p}\right)=\sum_{\substack{\beta\in[\alpha]\\\beta=(a_1,b_1,c_1,\ldots,a_{2p},b_{2p},c_{2p})}}\Bigg((2\pi i)^{-p}\prod_{i=1}^{2p}\frac{N-[a_i]-[b_i]}{N}\int_{\gamma}\omega_{(-a_i,-b_i,-c_i)}\Bigg)\omega_{\beta}.\]
	% where $\omega_{\beta,\mathrm{AH}}$ is the absolute Hodge class discussed in \Cref{rem:fermat-lift-hodge-to-abs-hodge}.
\end{proposition}
\begin{proof}
	We know that the $\omega_{\beta}$ form an eigenbasis of $\mathrm H^{2p}_{\mathrm{dR}}\left(X^{2p},\CC\right)(p)_{[\alpha]}$ by restricting \Cref{rem:diagonalize-de-rham} to the $[\alpha]$-generalized eigenspace. Thus, we know that $\pi_\infty(\gamma_{[\alpha],\mathrm{AH}})$ is certainly a linear combination of the $\omega_\beta$s, so we write
	\[\pi_\infty\left(\gamma_{[\alpha],\mathrm{AH}}^{2p}\right)=\sum_{\beta\in[\alpha]}z_\beta\omega_\beta,\]
	and it remains to compute the coefficients $z_\beta$. For this, we use the computation of the Poincar\'e pairing computation from \Cref{lem:fermat-poincare-pairing} (iterated $2p$ times), whereupon we see that
	\[P\left(\pi_\infty\left(\gamma_{[\alpha],\mathrm{AH}}^{2p}\right),\omega_{-\beta}\right)=z_\beta\prod_{i=1}^{2p}(-1)^N\frac N{N-[a_i]-[b_i]},\]
	where $\beta=(a_1,b_1,c_1,\ldots,a_{2p},b_{2p},c_{2p})$. Thus, to get the correct answer for $z_\beta$, we would like to show that
	\[P\left(\pi_\infty\left(\gamma_{[\alpha],\mathrm{AH}}^{2p}\right),\omega_{-\beta}\right)\stackrel?=(2\pi i)^{-p}\int_\gamma\omega_{-\beta}.\]
	(Note that the sign has disappeared because $(-1)^{N\cdot2p}=1$.) To compute this Poincar\'e pairing, we would like to remember that $\gamma_{[\alpha],\mathrm{AH}}$ comes from a Betti class. As such, we remark that the composite
	\[\mathrm H^{\mathrm B}_{2p}\left(X^{2p},\CC\right)(-p)\cong\mathrm H_{\mathrm B}^{2p}\left(X^{2p},\CC\right)(p)\subseteq\mathrm H^{2p}_\AA\left(X^{2p}\right)(p)\onto\mathrm H^{2p}_{\mathrm{dR}}\left(X^{2p},\CC\right)\]
	is just the usual cycle class map from Betti to de Rham cohomology. Thus, we see that the Poincar\'e pairing with $\gamma_{[\alpha],\mathrm{AH}}^{2p}$ may be computed as the integration pairing
	\[P\left(\pi_\infty\left(\gamma_{[\alpha],\mathrm{AH}}^{2p}\right),\omega_{-\beta}\right)=(2\pi i)^{-p}\int_{\gamma_{[\alpha]}^{2p}}\omega_{-\beta}.\]
	To complete the proof, we note that we may pass from integrating over $\gamma_{[\alpha]}^{2p}$ to $\gamma^{2p}$ because the adjunctive property of the integration pairing allows us to pass the projection onto the $[\alpha]$-component to $-\beta$, but $\omega_{-\beta}$ already lives in the $[\alpha]$-generalized eigenspace.
\end{proof}
Thus, we see that $\gamma_{[\alpha],\mathrm{AH}}$ is nonzero because we have found nonzero coefficients: the integrals are nonzero by \Cref{lem:gamma-periods}. While we're here, we translate this into a statement with $\nu_\bullet$s.
\begin{corollary} \label{cor:fermat-abs-hodge-to-coleman-hodge}
	Choose $\alpha\in\mf B^{2p}$. Then
	\[\pi_\infty\left(\gamma_{[\alpha],\mathrm{AH}}^{2p}\right)=\sum_{\substack{\beta\in[\alpha]\\\beta=(a_1,b_1,c_1,\ldots,a_{2p},b_{2p},c_{2p})}}\Bigg((2\pi i)^{-p}\prod_{i=1}^{2p}\int_{\gamma}\nu_{(-a_i,-b_i,-c_i)}\Bigg)\nu_{\beta}.\]
\end{corollary}
\begin{proof}
	The same proof as in \Cref{prop:fermat-abs-hodge-in-hodge-basis} applies when combined with \Cref{rem:coleman-differentials-dual}.
	% shows
	% \[\pi_\infty\left(\gamma_{[\alpha],\mathrm{AH}}^{2p}\right)=\sum_{\substack{\beta\in[\alpha]\\\beta=(a_1,b_1,c_1,\ldots,a_{2p},b_{2p},c_{2p})}}\Bigg((2\pi i)^{-p}\prod_{i=1}^{2p}\int_{\gamma}\nu_{(-a_i,-b_i,-c_i)}\Bigg)\nu_{\beta}.\]
	% It remains to compute the integrals, which \Cref{rem:coleman-periods} tells us yields
	% \[\prod_{i=1}^{2p}(-1)^{\floor{([-a_i]+[-b_i])/N}}\zeta_{2N}^{[-a_i]+[-b_i]-N}\Gamma\left(\frac{[-a_i]}N\right)\Gamma\left(\frac{[-b_i]}N\right)\Gamma\left(\frac{[c_i]}N\right)^{-1}\]
	% The statement now follows once we remark that $\floor{\frac{[-a_i]+[-b_i]}N}\in\{0,1\}$ equals $0$ exactly $p$ times and equals $1$ exactly $p$ times because $\alpha\in\mf B^{2p}$.
\end{proof}
\begin{remark}
	Following \Cref{rem:coleman-differentials-dual}, it will be computationally helpful to rewrite our formula in terms of the $\nu_\bullet$s because this will make the mysterious rational constant disappear.
\end{remark}
% \begin{remark}
% 	One can move the $\Gamma$s entirely into the numerator with only minor cost. Indeed, the reflection formula yields
% 	\[\Gamma\left(\frac{[c_i]}N\right)\Gamma\left(\frac{[-c_i]}N\right)=\frac{2\pi i}{\zeta_{2N}^{[-c_i]}-\zeta_{2N}^{-[-c_i]}}.\]
% 	Now, noting that $\zeta_{2N}^{[-a_i]+[-b_i]+[-c_i]-N}(-1)^{\floor{([-a_i]+[-b_i])/N}}$, we see that the extra sign will also disappear, leaving us with
% 	\[(2\pi i)^p\prod_{i=1}^{2p}\]
% \end{remark}
In order to hide these integrals for now, we introduce the following notation.
\begin{notation}
	For $\alpha\in\mf B^{2p}$ such that $\alpha=(\alpha_1,\ldots,\alpha_{2p})$, we define
	\[\op{Per}\left(\gamma^{2p},\nu_{\alpha}\right)\coloneqq(2\pi i)^{-p}\prod_{i=1}^{2p}\int_\gamma\nu_{\alpha_i}.\]
	Note that this number is algebraic by \Cref{prop:find-hodge-classes} because it is the integral of a differential against an absolute Hodge class. (See the end of the proof of \Cref{prop:fermat-abs-hodge-in-hodge-basis}.)
\end{notation}
\begin{remark} \label{rem:iterated-coleman-period}
	In order to compute these integrals, we note \Cref{rem:coleman-periods} grants the product of the integrals equals
	\[\prod_{i=1}^{2p}(-1)^{\floor{([a_i]+[b_i])/N}}\zeta_{2N}^{[a_i]+[b_i]-N}\Gamma\left(\frac{[a_i]}N\right)\Gamma\left(\frac{[b_i]}N\right)\Gamma\left(\frac{[-c_i]}N\right)^{-1}.\]
	We quickly note that $\floor{\frac{[a_i]+[b_i]}N}\in\{0,1\}$ equals $0$ exactly $p$ times and equals $1$ exactly $p$ times because $\alpha\in\mf B^{2p}$; additionally, $\zeta_{2N}^{-N\cdot2p}=1$, so that power vanishes. Thus, our period equals
	\[(-2\pi i)^{-p}\prod_{i=1}^{2p}\zeta_{2N}^{[a_i]+[b_i]}\frac{\Gamma\left(\frac{[a_i]}N\right)\Gamma\left(\frac{[b_i]}N\right)}{\Gamma\left(\frac{[-c_i]}N\right)}.\]
\end{remark}
We will also want to express the $\nu_\bullet$s in terms of $\gamma$.
\begin{corollary} \label{cor:fermat-hodge-basis-by-abs-hodge}
	Choose $\alpha\in\mf B^{2p}$. For any $\beta\in[\alpha]$, we have
	\[\nu_{\beta}=\frac1{\#G^{2p}(\ov\QQ)\op{Per}\left(\gamma^{2p},\nu_{-\alpha}\right)}\sum_{g\in G^{2p}(\ov\QQ)}\beta(g)^{-1}\cdot\pi_\infty\left(g^*\gamma^{2p}_{[\alpha],\mathrm{AH}}\right).\]
\end{corollary}
\begin{proof}
	By the orthogonality of characters applied to \Cref{cor:fermat-abs-hodge-to-coleman-hodge}, we find that
	\[\frac1{\#G^{2p}(\ov\QQ)}\sum_{g\in G^{2p}(\ov\QQ)}\beta(g)^{-1}\cdot \pi_\infty\left(g^*\gamma^{2p}_{[\alpha],\mathrm{AH}}\right)=\op{Per}\left(\gamma^{2p},\nu_{-\alpha}\right)\nu_{\beta,\mathrm{AH}},\]
	so the result follows.
\end{proof}

% Thus, \Cref{prop:find-hodge-classes} upgrades to assert that $\gamma_{[\alpha]}^{\mathrm{AH}}$ is a basis of the one-dimensional vector space $\mathrm H^{2p}_\AA\left(X^{2p},\CC\right)(p)_{[\alpha]}$ over $\QQ([\alpha])$. In particular, $\gamma_{[\alpha]}^{\mathrm{AH}}$

\subsection{Computation of the Galois Action}
In this subsection, we compute the Galois action on our absolute Hodge cycles.
To ground ourselves, we begin by noting that we are expecting a permutation matrix.
\begin{lemma}
	Choose $\alpha\in\mf A^{2p}$ and a prime $\ell$ such that $\ell\equiv1\pmod N$. Given $\sigma\in\op{Gal}(\ov\QQ/\QQ)$ such that $\sigma(\zeta_N)=\zeta_N^u$ for some $u\in(\ZZ/N\ZZ)^\times$, we find that $\sigma$ maps
	\[\mathrm H^{2p}_{\mathrm{\acute et}}\left(X_{\ov\QQ}^{2p},\QQ_\ell\right)_\alpha\to\mathrm H^{2p}_{\mathrm{\acute et}}\left(X_{\ov\QQ}^{2p},\QQ_\ell\right)_{u^{-1}\alpha}.\]
\end{lemma}
\begin{proof}
	Choose $v\in \mathrm H^{2p}_{\mathrm{\acute et}}\left(X_{\ov\QQ}^{2p},\QQ_\ell\right)_\alpha$. Then for any $g\in G^{2p}(\QQ_\ell)$, we find that
	\[\sigma(g\cdot v)=\sigma(g)\cdot\sigma(v)\]
	because the action of $G^{2p}$ is defined over $\QQ$ and hence Galois-invariant. Rearranging, we see that
	\begin{align*}
		g\cdot\sigma(v) &= \sigma\left(\sigma^{-1}(g)\right)\cdot\sigma(v) \\
		&= \sigma\left(\sigma^{-1}(g)\cdot v\right) \\
		&= \sigma\left(\alpha\left(\sigma^{-1}(g)\right)\cdot v\right) \\
		&= \alpha\left(\sigma^{-1}(g)\right)\sigma(v),
	\end{align*}
	where the last equality holds because the Galois action is $\QQ_\ell$-linear. A direct computation then shows $\alpha\left(\sigma^{-1}(g)\right)=\sigma^{-1}(\alpha(g))$ and then $\sigma^{-1}(\alpha(g))=\left(u^{-1}\alpha\right)(g)$.
\end{proof}
We now move towards the computation of the Galois action on absolute Hodge classes. This requires a warning. Our computation will be able to succeed by using de~Rham classes as representatives for absolute Hodge classes. However, de~Rham classes have no Galois action: only absolute Hodge classes have Galois action (through the $\ell$-adic components). The key to keeping track of the differences between these elements is to keep track of our base-changes. In particular, for any prime $\ell$, we may specify an embedding $\iota\colon\QQ_\ell\into\CC$ and note the ``comparison'' isomorphisms
\begin{align*}
	\mathrm H^{2p}_{\mathrm{dR}}(X,\CC)(p)_{[\alpha]} &= C^p_{\mathrm{AH}}\left(X^{2p}_{\ov\QQ}\right)_{[\alpha]}\otimes_\QQ\CC \\
	&= C^p_{\mathrm{AH}}\left(X^{2p}_{\ov\QQ}\right)_{[\alpha]}\otimes_\QQ\QQ_\ell\otimes_\iota\CC \\
	&= \mathrm H^{2p}_{\mathrm{\acute et}}\left(X^{2p}_{\ov\QQ},\QQ_\ell\right)(p)_{[\alpha]}\otimes_\iota\CC,
\end{align*}
where the last isomorphism is given by the Betti-to-\'etale comparison isomorphism. (We remark that these identifications are all $G^{2p}$-invariant.) For example, in the sequel, we may write bizzarre things such as
\[\gamma^{2p}_{[\alpha],\mathrm{AH}}\otimes1\in C^p_{\mathrm{AH}}\left(X^{2p}_{\ov\QQ}\right)\otimes_\QQ\ov\QQ\qquad\text{or}\qquad\nu_\alpha\otimes1\in\mathrm H^{2p}_{\mathrm{dR}}\left(X^{2p},\QQ\right)\otimes_\QQ\ov\QQ\]
and then pretend that these elements live in the same vector space.

% For the rest of this subsection, unless otherwise specified, we choose $\ell$ to be $1\pmod N$ and so that $\QQ_\ell$ contains all the periods
% \[\op{Per}\left(\gamma_{[\alpha]}^{2p},\nu_{\alpha}\right).\]
As promised in the previous section, we are able to compute the Galois action on $\gamma$. Explicitly, this amounts to the following.
\begin{lemma} \label{lem:fermat-galois-action-abs-hodge}
	Choose $\alpha\in\mf B^{2p}$.
	\begin{listalph}
		\item There is a function $\lambda\colon\op{Gal}(\ov\QQ/\QQ)\to\QQ([\alpha])^\times$ such that
		\[\sigma\left(\gamma_{[\alpha],\mathrm{AH}}^{2p}\right)=\lambda(\sigma)\gamma_{[\alpha],\mathrm{AH}}^{2p}.\]
		\item For any $\sigma\in\op{Gal}(\ov\QQ/\QQ)$ and $g\in G^{2p}(\ov\QQ)$, we have
		\[\sigma\left(g^*\gamma_{[\alpha],\mathrm{AH}}^{2p}\right)=\lambda(\sigma)\cdot\sigma(g)^*\gamma_{[\alpha],\mathrm{AH}}^{2p}.\]
		\item For any $\sigma\in\op{Gal}(\ov\QQ/\QQ)$, we compute $\iota_\alpha(\lambda(\sigma))\in\QQ(\zeta_{2N})$ as
		\[\iota_\alpha(\lambda(\sigma))=\frac{\sigma\left(\op{Per}\left(\gamma^{2p},\nu_{-\alpha}\right)\right)}{\op{Per}\left(\gamma^{2p},\nu_{-\alpha}\right)}.\]
	\end{listalph}
\end{lemma}
\begin{proof}
	Here, (a) follows because $C^{p}_{\mathrm{AH}}\left(X^{2p}\right)_{[\alpha]}$ is a one-dimensional vector space over $\QQ([\alpha])$ which is stable under the Galois action (because its Betti component is defined over $\QQ$); thus, we see that $\gamma_{[\alpha],\mathrm{AH}}^{2p}$ is a basis vector of this space, so (a) follows. Continuing, (b) follows because the action of $G^{2p}$ on $X^{2p}$ is defined over $\QQ$, implying that
	\begin{align*}
		\sigma\left(g^*\gamma_{[\alpha],\mathrm{AH}}^{2p}\right) &= \sigma(g)^*\sigma\left(\gamma_{[\alpha],\mathrm{AH}}^{2p}\right) \\
		&= \sigma(g)^*\left(\lambda(\sigma)\gamma_{[\alpha],\mathrm{AH}}^{2p}\right) \\
		&= \lambda(\sigma)\cdot\sigma(g)^*\gamma_{[\alpha],\mathrm{AH}}^{2p},
	\end{align*}
	where the last equality holds because $\sigma(g)^*$ is linear.

	Lastly, (c) will require a computation. We will work in the de~Rham component; the idea is to project onto the $\alpha$-component. Working in $C^p_{\mathrm{AH}}\left(X^{2p}\right)\otimes_\QQ\CC$, one has the equalities
	\[\left(\lambda(\sigma)\gamma^{2p}_{[\alpha],\mathrm{AH}}\otimes1\right) = \left(\sigma\gamma^{2p}_{[\alpha],\mathrm{AH}}\otimes1\right).\]
	We now project onto the $\alpha$-eigenspace; because the $G^{2p}$-action is defined over $\QQ$, the projection commutes with the Galois action, leaving us with
	\[\left(\lambda(\sigma)\gamma^{2p}_{[\alpha],\mathrm{AH}}\otimes1\right)_\alpha = \sigma\left(\gamma^{2p}_{[\alpha],\mathrm{AH}}\otimes1\right)_\alpha.\]
	On one hand, by definition of $\iota_\alpha$, we see that the left-hand side will equal $\iota_\alpha(\lambda(\sigma))\left(\gamma^{2p}_{[\alpha],\mathrm{AH}}\otimes1\right)$; then projecting onto the de~Rham component leaves us with
	\[\pi_\infty\left(\left(\lambda(\sigma)\gamma^{2p}_{[\alpha],\mathrm{AH}}\otimes1\right)_\alpha\right)=\lambda(\sigma)\op{Per}\left(\gamma^{2p},\nu_{-\alpha}\right)\nu_\alpha\]
	by \Cref{cor:fermat-abs-hodge-to-coleman-hodge}. On the other hand, for the right-hand side, we will want to project onto the de~Rham component first (which commutes with Galois action by our identifications). To complete the proof, we now run computations in $\mathrm H^{2p}_{\mathrm{dR}}\left(X^{2p},\CC\right)=\mathrm H^{2p}_{\mathrm{dR}}\left(X^{2p},\QQ\right)\otimes_\QQ\CC$, for which we use \Cref{cor:fermat-abs-hodge-to-coleman-hodge} to see
	\begin{align*}
		\pi_\infty\left(\sigma\left(\gamma^{2p}_{[\alpha],\mathrm{AH}}\otimes1\right)_\alpha\right) &= \sigma\left(\pi_\infty\left(\gamma^{2p}_{[\alpha],\mathrm{AH}}\otimes1\right)_\alpha\right) \\
		&= \sigma\left(\nu_\alpha\otimes\op{Per}\left(\gamma^{2p},\nu_{-\alpha}\right)\right) \\
		&= \sigma\left(\op{Per}\left(\gamma^{2p},\nu_{-\alpha}\right)\right)\nu_\alpha,
	\end{align*}
	where the last equality holds because the Galois action on $\mathrm H^{2p}_{\mathrm{dR}}\left(X^{2p},\QQ\right)$ is trivial. Comparing the previous two computations completes the proof.
\end{proof}
We are now ready for our main theorem.
\begin{theorem} \label{thm:fermat-galois}
	Choose $\alpha\in\mf B^{2p}$. For any $\sigma\in\op{Gal}(\ov\QQ/\QQ)$ such that $\sigma(\zeta_N)=\zeta_N^u$ for $u\in(\ZZ/N\ZZ)^\times$, we have
	\[\sigma(\nu_\alpha\otimes1)=\nu_{u^{-1}\alpha}\otimes\frac{\sigma\left(\op{Per}(\gamma^{2p},\nu_{-u^{-1}\alpha})\right)}{\op{Per}(\gamma^{2p},\nu_{-\alpha})},\]
	where this Galois action takes place in $\mathrm H^{2p}_{\mathrm{dR}}\left(X^{2p},\QQ\right)(p)_{[\alpha]}\otimes_\QQ\ov\QQ=C^p_{\mathrm{AH}}\left(X^{2p}\right)_{[\alpha]}\otimes_\QQ\ov\QQ$.
\end{theorem}
\begin{proof}
	We combine the computed Galois action in \Cref{lem:fermat-galois-action-abs-hodge} with the change-of-basis results \Cref{cor:fermat-abs-hodge-to-coleman-hodge,cor:fermat-hodge-basis-by-abs-hodge}. To begin, \Cref{cor:fermat-hodge-basis-by-abs-hodge} lets us write
	\begin{align*}
		\sigma(\nu_\alpha\otimes1) &= \sigma\Bigg(\frac1{\#G^{2p}(\ov\QQ)}\sum_{g\in G^{2p}(\ov\QQ)}g^*\gamma^{2p}_{\mathrm{AH}}\otimes\frac1{\alpha(g)\op{Per}\left(\gamma^{2p},\nu_{-\alpha}\right)}\Bigg) \\
		&= \frac1{\#G^{2p}(\ov\QQ)}\sum_{g\in G^{2p}(\ov\QQ)}\sigma\left(g^*\gamma^{2p}_{\mathrm{AH}}\otimes\frac1{\alpha(g)\op{Per}\left(\gamma^{2p},\nu_{-\alpha}\right)}\right) \\
		&= \frac1{\#G^{2p}(\ov\QQ)}\sum_{g\in G^{2p}(\ov\QQ)}\sigma\left(g^*\gamma^{2p}_{\mathrm{AH}}\right)\otimes\frac1{\alpha(g)\op{Per}\left(\gamma^{2p},\nu_{-\alpha}\right)},
	\end{align*}
	where the last equality takes place in $C^p_{\mathrm{AH}}\left(X^{2p}\right)\otimes_\QQ\ov\QQ$ so that the Galois action is happening in the left component. Continuing, \Cref{lem:fermat-galois-action-abs-hodge} tells us that
	\[\sigma\left(g^*\gamma_{[\alpha],\mathrm{AH}}^{2p}\right)=\sigma(g)\lambda(\sigma)\cdot\sigma(g)^*\gamma_{[\alpha],\mathrm{AH}}^{2p},\]
	so
	\[\sigma(\nu_\alpha\otimes1)=\frac1{\#G^{2p}(\ov\QQ)}\sum_{g\in G^{2p}(\ov\QQ)}\lambda(\sigma)\cdot\sigma(g)^*\gamma_{[\alpha],\mathrm{AH}}^{2p}\otimes\frac1{\alpha(g)\op{Per}\left(\gamma^{2p},\nu_{-\alpha}\right)}.\]
	(We will wait to evaluate $\lambda(\sigma)$ until the end because a trick is required to move it through the tensor product.) We now go back to the basis of $\nu_\bullet$s via \Cref{cor:fermat-abs-hodge-to-coleman-hodge}, writing
	\[\sigma(\nu_\alpha\otimes1)=\frac1{\#G^{2p}(\ov\QQ)}\sum_{\substack{g\in G^{2p}(\ov\QQ)\\\beta\in[\alpha]}}\lambda(\sigma)\cdot\sigma(g)^*\nu_\beta\otimes\frac{\op{Per}(\gamma^{2p},\nu_{-\beta})}{\alpha(g)\op{Per}\left(\gamma^{2p},\nu_{-\alpha}\right)}.\]
	Now, $\sigma(g)^*\nu_\beta\otimes1=\nu_\beta\otimes\beta(\sigma(g))$, where the equality is now taking place in $\mathrm H^{2p}_{\mathrm{dR}}\left(X^{2p},\QQ\right)\otimes_\QQ\ov\QQ$. Continuing, we see $\beta(\sigma(g))=\sigma(\beta(g))=\beta(g)^u$ because evaluating a character is Galois-invariant. Rearranging the sums, we now see that we can isolate the sum
	\[\frac1{\#G^{2p}(\ov\QQ)}\sum_{g\in G^{2p}(\ov\QQ)}\frac{(u\beta)(g)}{\alpha(g)},\]
	which orthogonality of characters tells us is the indicator for $\beta=u^{-1}\alpha$. Thus, we are left with
	\[\sigma(\nu_\alpha\otimes1)=\lambda(\sigma)\nu_{u^{-1}\alpha}\otimes\frac{\op{Per}(\gamma^{2p},\nu_{-u^{-1}\alpha})}{\op{Per}\left(\gamma^{2p},\nu_{-\alpha}\right)}.\]
	It remains to move $\lambda(\sigma)$ through the tensor product. Note that this is not totally trivial because the tensor product only lets us move rational numbers through. Anyway, it is enough to check the required equality in the de~Rham component, allowing us to use the proof of \Cref{lem:fermat-galois-action-abs-hodge} to note
	\[\lambda(\sigma)\nu_{u^{-1}\alpha}\otimes \op{Per}\left(\gamma^{2p},\nu_{-u^{-1}\alpha}\right)=\nu_{u^{-1}\alpha}\otimes \sigma\left(\op{Per}\left(\gamma^{2p},\nu_{-u^{-1}\alpha}\right)\right),\]
	from which the required result follows after some rearranging.
	% Anyway, it is enough to check the required equality in some $\ell$-adic component, so we choose $\ell$ so that $\QQ_\ell$ has $\zeta_N$ and all periods in sight; by adding enough transcednece degree (and maybe more algebraic elements), we may assume that $\nu_\alpha$ and $\nu_{u^{-1}\alpha}$ are defined over $\QQ_\ell$. Then choosing an embedding $\iota\colon\QQ_\ell\into\CC$ produces an identification
	% \[C^p_{\mathrm{AH}}\left(X^{2p}\right)\otimes_\QQ\QQ_\ell\otimes_\iota\CC\cong\mathrm H^{2p}\left(X^{2p}_{\ov\QQ},\QQ_\ell\right)(p)\otimes_\iota\CC,\]
	% and now we can run all of our computations with coefficients in $\QQ_\ell$. Because $\lambda(\sigma)$ now lives in $\QQ_\ell$, we are now allowed to move it through the tensor product, letting us conclude that
	% \[\sigma(\nu_\alpha\otimes1)=\lambda(\sigma)\nu_{u^{-1}\alpha}\otimes\frac{\op{Per}(\gamma^{2p},\nu_{-u^{-1}\alpha})}{\op{Per}\left(\gamma^{2p},\nu_{-\alpha}\right)}\cdot\nu_{u^{-1}\alpha}.\]
	% The result now follows from the proof of \Cref{lem:fermat-galois-action-abs-hodge} and some rearranging. Namely, we see that 
\end{proof}
\begin{remark}
	Because the $G^{2p}$-action commutes with the Galois action, it is not difficult to directly check that an $\alpha$-eigenvector should go to a $u^{-1}\alpha$-eigenvector.
\end{remark}
\begin{remark}
	As a sanity check, it is not hard to see that \Cref{thm:fermat-galois} actually defines a group representation.
\end{remark}
\begin{remark} \label{rem:compute-k-conn-a-fermat}
	Following \Cref{rem:compute-k-conn-a}, one can use \Cref{thm:fermat-galois} allows ons to compute the connected monodromy field $K^{\mathrm{conn}}_A$ of the Jacobian $A$ of any quotient $C$ of the Fermat curve $X_N$. Indeed, \Cref{rem:compute-k-conn-a} explains that this is essentially a matter of computing enough the field of definition of enough Tate classes (used to cut out the torus $G_\ell^\circ(A)$). In particular, we already know that $\QQ(\zeta_N)\subseteq K^{\mathrm{conn}}_A$ (because of the endomorphisms), and then \Cref{thm:fermat-galois} explains that $\sigma\in\op{Gal}(\ov\QQ/\QQ(\zeta_N))$ fixes a Tate cycle $\nu_\alpha$ if and only if it fixes the period $\op{Per}\left(\gamma^{2p},\nu_{-\alpha}\right)$.
\end{remark}
% S8.5 of GGL
% use kunneth to discuss how we get a Hodge cycle
% build the abs Hodge cycle from the Hodge cycle => this should allow me to describe the Hodge cycles on X^2p without too much pain, notably avoiding Deligne 82
% gamma^q_{[alpha]} should be in the image of Kunneth and has the correct eigenvalue
% image of Kunneth should be fully diagonalizable
% actually image of Kunneth consists of the alpha-eigenspaces of H^2p(X^2p) which have nonzero entries in their tuple, which is something we can see on the level of de Rham cohomology
% I think it is worthwhile to point out exactly where we use the space has abs Hodge cycles: the diagonal Betti subspace is not stable under Galois
Let's see an example.
\begin{corollary} \label{cor:fermat-galois-polarization}
	Choose $\alpha\coloneqq(a,b,c)\in\mf A^1$, and set $\alpha'\coloneqq(a',b',c')$ to be $-\alpha$. Then $(\alpha,\alpha')\in\mf B^2$, and for any $\sigma\in\op{Gal}(\ov\QQ/\QQ)$ such that $\sigma(\zeta_N)=\zeta_N^u$ for $u\in(\ZZ/N\ZZ)^\times$, we have
	\[\sigma(\nu_{(\alpha,\alpha')}\otimes1)=\nu_{u^{-1}(\alpha,\alpha')}\otimes(-1)^{\langle u^{-1}\alpha\rangle-\langle\alpha\rangle}.\]
	In particular, $\sigma$ fixes $\nu_{(\alpha,\alpha')}\otimes1$ if and only if $u-1$ is divisible by $N/\gcd(a,b,c,N)$.
\end{corollary}
\begin{proof}
	To see that $(\alpha,\alpha')\in\mf B^2$, we note that any $u\in(\ZZ/N\ZZ)^\times$ still has $u\alpha=-u\alpha'$, so $\{\langle u\alpha\rangle,\langle-u\alpha\rangle\}=\{1,2\}$.

	Looking at \Cref{thm:fermat-galois}, we see the main part of proof will be computing our periods. The main point is that the reflection formula for $\Gamma$ (recalled later in \Cref{prop:gamma-prod-props}) reassures us that
	\[\Gamma\left(\frac{[a]}N\right)\Gamma\left(\frac{[-a]}N\right)=\frac\pi{\sin\frac{a\pi}N}.\]
	We now combine this with the computation in \Cref{rem:iterated-coleman-period} to achieve
	\[\op{Per}\left(\gamma^{2p},\nu_{-(\alpha,\alpha')}\right) = -(2\pi i)^{-1}\cdot\zeta_{2N}^{[-a]+[-b]+[a]+[b]}\cdot\frac\pi{\sin\frac{[a]\pi}N}\cdot\frac\pi{\sin\frac{[b]\pi}N}\cdot\frac{\sin\frac{[c]\pi}N}\pi.\]
	Note that $[a]+[-a]=N$, so the power of $\zeta_{2N}$ disappears. Continuing, we expand $\sin z=\frac1{2i}\left(z+z^{-1}\right)$, which yields
	\[\op{Per}\left(\gamma^{2p},\nu_{-(\alpha,\alpha')}\right) = -\frac{\left(\zeta_{2N}^c-\zeta_{2N}^{-c}\right)}{\left(\zeta_{2N}^a-\zeta_{2N}^{-a}\right)\left(\zeta_{2N}^b-\zeta_{2N}^{-b}\right)}.\]
	Continuing, we factor $\zeta_{2N}^{c}/\zeta_{2N}^{-a-b}=\zeta_{2N}^{N\langle\alpha\rangle}=(-1)^{\langle\alpha\rangle}$, leaving us with
	\[\op{Per}\left(\gamma^{2p},\nu_{-(\alpha,\alpha')}\right) = -(-1)^{\langle\alpha\rangle}\cdot\frac{\left(1-\zeta_{N}^{-c}\right)}{\left(\zeta_{N}^a-1\right)\left(\zeta_{N}^b-1\right)}.\]
	We now plug into \Cref{thm:fermat-galois} to reveal
	\[\sigma(\nu_{(\alpha,\alpha')}\otimes1)=\nu_{u^{-1}(\alpha,\alpha')}\otimes\frac{\sigma\left((-1)^{\langle u^{-1}\alpha\rangle}\cdot\frac{\left(1-\zeta_{N}^{-u^{-1}c}\right)}{\left(\zeta_{N}^{u^{-1}a}-1\right)\left(\zeta_{N}^{u^{-1}b}-1\right)}\right)}{(-1)^{\langle\alpha\rangle}\cdot\frac{\left(1-\zeta_{N}^{-c}\right)}{\left(\zeta_{N}^a-1\right)\left(\zeta_{N}^b-1\right)}},\]
	which rearranges into the desired expression because $\sigma\left(\zeta_N^{u^{-1}}\right)=\zeta_N$.
	
	It now remains the last sentence. Well, we see that $\sigma$ fixes $\nu_{(\alpha,\alpha')}$ if and only if $u^{-1}\alpha=\alpha$, which is equivalent to $u\alpha=\alpha$. By taking $\ZZ$-linear combinations, it is equivalent to asking for $(u-1)\gcd(a,b,c)\equiv0\pmod N$, from which the claim follows.
\end{proof}

% \section{Some Examples}
% In this section, we compute some $\ell$-adic monodromy groups.

\subsection{Some Examples} \label{subsec:fermat-exs}
We begin with the superelliptic curve $C\colon y^9=x^3-1$.
\begin{proposition} \label{prop:special-fermat-st-full}
	Define $A$ to be the Jacobian of the proper curve $C$ with affine chart $y^9=x^3-1$. Then we show $K^{\mathrm{conn}}_A=\QQ(\zeta_9)$, and we compute $\op{ST}(A)$.
\end{proposition}
\begin{proof}
	We will freely use the computation executed in \Cref{prop:special-fermat-st-1}. Thoughout, $A\coloneqq\op{Jac}C$, and we recall that we have a decomposition $A=C_0\times A_1\times A_2$ (over $\QQ$) into geometrically simple abelian varieties. We proceed in steps.
	\begin{enumerate}
		\item Even though this is not a Fermat curve, it is a quotient of the Fermat curve $X_N$ with $N\coloneqq9$: this is witnessed by the quotient map from the affine patch $x^9+y^9+1=0$ to $C$ given by $\psi(x,y)\coloneqq\left(-x^3,y\right)$. Thus, we will be able to use the Galois-invariant embedding $\psi\colon\mathrm H^1_{\mathrm{\acute et}}(C_{\ov\QQ},\QQ_\ell)\into\mathrm H^1_{\mathrm{\acute et}}(X_{N,\ov\QQ},\QQ_\ell)$ to use \Cref{thm:fermat-galois} by restricting to the Galois submodule. To make this explicit, we recall that we have a basis
		\[\left\{\frac{dx}{y^4},\frac{dx}{y^5},\frac{dx}{y^6},\frac{dx}{y^7},\frac{dx}{y^8},\frac{x\,dx}{y^7},\frac{x\,dx}{y^8}\right\}\]
		of $\mathrm H^{10}(C)$, we see that we can pass this basis through $\psi^*$ to see that $\mathrm H^{10}(C)\subseteq\mathrm H^{10}(X)$ has basis
		\[\left\{\nu_{351},\nu_{342},\nu_{333},\nu_{324},\nu_{315},\nu_{621},\nu_{612}\right\}.\]
		Combining with the conjugate differentials yeilds a full basis of $\mathrm H^1_{\mathrm{dR}}(C,\QQ)\subseteq\mathrm H^1_{\mathrm{dR}}(X,\QQ)$.

		\item We now explain how to pass the \'etale site. By \Cref{conj:ast}, which is known in this case by \Cref{thm:mtc-implies-astc}, we may choose any $\ell$, so we choose $\ell$ so that $\QQ_\ell$ contains any algebraic numbers we will need in the sequel (most notably, we want $\zeta_N$ and our periods). For each $p\ge0$, we recall that any $\alpha\in\mf B^{2p}$ produces idenitifications
		\[\mathrm H^{2p}_{\mathrm{dR}}\left(X^{2p},\QQ\right)_{[\alpha]}\otimes_\QQ\CC=C^p_{\mathrm{AH}}\left(X^{2p}\right)_{[\alpha]}\otimes_\QQ\CC\into\mathrm H^{2p}_{\mathrm{\acute et}}\left(X^{2p},\QQ_\ell\right)(p)_{[\alpha]}\otimes_\iota\CC,\]
		where $\iota\colon\QQ_\ell\into\CC$ is some fixed embedding. In this way, we see that we are allowed to treat an expression like $\nu_{351}\otimes1$ as an element of $\mathrm H^{2p}_{\mathrm{\acute et}}\left(X^{2p},\QQ_\ell\right)\otimes_\iota\CC$; for carefully chosen $\ell$, a Galois descent argument is even able to reassure us that the basis vectors $\nu_\alpha\otimes1$ produces from the previous step can be found in $\mathrm H^{2p}_{\mathrm{\acute et}}\left(X^{2p},\QQ_\ell\right)(p)_{[\alpha]}$.

		Thus, in the notation of \Cref{prop:special-fermat-st-1}, we see that $\psi^*$ pulls the basis vectors $\{u_1\otimes1,v_1\otimes1,v_2\otimes1,v_4\otimes1,w_1\otimes1,w_2\otimes1,w_5\otimes1\}$ to
		\[\{\nu_{333}\otimes1,\quad\nu_{315}\otimes1,\nu_{621}\otimes1,\nu_{342}\otimes1,\quad\nu_{612}\otimes1,\nu_{324}\otimes1,\nu_{351}\otimes1\},\]
		and one can recover $\psi^*$ on the rest of the basis by taking conjugates.

		\item We are now ready to begin executing \Cref{prop:galois-computes-monodromy}; for this, \Cref{rem:galois-computes-monodromy-finite} informs us that we need to build a space of $W'$ of Tate classes cutting out $G_\ell(A)^\circ\subseteq\op{GL}_{14,\QQ_\ell}$. We begin by adding $W_1$, made up of the endomorphisms, which ensures (for example) that $G_\ell(A)^\circ$ is diagonal. Then \Cref{prop:special-fermat-st-1} computed that we also have the ``polarization equations''
		\begin{align*}
			\mu_1\mu_2 &= \kappa_1\kappa_8, \\
			\kappa_1\kappa_8 &= \kappa_2\kappa_7, \\
			\kappa_1\kappa_8 &= \kappa_4\kappa_5,
		\end{align*}
		and the exceptional equation
		\begin{align*}
			\mu_1\kappa_7 &= \kappa_5\kappa_8.
		\end{align*}
		We remark that the polarization equations translate into a Tate class like $\nu_{(\alpha,-\alpha,\beta,-\beta)}\otimes1$ understood as an element in $\mathrm H^4_{\mathrm{\acute et}}(X_{\ov\QQ},\QQ_\ell)(2)\otimes_\QQ\QQ_\ell$, but this Tate class actually already come from a class in $W_1$ (see \Cref{cor:fermat-galois-polarization}), so we may safely ignore it. Thus, we only have to translate the exceptional equation into the tensor
		\[\nu_{333,675,648,612}\otimes1\in\mathrm H^4_{\mathrm{\acute et}}(X_{\ov\QQ},\QQ_\ell)(2)\otimes_\QQ\QQ_\ell\]
		and its Galois orbit.

		\item We claim that $K^{\mathrm{conn}}_A=\QQ(\zeta_N)$. By \Cref{rem:galois-computes-monodromy-finite}, it is enough to know that $\op{Gal}(\QQ(\zeta_N)/\QQ)$ is the largest subgroup of $\op{Gal}(\ov\QQ/\QQ)$ fixing $W'$. We already know that our endomorphisms, except the isogeny $(A_1)_{\ov\QQ}\cong (A_2)_{\ov\QQ}$, are defined over $\QQ(\zeta_N)$ (see also \Cref{cor:fermat-galois-polarization} for these equations and the polarization). The isogeny corresponds to equations $\kappa_u=\lambda_{2u}$ for each $u\in(\ZZ/9\ZZ)^\times$, which means that we would like to check that
		\[\op{Per}\left(\gamma^{2p},\nu_{u(612,378)}\right)\]
		is in $\QQ(\zeta_N)$. Well, by \Cref{rem:coleman-periods}, this element is
		\[(-2\pi i)^{-1}\zeta_{2N}^{u(6+2+3+7)}\cdot\frac{\Gamma\left(\frac{[6u]}9\right)\Gamma\left(\frac{[2u]}9\right)}{\Gamma\left(\frac{[8u]}9\right)}\cdot\frac{\Gamma\left(\frac{[3u]}9\right)\Gamma\left(\frac{[7u]}9\right)}{\Gamma\left(\frac{[u]}9\right)}.\]
		A quick application of the reflection formula as in \Cref{cor:fermat-galois-polarization} shows this is in $\QQ(\zeta_N)$.

		It remains to check that $\sigma\in\op{Gal}(\QQ(\zeta_N)/\QQ)$ fixes the Galois orbit of $\nu_{333,675,648,612}\otimes1$. Well, looking at \Cref{thm:fermat-galois}, it is enough to check that $\sigma$ fixes
		\[\op{Per}\left(\gamma^4,\nu_{u(333,675,648,612)}\right)\]
		for any $u\in(\ZZ/N\ZZ)^\times$. Well, by \Cref{rem:coleman-periods}, we see this equals
		\[(-2\pi i)^{-2}\zeta_{2N}^{u(3+3+6+7+6+4+6+1)}\cdot\frac{\Gamma\left(\frac{[3u]}9\right)\Gamma\left(\frac{[3u]}9\right)}{\Gamma\left(\frac{[6u]}9\right)}\cdot\frac{\Gamma\left(\frac{[6u]}9\right)\Gamma\left(\frac{[7u]}9\right)}{\Gamma\left(\frac{[4u]}9\right)}\cdot\frac{\Gamma\left(\frac{[6u]}9\right)\Gamma\left(\frac{[4u]}9\right)}{\Gamma\left(\frac{[u]}9\right)}\cdot\frac{\Gamma\left(\frac{[6u]}9\right)\Gamma\left(\frac{[u]}9\right)}{\Gamma\left(\frac{[7u]}9\right)}.\]
		After the dust settles, we are left with
		\[(-2\pi i)^{-2}\cdot\Gamma\left(\frac39\right)^2\Gamma\left(\frac69\right)^2.\]
		Now, the reflection formula yields $\Gamma\left(\frac39\right)\Gamma\left(\frac69\right)=\frac\pi{\sin\frac\pi3}$, so we see that this period lives in $\QQ(\zeta_N)$ and hence is fixed by $\sigma$; in fact, it is rational!

		\item Choose $\sigma\in\op{Gal}(\QQ(\zeta_N)/\QQ)$ to satisfy $\sigma(\zeta_N)=\zeta_N^u$. We compute the action of $\sigma$ on $W'$. For example, the previous step actually shows that $\sigma$ fixes the Galois orbit of $\nu_{333,675,648,612}\otimes1$, so it remains to compute the action on $W_1$. Note that $G$ acts on the $\CC$-vector space, so the action can be diagonalized. Given some character $(\alpha,\beta)\in\mf A^2$, we note that $(W_1)_{(\alpha,\beta)}$ is at most one-dimensional spanned by $\nu_{(\alpha,\beta)}\otimes1$, and this element being a Tate class is equivalent to $\mathrm H^{2}_{\mathrm B}(X,\QQ)(1)_{[\alpha]}$ has Hodge cycles by the Mumford--Tate conjecture (known in this case by \Cref{rem:mtc-cm}), which is equivalent to $(\alpha,\beta)\in\mf B^2$ by \Cref{prop:find-hodge-classes}. With the aide of a computer, we can enumerate all such $(\alpha,\beta)$, and we see that they come in two forms.
		\begin{itemize}
			\item We could have $\alpha=(a,b,c)$ and $\beta=-\alpha$. In this case, \Cref{cor:fermat-galois-polarization} explains that
			\[\sigma(\nu_{(\alpha,\beta)}\otimes1)=\nu_{u^{-1}(\alpha,\beta)}\otimes(-1)^{\langle u^{-1}\alpha\rangle-\langle\alpha\rangle}.\]
			\item We could have $\alpha=(a,b,c)$ and $\beta=(-a,-c,-b)$. As in \Cref{cor:fermat-galois-polarization}, the main point is to compute our periods. Well, by \Cref{rem:coleman-periods}, we find
			\[\op{Per}\left(\gamma^{2p},\nu_{-(\alpha,\beta)}\right)=-(2\pi i)^{-1}\zeta^{[a]+[-a]+[-b]+[c]}_{2N}\cdot\frac{\Gamma\left(\frac{[-a]}N\right)\Gamma\left(\frac{[-b]}N\right)}{\Gamma\left(\frac{[c]}N\right)}\cdot\frac{\Gamma\left(\frac{[a]}N\right)\Gamma\left(\frac{[c]}N\right)}{\Gamma\left(\frac{[-b]}N\right)},\]
			which after an appliation of the reflection formula gives
			\begin{align*}
				\op{Per}\left(\gamma^{2p},\nu_{-(\alpha,\beta)}\right) &= (2\pi i)^{-1}\zeta_{2N}^{[-b]+[c]}\cdot\frac\pi{\sin\frac{a\pi}N} \\
				&= \frac{\zeta_{2N}^{[-b]+[c]}}{\zeta_{2N}^a-\zeta_{2N}^{-a}} \\
				&= \frac{\zeta_{2N}^{[-b]+[c]+[a]}}{\zeta_{N}^a-1}.
			\end{align*}
			It will be convenient to write this entirely in terms of $\zeta_N$, so we note that $N$ being odd forces $\zeta_{2N}=-\zeta_N^{(N+1)/2}$, so this equals $(-1)^{[a]+[-b]+[c]}\zeta_N^{(a-b+c)(N+1)/2}$. The purpose of this rewrite is that all $\zeta_N$s will go away in the computation
			\[\sigma(\nu_{(\alpha,\beta)}\otimes1)=\nu_{u^{-1}(\alpha,\beta)}\otimes\frac{\sigma\left(\op{Per}\left(\gamma^{2p},\nu_{-u^{-1}(\alpha,\beta)}\right)\right)}{\op{Per}\left(\gamma^{2p},\nu_{-(\alpha,\beta)}\right)}\]
			because $\sigma\left(\zeta_N^{u^{-1}}\right)=1$, so we are left with
			\[\sigma(\nu_{(\alpha,\beta)}\otimes1)=\nu_{u^{-1}(\alpha,\beta)}\otimes(-1)^{[u^{-1}a]+[-u^{-1}b]+[u^{-1}c]+[a]+[-b]+[c]}.\]
		\end{itemize}

		\item Now choose $\sigma\in\op{Gal}(\QQ(\zeta_N)/\QQ)$ to satisfy $\sigma(\zeta_N)=\zeta_N^5$, which we note is a generator. We now compute
		\[\{g\in{\op{GL}_{14,\QQ_\ell}}:g|_{W'}=\sigma|_{W'}\}.\]
		For this, we recall from \Cref{prop:galois-computes-monodromy} that we are looking at the component of $G_\ell(A)$ containing the image of $\sigma$. In particular, we know that $\sigma$ is a permutation matrix sending $(\nu_\alpha\otimes1)\mapsto(\nu_{2\alpha}\otimes1)$ (up to scalar), so we need $g$ to also be a permutation matrix also sending $(\nu_\alpha\otimes1)\mapsto(\nu_{2\alpha}\otimes1)$ (again up to scalar). Well, for each available $\alpha$, we will compute relations among scalars $\{\lambda_\alpha\}$ defined to satisfy $g(\nu_\alpha\otimes1)=(\nu_{2\alpha}\otimes\lambda_\alpha)$. Because $G_\ell(A)^\circ$ is a torus of rank $4$, we are expecting to be able to write all $\lambda_\bullet$s in terms of four of them.

		With this in mind, we use the previous step as follows to produce the required relations. For brevity, let $\lambda$ be the multiplier of $g$ with respect to the pairing induced by the polarization; this multiplier becomes the action of $g$ on $\QQ_\ell(1)$.
		\begin{itemize}
			\item We need $g$ to satisfy
			\[g(\nu_{(\alpha,-\alpha)}\otimes1)=\nu_{2(\alpha,-\alpha)}\otimes(-1)^{\langle2\alpha\rangle-\langle\alpha\rangle},\]
			so $\lambda_\alpha\lambda_{-\alpha}=(-1)^{\langle2\alpha\rangle-\langle\alpha\rangle}\lambda$.
			\item For available $(a,b,c)$, we need $g$ to satisfy
			\[g(\nu_{(a,b,c,-a,-c,-b)})=\nu_{(2a,2b,2c,-2a,-2c,-2b)}\otimes(-1)^{[2a]+[-2b]+[2c]+[a]+[-b]+[c]},\]
			so $\lambda_{(a,b,c)}\lambda_{(-a,-c,-b)}=\lambda(-1)^{[2a]+[-2b]+[2c]+[a]+[-b]+[c]}$. For convenience, we note that$\pmod2$ computations have
			\[[2a]+[-2b]+[2c]+[a]+[-b]+[c]\equiv[2a]+[2b]+[2c]+[a]+[b]+[c]\equiv\langle2\alpha\rangle-\langle\alpha\rangle,\]
			so we are seeing the same sign as before.
			\item We need $g$ to fix $\nu_{u(333,675,648,612)}$, so $\lambda_{u(333)}\lambda_{u(675)}\lambda_{u(648)}\lambda_{u(612)}=\lambda^2$.
		\end{itemize}
		The above points tell us that we can determine $g$ uniquely by choosing $(\kappa_1,\kappa_2,\kappa_4)=(\lambda_{612},\lambda_{324},\lambda_{648})$ and $\lambda$. Explicitly, we get the matrix
		\[\left[\begin{array}{cc|cccccc|cccccc}
			& -\kappa_1\kappa_4/\kappa_2 &&&&&&& \\
			\lambda\kappa_2/\kappa_1\kappa_4 &&&&&&&&\\\hline
			&& &&& \lambda/\kappa_2 &&&&&& \\
			&& \lambda/\kappa_4 &&&&&& \\
			&& & \kappa_1 &&&&&& \\
			&& &&&& \lambda/\kappa_1 &&&&&& \\
			&& &&&&& \kappa_4 &&&&&& \\
			&& && -\kappa_2 &&&&&& \\\hline
			&& &&&&&& &&& -\lambda/\kappa_4 \\
			&& &&&&&& \kappa_1 \\
			&& &&&&&& & \kappa_2 \\
			&& &&&&&& &&&& \lambda/\kappa_2 \\
			&& &&&&&& &&&&& \lambda/\kappa_1 \\
			&& &&&&&& && \kappa_4
		\end{array}\right]\]
		as representing $g$.
		% implies that $C^1_{\mathrm{AH}}(X)_{[\alpha]}$ is nonempty, which implies that $\mathrm H^{2}_{\mathrm B}(X,\QQ)(1)_{[\alpha]}$ has Hodge cycles, which implies $(\alpha,\beta)\in\mf B^2$.
	\end{enumerate}
	Thus, upon enforcing the multiplier to equal $1$ and base-changing to $\CC$, we see that $\op{ST}(A)$ is generated by $\op{ST}(A)^\circ$ (computed in \Cref{prop:special-fermat-st-1}) and the matrix
	\[\begin{bsmallmatrix}
		& -1 &&&&&&& \\
		1 &&&&&&&&\\
		&& &&& 1 &&&&&& \\
		&& 1 &&&&&& \\
		&& & 1 &&&&&& \\
		&& &&&& 1 &&&&&& \\
		&& &&&&& 1 &&&&&& \\
		&& && -1 &&&&&& \\
		&& &&&&&& &&& -1 \\
		&& &&&&&& 1 \\
		&& &&&&&& & 1 \\
		&& &&&&&& &&&& 1 \\
		&& &&&&&& &&&&& 1 \\
		&& &&&&&& && 1
	\end{bsmallmatrix}.\]
	This completes our computation.
\end{proof}
% \subsection{The Family \texorpdfstring{$y^9=\left(x^2+x+1\right)(x-\lambda)$}{y9 = (x2+x+1)(x-lambda)}}
We now use the above computation to compute the Sato--Tate group of some generic superelliptic curves.
\genericfullst
\begin{proof}
	As usual, we proceed in steps. Throughout, we freely use the computation of \Cref{prop:generic-fermat-st}.
	\begin{enumerate}
		\setcounter{enumi}{-1}
		\item Quickly, we note that we may pass from $y^9=x(x-1)(x-\lambda)$ (for $\lambda\notin\{0,1\}$) to $y^9=\left(x^2+x+1\right)(x-\lambda)$ (for $\lambda\notin\{\zeta_3,\ov\zeta_3\}$). Indeed, consider the isomorphism $f\colon\PP^1\to\PP^1$ defined over $\QQ(\zeta_9)$ by fixing $\infty$ and sending $0\mapsto\zeta_3$ and $1\mapsto\ov\zeta_3$. Then the curves $y^9=x(x-1)(x-\lambda)$ and $y^9=\left(x^2+x+1\right)(x-f(\lambda))$ are isomorphic by an isomorphism of the ``ground'' $\PP^1$. Thus, the connected monodromy field over $\QQ(\zeta_9)$ of both curves must be the same. Because $K_A^{\mathrm{conn}}$ for both curves must contain $\QQ(\zeta_9)$ anyway (there are endomorphisms whose field of definition is $\QQ(\zeta_9)$ already), we see that this movement must be harmless!

		\item We lift our situation to an abelian scheme. Let $S$ be $\AA^1_\QQ\setminus\{\zeta_3,\ov\zeta_3\}$, and we let $\mc C\to S$ be the curve cut out by the equation $y^9=\left(x^2+x+1\right)(x-\lambda)$ as $\lambda$ varies over $S$; then we can normalize and complete $C$ to produce a family of smooth projective curves $\widetilde{\mc C}\to S$. Then $\mc A\coloneqq\op{Pic}^0{\mc C/S}$ is an abelian scheme over $S$. In particular, for each $\lambda\in\QQ\setminus\{\zeta_3,\ov\zeta_3\}$, we can specialize to $\lambda\in S$ to produce $A_\lambda\coloneqq\mc A_\lambda$ as the Jacobian of the curve $\widetilde C_\lambda\coloneqq\widetilde{\mc C}_\lambda$.

		While we're here, we set up a family of Galois representations. In order to avoid any difficult \'etale cohomology, we will do this cheaply using the Tate module. For each $n\ge1$, we have a finite flat group scheme $\mc A[n]\to S$, so each $\lambda\in S(\QQ)$ gets a natural Galois-invariant pullback square as follows.
		% https://q.uiver.app/#q=WzAsNCxbMCwwLCJBX1xcbGFtYmRhW25dIl0sWzEsMCwiXFxtYyBBW25dIl0sWzEsMSwiUyJdLFswLDEsIlxcbGFtYmRhIl0sWzMsMl0sWzAsM10sWzAsMV0sWzEsMl1d&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
		\[\begin{tikzcd}
			{A_\lambda[n]} & {\mc A[n]} \\
			\lambda & S
			\arrow[from=1-1, to=1-2]
			\arrow[from=1-1, to=2-1]
			\arrow[from=1-2, to=2-2]
			\arrow[from=2-1, to=2-2]
		\end{tikzcd}\]
		Taking limits over $n$, we get Galois-invariant inclusions $V_\ell A\to V_\ell\mc A$, where $V_\ell\mc A$ can be interpreted as a sheaf with stalks given by $V_\ell A$. The moral of the story is that we will be able to use a special point in $S$ in order to compute the Galois action for generic $\lambda\in S$.

		\item As before, we will use \Cref{prop:galois-computes-monodromy} in order to compute $G_\ell(A_\lambda)$ when $A_\lambda$ does not have complex multiplication. Thus, \Cref{rem:galois-computes-monodromy-finite} asks us to find a space $W'$ of Tate classes cutting out $G_\ell(A)^\circ$. We may as well work with $\op{MT}(A)$ by the Mumford--Tate conjecture, which is known in our case by \Cref{prop:mtc-reldim-2}. As before, we go ahead and add in $W_1$ to account for the endomorphisms of $A$. We also add the class of the polarization to $W'$. Thus, our Tate classes so far cut out $\op L(A)$. The computation of \Cref{prop:generic-fermat-st} tells us that $\op{MT}(A)$ is $\op L(A)$ cut out by one additional equation from the center, given by
		\[\lambda_1\lambda_4\lambda_7=\lambda_2\lambda_5\lambda_8.\]
		Writing $g\in\op{MT}(A)\subseteq\op L(A)$ as $\op{diag}(g_0,g_1,g_2,g_4,g_5,g_7,g_8)$ as in \Cref{prop:generic-fermat-st}, we see that the above equation corresponds to the equation
		\[\det g_1g_4g_7=\det g_2g_5g_8,\]
		which we see corresponds to the exceptional Tate class
		\[(v_1\land v_1')\otimes(v_4\land v_4')\otimes(v_7\land v_7')\otimes1\in\mathrm H^{6}_{\mathrm{\acute et}}(A_{\ov\QQ},\QQ_\ell)(3),\]
		where $v\land v'=\frac12(v\otimes v'-v'\otimes v)$. Explicitly, the computation of \Cref{prop:generic-fermat-st} tells us that $g\in G_\ell(A)$ acts on $(v_1\land v_1')\otimes(v_4\land v_4')\otimes(v_7\land v_7')$ by some power of the multiplier, which is then cancelled out some by the Tate twist.

		\item We claim that $K_{A_\lambda}^{\mathrm{conn}}=\QQ(\zeta_9)$ for generic $\lambda$. Our endomorphisms come from the automorphisms of the curve, which are all defined over $\QQ(\zeta_9)$. Additionally, the polarization is certainly defined over $\QQ(\zeta_9)$.
		
		It remains to handle the Galois orbit of the exceptional class given in the previous step. By the discussion at the end of the first step, it is enough to compute the Galois action at a single $\lambda$ where this Tate class can be found. Well, we take $\lambda=1$ so that we can appeal to the computations of \Cref{prop:special-fermat-st-full}. To explicate our basis, we will take $\{v_1,\ldots,v_8\}=\{v_1,\ldots,v_8\}$ and $\{v_1',\ldots,v_8'\}=\{w_1,\ldots,w_8\}$. Unravelling the Tate class, we see that it is a linear combination of the Tate classes given by permuting the triples in the subscript of the Tate class
		\[\nu_{315,612,342,648,378,675}.\]
		(We also need to consider $\nu_{2(315,612,342,648,378,675)}$ for the full Galois orbit, but the computation is essentially the same.) We would like to check that this Tate class is defined over $\QQ(\zeta_9)$. Well, by \Cref{thm:fermat-galois}, it is enough to check that the period
		\[\op{Per}\left(\gamma^6,\nu_{315,612,342,648,378,675}\right)\]
		lives in $\QQ(\zeta_9)$. After expanding the $\Gamma$s, we are eventually left with some power of $\zeta_9$ multiplied by
		\[\left((2\pi i)^{-1}\Gamma\left(\frac39\right)\Gamma\left(\frac 69\right)\right)^3,\]
		which we see is in $\QQ(\zeta_9)$.
		
		\item We compute $G_\ell(A_\lambda)$ for generic $\lambda$. Above we computed that the Tate classes cutting out $G_\ell(A_\lambda)$ for generic $\lambda$ are a strict subset of those needed for $\lambda=1$, so one finds that $G_\ell(A_1)\subseteq G_\ell(\lambda)$ for generic $\lambda$. In particular, \Cref{prop:special-fermat-st-full} tells us that $G_\ell(A_\lambda)$ must contain
		\[\begin{bsmallmatrix}
			& -1 \\
			1 \\
			&& &&&&&& 1 \\
			&& &&&&&& & -1 \\
			&& 1 \\
			&& & 1 \\
			&& && 1 \\
			&& && & 1 \\
			&& &&&&&&&& 1 \\
			&& &&&&&&&& & 1 \\
			&& &&&&&&&&&& 1 \\
			&& &&&&&&&&&& & 1 \\
			&& &&&& -1 \\
			&& &&&& & 1
		\end{bsmallmatrix},\]
		where we have reordered the basis. However, having $K_{A_\lambda}^{\mathrm{conn}}=\QQ(\zeta_9)$ implies by \Cref{prop:galois-computes-monodromy} that $[G_\ell(A_\lambda):G_\ell(A_\lambda)^\circ]=9$, and we can see that the group generated by $G_\ell(A)^\circ$ and the above matrix also has $G_\ell(A_\lambda)^\circ$ as an index-$9$ subgroup. Thus, we conclude that $G_\ell(A_\lambda)$ is generated by $G_\ell(A)^\circ$ (computed in \Cref{prop:generic-fermat-st}) and the above matrix.

		\item We conclude that $\op{ST}(A)$ equals is generated by $\op{ST}(A)^\circ$ (computed in \Cref{prop:generic-fermat-st}) and the matrix given in the previous step. This completes the computation.
		\qedhere
	\end{enumerate}
\end{proof}

\section{Calculations of the Periods} \label{sec:fermat-periods}
Our calculation of the Galois action on absolute Hodge cycles above (\Cref{thm:fermat-galois}) found that the main difficulty reduces to a computation of the periods $\op{Per}\left(\gamma^{2p},\nu_\alpha\right)$. In general, it is not an easy problem to compute the periods of a variety, even an abelian variety with complex multiplication. However, we have already put in a lot of work into being able to do this: \Cref{rem:iterated-coleman-period} explains that $\alpha\in\mf B^{2p}$ will have
\[\op{Per}\left(\gamma^{2p},\nu_\alpha\right)=(2\pi i)^{-p}\prod_{i=1}^{2p}\zeta_{2N}^{[a_i]+[b_i]}\frac{\Gamma\left(\frac{[a_i]}N\right)\Gamma\left(\frac{[b_i]}{N}\right)}{\Gamma\left(\frac{[-c_i]}N\right)}.\]
It remains to compute these ratios, which comes down to being able to do arithmetic with products of $\Gamma$-functions. This is the primary goal of this section.

\subsection{Properties of \texorpdfstring{$\Gamma$}{ Gamma}}
To set ourselves up for the remaining subsections, we will now prove all needed properties of the $\Gamma$-function
\[\Gamma(s)\coloneqq\int_{\RR^+}t^se^{-t}\,\frac{dt}t\]
from scratch. We will be rather streamlined. Our end goal is to prove the following proposition.
\begin{proposition} \label{prop:gamma-prod-props}
	The function $\Gamma(s)$ admits a meromorphic continuation to $\CC$ with only simple poles at the nonpositive integers. Further, it satisfies the following properties.
	\begin{listalph}
		\item Translation: $\Gamma(s+1)=s\Gamma(s)$.
		\item Reflection: $\Gamma(s)\Gamma(1-s)=\frac{\pi}{\sin\pi s}$.
		\item Multiplication: for any positive integer $d$,
		\[\Gamma\left(\frac sd\right)\Gamma\left(\frac{s+1}d\right)\cdots\Gamma\left(\frac{s+(d-1)}d\right)=(2\pi)^{(d-1)/2}d^{1/2-s}\Gamma(s).\]
	\end{listalph}
\end{proposition}
Among (a)--(c), only (a) admits a quick proof.
\begin{proof}[Proof of \Cref{prop:gamma-prod-props}(a)]
	Assuming that the integral form is well-defined, we find that the result holds by integration by parts.
	\begin{align*}
		\Gamma(s+1) &= \int_{\RR^+}t^{s+1}e^{-t}\,\frac{dt}t \\
		&= -\int_{t\in\RR^+}t^s\,d\left(e^{-t}\right) \\
		&= -t^se^{-t}\bigg|_{t=0}^{t=\infty}+s\int_{\RR^+}t^se^{-t}\,\frac{dt}t \\
		&= s\Gamma(s),
	\end{align*}
	as required.
\end{proof}
\begin{example} \label{ex:gamma-on-ints}
	A direct integral computation shows that $\Gamma(1)=1$, so we note that we may read the integration by parts above backwards to see that we have shown that the integral defining $\Gamma(n)$ converges and equals $(n-1)!$ for any positive integer $n$.
\end{example}
Now that we have some idea how to bound the integral defining $\Gamma$, we are able to prove the meromorphic continuation.
\begin{proof}[Proof of meromorphic continuation of \Cref{prop:gamma-prod-props}]
	We have two steps.
	\begin{enumerate}
		\item We claim that the integral converges absolutely and uniformly on compacts in the region $\{s:\Re s>0\}$, which will prove that $\Gamma$ is holomorphic there. Here, we may bound the integral absolutely by
		\[\int_{\RR^+}\left|t^se^{-t}\right|\,dt\le\int_0^1t^{\Re s-1}\,dt+\int_1^\infty t^{\ceil{\Re s-1}}e^{-t}\,dt.\]
		The left integral equals $\frac1{\Re s-1}$, so it converges absolutely on compacts. The right integral is bounded by $\Gamma(\ceil{\Re s-1})$, which we know by \Cref{ex:gamma-on-ints} to converge.
		\item We complete the meromorphic continuation. The equation $\Gamma(s+1)=s\Gamma(s)$ allows us to inductively holomorphically continue $\Gamma(s)$ to the region $\CC\setminus\{0,-1,-2,\ldots\}$. This equation written as $\Gamma(s)=\frac1s\Gamma(s+1)$ also explains that $\Gamma$ admits a simple pole at $s=0$, which can then be inductively continued to produce simple poles on the nonpositive integers.
		\qedhere
	\end{enumerate}
\end{proof}
\begin{example} \label{ex:gamma-half}
	We compute $\Gamma(1/2)$. The proof above shows that the integral converges, so we would like to compute $\int_{\RR^+}t^{-1/2}e^{-t}\,dt$. Taking $u=\sqrt t$, we see that $2\,du=t^{-1/2}\,dt$, so
	\[\Gamma(1/2)=\int_{\RR}e^{-u^2}\,du.\]
	The technique of squaring the integral and passing to polar coordinates shows that the integral equals $\sqrt\pi$.
\end{example}
We now turn to the reflection formula.
\begin{proof}[Proof of \Cref{prop:gamma-prod-props}(b)]
	We will have to do some work. The following slick argument is taken from David Speyer, who credits Paul Monsky \cite{speyer-gamma-reflection}. We will show that the function $f(s)\coloneqq\Gamma(s)\Gamma(1-s)\sin\pi s$ is constant. Note that this will complete the proof because we can compute the constant is $\pi$ by writing
	\[f(1/2)=\Gamma(1/2)^2\sin\frac\pi2\]
	and using \Cref{ex:gamma-half}. We now proceed in steps. The idea is that the ambient $1$-periodicity of $f$ means that we only have worry about bounds on $f(x+iy)$ as $\left|y\right|\to\infty$.
	\begin{enumerate}
		\item We claim that there is a holomorphic function $g\colon\CC^\times\to\CC$ such that $f(s)=g\left(e^{2\pi is}\right)$. To begin, note that $\Gamma(s)$ has simple poles at the nonpositive integers, so $\Gamma(1-s)$ has simple poles at the positive integers, so $f(s)$ is entire. Furthermore, we claim that $f(s+1)=f(s)$. By analytic continuation, it is enough to check this away from the real axis. Because the function $\sin\pi s$ satisfies $\sin\pi(s+1)=-\sin\pi s$, it is enough to compute
		\[\Gamma(s+1)\Gamma(1-(s+1))=s\Gamma(s)\cdot\frac1{-s}\Gamma(1-s).\]
		We now turn towards defining $g$. The function $s\mapsto e^{2\pi is}$ is an entire surjection $\CC^\times\to\CC^\times$ with non-vanishing derivative everywhere, so one can at least locally invert it. Thus, we may use a local inverse suitably composed with $f$ to define $g$ locally. This local definition of $g$ however extends to a definition on all $\CC^\times$ because $f(s+1)=f(s)$.

		\item We provide some bounds on the function $g$. We begin with some bounds on $\Gamma$: if $x\in[0,1]$ and $\left|y\right|\ge1$, then
		\begin{align*}
			\left|\Gamma(x+iy)\right| &= \left|\frac1{x+iy}\right|\cdot\left|\Gamma((x+1)+iy)\right| \\
			&\le \Gamma(x+1) \\
			&\le \max_{x\in[1,2]}\Gamma(x),
		\end{align*}
		which is absolutely bounded by some constant $C$. Moving to $f$, we see
		\[\left|f(x+iy)\right|\le C^2e^{-\pi y}.\]
		Lastly, moving to $g$, we see that $\left|g\left(e^{2\pi i(x+iy)}\right)\right|\le C^2e^{-\pi y}$. We evaluate this in two extreme cases: sending $y\to\infty$ tells us that $\left|g(q)\right|\le C^2\left|q\right|^{1/2}$ as $\left|w\right|\to\infty$; on the other hand, sending $y\to-\infty$ tells us that $\left|g(q)\right|\le C^2\left|q\right|^{-1/2}$ as $q\to0$.

		\item We complete the proof. Our goal is to show that $f$ is constant, so it is enough to show that $g$ is constant. It is enough to show that $g(s)$ and $g(1/s)$ both extend to holomorphic functions at $s=0$ because this will imply that $g$ extendeds to a bounded holomorphic function, which is constant.

		It is therefore enough to show the following lemma in complex analysis: suppose $g\colon B(0,1)\setminus\{0\}\to\CC$ is a holomorphic function such that $\left|g(q)\right|\le\left|q\right|^{-1/2}$ as $q\to0$. Then we want to show that $g$ extends to a holomorphic function at $0$. Well, the function $g_1(q)\coloneqq qg(q)$ continues to be holomorphic on $B(0,1)\setminus\{0\}$, but now we see that it has a removable singularity at $0$ with $qg(q)\to0$ as $q\to0$, so $g_1$ admits a holomorphic continuation to $B(0,1)$ by taking $g_1(q)=0$. We may now divide out by the zero to define $g(q)$ at $q=0$.
		\qedhere
	\end{enumerate}
\end{proof}
We now turn to the multiplication formula. This will be harder still. We will require two lemmas.
\begin{lemma}[Stirling's approximation] \label{lem:stirling}
	As $s\to\infty$, we have
	\[\Gamma(s+1)\sim\left(\frac se\right)^s\sqrt{2\pi s}.\]
\end{lemma}
\begin{proof}
	The following argument is taken from \cite[Section~3]{conrad-stirling}. In order to make the asymptotic terms appear, we set $x\coloneqq\frac{t-s}{\sqrt s}$ so that
	\begin{align*}
		\Gamma(s+1) &= \int_{\RR^+}t^se^{-t}\,dt \\
		&= \int_{-\sqrt s}^\infty(\sqrt sx+s)^se^{-(\sqrt sx+s)}\sqrt s\,dx \\
		&= \left(\frac se\right)^s\sqrt s\underbrace{\int_{-\sqrt s}^\infty\left(1+\frac x{\sqrt s}\right)^se^{-\sqrt sx}\,dx}_{I(\sqrt s)\coloneqq}
	\end{align*}
	It remains to check that $I(s)\to\sqrt{2\pi}$ as $s\to\infty$. This will be done using the Dominated convergence theorem. Define $f_s\colon\RR\to\RR$ by $f_s(x)\coloneqq\left(1+\frac xs\right)^{s^2}e^{-sx}$ so that $I(s)=\int_\RR f_s(x)\,dx$. (Here, $f_s$ is defined to be $0$ on $(-\infty,-s]$.) We have two steps.
	\begin{enumerate}
		\item We claim that $f_s(x)\to e^{-x^2/2}$ as $s\to\infty$. It is enough to check equality after taking $\log$s, so we would like to show that
		\[\lim_{s\to\infty}\left(s^2\log\left(1+\frac xs\right)-sx\right)\stackrel?=-\frac{x^2}2.\]
		Now, $\log\left(1+\frac xs\right)=\sum_{k\ge1}\frac1k\left(\frac xs\right)^k$, so the Monotone convergence theorem (used for $s$ large) gives
		\begin{align*}
			\lim_{s\to\infty}\left(s^2\log\left(1+\frac xs\right)-sx\right) &= \lim_{s\to\infty}\Bigg(s^2\sum_{k\ge1}\frac1k\left(\frac xs\right)^k-sx\Bigg) \\
			&= \underbrace{0}_{k=1}-\underbrace{\frac{x^2}2}_{k=2}+\sum_{k\ge3}\lim_{s\to\infty}\frac1k\left(\frac xs\right)^k,
		\end{align*}
		which evaluates to $-x^2/2$, as needed.

		\item We now apply the Dominated convergence theorem to see that $I(s)\to\int_\RR e^{-x^2/2}\,dx$, where the integral equals $\sqrt{2\pi}$ as remarked in \Cref{ex:gamma-half}. In light of the previous step, it remains to find a dominating function for the $f_s$s. We will do this based on sign.
		\begin{itemize}
			\item For $x\le0$, we claim that $f_s(x)\le e^{-x^2/2}$. If $s\le-x$, then $f_s(x)=0$, so there is nothing to do; otherwise, we take $s>-x$. After taking logarithms, we see that we would like to check that the function
			\[s^2\log\left(1+\frac xs\right)-sx+\frac{x^2}2\]
			is nonpositive for $x\le0$. This function vanishes at $x=0$, so it is enough to check that it is increasing, for which we note its derivative (with respect to $x$) is
			\[\frac{s^{2}}{1+\frac{x}{s}}\cdot\frac{1}{s}-s+x=\frac{x^{2}}{s+x},\]
			which is nonnegative for $s\ge-x$.
			\item For $x\ge0$ (and $s\ge1$), we claim that $f_s(x)\le f_1(x)$. After taking logarithms, we see that we would like to show that
			\[\left(\log\left(1+x\right)-x\right)-\left(s^{2}\log\left(1+\frac{x}{s}\right)-sx\right)\]
			is nonnegative for $x\ge0$. This function vanishes at $x=0$, so it is enough to check that it is increasing, for which we note its derivative (with respect to $x$) is
			\[\left(\frac{1}{1+x}-1\right)-\left(\frac{s^{2}}{1+\frac{x}{s}}\cdot\frac{1}{s}-s\right)=\frac{x^{2}\left(s-1\right)}{\left(1+x\right)\left(s+x\right)},\]
			which is nonnegative for $s\ge1$.
		\end{itemize}
		Thus, we see that our dominating function may be taken to be $e^{-x^2/2}$ in the negative region and $f_1(x)$ in the positive region.
		\qedhere
	\end{enumerate}
\end{proof}
\begin{lemma}[Euler form] \label{lem:euler-form-gamma}
	If $s>0$, then
	\[\Gamma(s)=\lim_{n\to\infty}\frac{n!n^s}{s(s+1)\cdots(s+n)}.\]
\end{lemma}
\begin{proof}
	% Let the right-hand side be $\Gamma_1(s)$. A direct manipulation of the limit shows
	% \begin{align*}
	% 	\frac{\Gamma_1(s+1)}{s\Gamma_1(s)} &= \lim_{n\to\infty}\dfrac{\frac{n!n^{s+1}}{(s+1)(s+2)\cdots(s+n)}}{\frac{n!n^s}{}}
	% \end{align*}
	We evaluate the limit directly, using \Cref{lem:stirling}. Manipulating directly, we see the limit is
	\[\Gamma(s)\lim_{n\to\infty}\frac{\Gamma(n+1)n^s}{\Gamma(s+n+1)}.\]
	We now see the desired $\Gamma(s)$ term, so we want to show that the remaining limit equals $0$. By \Cref{lem:stirling} and taking logarithms, we see that we would like to show that
	\[\lim_{n\to\infty}\left(x\log x-x+s\log x-\left(s+x\right)\log\left(s+x\right)+s+x\right)\stackrel?=0.\]
	After some simplification, this limit is seen to equal the limit of $s-n\log\left(1+\frac sn\right)$, which can be evaluated to $0$ by expanding out the power series for $\log(1+x)$.
\end{proof}
\begin{remark}
	The right-hand side in fact defines a holomorphic function on $\CC\setminus\{0,-1,-2,\ldots\}$, so the given equality extends to this region by analytic continuation. This prior claim can be checked by verifying that the right-hand side converges uniformly on compact sets in the region $\{s:\Re s>0\}$ and also satisfies the equation $\Gamma(s+1)=s\Gamma(s)$.
\end{remark}
\begin{proof}[Proof of \Cref{prop:gamma-prod-props}(c)]
	The following argument is taken from \cite{random-gamma-multiplication}. By analytic continuation, it is enough to check the identity when $s$ is real and positive. We simply expand out the right-hand side using the Euler form (\Cref{lem:euler-form-gamma}) and Stirling's approximation (\Cref{lem:stirling}). To avoid off-by-one errors, we note that
	\begin{align*}
		\Gamma(s) &= \lim_{n\to\infty}\frac{n!n^s}{s(s+1)\cdots(s+n)} \\
		&= \lim_{n\to\infty}\frac{n!n^{s-1}}{s(s+1)\cdots(s+n-1)} \\
		&= \lim_{n\to\infty}\frac{\sqrt{2\pi}e^{-n}n^{n+s-1/2}}{s(s+1)\cdots(s+n-1)}.
	\end{align*}
	Namely, the denominator now has precisely $n$ terms. Now,
	\begin{align*}
		\prod_{k=0}^{d-1}\Gamma\left(\frac{s+k}d\right) &= \lim_{n\to\infty}\prod_{k=0}^{d-1}\frac{\sqrt{2\pi}e^{-n}n^{n+(s+k)/d-1/2}}{\left(\frac{s+k}d\right)\left(\frac{s+k+d}d\right)\cdots\left(\frac{s+k+(n-1)d}d\right)} \\
		&= \lim_{n\to\infty}\frac{(\sqrt{2\pi})^de^{-nd}n^{nd+(ds+(0+\cdots+(d-1)))/d-d/2}}{\frac sd\left(\frac{s+1}d\right)\cdots\left(\frac{s+nd-1}d\right)} \\
		&= \lim_{n\to\infty}\frac{(\sqrt{2\pi})^de^{-nd}n^{nd+s-1/2}d^{nd}}{s\left(s+1\right)\cdots\left(s+nd-1\right)}.
	\end{align*}
	We would like the Euler form (\Cref{lem:euler-form-gamma}) for $\Gamma(s)$ to come out of this limit, and this will be done by substituting $nd\to\infty$ into the limit for the coordinate $n\to\infty$. With this in mind, we move the strange factors from the right-hand side of the desired equality in \Cref{prop:gamma-prod-props} to the left-hand side, writing our limit as
	\[(2\pi)^{-(d-1)/2}d^{s-1/2}\prod_{k=0}^{d-1}\Gamma\left(\frac{s+k}d\right) = \lim_{n\to\infty}\frac{\sqrt{2\pi}e^{-nd}(nd)^{nd+s-1/2}}{s\left(s+1\right)\cdots\left(s+nd-1\right)},\]
	which is indeed the Euler form for $\Gamma(s)$.
\end{proof}

\subsection{Unrefined Algebraicity}
It will be worthwhile to give ourselves some language to describe the sorts of products we want to evalaute. A priori, we are basically computing a product which looks like
\[\prod_{i\in\ZZ}\Gamma\left(\frac iN\right)^{a_i},\]
where $\{a_i\}_{i\in\ZZ}$ is a sequence of integers arranged so that the above product is finite. (Namely, $i/N$ should never be in $\ZZ_{\le0}$ if $a_i>0$, and only finitely many of the $a_i$ should fail to vanish.) However, by using the fact that $\Gamma(s+1)=s\Gamma(s)$, we may slide all factors of the product to $(0,1)$, meaning that we want to compute a product which looks like
\[\prod_{i=1}^{N-1}\Gamma\left(\frac iN\right)^{f(i/N)},\]
where $f\colon\frac1N\ZZ/\ZZ\to\ZZ$ is some function.
\begin{notation}
	For any function $f\colon\frac1N\ZZ/\ZZ\to\ZZ$, we define
	\[\Gamma(f)\coloneqq\prod_{i=1}^{N-1}\Gamma\left(\frac iN\right)^{f(i/N)}.\]
	Dually, for any element $a\in\ZZ\left[\frac1N\ZZ/\ZZ\right]$, we may write $a=\sum_{i=0}^{N-1}a_i\cdot\ov{i/N}$, and we define $\Gamma(a)$ according to the function $i/N\mapsto a_i$. Note that $\Gamma(a)$ does not admit a value if $a$ is nonzero at $0/N$.
\end{notation}
\begin{remark}
	Because we are only interested in computing the periods $\op{Per}\left(\gamma^{2p},\nu_\alpha\right)$ where $\alpha\in\mf B^{2p}$, we may restrict our view to functions $a\colon\frac1N\ZZ/\ZZ\to\ZZ$ such that the weight $\langle a\rangle\colon(\ZZ/N\ZZ)^\times\to\ZZ$ is constant.
\end{remark}
Now, \Cref{prop:gamma-prod-props} gives us two further properties about products of $\Gamma$s we may use. By suitably translating, we are able to compute products which look like
\[\Gamma\left(\frac aN\right)\Gamma\left(\frac{N-a}N\right)\qquad\text{and}\qquad\Gamma\left(\frac{da}N\right)^{-1}\prod_{k=0}^{d-1}\Gamma\left(\frac aN+\frac k{d}\right),\]
$a,b\in\{1,\ldots,N\}$, and we require $d\mid N$ and $N\nmid da$ in the second product. Here is some notation to keep track of this.
\begin{notation}
	For a positive divisor $d$ of $N$ and $a\in\ZZ/N\ZZ$, we define the function $\varepsilon_{d,a}\colon\frac1N\ZZ/\ZZ\to\ZZ$ to be the characteristic function of the set
	\[\left\{\frac{N-da}N\right\}\cup\left\{\frac aN+\frac kd:k\in\{0,\ldots,d-1\}\right\}.\]
	Similarly, for any $a\in(\ZZ/N\ZZ)\setminus\{0\}$, we define $s_a\colon\frac1N\ZZ/\ZZ\to\ZZ$ to be the characteristic function of $\left\{\frac aN,\frac{-a}N\right\}$.
\end{notation}
\begin{remark}
	Abusing notation slightly, we may identify $\varepsilon_{d,a}$ and $s_a$ with the corresponding elements in $\ZZ\left[\frac1N\ZZ/\ZZ\right]$.
\end{remark}
The moral is that we can compute $\Gamma(\varepsilon_{d,a})$ and $\Gamma(s_a)$, so we would like to see which functions $\frac1N\ZZ/\ZZ\to\ZZ$ can be written as linear combinations of $\varepsilon_{d,a}$s and $s_a$s. Recalling that we are only interested in functions of constant weight, we pick up the following results in this direction.
\begin{lemma} \label{lem:const-weight-exs}
	For any positive divisor $d\mid N$ and $a\in\frac1N\ZZ/\ZZ$, the weight functions $\langle\varepsilon_{d,a}\rangle$ and $\langle s_a\rangle$ are constant. % (Here, $s_a$ only makes sense when $s\ne0$.)
\end{lemma}
\begin{proof}
	This is \cite[Example, p.~343]{deligne-periods}. Note $s_a=\varepsilon_{1,a}$ when $a\ne0$, so we are reduced to the considering $\varepsilon_{d,a}$s. Before doing any computation, we note that we will write $[q]$ to be the representative in $[0,1)$ of an element $q\in\QQ/\ZZ$. We now proceed in steps.
	\begin{enumerate}
		\item For any $u\in(\ZZ/N\ZZ)^\times$, we find $v$ such that $uv\equiv1\pmod N$ and compute
		\begin{align*}
			\langle\varepsilon_{d,a}\rangle(u) &= \frac1N\sum_{b\in(\ZZ/N\ZZ)}1_{\varepsilon_{d,a}}\left(\frac{ub}N\right)[b] \\
			&= \left[-\frac{dva}N\right]+\sum_{k=0}^{d-1}\left[\frac{va}N+\frac{vk}d\right] \\
			&= \langle\varepsilon_{d,va}\rangle(1).
		\end{align*}
		Thus, we see that we would like to show that $\langle\varepsilon_{d,a}\rangle(1)=\langle\varepsilon_{d,ua}\rangle(1)$ for any $u\in(\ZZ/N\ZZ)^\times$; for example, there is nothing to show in the case where $a=0$.
		\item Setting $e\coloneqq N/d$, we note that $\varepsilon_{d,a}=\varepsilon_{d,a+e}$ pointwise. Thus, we are reduced to the case where $a\in[0,e)$ by shifting $a$ appropriately.
		\item Now, for any $q\in\RR/\ZZ\setminus\frac1d\ZZ/\ZZ$, we define $\varepsilon_{d,q}$ as the indicator of the set $\{[-dq]\}\cup\{q+k/d:k\in\{0,1\ldots,d-1\}\}$. We claim that $\langle\varepsilon_{d,q}\rangle(1)$ does not depend on $q$, which will complete the proof in the cases where $a/N=q$ by the first step. As in the second step, we note that $\varepsilon_{d,q}$ only depends on the class of $q$ in $\QQ/\frac1d\ZZ$, so we may assume that $q\in(0,1/d)$. Now, as in the first step, we compute
		\begin{align*}
			\langle\varepsilon_{d,q}\rangle(1) &= [-dq]+\sum_{k=0}^{d-1}\left[q+\frac kd\right] \\
			&\stackrel*= (1-dq)+\sum_{k=0}^{d-1}\left(q+\frac kd\right) \\
			&= 1+\sum_{k=0}^{d-1}\frac kd,
		\end{align*}
		which is independent of $q$. Here, the key equality $\stackrel*=$ holds notably because $q\in(0,1/d)$.
		\qedhere
	\end{enumerate}
\end{proof}
\begin{remark} \label{rem:weight-of-distrib-relation}
	In fact, the above proof shows that $\langle\varepsilon_{d,a}\rangle$ is $\frac{d+1}2$ when $N\nmid da$.
\end{remark}
One also has a partial converse.
\begin{proposition}[Koblitz--Ogus] \label{prop:const-weight-to-distribs}
	Let $f\colon\frac1N\ZZ/\ZZ\to\QQ$ be a function of constant weight such that $f(0)=0$. Then $f$ is a $\QQ$-linear combination of the functions
	\[\{\varepsilon_{d,a}:d\mid N,d\text{ is prime},N\nmid da\}\sqcup\{s_a:N\mid a\}.\]
\end{proposition}
\begin{proof}
	This is \cite[Proposition, p.~344]{deligne-periods}. Approximately speaking, the idea is that we want to decompose $f$ into a sum over some cosets, which is a job for Fourier analysis. Before doing anything, we set up some notation. Let $E$ be the given set of $\varepsilon_{d,a}$s. Note that the given statement is one about some functions $E$ in a vector space spanning the full space, which can be checked by extending scalars, so we go ahead and extend scalars to $\CC$.
	
	Now, for a given function $f\colon\frac1N\ZZ/\ZZ\to\CC$ and a divisor $d\mid N$, we define $f_d\colon(\ZZ/d\ZZ)^\times\to\CC$ by $f_d(u)\coloneqq f(u/d)$. For example, because $f(0)=0$, we see that $f_1=0$. Continuing, for each function $f\colon\frac1N\ZZ/\ZZ\to\CC$, we define $d(f)$ to be the smallest divisor of $N$ such that $f_{d(f)}$ is nonzero, setting $d(f)=N$ if $f=0$. Lastly, for convenience, we also define $I_d\subseteq(\ZZ/N\ZZ)^\times$ (for $d\mid N$) to be the subgroup of elements $u\in(\ZZ/N\ZZ)^\times$ such that $u\equiv1\pmod d$. Note that there is a short exact sequence
	\[1\to I_d\subseteq(\ZZ/N\ZZ)^\times\onto(\ZZ/d\ZZ)^\times\to1.\]
	We now proceed in steps.
	\begin{enumerate}
		\item The general approach is to induct on $d(f)$. In particular, if $d(f)=1$, then $f=0$, so there is nothing to do. Thus, we may fix a divisor $d\mid N$ bigger than $1$, and we would like to show that any (fixed) $f$ of constant weight with $d(f)=d$ lives in $\op{span}_\CC E$, assuming this is true for any $f'$ with $d(f')<d(f)$. As such, our goal is to find $g\in\op{span}_\CC E$ such that $d(f-g)<d(f)$.

		We need to do something to get ourselves off the ground, so we go ahead and specify some kinds of functions $f$ with $d(f)=d$ for which we are already able to conclude.
		\begin{listalph}
			\item Suppose that $f_d$ factors through $(\ZZ/d\ZZ)^\times/\{\pm1\}$. Then $f_d(-a)=f_d(a)$ for each $a$, so we may define
			\[f'\coloneqq f-\sum_{a\in(\ZZ/d\ZZ)^\times/\{\pm1\}}f_d(a)s_{a/d}.\]
			By construction, $f'_d=0$ while $f'_e=f_e$ for any other divisor $e\mid N$, so $d(f')<d(f)$.
			\item Suppose that $f_d$ factors through $\big(\ZZ/\frac dp\ZZ\big)^\times$ for some prime factor $p\mid d$. Let $I_{d/p,d}$ be the kernel of the projection $(\ZZ/d\ZZ)^\times\onto\big(\ZZ/\frac dp\ZZ\big)^\times$ so that $f_d$ is invariant under $I_{d/p,d}$. Now, for each $a\in(\ZZ/d\ZZ)^\times$, we note that
			\[\frac adI_{d/p,d}=\left(\left\{\frac{d-pa}d\right\}\cup\left\{\frac ad+\frac kp:k\in\{0,\ldots,p-1\}\right\}\right)\cap\frac1d(\ZZ/d\ZZ)^\times\]
			because both sides are simply the elements of the form $\frac bd$ where $b\in(\ZZ/d\ZZ)^\times$ has $a\equiv b\pmod{\frac dp}$. Thus, as in (a), we may subtract out suitable multiples of $\varepsilon_{p,a}$s from $f$ to cause $f_d$ to vanish while not changing $f_e$ for any $e>d$, thereby making $d(f)$ smaller.
		\end{listalph}
		In the remaining steps, we will show that any $f_d$ is a linear combination of functions of the type described in (a) and (b), which completes the induction and thus the proof.

		\item The aforementioned goal will be achieved via Fourier analysis. Discrete Fourier analysis allows one to write $f_d$ as a linear combination of characters $\chi\colon(\ZZ/d\ZZ)^\times\to\CC^\times$, writing
		\[f=\sum_{\chi\colon(\ZZ/d\ZZ)^\times\to\CC^\times}\langle f,\chi_d\rangle\chi.\]
		Because we want to show $f_d$ is a linear combination of functions which factor through $(\ZZ/d\ZZ)^\times/\{\pm1\}$ or $\big(\ZZ/\frac dp\ZZ\big)^\times$, we may as well show that $f_d$ is a linear combination of even and imprimitive characters. Taking the contraposition, we must show $\langle f_d,\chi_d\rangle=0$ for any odd primitive character $\chi_d\colon(\ZZ/d\ZZ)^\times\to\CC^\times$.

		\item Forget the context of the previous step for a sentence. Continuing with the Fourier analysis, we will show in the next step that any function $f\colon\frac1N\ZZ/\ZZ\to\CC$ and any character $\widetilde\chi\colon(\ZZ/N\ZZ)^\times\to\CC^\times$ has
		\begin{equation}
			\langle\langle f\rangle,\widetilde\chi\rangle=\sum_{\substack{d\mid N\\\widetilde\chi|_{I_d}=1}}-L(0,\chi_d)\left|I_d\right|\langle f_d,\chi_d\rangle, \label{eq:fourier-weight-eq}
		\end{equation}
		where $\chi_d\colon(\ZZ/d\ZZ)^\times\to\CC^\times$ is the character induced from $\widetilde\chi$. Let's explain how this completes the proof, returning to the context of the previous step.

		We apply \eqref{eq:fourier-weight-eq} to our $f$ and some character $\widetilde\chi\colon(\ZZ/N\ZZ)^\times\to\CC^\times$ induced from a chosen odd primitive character $\chi_d\colon(\ZZ/d\ZZ)^\times$; we want to show that $\langle f_d,\chi_d\rangle=0$. Let's look at both sides of \eqref{eq:fourier-weight-eq}.
		\begin{itemize}
			\item Because $\langle f\rangle$ is constant and $\widetilde\chi$ is nontrivial, the left-hand side $\langle\langle f\rangle,\widetilde\chi\rangle$ vanishes.
			\item On the other hand, the right-hand side sees contributions only from divisors $e\mid N$ for which $I_e\subseteq\ker\widetilde\chi$. But then the image of $I_e$ in $(\ZZ/d\ZZ)^\times$ will be contained in $\ker\chi_d$, which forces $I_e\subseteq I_d$ because $\ker\chi_d$ is trivial (because $\chi_d$ is primitive). Thus, our sum only consider divisors $e\mid d$, but because $d(f)=d$, we see that $f_e=0$ whenever $e<d$. In total, our right-hand side features only the term $-L(0,\chi_d)\left|I_d\right|\langle f_d,\chi_d\rangle$.
		\end{itemize}
		The above two points combine to imply $-L(0,\chi_d)\left|I_d\right|\langle f_d,\chi_d\rangle=0$, so $\langle f_d,\chi_d\rangle=0$ because $\chi_d$ being odd and primitive implies $L(0,\chi_d)\ne0$. (Namely, $L(0,\chi_d)\ne0$ by combining the functional equation for this Dirichlet $L$-function with the non-vanishing result \Cref{prop:hecke-nonvanish}.)

		\item It remains to check the equality \eqref{eq:fourier-weight-eq}. This is a direct computation. Expanding everything out, we see
		\[\langle\langle f\rangle,\widetilde\chi\rangle=\frac1N\sum_{\substack{u\in(\ZZ/N\ZZ)^\times\\a\in\ZZ/N\ZZ}}\frac{\langle a\rangle}N f\left(\frac{au}N\right)\ov\chi(u).\]
		In order to make $f_d$s appear, we stratify the sum over $a$, writing
		\[\langle\langle f\rangle,\widetilde\chi\rangle=\sum_{d\mid N}\frac1d\sum_{\substack{u\in(\ZZ/N\ZZ)^\times\\v\in(\ZZ/d\ZZ)^\times}}\langle v\rangle f_d\left(uv\right)\ov\chi(u).\]
		Eventually, the sum over $v$ will turn into a term like $\langle f_d,\chi_d\rangle$, so we need to get rid of the sum over $u$. Let $U_d'\subseteq(\ZZ/N\ZZ)^\times$ be a set of coset representatives for $(\ZZ/N\ZZ)^\times/I_d$ so that $(\ZZ/N\ZZ)^\times=U_d'I_d$. Then the internal sum over $u$ looks like
		\[\sum_{\substack{u'\in U_d'\\u\in I_d}}f_d(uu'v)\ov\chi(uu').\]
		Note $f_d(uu'v)=f_d(u'v)$, so we may sum $\ov\chi$ over just $u$ alone. If $I_d\not\subseteq\ker\chi$, then this sum over $u$ vanishes; otherwise, the sum over $u$ is $\left|I_d\right|$, so the total sum is
		\[\sum_{u'\in U_d'}f_d(u'v)\ov\chi(u')\left|I_d\right|=\chi_d(v)\left|I_d\right|\langle f_d,\chi_d\rangle.\]
		Plugging this back in, we see
		\[\langle\langle f\rangle,\widetilde\chi\rangle=\sum_{d\mid N}\Bigg(\frac1d\sum_{v\in(\ZZ/d\ZZ)^\times}\langle v\rangle\chi_d(v)\Bigg)\left|I_d\right|\langle f_d,\chi_d\rangle.\]
		The claim now follows by \cite[Proposition~4.1, Theorem~4.2]{washington-cyclotomic-field}.
		\qedhere
	\end{enumerate}
\end{proof}
\begin{corollary} \label{cor:unrefined-gamma-alg}
	Let $f\colon\frac1N\ZZ/\ZZ\to\ZZ$ be a function of constant weight $w$. Then
	\[\pi^{-w}\Gamma(f)\in\ov\QQ.\]
\end{corollary}
\begin{proof}
	By adding or subtracting $1_0$s (which have weight $0$), we may assume that $f(0)=0$. The hypothesis and conclusion are $\QQ$-linear in $f$ (note that fractional powers are permitted in an algebraicity question), so \Cref{prop:const-weight-to-distribs} tells us that it is enough to check the result for $f$ being one of the $\varepsilon_{d,a}$s in the statement; recall from \Cref{rem:weight-of-distrib-relation} that $\langle\varepsilon_{d,a}\rangle=\frac{d+1}2$.

	In fact, for any divisor $d\mid N$ and choice of $a\in\ZZ/N\ZZ$ with $N\nmid da$, we claim that $\pi^{-w}\Gamma(\varepsilon_{d,a})\in\ov\QQ^\times$, where $w=\frac{d+1}2$ is the weight. Indeed, by combining the reflection and multiplication formulae (\Cref{prop:gamma-prod-props}), we see that $\Gamma(\varepsilon_{d,a})$ is
	\[\Gamma\left(\frac{N-da}N\right)\prod_{k=0}^{d-1}\Gamma\left(\frac aN+\frac kd\right)\equiv\pi^{(d+1)/2}\pmod{\ov\QQ^\times},\]
	so the result follows.
\end{proof}

\subsection{The Universal Distribution}
This section follows \cite{kubert-distribution}. We are now permitted to make the following definition.
\begin{definition}[distribution]
	A \textit{distribution relation} is an element of $\ZZ\left[\frac1N\ZZ/\ZZ\right]$ of the form
	\[\ov a-\sum_{\substack{b\in\frac1N\ZZ/\ZZ\\db=a}}\ov b,\]
	where $d\mid N$ is a positive divisor. A \textit{distrubtion} is a function $f\colon\frac1N\ZZ/\ZZ\to A$ to an abelian group $A$ whose natural extension to $\ZZ\left[\frac1N\ZZ/\ZZ\right]$ vanishes on all distribution relations. A distribution is \textit{odd} if and only if it also satisfies $f(-a/N)=-f(a/N)$ for all $a$.
\end{definition}
\begin{example}[universal] \label{ex:universal-distribution}
	Let $U_N$ be the abelian group given by taking the quotient of $\ZZ\left[\frac1N\ZZ/\ZZ\right]$ by the subgroup generated by the distribution relations. Then there is a natural inclusion $i\colon\frac1N\ZZ/\ZZ\to U_N$, which we see is a distribution by construction. In fact, we see that every distribution $f\colon\frac1N\ZZ/\ZZ\to A$ factors uniquely through $i$, so $i$ is initial in the category of distributions.
\end{example}
\begin{example} \label{ex:gamma-as-distribution}
	By \Cref{prop:gamma-prod-props}, the function $\frac1{\sqrt{2\pi}}\Gamma\colon\QQ/\ZZ\to\CC/\ov\QQ$ is an odd distribution. Namely, this function descends to $\QQ/\ZZ$ by the translation property, it is a distribution by the multiplication formula, and it is odd by the reflection formula. The Lang--Rohrlich conjecture asserts that $\frac1{\sqrt{2\pi}}\Gamma$ is a universal odd distribution; we refer to \cite[Lemma~24.6.1.1]{andre-motive} for some related conjectures.
\end{example}
\Cref{ex:gamma-as-distribution} explains why we are discussing distributions in this section: products of $\Gamma$s can be tracked through as satisfying these distribution relations. We also remark that integer-valued functions of constant weight $0$ live a new life here.
\begin{lemma} \label{lem:const-weight-as-odd-distrib}
	Let $D_N^-\subseteq\ZZ\left[\frac1N\ZZ/\ZZ\right]$ be the $\ZZ$-module generated by the distribution relations and the elements $\ov a+\ov{-a}$ and $\ov0$. After identifying $\ZZ\left[\frac1N\ZZ/\ZZ\right]$ with functions $\frac1N\ZZ/\ZZ\to\ZZ$, we see $D_N^-$ is generated by the elements $\ov0$ and $\varepsilon_{d,a}$ where $d\mid N$ is a divisor and $a\in(\ZZ/N\ZZ)$.
\end{lemma}
\begin{proof}
	For nonzero $a$, note that $\varepsilon_{1,a}$ is simply the generator $\ov{a/N}+\ov{-a/N}$, and $\varepsilon_{d,a}$ produces the distribution relation
	\[-\varepsilon_{d,a}+\varepsilon_{1,da}=\overline{\frac{da}N}-\sum_{k=0}^{d-1}\overline{\frac aN+\frac kd}.\]
	Thus, up to adding or subtracting some $\varepsilon_{1,\bullet}$, we see that the distribution relations are in bijection with the $\varepsilon_{d,a}$s, so these elements generate the same subgroup of $\ZZ\left[\frac1N\ZZ/\ZZ\right]$.
\end{proof}
\begin{remark} \label{rem:const-weight-as-odd-prime-distrib}
	It is not hard to see that one may inductively write $\varepsilon_{d,a}$s as a $\ZZ$-linear combination of $\varepsilon_{p,a}$s where $p$ is a prime. (For that matter, one can inductively write distribution relations in terms of ones where the divisor $d\mid N$ is prime.) The point is that we really only have to consider $\varepsilon_{p,a}$s (with $p$ prime) and $\varepsilon_{1,a}$s in \Cref{lem:const-weight-as-odd-distrib}.
\end{remark}
The goal of the present subsection is to show the following structure result \cite[Theorem~1.8]{kubert-distribution}.
\begin{theorem}[Kubert] \label{thm:free-abelian-distribution}
	Let $i\colon\frac1N\ZZ/\ZZ\to U_N$ be an initial distribution. Then $U_N$ is a free abelian group of rank $\varphi(N)$.
\end{theorem}
\begin{proof}[Proof from \Cref{prop:free-abelian-distribution-upper,prop:free-abelian-distribution-lower}]
	We will go ahead and outline the argument, referring forward to results we will prove in the sequel. There are two main steps.
	\begin{enumerate}
		\item In \Cref{prop:free-abelian-distribution-upper}, we show that any distribution $f$ has $\langle\im f\rangle$ admitting a generating set of $\varphi(N)$ elements.
		\item In \Cref{prop:free-abelian-distribution-lower}, we exhibit a distribution $r$ with $\dim_\QQ\langle\im r\rangle_\QQ=\varphi(N)$.
	\end{enumerate}
	Let's quickly explain why these two implications allow us to conclude the proof. By the first step, we see that there is a surjection $\ZZ^{\varphi(N)}\onto U_N$ of abelian groups, and we will be done as soon as we know that this map is an isomorphism. Well, because $i$ is an initial distribution, we see that the distribution $r$ factors through $i$, meaning that there is an induced surjection
	\[\ZZ^{\varphi(N)}\onto U_N\onto\langle\im r\rangle.\]
	However, this composite must become an isomorphism after tensoring with $\QQ$ (for dimension reasons) by the second step, so the composite must in particular be injective. We conclude that the map $\ZZ^{\varphi(N)}\onto U_N$ is an isomorphism.
\end{proof}
It remains to provide the proofs of \Cref{prop:free-abelian-distribution-upper,prop:free-abelian-distribution-lower}. Before going further, we need some notation.
\begin{notation}
	By the Chinese remainder theorem, summation provides an isomorphism
	\[\sum_{p\mid N}\frac1{p^{\nu_p(N)}}\ZZ/\ZZ\to\frac1N\ZZ/\ZZ.\]
	For any $s\in\frac1N\ZZ/\ZZ$ and $p\mid N$, we define $s_p\in\frac1{p^{\nu_p(N)}}\ZZ/\ZZ$ to be the corresponding $p$-component. Similarly, if we have $\frac aN\in\frac1N\ZZ/\ZZ$, we let $\frac{a_p}{p^{\nu_p(N)}}$ be the $p$-component.
\end{notation}
Because it is faster, we now proceed with \Cref{prop:free-abelian-distribution-lower}.
\begin{proposition} \label{prop:free-abelian-distribution-upper}
	Let $f\colon\frac1N\ZZ/\ZZ\to A$ be a distribution. Then $\langle\im f\rangle$ admits a generating set of $\varphi(N)$ elements.
\end{proposition}
\begin{proof}
	This result is \cite[Proposition~1.8]{kubert-distribution}, though we follow the isomorphic proof given in \cite[Proposition~12.10]{washington-cyclotomic-field}. The idea is to use the distribution relations to minimize the number of generators. There are two steps.
	\begin{enumerate}
		\item We claim that the collection
		\[S_N\coloneqq\left\{f\left(\frac aN\right):a_p=0\text{ or }\gcd(a_p,p)=1\right\}\]
		generates $\langle\im f\rangle$. We proceed by induction on the number of primes factors of $N$, where the statement has little content if $N=1$.
		
		Now, for a given $N$, choose some $a/N\in\frac1N\ZZ/\ZZ$, and we want to show that $f(a/N)\in\langle S_N\rangle$. Quickly, if $a_p=0$ for some prime $p\mid N$, then in fact $a/N\in\frac1d\ZZ/\ZZ$ for some divisor $d\mid N$ with strictly fewer prime factors, so $f(a/N)\in\langle S_d\rangle$ by the induction.
		
		Thus, we may assume that $a_p\ne0$ for all $p\mid N$. In this case, we hope to use a distribution relation to find $f(a/N)$ in $\langle S_N\rangle$. In particular, note that we can write $a=dx$ where $d\mid N$ and $\gcd(x,N)=1$: indeed, simply write $\frac aN$ in reduced terms as $\frac xe$, and then $a=\frac Ne\cdot x$ is a suitable expansion. (In particular, $e$ is the order of $a$, so $p\mid e$ for all primes $e$, so $\gcd(x,e)=1$ implies $\gcd(x,N)=1$.) Thus, $f(a/N)$ equals
		\[f\left(d\cdot\frac xN\right)=\sum_{k=0}^{d-1}f\left(\frac xN+\frac kd\right),\]
		and now every term in the right-hand side lives in $S_N$.

		\item We claim that the collection
		\[T_N\coloneqq\left\{f\left(\frac aN\right):a_p=0,\text{ or }a_p\ne1\text{ and }\gcd(a_p,p)=1\right\}\]
		generates $\langle\im f\rangle$. Once again, we proceed by induction on the number of prime factors of $N$, where the statement has little content if $N=1$. Note that the previous step tells us that it is enough to check that $S_N\subseteq\langle T_N\rangle$.

		As such, we go ahead and pick up some $f(a/N)\in S_N$, and to show that $f(a/N)\in\langle T_N\rangle$. As in the prior step, we note that having $a_p=0$ for any prime $p$ implies that $f(a/N)\in S_d$ for some $d\mid N$ with fewer prime factors, yielding $f(a/N)\in\langle T_N\rangle$ by the induction. Thus, we may assume that $a_p\ne0$ for all $p$.
		
		We will induct on the number $\omega(a/N)$ of primes $p$ such that $a_p=1$. Of course, if $\omega(a/N)=0$, then $a/N\in T_N$ already, so there is nothing to do. Otherwise, suppose that our $a/N$ has at least one prime $q\mid N$ with $a_q=1$. We now use the distribution relations twice: set
		\[\frac bM\coloneqq\sum_{\substack{p\mid N\\p\ne q}}\frac{a_p}{p^{\nu_p(N)}},\]
		and then we note that we have two equalities
		\begin{align*}
			f\left(q^{\nu_q(N)}\cdot\frac bM\right) &= \sum_{k=0}^{q^{\nu_q(N)}-1}f\left(\frac bM+\frac k{q^{\nu_q(N)}}\right), \\
			f\left(q^{\nu_q(N)-1}\cdot\frac bM\right) &= \sum_{k=0}^{q^{\nu_q(N)-1}-1}f\left(\frac bM+\frac{qk}{q^{\nu_q(N)}}\right).
		\end{align*}
		Both left-hand sides are in $\langle T_N\rangle$ by the induction on the number of prime factors. Now, subtracting these two equations produces the relation
		\[\sum_{k\in(\ZZ/q^{\nu_q(N)})^\times}f\left(\frac bM+\frac k{q^{\nu_q(N)}}\right)\in\langle T_N\rangle.\]
		Note $\frac aN=\frac bM+\frac1{q^{\nu_q(N)}}$ is the first term in this sum while the other terms in the sum have strictly smaller $\omega$ (because the $q$-component is not equal to $1$), so we are done by the induction.
	\end{enumerate}
	Note that the second step completes the proof because $\#S_N$ equals
	\[\prod_{p\mid N}\#\left(\{0\}\cup\left(\ZZ/p^{\nu_p(N)}\ZZ\right)^\times\setminus\{1\}\right),\]
	which is simply $\#(\ZZ/N\ZZ)^\times=\varphi(N)$ by the Chinese remainder theorem.
\end{proof}
\begin{remark}
	The proof of \Cref{prop:free-abelian-distribution-upper} actually gives explicit generators of $\im f$. One can unwind this (and the proof of \Cref{thm:free-abelian-distribution}) to give explicit generators of $U_N$ defined in \Cref{ex:universal-distribution}.
\end{remark}
We now turn to the construction for \Cref{prop:free-abelian-distribution-lower}.
\begin{proposition} \label{prop:free-abelian-distribution-lower}
	There exists a distribution $r\colon\frac1N\ZZ/\ZZ\to A$ such that $\dim_\QQ\langle\im r\rangle_\QQ=\varphi(N)$.
\end{proposition}
\begin{proof}
	To understand why this is difficult, we note that we are basically trying to compute the dimension of the vector space $U_{N,\QQ}$, where $U_N$ is the rather horrendous abelian group constructed \Cref{ex:universal-distribution}. Technically, \Cref{prop:free-abelian-distribution-upper} tells us what should be a basis, but this vector space has so many relations that it is difficult to determine if these elements are actually linearly independent. The usual proof (in \cite[Chapter~12]{washington-cyclotomic-field} or \cite[Section~3]{kubert-distribution}) uses cyclotomy theory and some facts about character sums, reducing the task to a non-vanishing of some special value. These topics are moderately tangential to this thesis, so we will not discuss them. Instead, we will follow \cite[Section~4]{kubert-distribution} and provide a direct combinatorial construction.
	
	Our target space will be $A_N\coloneqq\QQ\left[(\ZZ/N\ZZ)^\times\right]$, and we note that $(\ZZ/N\ZZ)^\times$ has a natural permutation action on $A_N$. Throughout, $\op{ord}$ denotes the additive order of a group element. We require two elements of $A_N$.
	\begin{itemize}
		\item For $s\in\frac1N\ZZ/\ZZ$, we define
		\[X_N(s)\coloneqq\sum_{\substack{x\in(\ZZ/N\ZZ)^\times\\x\cdot N/\op{ord}s\equiv Ns}}\ov x.\]
		For example, if $\op{ord}s=N$, then $X_N(s)=\{Ns\}$. In general, if $s=a/d$ where $d=\op{ord}s$ so that $\gcd(a,d)=1$, then the $x$s take the form $(a+kd)$.
		\item For prime divisors $p\mid N$, we define
		\[Y_N(p)\coloneqq\sum_{\substack{y\in(\ZZ/N\ZZ)^\times\\py\equiv1\pmod{N/p^{\nu_p(N)}}}}\ov y.\]
		Notably, the value of $y\in(\ZZ/N\ZZ)^\times$ only has freedom in the $p$-component, so $Y_N(p)$ has $\varphi\left(p^{\nu_p(N)}\right)$ elements.
	\end{itemize}
	Because $X_N(s)$ and $Y_N(p)$ are basically subsets of $(\ZZ/N\ZZ)^\times$, we may write $\#X_N(s)$ or $\#Y_N(p)$ to mean the number of their elements. We are now ready to define $r_N\colon\frac1N\ZZ/\ZZ\to\QQ\left[(\ZZ/N\ZZ)^\times\right]$ by
	\[r_N(s)\coloneqq\frac{X_N(s)}{\varphi(N)}\prod_{p\mid\op{ord}s}\left(1-\frac{Y_N(p)}{\#Y_N(p)}\right).\]
	It remains to run many checks on $r_N$. They are all some explicit combinatorial manipulations.
	\begin{enumerate}
		\item For $c\in(\ZZ/N\ZZ)^\times$, we check that $r_N(cs)=cr_N(s)$. Note that $cX_N(s)=X_N(cs)$ because both contain the $x$ such that $cxN/\ord s\equiv Ns$. It now suffices to check that
		\[c\left(\left(1-\frac{Y_N(p)}{\#Y_N(p)}\right)\cdot X\right)\stackrel?=\left(1-\frac{Y_N(p)}{\#Y_N(p)}\right)\cdot cX\]
		for any prime divisor $p\mid N$ and $X\in\QQ\left[(\ZZ/N\ZZ)^\times\right]$. Well, it is enough to check this claim for $X\in(\ZZ/N\ZZ)^\times$, whereupon doing some rearragnement shows that it is enough to check that $c(Y_N(p)X)=Y_N(p)(cX)$, which is true by definition of the $(\ZZ/N\ZZ)^\times$-action on $A_N$.

		\item For any divisor $M\mid N$, we claim that the diagram
		% https://q.uiver.app/#q=WzAsNCxbMCwwLCJcXGZyYWMxTVxcWlovXFxaWiJdLFsxLDAsIlxcUVFcXGxlZnRbKFxcWlovTVxcWlopXlxcdGltZXNcXHJpZ2h0XSJdLFsxLDEsIlxcUVFcXGxlZnRbKFxcWlovTlxcWlopXlxcdGltZXNcXHJpZ2h0XSJdLFswLDEsIlxcZnJhYzFOXFxaWi9cXFpaIl0sWzEsMiwiaSJdLFswLDMsIlxcc3Vic2V0ZXEiLDMseyJzdHlsZSI6eyJib2R5Ijp7Im5hbWUiOiJub25lIn0sImhlYWQiOnsibmFtZSI6Im5vbmUifX19XSxbMCwxLCJyX00iXSxbMywyLCJyX04iXV0=&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
		\[\begin{tikzcd}[cramped]
			{\frac1M\ZZ/\ZZ} & {\QQ\left[(\ZZ/M\ZZ)^\times\right]} \\
			{\frac1N\ZZ/\ZZ} & {\QQ\left[(\ZZ/N\ZZ)^\times\right]}
			\arrow["{r_M}", from=1-1, to=1-2]
			\arrow["\subseteq"{marking, allow upside down}, draw=none, from=1-1, to=2-1]
			\arrow["{i}", from=1-2, to=2-2]
			\arrow["{r_N}", from=2-1, to=2-2]
		\end{tikzcd}\]
		commutes, where $i$ is given by $i(\ov y)=\frac{\varphi(M)}{\varphi(N)}\sum_{x\equiv y\pmod M}\ov x$ for any $y\in(\ZZ/M\ZZ)^\times$. Note that $i$ is injective and $\QQ$-linear by construction, but it is not a ring map because it does not map $1\mapsto1$. However, the leading constant is chosen to make $i$ multiplicative: for $\ov y_1,\ov y_2\in(\ZZ/M\ZZ)^\times$, we see $i(\ov y_1)i(\ov y_2)$ equals
		\[\left(\frac{\varphi(M)}{\varphi(N)}\right)^2\sum_{\substack{x_1\equiv y_1\pmod M\\x_2\equiv y_2\pmod M}}\ov x_1\ov x_2=\left(\frac{\varphi(M)}{\varphi(N)}\right)^2\sum_{\substack{x\equiv y_1y_2\pmod M\\x'\equiv1\pmod M}}\ov x,\]
		where we have substituted $(x,x')=(x_1x_2,x_1/x_2)$. We conclude $i(\ov y_1)i(\ov y_2)=i(\ov y_1\ov y_2)$, an equation which extends $\QQ$-linearly to all $A_N$.

		The main computation will be to compute $i(r_M(s))$ for $s\in\frac1M\ZZ/\ZZ$. Using the multiplicativity of the previous paragraph, we see
		\[i(r_M(s))=\frac{i(X_M(s))}{\varphi(M)}\prod_{p\mid\op{ord}s}i\left(1-\frac{Y_M(p)}{\#Y_M(p)}\right).\]
		We see that we have to compute $i(X_M(s))$ and $i(Y_M(p))$.
		\begin{itemize}
			\item Note $\frac{\varphi(N)}{\varphi(M)}i(X_M(s))=X_N(s)$: some $x\in(\ZZ/N\ZZ)^\times$ finds itself in $\frac{\varphi(N)}{\varphi(M)}i(X_M(s))$ if and only if $x\cdot M/\op{ord}s\equiv Ms$, which is equivalent to $x\cdot N/\op{ord}s\equiv Ns$.
			\item We claim $\frac{i(Y_M(p))}{\#Y_M(p)}=i(1)\frac{Y_N(p)}{\#Y_N(p)}$. Note that the reduction map $Y_N(p)\to Y_M(p)$ is surjective: any $y$ with $py\equiv1\pmod{M/p^{M/\nu_p(M)}}$ may be lifted to a multiplicative inverse of $p\pmod{N/p^{N/\mu_p(N)}}$. We thus see that the support of $\frac{\varphi(N)}{\varphi(M)}i(1)Y_M(p)$ agrees with the support of $\frac{\varphi(N)}{\varphi(M)}i(Y_M(p))$; however, each element in $\frac{\varphi(N)}{\varphi(M)}i(Y_M(p))$ is overcounted by a factor of $\varphi\left(p^{\nu_p(N)}\right)/\varphi\left(p^{\nu_p(M)}\right)$ because we already had freedom in the $p$-component. Adjusting for this completes the claim.
		\end{itemize}
		We now see
		\[i(r_M(s))=\frac{i(X_M(s))}{\varphi(M)}\prod_{p\mid\op{ord}s}i(1)\left(1-\frac{Y_N(p)}{\#Y_N(p)}\right).\]
		To get rid of the factor of $i(1)$, we note that $i(X_M(s))i(1)=i(X_M(s))$ by the multiplicativity. Lastly, we may substitute $\frac{i(X_M(s))}{\varphi(M)}=\frac{X_N(s)}{\varphi(N)}$, writing
		\[i(r_M(s))=\frac{X_N(s)}{\varphi(N)}\prod_{p\mid\op{ord}s}\left(1-\frac{Y_N(p)}{\#Y_N(p)}\right),\]
		which is indeed $r_N(s)$.

		\item We claim that $r_N$ is a distribution. Namely, for any divisor $d\mid N$ and $s\in\frac1N\ZZ/\ZZ$, we must check hat
		\[r_N(ds)\stackrel?=\sum_{k=0}^{d-1}r_N\left(s+\frac kd\right).\]
		We begin with a few reductions. By adjusting $s$ by some $k/d$, we may assume that $\op{ord}s$ is divisible by $d$. By inductively applying the distribution relations, we may assume that $d$ is prime. Lastly, because $i$ defined in the previous step is injective, we can pass from $r_N$ to $r_{\op{ord}s}$, allowing us to assume that $\op{ord}s=N$. We now have two cases for the prime divisor $d$ of $N$.
		\begin{itemize}
			\item Suppose that $d^2\mid N$. In this case, all primes dividing $\op{ord}s=N$ continue to divide $\op{ord}ds=N/d$. Additionally, $s+\frac kd$ always has order $N$, so
			\[\sum_{k=0}^{d-1}r_N\left(s+\frac kd\right)=\Bigg(\frac1{\varphi(N)}\sum_{k=0}^{d-1}X_N\left(s+\frac kd\right)\Bigg)\prod_{p\mid N}\left(1-\frac{Y_N(p)}{\#Y_N(p)}\right).\]
			Because $s+\frac kd$ has order $N$, we see $X_N\left(s+\frac kd\right)=\overline{N(s+\frac kd)}$. On the other hand, $X_N(ds)$ consists of the $x$ for which $dx\equiv d(Ns)$, which is equivalent to having $x=N(s+\frac kd)$. We conclude
			\[\sum_{k=0}^{d-1}r_N\left(s+\frac kd\right)=\frac{X_N(ds)}{\varphi(N)}\prod_{p\mid N}\left(1-\frac{Y_N(p)}{\#Y_N(p)}\right),\]
			which is $r_N(ds)$.
			\item Suppose $d\mid N$ while $d^2\nmid N$. The same computation essentially goes through except for two caveats: $\op{ord}ds=N/d$ has one fewer prime factor, and $s+\frac kd$ need not have order $N$. In particular, the $p$-component of $s+\frac kd$ is the same as the same $p$-component of $s$, so the order of $s+\frac kd$ is either $N$ or $N/d$. Further, and we see that it will be $N/d$ only when $s+\frac kd$ has $d$-component equal to $0$ for exactly when $k$; say that $t=s+\frac{k_0}d$ is this value of $k$. Then
			\[\sum_{k=0}^{d-1}r_N\left(s+\frac kd\right)=\frac1{\varphi(N)}\Bigg(X_N(t)+\sum_{k=1}^{d-1}X_N\left(t+\frac kd\right)\left(1-\frac{Y_N(d)}{\#Y_N(d)}\right)\Bigg)\prod_{p\mid N/d}\left(1-\frac{Y_N(p)}{\#Y_N(p)}\right).\]
			Comparing this to $r_N(ds)=r_N(dt)$, we see that we have left to show
			\[X_N(dt)\stackrel?=X_N(t)+\sum_{k=1}^{d-1}X_N\left(t+\frac kd\right)\left(1-\frac{Y_N(d)}{\#Y_N(d)}\right),\]
			which is equivalent to
			\[X_N(dt)+\frac1{\#Y_N(d)}\sum_{k=1}^{d-1}X_N\left(t+\frac kd\right)Y_N(d)\stackrel?=X_N(t)+\sum_{k=1}^{d-1}X_N\left(t+\frac kd\right).\]
			We now must compute the various $X_N$s.
			\begin{itemize}
				\item Each $t+\frac kd$ has order $N$ by construction of $t$, so $X_N\left(t+\frac kd\right)=\overline{N(t+\frac kd)}$. As such, multiplying by $Y_N(d)$ will leave us with $x\in(\ZZ/N\ZZ)^\times$ such that $x\equiv{\frac Nd(t+\frac kd)}\pmod{N/d}$, which is equivalent to $x\equiv\frac Ndt\pmod{N/d}$; in particular, the sum on the left-hand side counts all these elements $\#Y_N(d)=(d-1)$ times. On the other hand, $X_N(t)$ consists of the $x$ for which $dx\equiv Nt$, which is equivalent to $x\equiv\frac Ndt\pmod{N/d}$, so
				\[\frac1{\#Y_N(d)}\sum_{k=1}^{d-1}X_N\left(t+\frac kd\right)=X_N(t).\]
				\item Similarly, $dt$ has order $N/d$, so $X_N(dt)$ consists of the $x\in(\ZZ/N\ZZ)^\times$ such that $dx\equiv Ndt$. Well, this is equivalent to having $x\equiv\overline{N(t+\frac kd)}$, so
				\[X_N(dt)=\sum_{k=1}^{d-1}X_N\left(t+\frac kd\right).\]
			\end{itemize}
			Combining the above two points completes the computation.
		\end{itemize}

		\item We begin computing $\langle\im r_N\rangle_\QQ$. For each prime $p\mid N$, define the fractional ideal
		\[U_p\coloneqq X_N\left(\frac{p^{\nu_p(N)}}N\right)\ZZ\left[(\ZZ/N\ZZ)^\times\right]+\left(1-\frac{Y_N(p)}{\#Y_N(p)}\right)\ZZ\left[(\ZZ/N\ZZ)^\times\right].\]
		We claim that $\langle\im r_N\rangle$ equals $\prod_{p\mid N}U_p$. Because $r_N$ respects the $(\ZZ/N\ZZ)^\times$-action, it is enough to check that $\langle\im r_N\rangle$ is given by generators of this ideal. Well, a generic generator of $\prod_{p\mid N}U_p$ looks like
		\[\prod_{p\nmid M}X_N\left(\frac{p^{\nu_p(N)}}N\right)\prod_{p\mid M}\left(1-\frac{Y_N(p)}{\#Y_N(p)}\right),\]
		where $M$ is some divisor of $N$; in fact, we may as well assume $\nu_p(M)\in\{0,\nu_p(N)\}$ for all primes $p$. We claim that the above element is $\varphi(N)r_N(1/M)$; this claim completes this step. To show the claim, we note the right product is already seen in $r_N(1/M)$. It thus remains to show that
		\[\prod_{p\nmid M}X_N\left(\frac{p^{\nu_p(N)}}N\right)\stackrel?=X_N\left(\frac1M\right).\]
		Indeed, the left-hand side is made of products $\prod_{p\nmid M}x_p$ where $x_p\cdot p^{\nu_p(N)}\equiv p^{\nu_p(N)}\pmod N$, which is equivalent to a condition on $x_p\equiv1\pmod{N/p^{\nu_p(N)}}$. By the Chinese remainder theorem, such products are in bijection with $x$s such that $x\equiv1\pmod{N/M}$, which is $X_N(1/M)$.

		\item We claim that $(U_p)_\QQ=\QQ\left[(\ZZ/N\ZZ)^\times\right]$. Because $(\#Y_N(p)-Y_N(p))\in U_p$, it is enough to check that $Y_N(p)\in U_p$. In fact, we claim that $Y_N(p)$ is a multiple of $X_N\left(p^{\nu_p(N)}/N\right)$, which will complete the proof. Well, $Y_N(p)$ has $x$ such that $px\equiv1\pmod{N/p^{\nu_p(N)}}$, and $X_N\left(p^{\nu_p(N)}/N\right)$ has $x$ such that $x\equiv1\pmod{N/p^{\nu_p(N)}}$ as discussed in the previous step. Thus, we see
		\[p'X_N\left(\frac{p^{\nu_p(N)}}N\right)=Y_N(p),\]
		where $p'\in(\ZZ/N\ZZ)^\times$ is chosen so that $p'\equiv p\pmod{N/p^{\nu_p(N)}}$, and the claim follows.
	\end{enumerate}
	Thus, we have checked that $r_N$ is a distribution, and the last two steps check that $\langle\im r_N\rangle_\QQ=A_N$, so $\dim\langle\im r_N\rangle_\QQ=\varphi(N)$ follows.
\end{proof}

\subsection{Cohomology of the Universal Distribution}
Let $i\colon\frac1N\ZZ/\ZZ\to U_N$ be the initial distribution of \Cref{ex:universal-distribution}, and further let $U_N^-$ be the quotient of $U_N$ by the elements $\langle\ov a+\ov{-a}\rangle_{a\in\frac1N\ZZ/\ZZ}$. The quotient $U_N^-$ is of interest to us because $\Gamma$ factors through $U_N^-$ by combining the reflection formula (\Cref{prop:gamma-prod-props}) with \Cref{ex:gamma-as-distribution}.

We are now ready to state the main result of this subsection.
\begin{theorem} \label{thm:distribution-torsion}
	Let $i\colon\frac1N\ZZ/\ZZ\to U_N$ be the initial distribution of \Cref{ex:universal-distribution}, and further let $U_N^-$ be the quotient of $U_N$ by the elements $\langle\ov a+\ov{-a}\rangle_{a\in\frac1N\ZZ/\ZZ}$.
	\begin{listalph}
		\item The torsion subgroup $U_{N,\mathrm{tors}}^-$ is $2$-torsion.
		\item If $N$ is odd or divisible by $4$, then $\dim_{\FF_2}U_{N,\mathrm{tors}}^-=2^{\omega(N)-1}$, where $\omega(N)$ is the number of distinct prime factors of $N$.
	\end{listalph}
\end{theorem}
\begin{proof}[Proof from \Cref{prop:odd-distrib-2,prop:odd-distrib-rank}]
	As in the previous subsection, we go ahead and outline the argument, referring forward to results we will prove in the sequel. There are two steps: in \Cref{prop:odd-distrib-2}, we show that $U_{N,\mathrm{tors}}^-$ is isomorphic to the cohomology group $\mathrm H^2(\langle\pm1\rangle,U_N)$, thereby proving (a). The dimension computation for this cohomology group is carried out in \Cref{prop:odd-distrib-rank}.
\end{proof}
We now turn our attention to the proofs of \Cref{prop:odd-distrib-2} and \Cref{prop:odd-distrib-rank}.
\begin{proposition} \label{prop:odd-distrib-2}
	Let $i\colon\frac1N\ZZ/\ZZ\to U_N$ be the initial distribution of \Cref{ex:universal-distribution}. Further, let $U_N^-$ be the quotient by the elements $\langle\ov a+\ov{-a}\rangle_{a\in\frac1N\ZZ/\ZZ}$. Then the torsion subgroup of $U_N^-$ is isomorphic to
	\[\mathrm H^2(\langle\pm1\rangle,U_N).\]
\end{proposition}
\begin{proof}
	This is an application of \Cref{thm:free-abelian-distribution}. We follow \cite[Proposition~6.3.3]{ggl-fermat}. Note that the action of $\langle\pm1\rangle\subseteq(\ZZ/N\ZZ)^\times$ on $\frac1N\ZZ/\ZZ$ extends to $U_N$. We will actually show that $U_{N,\mathrm{tors}}^-$ is isomorphic to the Tate cohomology group
	\[\mathrm H^0_{\mathrm T}(\langle\pm1\rangle,U_N)=\frac{U_N^{\langle\pm1\rangle}}{\op N_{\langle\pm1\rangle}(U_N)},\]
	which is enough because the group cohomology of a cyclic group is $2$-periodic. We have two inclusions.
	\begin{itemize}
		\item On one hand, the denominator of $\mathrm H^0_{\mathrm T}(\langle\pm1\rangle,U_N)$ is basically modding out by the elements $\ov a+\ov{-a}$. Thus, we have an inclusion $\mathrm H^0_{\mathrm T}(\langle\pm1\rangle,U_N)\subseteq U_N^-$, so $\mathrm H^0_{\mathrm T}(\langle\pm1\rangle,U_N)\subseteq U_{N,\mathrm{tors}}^-$ because Tate cohomology groups are torsion.

		\item On the other hand, choose some $f\in U_{N,\mathrm{tors}}^-$, and we would like to check that $f\in U_N^{\langle\pm1\rangle}$. Well, we are given that there is some $D>0$ such that $Df$ vanishes in $U_N^-$, so $Df=(\ov 1+\ov{-1})g$ (in $U_N$) for some $g\in U_N$. However, this implies that $(\ov 1-\ov{-1})Df=0$ in $U_N$, which requires $(\ov 1-\ov{-1})f=0$ because $U_N$ is torsion-free by \Cref{thm:free-abelian-distribution}! We conclude that $f\in U_N^{\langle\pm1\rangle}$.
		\qedhere
	\end{itemize}
\end{proof}
Before proceeding with the long proof of \Cref{prop:odd-distrib-rank}, we pick up a group-theoretic lemma.
\begin{lemma} \label{lem:free-invariant-coinvariant}
	Fix finite abelian groups $G$ and $H$. If $M$ is a free $\ZZ[G\times H]$-module, then $M^H$ and $M/M^H$ are both free $\ZZ[G]$-modules.
\end{lemma}
\begin{proof}
	Because $M$ is a module over $G\times H$, we see that $M^H$ is still a $G$-module. Quickly, note that $M$ is a sum of $\ZZ[G\times H]$s, so because taking $(\cdot)^H$ and the quotient are both additive functors, it suffices to check the result for $M=\ZZ[G\times H]$. We now show that $M^H$ and $M/M^H$ are free independently.
	\begin{itemize}
		\item We show that $M^H$ is a free $\ZZ[G]$-module. Indeed, some element $\sum_{(g,h)}a_{(g,h)}(g,h)$ is $H$-invariant if and only if $a_{(g,h)}=a_{(g,h')}$ always, in which case we see that
		\[\sum_{(g,h)\in G\times H}a_{(g,h)}(g,h)=\sum_{g\in G}\Bigg(a_{(g,1)}(g,1)\sum_{h\in H}(1,h)\Bigg).\]
		Thus, we see that the map $\ZZ[G]\to\ZZ[G\times H]^H$ given by multiplying by $\sum_h(1,h)$ is an isomorphism.
		\item We show that $M/M^H$ is a free $\ZZ[G]$-module. Quickly, observe that $\ZZ[G\times H]$ is free over $\ZZ[G]$ with a basis given by $\{(1,h)\}_{h\in H}$, so we may apply a linear transformation to see that $\ZZ[G\times H]$ is free over $\ZZ[G]$ with basis instead given by
		\[\left\{\sum_h(1,h)\right\}\sqcup\{(1,h)\}_{h\ne1}.\]
		The first element is a basis of $\ZZ[G\times H]^H$ over $\ZZ[G]$ by the previous point, so we see that the quotient is free over $\ZZ[G]$ with basis given by the remaining entries.
		\qedhere
	\end{itemize}
\end{proof}
\begin{proposition}[Kubert] \label{prop:odd-distrib-rank}
	Fix a positive integer $N$ which is odd or divisible by $4$, and let $i\colon\frac1N\ZZ/\ZZ\to U_N$ be the initial distribution of \Cref{ex:universal-distribution}. Then
	\[\dim_{\FF_2}\mathrm H_{\mathrm T}^\bullet(\langle\pm1\rangle,U_N)=2^{\omega(N)-1},\]
	where $\omega(N)$ is the number of distinct prime factors of $N$.
\end{proposition}
\begin{proof}
	Our argument follows \cite[Section~2]{kubert-cohom}. We continue with the set-up of \Cref{prop:free-abelian-distribution-lower}, but we drop all the subscript $N$s because we will work with fixed $N$ throughout. Thus, we may also set $\nu_p\coloneqq\nu_p(N)$ for each prime $p$. In particular, by the universal property (and as outlined in \Cref{thm:free-abelian-distribution}), we see that $U_N$ is isomorphic to the image of induced map $r\colon\ZZ\left[\frac1N\ZZ/\ZZ\right]\to\QQ\left[(\ZZ/N\ZZ)^\times\right]$.
	
	We will need a few other pieces of notation. For bookkeeping reasons, we say that a divisor $M\mid N$ is admissible if and only if $\nu_p(M)\in\{0,\nu_p\}$ for all primes $p$; roughly speaking, $M$ keeps track of a subset of primes dividing $N$. For example, for each admissible divisor $M\mid N$, we define
	\[U(M)\coloneqq\prod_{p\mid M}U_p,\]
	where $U_p$ is the ideal defined at the end of the proof of \Cref{prop:free-abelian-distribution-lower}; for example, $U(1)=\ZZ\left[(\ZZ/N\ZZ)^\times\right]$ and $U(N)=\im r$. In short, $U(M)$s will allow us to make certain inductive arguments.

	Continuing, for each admissible divisor $M\mid N$, we define the subgroup $C(M)\subseteq(\ZZ/N\ZZ)^\times$ by
	\[C(M)\coloneqq\{a\in(\ZZ/N\ZZ)^\times:a\equiv1\pmod{N/M}\}.\]
	Thus, $C(M)\cong\prod_{p\mid M}(\ZZ/p^{\nu_p}\ZZ)^\times$ is isomorphic to $(\ZZ/M\ZZ)^\times$. For example, $C(1)=(\ZZ/N\ZZ)^\times$ and $C(N)=\{1\}$. We also remark that the sum $Y(p)$ is fixed by $C(p^{\nu_p})$ by contruction (in fact, the set admits a transitive action), and a quick expansion of the definitions reveals that $X\left(p^{\nu_p}/N\right)=C(p^{\nu_p})$. As usual, we may identify $C(p^{\nu_p})$ with an element of $\ZZ\left[(\ZZ/N\ZZ)^\times\right]$ given by $\sum_{a\in C(p^{\nu_p})}\ov a$.

	In the end, we will show that
	\[\dim_{\FF_2}\mathrm H^\bullet_{\mathrm T}\left(\langle\pm1\rangle,U(M)^{C(N/M)}\right)\stackrel?=2^{\omega(M)-1}\]
	for any admissible divisor $M\mid N$ bigger than $1$, via an induction; taking $M=N$ then produces the desired result. Our proof now proceeds in many steps. We remark that our first few steps are picking up some technica tools used later.
	\begin{enumerate}
		\item Let $\varepsilon_p\in\QQ\left[(\ZZ/N\ZZ)^\times\right]$ be the idempotent $\frac1{\#C(p^{\nu_p})}\sum_{a\in C(p^{\nu_p})}\ov a$. Then we claim that $x\in\QQ\left[(\ZZ/N\ZZ)^\times\right]$ is fixed by $C(p^{\nu_p})$ if and only if $(1-\varepsilon_p)x=0$. This is some abstract group theory. In one direction, if $x$ is fixed by $C(p^{\nu_p})$, then
		\[\frac1{\#C(p)}\sum_{a\in C(p^{\nu_p})}ax=\frac1{\#C(p^{\nu_p})}\sum_{a\in C(p^{\nu_p})}x\]
		is simply $x$. In the other direction, if $(1-\varepsilon_p)x=0$, then $x=\varepsilon_px$; however, $a\varepsilon_p=\varepsilon_p$ for all $a\in C(p^{\nu_p})$ by a rearrangement of the terms in $\varepsilon_p$, so we see that $\varepsilon_px$ is certainly fixed by $C(p^{\nu_p})$.

		\item For an admissible divisor $M\mid N$ and prime $p\mid(N/M)$, we claim that $(1-\varepsilon_p)U\left(Mp^{\nu_p}\right)=(1-\varepsilon_p)U_M$ and
		\[U\left(Mp^{\nu_p}\right)^{C\left(p^{\nu_p}\right)}\stackrel?=C(p^{\nu_p})\cdot U(M)+\left(1-\frac{Y(p)}{\#Y(p)}\right)U(M)^{C\left(p^{\nu_p}\right)},\]
		where $C(p)$ refers to the element $\sum_{a\in C(p)}\ov a$ by abuse of notation.
		
		For this, we note $U\left(Mp^{\nu_p}\right)=U_pU(M)$ by definition, so
		\[U\left(Mp^{\nu_p}\right)=C\left(p^{\nu_p}\right)U(M)+\left(1-\frac{Y(p)}{\#Y(p)}\right)U(M).\]
		The first and the second claimed equalities are linked by the previous step, which tells us that we are interested in the kernel of $(1-\varepsilon_p)$. As such, let's look at how $(1-\varepsilon_p)$ behaves on each term.
		\begin{itemize}
			\item Certainly $(1-\varepsilon_p)$ vanishes on $C\left(p^{\nu_p}\right)$, so the left term above lives in the kernel.
			\item Similarly, $Y(p)$ is fixed by $C\left(p^{\nu_p}\right)$, so it is in the kernel of $(1-\varepsilon_p)$, from which one sees $(1-\varepsilon_p)\left(1-\frac{Y(p)}{\#Y(p)}\right)=(1-\varepsilon_p)$. For example, we see that multiplying by $(1-\varepsilon_p)$ kills the coefficient $\left(1-\frac{Y(p)}{\#Y(p)}\right)$. Additionally, the kernel of $(1-\varepsilon_p)$ will simply be the kernel of $(1-\varepsilon_p)$ acting on $U(M)$.
		\end{itemize}
		Combining these two points completes the proof.

		\item Suppose that $M$ and $M'$ are admissible divisors of $N$ such that $MM'\mid N$. Then we claim that $U(M)$ is free as a $C(M')$-module; further, if $MM'\ne N$, we claim that $U(M)$ is free as a $\pm C(M')$-module.
		
		For this, we induct on $M$. If $M=1$, then $U(M)$ is free over all subgroups of $(\ZZ/N\ZZ)^\times$, so there is nothing to do. Thus, we focus on the inductive step, so suppose that the statement is true for $M$, and we would like to show it for $Mp^{\nu_p}$ for some prime $p\mid(N/M)$. Then the previous step provides short exact sequences as follows.
		% https://q.uiver.app/#q=WzAsMTAsWzAsMCwiMCJdLFsxLDAsIlUoTSlee0NcXGxlZnQocF57XFxudV9wfVxccmlnaHQpfSJdLFsyLDAsIlUoTSkiXSxbMiwxLCJVKE1wXntcXG51X3B9KSJdLFszLDAsIigxLVxcdmFyZXBzaWxvbl9wKVUoTSkiXSxbNCwwLCIwIl0sWzMsMSwiKDEtXFx2YXJlcHNpbG9uX3ApVShNcF57XFxudV9wfSkiXSxbNCwxLCIwIl0sWzEsMSwiVShNcF57XFxudV9wfSlee0MocF57XFxudV9wfSl9Il0sWzAsMSwiMCJdLFsxLDJdLFsyLDRdLFs0LDVdLFswLDFdLFs5LDhdLFs4LDNdLFszLDZdLFs2LDddLFs0LDYsIiIsMSx7ImxldmVsIjoyLCJzdHlsZSI6eyJoZWFkIjp7Im5hbWUiOiJub25lIn19fV1d&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
		\[\begin{tikzcd}[cramped]
			0 & {U(M)^{C\left(p^{\nu_p}\right)}} & {U(M)} & {(1-\varepsilon_p)U(M)} & 0 \\
			0 & {U(Mp^{\nu_p})^{C(p^{\nu_p})}} & {U(Mp^{\nu_p})} & {(1-\varepsilon_p)U(Mp^{\nu_p})} & 0
			\arrow[from=1-1, to=1-2]
			\arrow[from=1-2, to=1-3]
			\arrow[from=1-3, to=1-4]
			\arrow[from=1-4, to=1-5]
			\arrow[equals, from=1-4, to=2-4]
			\arrow[from=2-1, to=2-2]
			\arrow[from=2-2, to=2-3]
			\arrow[from=2-3, to=2-4]
			\arrow[from=2-4, to=2-5]
		\end{tikzcd}\]
		The main claim is that $U(M)^{C(p^{\nu_p})}=U(Mp^{\nu_p})^{C(p^{\nu_p})}$. Let's quickly explain why this claim will complete this step. Fix an admissible divisor $M'\mid (N/Mp^{\nu_p})$, and then there are two things to show.
		\begin{itemize}
			\item We would like to show that $U(Mp^{\nu_p})$ is free over $C(M')$. By the inductive hypothesis, we know that $U(M)$ is free over $C(M')$ and $C(p^{\nu_p})$ and even over the product of the two groups. Thus, \Cref{lem:free-invariant-coinvariant} tells us that $U(M)^{C(p^{\nu_p})}=U(Mp^{\nu_p})^{C(p^{\nu_p})}$ and $(1-\varepsilon_p)U(M)=(1-\varepsilon_p)U(Mp^{\nu_p})$ are both free over $C(M')$. Because the right term of the bottom short exact sequence is free, we conclude that the bottom short exact sequence thus splits, forcing $U(Mp^{\nu_p})$ to be a sum of free $C(M')$-modules and hence free.
			\item Suppose $MM'p^{\nu_p}\ne N$. Then we would like to show that $U(Mp^{\nu_p})$ is free over $\pm C(M')$. In this case, $U(M)$ is free over $\pm C(p^{\nu_p})C(M')$ by the induction, but $\pm C(M')\cap C(p^{\nu_p})$ is trivial: any element $a$ in the intersection has $a\equiv1\pmod{N/p^{\nu_p}}$ and $a\equiv\pm1\pmod{N/M'}$, but the $+1$ is forced by having $N/(M'p^{\nu_p})$ be bigger than $2$ by the hypotheses on $N$. Thus, $U(M)$ is actually free over $\pm C(M')\times C(p^{\nu_p})$, and now the argument can proceed as in the previous step. 
		\end{itemize}
		It remains to prove the main claim $U(M)^{C(p^{\nu_p})}=U(Mp^{\nu_p})^{C(p^{\nu_p})}$. Well, the previous step grants
		\[U\left(Mp^{\nu_p}\right)^{C\left(p^{\nu_p}\right)}=C(p^{\nu_p})\cdot U(M)+\left(1-\frac{Y(p)}{\#Y(p)}\right)U(M)^{C\left(p^{\nu_p}\right)}.\]
		By the inductive hypothesis, $U(M)$ is free over $C(p^{\nu_p})$, so $U(M)^{C(p^{\nu_p})}=C(p^{\nu_p})\cdot U(M)$. Thus, it is enough to show that $\left(1-\frac{Y(p)}{\#Y(p)}\right)U(M)^{C\left(p^{\nu_p}\right)}\subseteq U(M)^{C(p^{\nu_p})}$. Well, $Y(p)$ is stable under $C(p^{\nu_p})$, so we can express $\left(1-\frac{Y(p)}{\#Y(p)}\right)\cdot C(p^{\nu_p})$ as $(1-y)\cdot C(p^{\nu_p})$ for some $y\in Y(p)$, and the result follows because $U(M)$ is a fractional ideal for $\ZZ\left[(\ZZ/N\ZZ)^\times\right]$.

		\item As a last tool, we show that the induced action of $(\ZZ/N\ZZ)^\times$ on $\mathrm H^\bullet\left(\langle\pm1\rangle,U(M)^{C(N/M)}\right)$ is trivial for any admissible divisor $M\mid N$. In fact, it's enough to check that the action of $C(p^{\nu_p})$ is trivial because these subgroups generate $(\ZZ/N\ZZ)^\times$. Now, note that $U(M)^{C(N/M)}$ automatically has trivial action by $C(p^{\nu_p})$ if $p\nmid M$, so we now focus on the case $p\mid M$.

		Well, for a given $a\in C(p^{\nu_p})$, we would like to show that the action of $a$ is trivial, for which it is enough to show that the action of $(1-a)$ is zero. Well, we claim that multiplication by $(1-a)$ factors through $\mathrm H^\bullet_{\mathrm T}\left(\langle\pm1\rangle,U(M/p^{\nu_p})^{C(N/M)}\right)$, which we note vanishes because $U(M/p^{\nu_p})^{C(N/M)}$ is free over $\langle\pm1\rangle$ by the previous step!

		Now, to show that multiplication by $(1-a)$ factors as claimed, it is enough by functoriality to show that multiplication by $(1-a)$ on $U(M)$ factors through $U(M/p^{\nu_p})$. Well, we see
		\[U(M)=C\left(p^{\nu_p}\right)U(M/p^{\nu_p})+\left(1-\frac{Y(p)}{\#Y(p)}\right)U(M/p^{\nu_p}).\]
		Note $(1-a)C\left(p^{\nu_p}\right)=0$, and $(1-a)\left(1-\frac{Y(p)}{\#Y(p)}\right)=(1-a)$ because $Y(p)$ is fixed by $a$. Thus, $(1-a)U(M)\subseteq U(M/p^{\nu_p})$, as needed.

		\item If $M$ and $Mp^{\nu_p}$ are admissible divisors of $N$, we claim that there is a short exact sequence
		\[0\to\mathrm H^\bullet_{\mathrm T}\left(\langle\pm1\rangle,U(M)^{C(N/M)}\right)\to\mathrm H^\bullet_{\mathrm T}\left(\langle\pm1\rangle,U(Mp^{\nu_p})^{C(N/Mp^{\nu_p})}\right)\to \mathrm H^{\bullet+1}_{\mathrm T}\left(\langle\pm1\rangle,U(M)^{C(N/M)}\right)\to0.\]
		Note that we will have to do something nontrivial (beyond immediately applying a long exact sequence) because the middle group has a different invariant subgroup $C$ acting on it. Our extra input will come from the morphism
		% https://q.uiver.app/#q=WzAsMTAsWzAsMCwiMCJdLFsxLDAsIlUoTSlee0MocF57XFxudV9wfSl9Il0sWzEsMSwiVShNcF57XFxudV9wfSlee0MocF57XFxudV9wfSl9Il0sWzAsMSwiMCJdLFsyLDAsIlUoTSkiXSxbMywwLCIoMS1cXHZhcmVwc2lsb25fcClVKE0pIl0sWzMsMSwiKDEtXFx2YXJlcHNpbG9uX3ApVShNcF57XFxudV9wfSkiXSxbMiwxLCJVKE1wXntcXG51X3B9KSJdLFs0LDAsIjAiXSxbNCwxLCIwIl0sWzAsMV0sWzMsMl0sWzEsMiwiXFxsZWZ0KDEtXFxmcmFje1kocCl9e1xcI1kocCl9XFxyaWdodCkiLDJdLFsxLDRdLFsyLDddLFs3LDYsIigxLVxcdmFyZXBzaWxvbl9wKSJdLFs0LDUsIigxLVxcdmFyZXBzaWxvbl9wKSJdLFs1LDhdLFs2LDldLFs0LDcsIlxcbGVmdCgxLVxcZnJhY3tZKHApfXtcXCNZKHApfVxccmlnaHQpIiwyXSxbNSw2XV0=&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
		\[\begin{tikzcd}[cramped]
			0 & {U(M)^{C(p^{\nu_p})}} & {U(M)} & {(1-\varepsilon_p)U(M)} & 0 \\
			0 & {U(Mp^{\nu_p})^{C(p^{\nu_p})}} & {U(Mp^{\nu_p})} & {(1-\varepsilon_p)U(Mp^{\nu_p})} & 0
			\arrow[from=1-1, to=1-2]
			\arrow[from=1-2, to=1-3]
			\arrow["{\left(1-\frac{Y(p)}{\#Y(p)}\right)}"', from=1-2, to=2-2]
			\arrow["{(1-\varepsilon_p)}", from=1-3, to=1-4]
			\arrow["{\left(1-\frac{Y(p)}{\#Y(p)}\right)}"', from=1-3, to=2-3]
			\arrow[from=1-4, to=1-5]
			\arrow[from=1-4, to=2-4]
			\arrow[from=2-1, to=2-2]
			\arrow[from=2-2, to=2-3]
			\arrow["{(1-\varepsilon_p)}", from=2-3, to=2-4]
			\arrow[from=2-4, to=2-5]
		\end{tikzcd}\]
		of exact sequences discussed in the third step; note that the left arrow is well-defined by the second step, and right arrow is then induced by the diagram. Before continuing, we make a few simplifiactions to this diagram.
		\begin{itemize}
			\item In the third step, we showed that $U(M)^{C(p^{\nu_p})}=U(Mp^{\nu_p})^{C(p^{\nu_p})}$.
			\item Recall that $Y(p)$ is fixed by $C(p^{\nu_p})$, so $(1-\varepsilon_p)\left(1-\frac{Y(p)}{\#Y(p)}\right)=(1-\varepsilon_p)$, thereby implying that the right arrow is simply the identity. We no longer care about the exact content of this right-hand term, so we denote it by $K\coloneqq(1-\varepsilon_p)U(M)=(1-\varepsilon_p)U(Mp^{\nu_p})$.
			\item Using the fact that the set $Y(p)$ has a transitive action  by $C(p^{\nu_p})$, we see that multiplying an element of $U(M)^{C(p^{\nu_p})}$ by $Y(p)$ is the same as multiplying it by any other element. Thus, we go ahead and fix some element $y_p\in Y(p)$, and we see that the left arrow is simply multiplication by $(1-y_p)$.
		\end{itemize}
		Our diagram now looks like the following.
		% https://q.uiver.app/#q=WzAsMTAsWzAsMCwiMCJdLFsxLDAsIlUoTSlee0MocF57XFxudV9wfSl9Il0sWzEsMSwiVShNcF57XFxudV9wfSlee0MocF57XFxudV9wfSl9Il0sWzAsMSwiMCJdLFsyLDAsIlUoTSkiXSxbMywwLCJLIl0sWzMsMSwiSyJdLFsyLDEsIlUoTXBee1xcbnVfcH0pIl0sWzQsMCwiMCJdLFs0LDEsIjAiXSxbMCwxXSxbMywyXSxbMSwyLCIoMS15X3ApIiwyXSxbMSw0XSxbMiw3XSxbNyw2XSxbNCw1XSxbNSw4XSxbNiw5XSxbNCw3LCJcXGxlZnQoMS1cXGZyYWN7WShwKX17XFwjWShwKX1cXHJpZ2h0KSIsMl0sWzUsNiwiIiwxLHsibGV2ZWwiOjIsInN0eWxlIjp7ImhlYWQiOnsibmFtZSI6Im5vbmUifX19XV0=&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
		\[\begin{tikzcd}[cramped]
			0 & {U(M)^{C(p^{\nu_p})}} & {U(M)} & K & 0 \\
			0 & {U(M)^{C(p^{\nu_p})}} & {U(Mp^{\nu_p})} & K & 0
			\arrow[from=1-1, to=1-2]
			\arrow[from=1-2, to=1-3]
			\arrow["{(1-y_p)}"', from=1-2, to=2-2]
			\arrow[from=1-3, to=1-4]
			\arrow["{\left(1-\frac{Y(p)}{\#Y(p)}\right)}"', from=1-3, to=2-3]
			\arrow[from=1-4, to=1-5]
			\arrow[equals, from=1-4, to=2-4]
			\arrow[from=2-1, to=2-2]
			\arrow[from=2-2, to=2-3]
			\arrow[from=2-3, to=2-4]
			\arrow[from=2-4, to=2-5]
		\end{tikzcd}\]
		We now take $C(N/Mp^{\nu_p})$-invariants and $\langle\pm1\rangle$-cohomology to recover the result. Taking $C(N/Mp^{\nu_p})$-invariants keeps the exactness because $U(M)^{C(p^{\nu_p})}$ is free over $C(N/Mp^{\nu_p})$ by using \Cref{lem:free-invariant-coinvariant} and the result in step 3. Thus, our diagram looks like the following.
		% https://q.uiver.app/#q=WzAsMTAsWzAsMCwiMCJdLFsxLDAsIlUoTSlee0MoTi9NKX0iXSxbMSwxLCJVKE1wXntcXG51X3B9KV57QyhOL00pfSJdLFswLDEsIjAiXSxbMiwwLCJVKE0pXntDKE4vTXBee1xcbnVfcH0pfSJdLFszLDAsIktee0MoTi9NcF57XFxudV9wfSl9Il0sWzMsMSwiS157QyhOL01wXntcXG51X3B9KX0iXSxbMiwxLCJVKE1wXntcXG51X3B9KV57QyhOL01wXntcXG51X3B9KX0iXSxbNCwwLCIwIl0sWzQsMSwiMCJdLFswLDFdLFszLDJdLFsxLDIsIigxLXlfcCkiLDJdLFsxLDRdLFsyLDddLFs3LDZdLFs0LDVdLFs1LDhdLFs2LDldLFs0LDcsIlxcbGVmdCgxLVxcZnJhY3tZKHApfXtcXCNZKHApfVxccmlnaHQpIiwyXSxbNSw2LCIiLDEseyJsZXZlbCI6Miwic3R5bGUiOnsiaGVhZCI6eyJuYW1lIjoibm9uZSJ9fX1dXQ==&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
		\[\begin{tikzcd}[cramped]
			0 & {U(M)^{C(N/M)}} & {U(M)^{C(N/Mp^{\nu_p})}} & {K'} & 0 \\
			0 & {U(M)^{C(N/M)}} & {U(Mp^{\nu_p})^{C(N/Mp^{\nu_p})}} & {K'} & 0
			\arrow[from=1-1, to=1-2]
			\arrow[from=1-2, to=1-3]
			\arrow["{(1-y_p)}"', from=1-2, to=2-2]
			\arrow[from=1-3, to=1-4]
			\arrow["{\left(1-\frac{Y(p)}{\#Y(p)}\right)}"', from=1-3, to=2-3]
			\arrow[from=1-4, to=1-5]
			\arrow[equals, from=1-4, to=2-4]
			\arrow[from=2-1, to=2-2]
			\arrow[from=2-2, to=2-3]
			\arrow[from=2-3, to=2-4]
			\arrow[from=2-4, to=2-5]
		\end{tikzcd}\]
		Here, $K'$ is the induced quotient, which we continue to not care about. We now take $\langle\pm1\rangle$-cohomology. For brevity, we will set $\mathrm H^\bullet_{\mathrm T}(M')\coloneqq\mathrm H^\bullet_{\mathrm T}\left(\langle\pm1\rangle,U(M')^{C(N/M')}\right)$ for any admissible divisor $M'\mid N$.
		% https://q.uiver.app/#q=WzAsMTIsWzAsMSwiXFxtYXRocm0gSF57XFxidWxsZXQtMX1fe1xcbWF0aHJtIFR9KFxcbGFuZ2xlXFxwbTFcXHJhbmdsZSxLJykiXSxbMCwwLCJcXG1hdGhybSBIXntcXGJ1bGxldC0xfV97XFxtYXRocm0gVH0oXFxsYW5nbGVcXHBtMVxccmFuZ2xlLEsnKSJdLFsxLDAsIlxcbWF0aHJtIEheXFxidWxsZXRfe1xcbWF0aHJtIFR9KE0pIl0sWzEsMSwiXFxtYXRocm0gSF5cXGJ1bGxldF97XFxtYXRocm0gVH0oTSkiXSxbMiwwLCIwIl0sWzIsMSwiXFxtYXRocm0gSF5cXGJ1bGxldF97XFxtYXRocm0gVH0oTXBee1xcbnVfcH0pIl0sWzMsMCwiXFxtYXRocm0gSF5cXGJ1bGxldF97XFxtYXRocm0gVH0oXFxsYW5nbGVcXHBtMVxccmFuZ2xlLEsnKSJdLFs1LDAsIjAiXSxbMywxLCJcXG1hdGhybSBIXlxcYnVsbGV0X3tcXG1hdGhybSBUfShcXGxhbmdsZVxccG0xXFxyYW5nbGUsSycpIl0sWzUsMSwiXFxtYXRocm0gSF57XFxidWxsZXQrMX1fe1xcbWF0aHJtIFR9KE1wXntcXG51X3B9KSJdLFs0LDAsIlxcbWF0aHJtIEhee1xcYnVsbGV0KzF9X3tcXG1hdGhybSBUfShNKSJdLFs0LDEsIlxcbWF0aHJtIEhee1xcYnVsbGV0KzF9X3tcXG1hdGhybSBUfShNKSJdLFsxLDAsIiIsMCx7ImxldmVsIjoyLCJzdHlsZSI6eyJoZWFkIjp7Im5hbWUiOiJub25lIn19fV0sWzIsMywiKDEteV9wKSIsMl0sWzEsMl0sWzAsM10sWzEwLDExLCIoMS15X3ApIl0sWzIsNF0sWzQsNl0sWzYsMTBdLFszLDVdLFs1LDhdLFs4LDExXSxbMTEsOV0sWzEwLDddLFs3LDldLFs0LDVdLFs2LDhdXQ==&macro_url=https%3A%2F%2Fraw.githubusercontent.com%2FdFoiler%2Fnotes%2Fmaster%2Fnir.tex
		\[\begin{tikzcd}[cramped]
			{\mathrm H^{\bullet-1}_{\mathrm T}(\langle\pm1\rangle,K')} & {\mathrm H^\bullet_{\mathrm T}(M)} & 0 & {\mathrm H^\bullet_{\mathrm T}(\langle\pm1\rangle,K')} & {\mathrm H^{\bullet+1}_{\mathrm T}(M)} & 0 \\
			{\mathrm H^{\bullet-1}_{\mathrm T}(\langle\pm1\rangle,K')} & {\mathrm H^\bullet_{\mathrm T}(M)} & {\mathrm H^\bullet_{\mathrm T}(Mp^{\nu_p})} & {\mathrm H^\bullet_{\mathrm T}(\langle\pm1\rangle,K')} & {\mathrm H^{\bullet+1}_{\mathrm T}(M)} & {}
			\arrow[from=1-1, to=1-2]
			\arrow[equals, from=1-1, to=2-1]
			\arrow[from=1-2, to=1-3]
			\arrow["{(1-y_p)}"', from=1-2, to=2-2]
			\arrow[from=1-3, to=1-4]
			\arrow[from=1-3, to=2-3]
			\arrow[from=1-4, to=1-5]
			\arrow[from=1-5, to=1-6]
			\arrow[equals, from=1-4, to=2-4]
			\arrow["{(1-y_p)}", from=1-5, to=2-5]
			\arrow[from=2-1, to=2-2]
			\arrow[from=2-2, to=2-3]
			\arrow[from=2-3, to=2-4]
			\arrow[from=2-4, to=2-5]
		\end{tikzcd}\]
		Here, the $0$s arise because $U(M)^{C(N/Mp^{\nu_p})}$ is free over $\langle\pm1\rangle$ by the third step. We now make a few simplications.
		\begin{itemize}
			\item The $0$s in the top row imply that $\mathrm H^\bullet_{\mathrm T}(\langle\pm1\rangle,K')\to\mathrm H^{\bullet+1}_{\mathrm T}(M)$ is an isomorphism.
			\item By the previous step, we know that the $(1-y_p)$ arrows are the $0$ map. Thus, the commutativity of the diagram implies that the arrows $\mathrm H_{\mathrm T}^{\bullet-1}(\langle\pm1\rangle,K')\to\mathrm H^\bullet_{\mathrm T}(M)$ and $\mathrm H^\bullet_{\mathrm T}(\langle\pm1\rangle,K')\to\mathrm H^{\bullet+1}_{\mathrm T}(M)$ in the bottom row are both the zero map.
		\end{itemize}
		The above two observations turns the bottom row into
		\[0\to\mathrm H^\bullet_{\mathrm T}(M)\to\mathrm H^\bullet_{\mathrm T}(Mp^{\nu_p})\to\mathrm H^{\bullet+1}_{\mathrm T}(M)\to0.\]

		\item We now complete the proof by induction. We want to compute $\dim_{\FF_2}\mathrm H^\bullet_{\mathrm T}\left(\langle\pm1\rangle,U(M)^{C(N/M)}\right)$ for any admissible divisor $M\mid N$. The previous step grants an ``inductive step'' that
		\[\dim_{\FF_2}\mathrm H^\bullet_{\mathrm T}\left(\langle\pm1\rangle,U(Mp^{\nu_p})^{C(N/Mp^{\nu_p})}\right)=\sum_{i\in\{0,1\}}\dim_{\FF_2}\mathrm H^i_{\mathrm T}\left(\langle\pm1\rangle,U(M)^{C(N/M)}\right)\]
		whenever $M$ and $Mp^{\nu_p}$ is an admissible divisor of $N$. For example, we find that
		\[\dim_{\FF_2}\mathrm H^\bullet_{\mathrm T}\left(\langle\pm1\rangle,U(p^{\nu_p})^{C(N/p^{\nu_p})}\right)=\sum_{i\in\{0,1\}}\dim_{\FF_2}\mathrm H^i_{\mathrm T}\left(\langle\pm1\rangle,U(1)^{C(N)}\right)\]
		by taking $M=1$. But now this dimension is independent of the cohomological index, so we inductively see that
		\[\dim_{\FF_2}\mathrm H^\bullet_{\mathrm T}\left(\langle\pm1\rangle,U(M)^{C(N/M)}\right)=2^{\omega(M)-1}\sum_{i\in\{0,1\}}\dim_{\FF_2}\mathrm H^i_{\mathrm T}\left(\langle\pm1\rangle,U(1)^{C(N)}\right)\]
		for any admissible divisor $M\mid N$ such that $M>1$.

		The proof will be over as soon as we check
		\[\sum_{i\in\{0,1\}}\dim_{\FF_2}\mathrm H^i_{\mathrm T}\left(\langle\pm1\rangle,U(1)^{C(N)}\right)=1.\]
		Well, note $U(1)=\ZZ[(\ZZ/N\ZZ)^\times]$, so the $C(N)$-fixed points are given by $C(N)\cdot\ZZ[(\ZZ/N\ZZ)^\times]=\ZZ C(N)$. This has trivial action by $\langle\pm1\rangle$, so we are computing the Tate cohomology of the trivial $\langle\pm1\rangle$-module $\ZZ$. Well, one has
		\[\begin{cases}
			\mathrm H^0_{\mathrm T}(\langle\pm1\rangle,\ZZ) = \ZZ/2\ZZ, \\
			\mathrm H^{-1}_{\mathrm T}(\langle\pm1\rangle,\ZZ) = 0,
		\end{cases}\]
		so we see that the sum of the $\FF_2$-dimensions is in fact $1$.
		\qedhere
	\end{enumerate}
\end{proof}
\begin{remark} \label{rem:distrib-cohom-by-inclusion}
	Choose admissible divisors $M\mid M'$. The fifth step of the argument shows that there is an inclusion $U(M)^{C(N/M)}\subseteq U(M')^{C(N/M')}$ which then induces an inclusion
	\[\mathrm H^\bullet_{\mathrm T}\left(\langle\pm1\rangle,U(M)^{C(N/M)}\right)\to\mathrm H^\bullet_{\mathrm T}\left(\langle\pm1\rangle,U(M')^{C(N/M')}\right)\]
	on (Tate) cohomology. As seen in the fifth step of the argument, these inclusions explain ``half'' of the elements of a given $\mathrm H^\bullet_{\mathrm T}\left(U(M')^{C(N/M')}\right)$ by taking $M\mid M'$ to be $M'/p^{\nu_p}$ for some prime $p\mid M'$. The ``other half'' arises from a quotient and is thus harder to describe.
\end{remark}
\begin{example} \label{ex:const-is-nontrivial-in-h0}
	Let's exhibit a nontrivial element in $\mathrm H^0_{\mathrm T}(\langle\pm1\rangle,U_N)$. \Cref{rem:distrib-cohom-by-inclusion} explains that there is an inclusion $\ZZ[(\ZZ/N\ZZ)^\times]^{(\ZZ/N\ZZ)^\times}\subseteq U_N$ which induces an inclusion
	\[\mathrm H^0_{\mathrm T}\left(\langle\pm1\rangle,\ZZ[(\ZZ/N\ZZ)^\times]^{(\ZZ/N\ZZ)^\times}\right)\subseteq\mathrm H^0_{\mathrm T}(\langle\pm1\rangle,U_N).\]
	Now, $\ZZ[(\ZZ/N\ZZ)^\times]^{(\ZZ/N\ZZ)^\times}\subseteq U_N$ is isomorphic to $\ZZ$ generated by $\sum_{a\in(\ZZ/N\ZZ)^\times}\ov a$. Because this module has the trivial $\langle\pm1\rangle$-action, we see that this generating element $\sum_{a\in(\ZZ/N\ZZ)^\times}\ov a$ provides a nontrivial class in $\mathrm H^0_{\mathrm T}(\langle\pm1\rangle,U_N)$.
\end{example}

\subsection{Refined Algebraicity}
The previous subsections (and in particular \Cref{thm:distribution-torsion}) allows us to upgrade \Cref{prop:const-weight-to-distribs}.
\begin{lemma} \label{lem:2-const-weight-to-distribs}
	Let $f\colon\frac1N\ZZ/\ZZ\to\ZZ$ be a function of constant weight. Then $2f$ is a $\ZZ$-linear combination of the functions $1_0$ and $\varepsilon_{d,a}$ where $N\nmid da$.
\end{lemma}
\begin{proof}
	This is \cite[Proposition~6.3.6]{ggl-fermat}. By adding or subtracting $1_0$s (which have weight $0$), we may assume that $f(0)=0$. By \Cref{prop:const-weight-to-distribs}, we know that there is some denominator $D>0$ such that $Df$ is a $\ZZ$-linear combination of the functions $1_0$ and $\varepsilon_{d,a}$ where $N\nmid da$, and we can see that there are no $1_0$s because $f(0)=0$. Thus, \Cref{lem:const-weight-as-odd-distrib} tells us that $Df$ (up to $1_0$) vanishes in the group $U_N^-$ described in \Cref{thm:distribution-torsion}. This group is actually $2$-torsion by \Cref{thm:distribution-torsion}, so we conclude that $2f$ vanishes in $U_N^-$. Another application of \Cref{lem:const-weight-as-odd-distrib} tells us that $2f$ is a $\ZZ$-linear combination of the $\varepsilon_{d,a}$s.
\end{proof}
\begin{remark} \label{rem:effective-2-const-weight-to-distrib}
	In fact, once we know that $2f$ is a $\ZZ$-linear combination of $1_0$ and the $\varepsilon_{d,a}$s, one can use some linear algebra to explicitly find this linear combination. We take a moment to note that \Cref{rem:const-weight-as-odd-prime-distrib} tells us that we are allowed to only use $\varepsilon_{1,a}$s and $\varepsilon_{p,a}$s where $p\mid N$ is prime.
\end{remark}
Here is the appliation to products of $\Gamma$.
\begin{lemma} \label{lem:gamma-gen-from-distrib-relations}
	Let $K_N$ be the extension of $\QQ(\zeta_{2N},i)$ generated by the elements $\pi^{-w}\Gamma(f)$, where $f\colon\frac1N\ZZ/\ZZ$ is a function of constant weight $w$ which is a $\ZZ$-linear combination of the $\varepsilon_{d,a}$s. Then
	\[K_N=\QQ(i,\zeta_{2N})\left(\{p^{p/N}:\text{prime }p\mid N\}\right).\]
\end{lemma}
\begin{proof}
	It is enough to handle $f$ which are equal to some $\varepsilon_{d,a}$. One can inductively write $\varepsilon_{d,a}$ as a sum of $\varepsilon_{1,\bullet}$s and $\varepsilon_{p,\bullet}$s, so we can just handle those. By the reflection formula (\Cref{prop:gamma-prod-props}), $\Gamma(\varepsilon_{1,a})$ is in $\QQ(\zeta_{2N},i)$, so we don't have to worry about these elements.

	Continuing, by the multipliation formula (\Cref{prop:gamma-prod-props}), we see
	\[\frac{\Gamma(\varepsilon_{p,a})}{\Gamma(\varepsilon_{1,pa})}=(2\pi)^{(p-1)/2}p^{1/2-pa/N}.\]
	We now have two cases on the parity of $p$.
	\begin{itemize}
		\item If $p$ is odd, then these elements show $p^{1/2-pa/N}\in K_N$. However, $p^{1/2}\in\QQ(i,\zeta_{2N})$ already, so we are only generating $p^{p/N}\in K_N$.
		\item Similarly, if $p=2$, then these elements show $2^{1/2}\cdot2^{1/2-2/N}\in K_N$. Thus, we are again only generating $2^{2/N}\in K_N$.
		\qedhere
	\end{itemize}
\end{proof}
\begin{proposition} \label{prop:refined-gamma-alg}
	Let $L_N$ be the extension of
	\[K_N=\QQ(i,\zeta_{2N})\left(\{p^{p/N}:\text{prime }p\mid N\}\right)\]
	generated by the elements $\pi^{-w}\Gamma(f)$, where $f\colon\frac1N\ZZ/\ZZ\to\ZZ$ is a function of constant weight $w$. Then the extension $L_N/K_N$ is multiquadratic. If $N$ is odd or divisible by $4$, the degree is bounded by
	\[\log_2[L_N:K_N]\le2^{\omega(N)-1}-1.\]
\end{proposition}
\begin{proof}
	We proceed in steps, showing the various claims separately.
	\begin{enumerate}
		\item To check that this extension is multiquadratic, we will actually check that $(\pi^{-w}\Gamma(f))^2$ is in $K_N$ for each $f$; note that $\pi^{-w}\Gamma(f)$ is already algebraic by \Cref{cor:unrefined-gamma-alg}. Now, by \Cref{lem:2-const-weight-to-distribs}, we may write $2f$ as a $\ZZ$-linear combination of $\varepsilon_{d,a}$s, so $\Gamma(f)^2$ can be written as a product of $\Gamma(\varepsilon_{d,a})$s. But up to a power $\pi$, \Cref{lem:gamma-gen-from-distrib-relations} assures us that $\Gamma(\varepsilon_{d,a})$ is in $K_N$.
		% : the reflection formula tells us that $\Gamma(\varepsilon_{1,a})$s are in $K_N$, and the multiplication formula (combined with the reflection formula) works in general. We conclude that
		% \[\Gamma(f)^2\in\pi^\ZZ K_N,\]
		% so actually $(\pi^{-w}\Gamma(f))^2$ is in $K_N$ because we already know that this number is algebraic (and $\pi$ is transcendental).

		\item It remains to bound $[L_N:K_N]$ when $N$ is odd. By the previous step and Kummer theory \cite[Theorem~VI.8.1]{lang-algebra}, we would like to show that the $2$-subgroup $\Gamma_N\subseteq K_N^\times/K_N^{\times2}$ generated by the elements $(\pi^{-w}\Gamma(f))^2$ has
		\[\dim_{\FF_2}\Gamma_N\stackrel?\le2^{\omega(N)-1}-1.\]
		This bound will come from \Cref{thm:distribution-torsion}. To be formal, let $\varphi\colon\op{Mor}_{\mathrm{cw}}(\frac1N\ZZ/\ZZ,\ZZ)\to K_N^\times$ be the homomorphism taking functions $f\colon\frac1N\ZZ/\ZZ\to\ZZ$ of constant weight $w$ to $(\pi^{-w}\Gamma(f))^2\in K_N^\times$. By construction, we see that this homomorphism sends elements of the form $\varepsilon_{d,a}$ to $K_N^{\times2}$, as discussed in \Cref{lem:gamma-gen-from-distrib-relations}. Thus, \Cref{lem:const-weight-as-odd-distrib} tells us that $\varphi$ descends to a homomorphism
		\[\ov\varphi\colon U_{N,\mathrm{tors}}^-\to\frac{K_N^\times}{K_N^{\times2}},\]
		and $\Gamma_N$ is the image of this map. \Cref{thm:distribution-torsion} explains that the domain $U_{N,\mathrm{tors}}^-$ is already a $2$-torsion group and has $\FF_2$-dimension bounded by $2^{\omega(N)-1}$, so we will be done if we can lower the dimension any further.

		\item We complete the proof by showing that $\ov\varphi$ has a nontrivial kernel. Indeed, consider the constant function $f_1\equiv1$. We have two checks.
		\begin{itemize}
			\item On one hand, we claim that $f_1\in\ker\varphi$. Then
			\[f_1=1_0+1_{2\mid N}1_{1/2}\sum_{a=1}^{\floor{(N-1)/2}}\varepsilon_{1,a},\]
			where $1_0$ and $1_{1/2}$ are indicators. Certainly $1_0$ and $1_{1/2}$ are in $\ker\ov{\varphi}$ because $\Gamma(1_0)=\Gamma(1_{1/2})=1$ (see \Cref{ex:gamma-half}), and the $\varepsilon_{1,a}$s are in $\ker\ov\varphi$ as already noted. We conclude $f_1\in\ker\varphi$.
			\item On the other hand, we claim that $f_1$ is a nontrivial element of $U_{N,\mathrm{tors}}^-$. This is a little tricky. Under the isomorphism $U_{N,\mathrm{tors}}^-\cong\mathrm H^0_{\mathrm T}(\langle\pm1\rangle,U_N)$ of \Cref{prop:odd-distrib-2}, $f_1$ corresponds to the (Tate) cohomology class
			\[\sum_{a\in(\ZZ/N\ZZ)}\ov a\in\mathrm H^0_{\mathrm T}(\langle\pm1\rangle,U_N).\]
			However, this element is nontrivial by \Cref{ex:const-is-nontrivial-in-h0}!
		\end{itemize}
		We conclude that $\ker\ov\varphi$ is nontrivial, so $\Gamma_N=\im\ov\varphi$ satisfies
		\[\dim_{\FF_2}\im\ov\varphi<\dim_{\FF_2}U_{N,\mathrm{tors}}^-,\]
		so we are done by \Cref{thm:distribution-torsion}.
		\qedhere
	\end{enumerate}
\end{proof}
\begin{remark} \label{rem:effective-gamma-prod}
	The first step of the proof has the pleasant consequence of providing an explicit algorithm to compute the algebraic numbers $\pi^{-w}\Gamma(f)$, as discussed in \cite[Theorem~6.3.9]{ggl-fermat}. Indeed, it suffices to compute the square $\pi^{-2w}\Gamma(2f)$. Now, \Cref{rem:effective-2-const-weight-to-distrib} says that we can use linear algebra to write $2f$ as a $\ZZ$-linear combination of some $\varepsilon_{d,a}$s, and then we can compute $\Gamma(\varepsilon_{d,a})$ using the reflection and multiplication formulae of \Cref{prop:gamma-prod-props} (as explained in \Cref{cor:unrefined-gamma-alg}).
\end{remark}
\begin{remark}
	Whether equality is achieved in \Cref{prop:refined-gamma-alg} is an interesting question. It seems to be true in small examples; see \Cref{rem:k-conn-hyper-fermat}.
\end{remark}
% \subsection{Application to the Fermat Curve}
We now apply our theory to periods of the Fermat curve. To begin, we note that periods of Fermat curves can handle fairly general functions of constant weight.
\begin{lemma} \label{lem:period-to-const-weight}
	Let $f\colon\frac1N\ZZ/\ZZ\to\ZZ$ be a function of constant weight $w$ such that $f(0)=0$. Then there is some index $p\ge0$ and $\alpha\in\mf B^{2p}$ and a list $\{a_i\}_{i=1}^n\subseteq(\ZZ/N\ZZ)$ such that
	\[f=1_\alpha-\sum_{i=1}^n\varepsilon_{1,a_i}.\]
\end{lemma}
\begin{proof}
	We will actually show that there is a list $\{a_i\}_{i=1}^n$ such that $f+\sum_{i=1}^n\varepsilon_{1,a_i}$ equals $1_\alpha$ for some $\alpha\in\mf B^{2p}$. In fact, it is enough to get $\alpha\in\mf A^{2p}$: we already know that $f+\sum_{i=1}^n\varepsilon_{1,a_i}$ has constant weight by \Cref{lem:const-weight-exs}, so the weight will correctly be $3p$ as soon as this is some suitably $\alpha\in\mf A^{2p}$ by \Cref{rem:a-2p-const-weight-is-b-2p}. As a last reduction, we note that we may assume $\im f\subseteq\ZZ_{\ge0}$ by adding in suitable $\varepsilon_{1,\bullet}$s.
	
	We now induct on $\norm f_1=\sum_{i=0}^nf(i/N)$. Here are some small cases.
	\begin{itemize}
		\item If $\norm f_1=0$, then $f=0$, and we can take $p=0$ and $\alpha$ to be empty.
		\item It is not possible for $f$ to be supported on a single nonzero entry because such a function cannot have constant weight.
		\item Suppose $\norm f_1=2$. Because $f$ should not be supported at a single point, we have $f=\ov{a/N}+\ov{b/N}$ for some $a,b\in\ZZ/N\ZZ$. We claim that $f=\varepsilon_{1,a}$. Well, $f$ needs to have constant weight, so
		\[[a]+[b]=[-a]+[-b].\]
		Thus, $[a]+[b]=N$, so $b=-a$, as required.
	\end{itemize}
	We now proceed with the induction. Suppose that $\norm f_1>2$. Because $f$ is nonzero, $f$ is supported on at least two points, which we name $a/N$ and $b/N$ where $a,b\in(\ZZ/N\ZZ)$. We have two cases.
	\begin{itemize}
		\item Suppose that $b=-a$. Then $f-\varepsilon_{1,a}$ continues to have nonnegative image and constant weight, but $\norm{f-\varepsilon_{1,a}}_1<\norm f_1$, so we may apply the inductive hypothesis to $f-\varepsilon_{1,a}$ to conclude the proof.
		\item Suppose that $b\ne-a$. Then there is a nonzero $c\in(\ZZ/N\ZZ)$ such that $a+b+c=0$, and we define $\alpha\coloneqq(a,b,c)$ to be in $\mf A^1$. We now see that
		\[f-1_\alpha+\varepsilon_{1,c}\]
		has nonnegative image and constant weight, but $\norm{f-1_\alpha+\varepsilon_{1,c}}_1<\norm f_1$. We now again conclude by applying the inductive hypothesis.
		\qedhere
	\end{itemize}
\end{proof}
\boundkconnfermat
\begin{proof}
	As explaind in \Cref{rem:compute-k-conn-a-fermat}, $K_A^{\mathrm{conn}}$ is the extension of $\QQ(\zeta_N)$ which contains the periods
	\[\op{Per}\left(\gamma^{2p},\nu_\alpha\right)=(2\pi i)^{-p}\prod_{i=1}^{2p}\zeta_{2N}^{[a_i]+[b_i]}\frac{\Gamma\left(\frac{[a_i]}N\right)\Gamma\left(\frac{[b_i]}{N}\right)}{\Gamma\left(\frac{[-c_i]}N\right)},\]
	where $\alpha\in\mf B^{2p}$ varies. By the reflection formula (\Cref{prop:gamma-prod-props}), this period is in $\pi^{-\langle\alpha\rangle}\Gamma(1_\alpha)\QQ(i,\zeta_{2N})$. Now, \Cref{lem:period-to-const-weight} explains that any function $f\colon\frac1N\ZZ/\ZZ\to\ZZ$ of constant weight can be transformed into some $1_\alpha$ for $\alpha\in\mf B^{2p}$ at merely the cost of some $1_0$s and $\varepsilon_{1,a}$s, so $K_A^{\mathrm{conn}}(i,\zeta_{2N})$ is actually generated by $\pi^{-w}\Gamma(f)$, where $f$ may now vary over all functions $f\colon\frac1N\ZZ/\ZZ\to\ZZ$ of some constant weight $w$. Part (a) now follows from \Cref{lem:gamma-gen-from-distrib-relations}, and parts (b) and (c) now follow from \Cref{prop:refined-gamma-alg}.
\end{proof}
\begin{remark} \label{rem:k-conn-hyper-fermat}
	Let $A$ be the Jacobian of the curve $y^2=x^N-1$, which is a quotient of the Fermat curve $X_N$. In \cite[Theorem~7.1.1]{ggl-fermat}, it is shown that $K_A^{\mathrm{conn}}$ is multiquadratic over merely $\QQ(\zeta_N)$ via some algebro-geometric arguments. If $N$ is odd, then \Cref{thm:bound-k-conn-fermat} shows that
	\[\log_2[K_A^{\mathrm{conn}}(i):\QQ(i,\zeta_N)]\le2^{\omega(N)-1}-1.\]
	In particular, note that the $p^{p/N}$s define odd-degree cyclic extensions of $\QQ(i,\zeta_N)$ and hence cannot live in the multiquadratic extension $K_A^{\mathrm{conn}}$ of $\QQ(\zeta_N)$. The above bound agrees with the table in \cite[Example~6.4.10]{ggl-fermat}; in fact, that table suggests that equality may hold without the added $i$s!
\end{remark}
Let's see an example computation.
\begin{proposition} \label{prop:special-fermat-st-full-2}
	Define $A$ to be the Jacobian of the proper curve $C$ with affine chart $y^9=x\left(x^2+1\right)$. Then we show $K_A^{\mathrm{conn}}=\QQ\left(\zeta_N,2^{1/3},2^{2/9}\cdot3^{1/6}\right)$.
\end{proposition}
\begin{proof}
	This computation follows the one in \Cref{prop:special-fermat-st-full}. We will freely use the computation executed in \Cref{prop:special-fermat-st-2}. Thoughout, $A\coloneqq\op{Jac}C$, and we recall that we have a decomposition $A=C_0\times A_1\times A_2$ (over $\QQ$) into geometrically simple abelian varieties. We proceed in steps.
	\begin{enumerate}
		\item Set $N\coloneqq18$, and we note that there is a quotient map $X_N\to C$ from the affine patch $x^{18}+y^{18}+1=0$ to $C$ given by $\psi(x,y)\coloneqq\left(x^9,xy^2\right)$. Thus, we will be able to use the Galois-invariant embedding $\psi\colon\mathrm H^1_{\mathrm{\acute et}}(C_{\ov\QQ},\QQ_\ell)\into\mathrm H^1_{\mathrm{\acute et}}(X_{N,\ov\QQ},\QQ_\ell)$ to use \Cref{thm:fermat-galois} by restricting to the Galois submodule. To make this explicit, we recall that we have a basis
		\[\left\{\frac{dx}{y^4},\frac{dx}{y^5},\frac{dx}{y^6},\frac{dx}{y^7},\frac{dx}{y^8},\frac{x\,dx}{y^7},\frac{x\,dx}{y^8}\right\}\]
		of $\mathrm H^{10}(C)$, we see that we can pass this basis through $\psi^*$ to see that $\mathrm H^{10}(C)\subseteq\mathrm H^{10}(X)$ has basis
		\[\left\{\nu_{5,10,3},\nu_{4,8,6},\nu_{3,6,9},\nu_{2,4,12},\nu_{1,2,15},\nu_{11,4,3},\nu_{10,2,6}\right\}.\]
		Combining with the conjugate differentials yeilds a full basis of $\mathrm H^1_{\mathrm{dR}}(C,\QQ)\subseteq\mathrm H^1_{\mathrm{dR}}(X,\QQ)$.

		\item We pass to the \'etale site in exactly the same way as in \Cref{prop:special-fermat-st-full}. In the notation of \Cref{prop:special-fermat-st-2}, we see that $\psi^*$ pulls the basis $\{u_1\otimes1,v_1\otimes1,v_2\otimes1,v_4\otimes1,w_1\otimes1,w_2\otimes1,w_5\otimes1\}$ to
		\[\{\nu_{3,6,9}\otimes1,\quad\nu_{10,2,6}\otimes1,\nu_{2,4,12}\otimes1,\nu_{4,8,6}\otimes1,\quad\nu_{1,2,15}\otimes1,\nu_{11,4,3}\otimes1,\nu_{5,10,3}\otimes1\}.\]

		\item We are now ready to begin executing \Cref{prop:galois-computes-monodromy}; for this, \Cref{rem:galois-computes-monodromy-finite} informs us that we need to build a space of $W'$ of Tate classes cutting out $G_\ell(A)^\circ\subseteq\op{GL}_{14,\QQ_\ell}$. We begin by adding $W_1$, made up of the endomorphisms, which ensures (for example) that $G_\ell(A)^\circ$ is diagonal. Then \Cref{prop:special-fermat-st-2} computed that we also have the ``polarization equations''
		\begin{align*}
			\mu_1\mu_2 &= \kappa_1\kappa_8, \\
			\kappa_1\kappa_8 &= \kappa_2\kappa_7, \\
			\kappa_1\kappa_8 &= \kappa_4\kappa_5,
		\end{align*}
		and the exceptional equation
		\begin{align*}
			\mu_1\kappa_7 &= \kappa_5\kappa_8.
		\end{align*}
		We remark that the polarization equations translate into a Tate class like $\nu_{(\alpha,-\alpha,\beta,-\beta)}\otimes1$ understood as an element in $\mathrm H^4_{\mathrm{\acute et}}(X_{\ov\QQ},\QQ_\ell)(2)\otimes_\QQ\QQ_\ell$, but this Tate class actually already come from a class in $W_1$ (see \Cref{cor:fermat-galois-polarization}), so we may safely ignore it. Thus, we only have to translate the exceptional equation into the tensor
		\[\nu_{(3,6,9),(7,14,15),(13,8,15),(1,2,15)}\otimes1\in\mathrm H^4_{\mathrm{\acute et}}(X_{\ov\QQ},\QQ_\ell)(2)\otimes_\QQ\QQ_\ell\]
		and its Galois orbit.

		\item Arguing as in \Cref{rem:compute-k-conn-a-fermat}, we know that the periods of the Tate classes given in the previous step generate $K_A^{\mathrm{conn}}$, so it remains to compute these periods. We already know that our endomorphisms, except for the isogeny $(A_1)_{\ov\QQ}\cong (A_2)_{\ov\QQ}$, are defined over $\QQ(\zeta_N)$ (see also \Cref{cor:fermat-galois-polarization}). We now handle the remaining cycles.
		\begin{itemize}
			\item The isogeny $A_1\cong A_2$ corresponds to equations $\kappa_u=\lambda_{2u}$ for each $u\in(\ZZ/18\ZZ)^\times$, which means that we would like to compute
			\[\op{Per}\left(\gamma^{2p},\nu_{u(1,2,15),u(16,14,6)}\right).\]
			Well, by \Cref{rem:coleman-periods}, this element is
			\[(-2\pi i)^{-1}\zeta_{2N}^{u(1+2+16+14)}\cdot\frac{\Gamma\left(\frac{[u]}{18}\right)\Gamma\left(\frac{[2u]}{18}\right)}{\Gamma\left(\frac{[3u]}{18}\right)}\cdot\frac{\Gamma\left(\frac{[16u]}{18}\right)\Gamma\left(\frac{[14u]}{18}\right)}{\Gamma\left(\frac{[12u]}{18}\right)}.\]
			One can check that the term on the left is in $\pi^{-1}\QQ(\zeta_N)$, so it remains to handle the product of $\Gamma$s. We handle the case where $u=1$ because the others turn out to be essentially Galois conjugates. (Indeed, \Cref{thm:fermat-galois} explains that the remaining $u$s belong to the same Galois orbit.) Using the algorithm suggested in \Cref{rem:effective-gamma-prod}, one finds that this product equals
			\[\Gamma(-\varepsilon_{1,8} -\varepsilon_{2,3} -\varepsilon_{2,4} -\varepsilon_{2,6} -\varepsilon_{2,7} + \varepsilon_{3,1} + \varepsilon_{3,2} + 2 \varepsilon_{3,4}),\]
			which evaluates to
			\[\left(-\zeta_N^5 + \zeta_N^2 + \zeta_N + 1\right)\cdot\left(2^{22} \cdot 3^3\right)^{1/18},\]
			up to a (correct) power of $\pi$.
			
			\item It remains to compute
			\[\op{Per}\left(\gamma^4,\nu_{(3,6,9),(7,14,15),(13,8,15),(1,2,15)}\otimes1\right).\]
			Well, by \Cref{rem:coleman-periods}, we see this equals
			\[(-2\pi i)^{-2}\zeta_{2N}^{(3+6+7+14+13+8+1+2)}\cdot\frac{\Gamma\left(\frac{3}{18}\right)\Gamma\left(\frac{6}{18}\right)}{\Gamma\left(\frac{9}{18}\right)}\cdot\frac{\Gamma\left(\frac{7}{18}\right)\Gamma\left(\frac{14}{18}\right)}{\Gamma\left(\frac{3}{18}\right)}\cdot\frac{\Gamma\left(\frac{13}{18}\right)\Gamma\left(\frac{8}{18}\right)}{\Gamma\left(\frac{3}{18}\right)}\cdot\frac{\Gamma\left(\frac{1}{18}\right)\Gamma\left(\frac{2}{18}\right)}{\Gamma\left(\frac{3}{18}\right)}.\]
			As above, the term on the left belongs to $\pi^{-2}\QQ(\zeta_N)$, so it remains to handle the product of $\Gamma$s. Once again using the algorithm suggested in \Cref{rem:effective-gamma-prod}, one finds that this product equals
			\[\Gamma\left(\varepsilon_{1,7} -\varepsilon_{1,8} + \frac12 \varepsilon_{1,9} + \varepsilon_{2,5} -\varepsilon_{2,7} + \varepsilon_{2,8} + \varepsilon_{3,1} -\varepsilon_{3,3} + \varepsilon_{3,4} -\varepsilon_{3,5}\right),\]
			which evaluates to $4\cdot2^{6/18}$ up to a (correct) power of $\pi$.
		\end{itemize}
		Altogether, we can combine these two calculations to show $K_A^{\mathrm{conn}}=\QQ\left(\zeta_N,2^{2/9}\cdot3^{1/6}\right)$ because this field already contains $2^{1/3}$.
		\qedhere
	\end{enumerate}
\end{proof}
\begin{remark}
	Perhaps it is notable that the exceptional Hodge class is defined over a smaller field than the endomorphisms!
\end{remark}
% \section{The Frobenius}
% In this section, we use the theory of complex multiplication (in particular, \Cref{thm:fundamental}) to compute the Frobenius of some Fermat curves.

% \subsection{}


% \section{Fermat Hypersurfaces}
% We would be remiss without mentioning something about Fermat hypersurfaces. Thus, we will state (but not prove) a few facts about what is known for Fermat hypersurfaces. There is much known here, but the proofs tend to be somewhat harder than what one does with the Fermat curves, which is why we have avoided the theory.\todo{}

\end{document}