\documentclass{article}
\usepackage[utf8]{inputenc}

\newcommand{\nirpdftitle}{Notes on Bump}
\usepackage{import}
\inputfrom{../../notes}{nir}
\usepackage[backend=biber,
    style=alphabetic,
    sorting=ynt
]{biblatex}
\setcounter{tocdepth}{2}

\pagestyle{contentpage}

\title{Notes on Bump}
\author{Nir Elber}
\date{Spring 2024}
\usepackage{graphicx}

\begin{document}

\maketitle

\tableofcontents

\section{June 7th}
We plan on covering \S1.1--1.3.

\subsection{Dirichlet \texorpdfstring{$L$}{ L}-Functions}
We begin by defining Dirichlet characters.
\begin{definition}[Dirichlet character]
	Fix a positive integer $N$. A \textit{Dirichlet character$\pmod N$} is a character $\chi\colon(\ZZ/N\ZZ)^\times$ extended to $\ZZ$ by declaring $\chi(n)=0$ whenever $\gcd(n,N)>1$. If $N\mid M$ where $N<M$, then a Dirichlet character $\chi\pmod N$ \textit{induces} a Dirichlet character$\pmod M$ by the canonical projection $\ZZ/M\ZZ\onto\ZZ/N\ZZ$. If $\chi$ is not induced by any other character, then $\chi$ is \textit{primitive}; otherwise, $\chi$ is \textit{imprimitive}.
\end{definition}
Dirichlet characters $\chi\pmod N$ have two important attached invariants.
\begin{definition}[$L$-function]
	Fix a Dirichlet character $\chi\pmod N$. Then we define the \textit{Dirichlet $L$-function} by
	\[L(s,\chi)\coloneqq\sum_{n=1}^\infty\frac{\chi(n)}{n^s}.\]
\end{definition}
\begin{remark}
	We note that $L(s,\chi)$ converges absolutely for $\Re s>1$. If $\chi$ is not induced by the trivial character, then one sees $L(s,\chi)$ actually converges for $\Re s>0$ uniformly on compacts. If $\chi=1$, then $L(s,\chi)=\zeta(s)$, and one can use a summation-by-parts argument to show that $\zeta(s)$ has an integral representation valid for $\Re s>0$.
\end{remark}
\begin{remark}
	The usual argument with unique prime factorization implies $L(s,\chi)$ admits an Euler product
	\[L(s,\chi)=\prod_p\frac1{1-\chi(p)p^{-s}}.\]
\end{remark}
Our goal for the time being is to show that $L(s,\chi)$ admits a meromorphic continuation and functional equation. To this end, we introduce the second invariant of a Dirichlet character.
\begin{definition}[Gauss sum]
	Fix a primitive Dirichlet character $\chi\pmod N$. Then we define the \textit{Gauss sum}
	\[\tau(\chi)\coloneqq\sum_{n\in\ZZ/N\ZZ}\tau(n)e^{2\pi in/N}.\]
\end{definition}
We may like to adjust the character $n\mapsto e^{2\pi in/N}$. To this end, we have the following lemma.
\begin{lemma}
	Fix a primitive Dirichlet character $\chi\pmod N$. Then
	\[\sum_{n\in\ZZ/N\ZZ}\chi(n)e^{2\pi inm/N}=\ov\chi(m)\tau(\chi).\]
\end{lemma}
\begin{proof}
	If $\gcd(m,N)=1$, then this is a matter of rearranging the sum. Otherwise, the right-hand side vanishes by definition of $\chi$, and one shows that the left-hand side vanishes essentially because the ``periods'' of $\chi$ and $n\mapsto e^{2\pi inm/N}$ differ.
\end{proof}
We will want to know that $\tau(\chi)$ is nonzero. As is common in harmonic analysis, it will be easier to compute the norm.
\begin{lemma}
	Fix a primitive Dirichlet character $\chi\pmod N$. Then $\left|\tau(\chi)\right|^2=N$.
\end{lemma}
\begin{proof}
	Some rearranging reveals that
	\[\tau(\chi)\ov{\tau(\chi)}=\frac1{\varphi(N)}\sum_{m\in\ZZ/N\ZZ}\sum_{n_1,n_2\in(\ZZ/N\ZZ)^\times}\chi(n_1)\ov\chi(n_2)e^{2\pi i(n_1-n_2)m/N}.\]
	(The point is that each $m$ produces the same value.) Summing over $m$, we see that we only care about terms where $n_1\equiv n_2\pmod N$, from which the result follows.
\end{proof}
Our proof of the functional equation requires the Poisson summation formula. Thus, we introduce a little more harmonic analysis.
\begin{definition}[Fourier transform]
	For a Schwartz function $f\colon\RR\to\CC$, we define its \textit{Fourier transform} by
	\[\mc Ff(x)\coloneqq\int_\RR f(y)e^{2\pi ixy}\,dy.\]
\end{definition}
\begin{example} \label{ex:fourier-transform-gaussian}
	For $t\in\RR$, define $f_t(x)\coloneqq e^{-\pi tx^2}$. Then one can compute that $\mc Ff_t=t^{-1/2}f_{1/t}$. Bump includes a proof using contour integration, but of course other proofs exist.
\end{example}
\begin{example} \label{ex:fourier-transform-almost-gaussian}
	For $t\in\RR$, define $g_t(x)\coloneqq xe^{-\pi tx^2}$. Integrating by parts and using \Cref{ex:fourier-transform-gaussian}, one finds that $\mc Fg_t=it^{-3/2}g_{1/t}$.
\end{example}
\begin{proposition}[Poisson summation] \label{prop:poisson-sum}
	For a Schwarz function $f\colon\RR\to\CC$, we have
	\[\sum_{n\in\ZZ}f(n)=\sum_{n\in\ZZ}\mc Ff(n).\]
\end{proposition}
\begin{proof}
	The trick is to consider the periodic function
	\[F(x)\coloneqq\sum_{n\in\ZZ}f(x+n).\]
	Because $f$ is Schwartz, $F$ is infinitely differentiable, so it admits a Fourier series. A computation of the Fourier coefficients then reveals that
	\[F(x)=\sum_{m\in\ZZ}\mc Ff(m)e^{2\pi imx},\]
	from which the result follows by taking $m=0$.
\end{proof}
\begin{corollary} \label{cor:twisted-poisson-sum}
	For a Schwarz function $f\colon\RR\to\CC$ and primitive Dirichlet character $\chi\pmod N$, we have
	\[\sum_{n\in\ZZ}\chi(n)f(n)=\frac{\tau(\ov\chi)}N\sum_{n\in\ZZ}\widehat f(n/N).\]
\end{corollary}
\begin{proof}
	Apply Poisson summation to the function
	\[g(x)\coloneqq\left(\frac{\tau(\ov\chi)}N\sum_{m\in\ZZ/N\ZZ}\ov\chi(m)e^{2\pi ixm/N}\right)f(x).\]
	For example, the left-hand side equals $\sum_{n\in\ZZ}g(n)$ because the big factor equals $\chi(n)$ when $x=n$ is an integer.
\end{proof}
We now move towards our proof of the functional equation. Our functional equation for Dirichlet $L$-func\-tions will be boot\-strapped from the functional equation for certain $\theta$-functions.
\begin{proposition} \label{prop:theta-functional-eq}
	Fix a primitive Dirichlet character $\chi\pmod N$. Say $\chi(-1)=(-1)^\varepsilon$, where $\varepsilon\in\{0,1\}$. Define the $\theta$-function
	\[\theta_\chi(t)\coloneqq\frac12\sum_{n\in\ZZ}n^\varepsilon\chi(n)e^{-\pi n^2t}.\]
	Then
	\[\theta_\chi(t)=\frac{(-i)^\varepsilon\tau(\chi)}{N^{1+\varepsilon}t^{\varepsilon+1/2}}\theta_{\ov\chi}\left(\frac1{N^2t}\right).\]
\end{proposition}
\begin{proof}
	Doing casework on $\varepsilon$, combine \Cref{cor:twisted-poisson-sum} with \Cref{ex:fourier-transform-gaussian,ex:fourier-transform-almost-gaussian}.
\end{proof}
At long last, here is our result.
\begin{theorem}
	Fix a primitive Dirichlet character $\chi\pmod N$. Say $\chi(-1)=(-1)^\varepsilon$, where $\varepsilon\in\{0,1\}$. Then the completed $L$-function
	\[\Lambda(s,\chi)\coloneqq\pi^{-(s+\varepsilon)/2}\Gamma\left(\frac{s+\varepsilon}2\right)L(s,\chi)\]
	has a meromorphic continuation to $\CC$ and satisfies the functional equation
	\[\Lambda(s,\chi)=(-i)^\varepsilon\tau(\chi)N^{-s}\Lambda(1-s,\ov\chi).\]
\end{theorem}
\begin{proof}
	It is enough to show the functional equation. A $u$-substitution proves
	\[\int_{\RR^+}e^{-\pi tn^2}t^{(s+\varepsilon)/2}\,\frac{dt}t=\pi^{-(s+\varepsilon)/2}\Gamma\left(\frac{s+\varepsilon}2\right)n^{-s-\varepsilon}.\]
	Summing over $n\ge0$ reveals
	\[\Lambda(s,\chi)=\int_{\RR^+}\theta_\chi(t)t^{(s+\varepsilon)/2}\,\frac{dt}t.\]
	\Cref{prop:theta-functional-eq} completes the proof.
\end{proof}

\subsection{The Modular Group}
The natural action of $\op{SL}_2(\CC)$ on $\CC^2$ descends to an action of $\op{SL}_2(\RR)$ on $\mathbb H\coloneqq\{z\in\CC:\Im z>0\}$ by fractional linear transformations. Explicitly,
\[\begin{bmatrix}
	a & b \\ c & d
\end{bmatrix}z\coloneqq\frac{az+b}{cz+d}.\]
We would like some arithmetic input to this action, so we introduce some subgroups.
\begin{definition}[congruence subgroup]
	For a positive integer $N$, we define $\Gamma(N)$ as the kernel of the reduction map $\op{SL}_2(\ZZ)\to\op{SL}_2(\ZZ/N\ZZ)$. Explicitly,
	\[\Gamma(N)\coloneqq\left\{\begin{bmatrix}
		a & b \\ c & d
	\end{bmatrix}\in\op{SL}_2(\ZZ):\begin{bmatrix}
		a & b \\ c & d
	\end{bmatrix}\equiv\begin{bmatrix}
		1 & 0 \\ 0 & 1
	\end{bmatrix}\pmod N\right\}.\]
	A subgroup $\Gamma\subseteq\op{SL}_2(\ZZ)$ is a \textit{congruence subgroup} if and only if it contains $\Gamma(N)$ for some positive integer $N$.
\end{definition}
We will spend the rest of the section collecting some facts about $\op{SL}_2(\ZZ)$ and its action on $\HH$.
\begin{proposition}
	The group $\op{SL}_2(\ZZ)$ acts discontinuously on $\mathbb H$.
\end{proposition}
\begin{proof}
	For compact subsets $K_1,K_2\subseteq\HH$, we must show that
	\[S\coloneqq\{g\in\op{SL}_2(\ZZ):K_2\cap gK_1\ne\emp\}\]
	is a finite set. Well, note that $g\coloneqq\begin{bsmallmatrix}
		a & b \\ c & d
	\end{bsmallmatrix}$ has
	\[\Im g(z)=\frac y{\left|cz+d\right|^2}\]
	by a direct computation. Thus, the values of $c$ and $d$ are bounded in $S$. Because $\begin{bsmallmatrix}
		1 & b \\ & 1
	\end{bsmallmatrix}$ behaves a lateral shift (to the left or right by $\left|a\right|$), we see that there are only finitely many possible values of $b$. Lastly, $a$ is determined by $(b,c,d)$ because $ad-bc=1$, so we conclude that $S$ is finite.
\end{proof}
\begin{proposition}
	The action of $\op{SL}_2(\ZZ)$ on $\HH$ has a fundamental domain given by
	\[F\coloneqq\left\{z\in\HH:\left|\Re z\right|<\frac12,\left|z\right|>1\right\}.\]
	Namely, any class of $\op{SL}_2(\ZZ)\backslash\HH$ has a representative in $\ov F$, and $z_1,z_2\in F$ with $g(z_1)=z_2$ must have $z_1=z_2$ (and $g=\pm I_2$).
\end{proposition}
\begin{proof}
	This is essentially a matter of making the previous proof explicit. For the first claim, choose $z\in\HH$, and apply $\op{SL}_2(\ZZ)$ until $\Im z$ is maximized; then apply elements of the form $\begin{bsmallmatrix}
		1 & b \\ & 1
	\end{bsmallmatrix}$ until $\Re z\in[-1/2,1/2]$. For the second claim, one does some explicit algebra and casework on $z$ and $g$.
\end{proof}
\begin{remark}
	Any finite-index subgroup $\Gamma\subseteq\op{SL}_2(\ZZ)$ can also be given a fundamental domain by taking $\bigcup_{g\in\Gamma\backslash\op{SL}_2(\ZZ)}gF$, where the union is merely over a set of representatives for $\Gamma\backslash\op{SL}_2(\ZZ)$.
\end{remark}
\begin{proposition}
	Fix a congruence subgroup $\Gamma\subseteq\op{SL}_2(\ZZ)$. Then the quotient $\Gamma\backslash\HH$ can be compactified and then given the structure of a compact Riemann surface.
\end{proposition}
\begin{proof}
	Define $\HH^*\coloneqq\HH\sqcup\PP^1_\QQ$, where the points of $\PP^1_\QQ$ are called ``cusps.'' Note that $\Gamma$ acts on $\PP^1_\QQ$ separately and with only finitely many orbits (because $\Gamma\subseteq\op{SL}_2(\ZZ)$ has finite index). We will explain how $\Gamma\backslash\HH^*$ can be given the structure of a compact Riemann surface. Let $\ov\Gamma\subseteq\op{PSL}_2(\RR)$ be the image of $\Gamma$; there are three cases for $a\in\HH^*$
	\begin{itemize}
		\item If the stabilizer of $a$ in $\ov\Gamma$ is trivial, then the discontinuity of our action implies that this is the case in an open neighborhood of $a$. So we map $a$ to the fundamental domain and take a chart there.
		\item If the stabilizer of $a$ in $\ov\Gamma$ is nontrivial and $a\in\HH$, then we use the map $z\mapsto\frac{z-a}{z-\ov a}$ to send $a$ to the origin, and it sends everything else to the unit disk. Tracking through how fractional linear transformations behave, we see that the stabilizer must now be a finite collection of rotations about the origin, so we take roots to build our charts.
		\item If the stabilizer of $a$ in $\ov\Gamma$ is nontrivial and $a\in\PP^1_\QQ$, use $\op{SL}_2(\ZZ)$ to move $a$ to $\infty$, and a similar argument as the previous point can move everything to the unit disk again.
		\qedhere
	\end{itemize}
\end{proof}

\subsection{Modular Forms}
Here is our definition.
\begin{definition}[modular form]
	Fix an integer $k$ and finite-index subgroup $\Gamma\subseteq\op{SL}_2(\ZZ)$. Then a \textit{modular form} of weight $k$ and level $\Gamma$ is a holomorphic function $f$ on $\HH^*$ such that
	\[f\left(\frac{az+b}{cz+d}\right)=(cz+d)^kf(z)\]
	for any $\begin{bsmallmatrix}
		a & b \\ c & d
	\end{bsmallmatrix}\in\Gamma$. The vector space of such $f$ is denoted by $M_k(\Gamma)$. If $f$ vanishes on the cusps of $\HH^*$, we say that $f$ is a \textit{cusp form}, and 
\end{definition}
\begin{remark}
	Being holomorphic on $\HH^*$ is a somewhat tricky condition. Because $\Gamma\backslash\HH^*$ has already been given the structure of a compact Riemann surface, it is enough to show that $f$ has at worst removable singularities, so it is enough to show that $f$ is bounded approaching the cusps in $\PP^1_\QQ$. More explicitly, if $\Gamma\supseteq\Gamma(N)$, then $q\coloneqq e^{2\pi iz/N}$ is a local chart around $\infty\in\PP^1_\QQ$, so we want the Fourier expansion
	\[f(z)=\sum_{n\in\ZZ}a_nq^n\]
	to have $a_n=0$ for $n<0$.
\end{remark}
\begin{remark} \label{rem:odd-weight}
	Suppose $k$ is odd and $\Gamma=\op{SL}_2(\ZZ)$. Then $g=-I_2$ tells us that $f(z)=(-1)^kf(z)$, so $f=0$.
\end{remark}
\begin{remark}
	If $k=0$, then we are asking for holomorphic functions on $\Gamma\backslash\HH^*$, but this is a compact Riemann surface, so our modular forms of weight $0$ are constant.
\end{remark}
\begin{remark}
	More formally, we see that $M(\Gamma)$ is a graded ring, with grading given by the weight. The point is that the product of modular forms of weights $k$ and $\ell$ produces a modular form of weight $k+\ell$.
\end{remark}
We would like to classify modular forms for $\op{SL}_2(\ZZ)$.
\begin{proposition} \label{prop:mk-fin-dim}
	Fix a finite-index subgroup $\Gamma\subseteq\op{SL}_2(\ZZ)$. Then $M_k(\Gamma)$ is finite-dimensional.
\end{proposition}
\begin{proof}
	If $M_k(\Gamma)$ only has $0$, then we are done. Else, choose a nonzero element $f_0$. Then division by $f_0$ sends $f\in M_k(\Gamma)$ to meromorphic functions $f/f_0$ on $X\coloneqq\Gamma\backslash\HH^*$. Now, this collection of holomorphic functions $f/f_0$ on $X$ have prescribed poles at the zeroes of $f$, so an argument with Laurent expansions in local charts around these poles explains that the space of such holomorphic functions on $X$ is finite-dimensional.
\end{proof}
Thus, $M_k(\op{SL}_2(\ZZ))$ is relatively small. We now want to show that it is frequently nonempty when $k$ is even (see \Cref{rem:odd-weight}).
\begin{lemma}
	For even $k\ge4$, define
	\[E_k(z)\coloneqq\frac12\sum_{(m,n)\in\ZZ^2\setminus\{(0,0)\}}\frac1{(mz+n)^{k}}.\]
	Then $E_k\in M_k(\op{SL}_2(\ZZ))$.
\end{lemma}
\begin{proof}
	With $k\ge4$, one can check that $E_k$ is absolutely convergent, and it is weight $k$ essentially by construction. To check that $E_k$ is holomorphic at $\infty$, we compute its Fourier expansion. The Fourier transform of $f(u)\coloneqq(u-\tau)^{-1}$ is
	\[\mc Ff(v)=\begin{cases}
		2\pi i\op{Res}_{u=t}\left(e^{2\pi iuv}(u-\tau)^{-k}\right) & \text{if }v>0 \\
		0 & \text{if }v\le0,
	\end{cases}=\begin{cases}
		\frac{(2\pi i)^k}{(k-1)!}v^{k-1}e^{2\pi iv\tau} & \text{if }v>0, \\
		0 & \text{if }v\le0.
	\end{cases}\]
	Thus, the Poisson summation formula and a little rearrangement tells us that
	\[E_k(z)=\zeta(k)+\frac{(2\pi i)^k}{(k-1)!}\sum_{n=1}^\infty\sigma_{k-1}(n)q^n,\]
	where $\sigma_{k-1}(n)$ is the sum of the $(k-1)$st powers of the divisors of $n$.
\end{proof}
\begin{remark}
	A computation of $\zeta(k)$ (for even $k$) reveals that $G_k(z)\coloneqq\zeta(k)^{-1}E_k(z)$ has rational coefficients. For example, one can see that $\Delta\coloneqq G_4^3-G_6^2$ lives in $S_{12}(\op{SL}_2(\ZZ))$.
\end{remark}
\begin{lemma}
	There exists an element in $S_{12}(\op{SL}_2(\ZZ))$ which does not vanish on $\HH$.
\end{lemma}
\begin{proof}
	We recall the Jacobi triple product formula given by
	\[\sum_{n\in\ZZ}q^{n^2}x^n=\prod_{n=1}^\infty\left(1-q^{2n}\right)\left(1+q^{2n-1}x\right)\left(1+q^{2n-1}x^{-1}\right).\]
	Substituting $q\mapsto q^{3/2}$ and $x\mapsto-q^{-1/2}$ and rearranging, we see
	\[\eta(z)\coloneqq q^{1/24}\prod_{n=1}^\infty\left(1-q^n\right)=\sum_{n\in\ZZ}\chi(n)q^{n^2/24},\]
	where $\chi\pmod{12}$ is the primitive quadratic character. (Explicitly, $\chi(\pm)=1$ and $\chi(\pm5)=-1$.) Note $\eta(z)=\theta_\chi(-z/12)$.

	We claim that $\eta^{24}$ is the required function. The infinite product tells us that $\eta$ does not vanish on $\HH$, but $\eta$ vanishes at $\infty\in\HH^*$ (which is $q=0$). Thus, it remains to show that $\eta^{24}$ is modular with weight $12$. The infinite product explains that $\eta^{24}$ satisfies the modularity property for $\begin{bsmallmatrix}
		1 & 1 \\ & 1
	\end{bsmallmatrix}$, so it remains to check for $\begin{bsmallmatrix}
		& -1 \\ & 1
	\end{bsmallmatrix}$. Well, plugging $\theta_\chi$ into \Cref{prop:theta-functional-eq}, we see
	\[\sqrt{-iz}\eta(z)=\eta\left(-\frac1z\right),\]
	which completes the proof upon raising to the $24$th power.
\end{proof}
\begin{remark}
	The argument of \Cref{prop:mk-fin-dim} tells us that $S_{12}(\op{SL}_2(\ZZ))$ is actually one-dimensional. Thus, it is spanned by $\Delta$.
\end{remark}
And here is our classification result.
\begin{theorem}
	The ring $M(\op{SL}_2(\ZZ))$ is generated by $G_4$ and $G_6$. In particular,
	\[\dim M_{12a+2b}(\op{SL}_2(\ZZ))=\begin{cases}
		a+1 & \text{if }2b\in\{0,4,6,8,10\}, \\
		a & \text{if }2b=2.
	\end{cases}\]
\end{theorem}
\begin{proof}
	We abbreviate the group $\op{SL}_2(\ZZ)$ from our notation. Dimension arguments imply that it is enough to show the last computation. The argument of \Cref{prop:mk-fin-dim} implies that multiplication by $\Delta$ provides an isomorphism $M_{k}\to S_{k+12}$ for all $k$; additionally, because we have only one cusp, we see that either $M_k=S_k$ or $\dim M_k=\dim S_k+1$. Thus, $\dim M_{k+12}=1+\dim M_k$ always, so it remains to show the result for $k<12$.

	Examining what we've done so far, it remains to show $\dim M_k=1$ for even $k\in[4,10]$ and $\dim M_2=0$.
	\begin{itemize}
		\item Take $k\in\{4,6,8,10\}$. To show $\dim M_k=1$, we will show $\dim S_k=0$ (and then use $E_k$ to increase dimension). Well, suppose for contradiction that we have a nonzero element $f\in S_k$. On one hand, we see $E_{6(12-k)}(f/\Delta)^6$ is a modular form of weight $0$, so it is constant, so we may say $E_{6(12-k)}=\Delta^6/f^6$ by adjusting $f$ by a constant multiple. On the other hand, this means $E_{6(12-k)}$ fails to vanish on $\HH$, so $\Delta^{(12-k)/2}/E_{6(12-k)}$ is a modular form of weight $0$ with no poles but a zero at the cusp, which is impossible.
		\item Take $k=2$. Suppose for contradiction that we have a nonzero element $f\in M_2$. By adjusting $f$ by a constant multiple, the previous tells us we have $fE_4=E_6$. However, a computation shows $E_4\left(e^{2\pi i/3}\right)=0$, which would $\Delta$ has a zero in $\HH$, which we know is false.
		\qedhere
	\end{itemize}
\end{proof}
Our next goal is to make a discussion of $L$-functions.
\begin{definition}[$L$-function]
	For $f\in M_k(\op{SL}_2(\ZZ))$ with Fourier expansion $f(z)=\sum_{n=1}^\infty a_nq^n$, we define
	\[L(s,f)\coloneqq\sum_{n=1}^\infty\frac{a_n}{n^s}.\]
\end{definition}
We should probably check that this converges.
\begin{proposition}
	For $f\in S_k(\op{SL}_2(\ZZ))$ with Fourier expansion $f(z)=\sum_{n=1}^\infty a_nq^n$. Then $\left|a_n\right|=O\left(n^{k/2}\right)$.
\end{proposition}
\begin{proof}
	A direct computation shows that $\left|f(z)(\Im z)^{k/2}\right|$ is $\op{SL}_2(\ZZ)$-invariant; because $f$ is a cusp form, we see that $\left|f(z)(\Im z)^{k/2}\right|$ is bounded on $\HH$ by some constant $C$. Now, for any $y\in\RR$, we see
	\[\left|a_n\right|e^{-2\pi ny}=\left|\int_{\RR/\ZZ}f(x+iy)e^{-2\pi inx}\,dx\right|\le\int_0^1\left|f(x+iy)\right|\,dx\le Cy^{-k/2}.\]
	Choosing $y=1/n$ completes the proof.
\end{proof}
\begin{remark}
	In general, we know we can write $f=f_0+cE_k$ for cusp form $f_0$, so our computation of the Fourier expansion of $E_k$ reveals that 
\end{remark}
Thus, $L(s,f)$ converges for $\Re s$ sufficiently large. Here is our functional equation.
\begin{theorem}
	For $f\in M_k(\op{SL}_2(\ZZ))$, define
	\[\Lambda(s,f)\coloneqq(2\pi)^{-s}\Gamma(s)L(s,f).\]
	Then $\Lambda$ has a meromorphic continuation to $\CC$ and satisfies the functional equation
	\[\Lambda(s,f)=(-1)^{k/2}\Lambda(k-s,f).\]
\end{theorem}
\begin{proof}
	Summing the identity
	\[\int_{\RR^+}e^{-2\pi ny}y^s\,\frac{dy}y=(2\pi)^{-s}\Gamma(s)n^{-s}\]
	for $n\ge1$ shows that
	\[\Lambda(s,f)=\int_{\RR^+}f(iy)y^s\,\frac{dy}y.\]
	The result now follows because $f(iy)=(-1)^{k/2}y^{-k}=f(i/y)$ by the modularity of $f$.
\end{proof}

\section{June 14th}
Today we plan on covering \S1.4--1.5.

\subsection{Hecke Operators}
Following Bump, we begin by discussing Hecke operators for $\op{SL}_2(\ZZ)$ and then will discuss Hecke operators for different level in remarks later.
\begin{notation}
	Fix a positive integer $k$. Given holomorphic $f\colon\HH\to\CC$ and $\gamma\coloneqq\begin{bsmallmatrix}
		a & b \\ c & d
	\end{bsmallmatrix}\in\op{GL}_2(\RR)$ with $\deg\gamma>0$, we define $f|_\gamma\colon\HH\to\CC$ by
	\[(f|_\gamma)(z)\coloneqq(\det\gamma)^{k/2}(cz+d)^{-k}f(\gamma\cdot z).\]
\end{notation}
One can check that this creates a right action of $\op{GL}_2(\RR)^+$ on holomorphic functions $\HH\to\CC$.

One would like to know that this action sends modular forms to modular forms, but this has the nasty side effect of adjusting level. Nonetheless, one can check a congruence subgroup $\Gamma\subseteq\op{SL}_2(\ZZ)$ continues to make the conjugate $\gamma^{-1}\Gamma\gamma\cap\op{SL}_2(\ZZ)$ a congruence subgroup for any $\gamma\in\op{GL}_2(\QQ)^+$.\footnote{The corresponding level depends on $\alpha$ and $\Gamma$.} From here, one can indeed check that $f$ being a modular form for a congruence subgroup $\Gamma$ of weight $k$ makes $f|_\gamma$ continue to be a modular form for the congruence subgroup $\gamma^{-1}\Gamma\gamma\cap\op{SL}_2(\ZZ)$ of weight $k$.

We will spend most of the rest of this subsection in level $1$, so we set $\Gamma\coloneqq\op{SL}_2(\ZZ)$ until stated otherwise. Our construction of Hecke operators will rest on certain double coset computations, which we now carry out.
\begin{lemma} \label{lem:double-coset-quotient}
	Fix $\gamma\in\op{GL}_2(\QQ)^+$. Then
	\[\left|\frac{\Gamma\gamma\Gamma}{\Gamma}\right|=\left|\frac{\Gamma}{\gamma^{-1}\Gamma\gamma\cap\Gamma}\right|,\]
	which is finite.
\end{lemma}
\begin{proof}
	Note that the right-hand side is in fact finite because $\gamma^{-1}\Gamma\gamma\cap\Gamma$ is a congruence subgroup, so it suffices to compute
	\[\frac{\Gamma\gamma\Gamma}{\Gamma}\cong\frac{\Gamma\gamma\Gamma\gamma^{-1}}{\Gamma}\cong\frac{\gamma\Gamma\gamma^{-1}}{\Gamma\cap\gamma\Gamma\gamma^{-1}}\cong\frac{\Gamma}{\gamma^{-1}\Gamma\gamma\cap\Gamma},\]
	as required.
\end{proof}
\begin{definition}[Hecke operator]
	Fix a modular form $f$ of weight $k$ and level $\Gamma=\op{SL}_2(\ZZ)$. For each $\alpha\in\op{GL}_2(\QQ)^+$, we define the \textit{Hecke operator}
	\[f|T_\alpha\coloneqq\sum_{\Gamma\gamma\subseteq\Gamma\alpha\Gamma}f|_\gamma.\]
	Note $T_\alpha$ only depends on $\Gamma\alpha\gamma$, so we let $\mc R$ denote the free abelian group generated by $\{T_\alpha\}_{\Gamma\alpha\Gamma}$.
\end{definition}
Modularity of $f$ implies that the choice of representatives $\gamma$ for $\Gamma\gamma\subseteq\Gamma\alpha\Gamma$ does not remember. In fact, for any $\gamma'\in\Gamma$, we see that applying $f|T_\alpha|_{\gamma'}$ merely rearranges right cosets in the sum and thus just equals $f|_{\gamma'}|T_\alpha$, meaning $f|T_\alpha$ will continue to be a modular form of weight $k$.

As suggested by the letter $\mc R$, we would like to define a ring structure. Unsurprisingly, this will be by composition. A direct computation reveals that
\[f|T_\alpha|T_\beta=\sum_{\sigma\in\Gamma\backslash\op{GL}_2(\QQ)^+/\Gamma}m(\alpha,\beta,\sigma)f|T_\sigma,\]
where
\[m(\alpha,\beta,\sigma)\coloneqq\#\{(\Gamma\alpha',\Gamma\beta'):\sigma\in\Gamma\alpha'\beta'\}.\]
(Importantly, one must check that $m(\alpha,\beta,\sigma)$ only depends on $\Gamma\sigma\Gamma$, for example.) Thus, we may extrapolate a definition of $T_\alpha\cdot T_\beta$ from the right-hand side above. A direct computation shows that this multiplication is associative, so we get a (a priori non-commutative) ring; the identity is $T_{I_2}$. (This is not immediate from composition being commutative, sadly.)

We would like to show that $\mc R$ is commutative. Approximately speaking $\mc R$ is the convolution algebra on $\Gamma\backslash\op{GL}_2(\QQ)^+/\Gamma$, so this will be done by providing an anti-involution on the level of these double cosets. As such, we want to understand these double cosets more.
\begin{lemma} \label{lem:gl2-double-coset}
	We have
	\[\Gamma\backslash\op{GL}_2(\QQ)^+/\Gamma=\left\{\Gamma\begin{bmatrix}
		d_1 \\ & d_2
	\end{bmatrix}\Gamma:d_1,d_2\in\QQ,\frac{d_1}{d_2}\in\ZZ^+\right\}.\]
\end{lemma}
\begin{proof}
	For $\alpha\in\op{GL}_2(\QQ)^+$, we need to show that $\Gamma\alpha\Gamma$ has a unique representative in the required form. Existence follows by putting (some positive integer multiple of) $\alpha$ into Smith normal form. Uniqueness follows by a direct computation of what elements of $\Gamma\begin{bsmallmatrix}
		d_1 \\ & d_2
	\end{bsmallmatrix}\Gamma$ look like.
\end{proof}
\begin{proposition}
	The Hecke algebra $\mc R$ is commutative.
\end{proposition}
\begin{proof}
	We must show that $m(\alpha,\beta;\sigma)=m(\beta,\alpha;\sigma)$. It is enough to show that $m(\alpha,\beta;\sigma)=m(\beta,\alpha;\sigma^\intercal)$ because $T_{\sigma}=T_{\sigma^\intercal}$ by selecting the representative $\sigma$ to be diagonal (via the above lemma).

	It will be useful to have some explicit representatives for \Cref{lem:double-coset-quotient}. Begin with any choice of representatives $\{\alpha_i\}$, and then replace a given $\alpha_i$ with an element of $\Gamma\alpha_i\cap\alpha_i^\intercal\Gamma$ so that
	\[\Gamma\alpha\Gamma=\bigcup_i\Gamma\alpha_i=\bigcup_i\alpha_i\Gamma.\]
	We similarly set $\{\beta_j\}$ and $\{\sigma_k\}$ for representatives for \Cref{lem:double-coset-quotient}. Then
	\[\{(i,j):\sigma\in\Gamma\alpha_i\beta_j\Gamma\}=\sum_km(\alpha,\beta;\sigma_k)=\left|\frac{\Gamma\sigma\Gamma}\Gamma\right|m(\alpha,\beta;\sigma).\]
	We now take $\alpha\mapsto\alpha^\intercal$ and $\beta\mapsto\beta^\intercal$ on the left-hand side to see that $m(\alpha,\beta;\sigma)=m(\beta,\alpha;\sigma^\intercal)$.
\end{proof}
\begin{notation}
	Now that our Hecke operators are commutative, we will choose to write $T_\alpha$ on the left, writing $T_\alpha f$ for $f|T_\alpha$.
\end{notation}
We next show that these Hecke operators are self-adjoint. This requires an inner product.
\begin{definition}[Petersson inner product]
	Fix cusp forms $f$ and $g$ of weight $k$ and some level $\Gamma(N)$. Then we define
	\[\langle f,g\rangle\coloneqq\frac1{[\op{SL}_2(\ZZ):\Gamma(N)]}\int_{\Gamma(N)\backslash\HH}f(z)\ov{g(z)}\,y^k\frac{dx\,dy}{y^2}.\]
\end{definition}
One can check that $f$ and $g$ being modular forms implies that the integral is well-defined. Being a cusp form implies that the integral converges (in particular, it will vanish rapidly approaching any cusp of the compact space $\Gamma(N)\backslash\HH^*$).
\begin{proposition}
	Each operator $T_\alpha\in\mc R$ is self-adjoint with respect to the Petersson inner product.
\end{proposition}
\begin{proof}
	Fix cusp forms $f$ and $g$ and some $\alpha\in\op{GL}_2(\QQ)^+$. Light rearrangement verifies $\langle f|_\alpha,g\rangle=\langle f,g|_{\alpha^{-1}}\rangle$. For example, this implies that the computed inner product only depends on the ambient double coset $\Gamma\alpha\Gamma$. As such, we compute
	\[\langle T_\alpha f,g\rangle=\left|\frac{\Gamma\alpha\Gamma}{\Gamma}\right|\langle f|_\alpha,g\rangle,\]
	and we can now move the $\alpha$ over to $g$ and rearrange everything back into $\langle f,T_\alpha g\rangle$ after a little work.
\end{proof}
Thus, $\mc R$ becomes a commutative family of self-adjoint operators acting on the finite-dimensional vector space $S_k(\Gamma)$, so the operators in $\mc R$ are simultaneously diagonalizable by a basis of ``Hecke eigenforms.''

Our last goal is to show that $L(f,s)$ for Hecke eigenforms $f$ admit Euler products. For this, we will use a special subset of Hecke operators.
\begin{notation}
	For positive integer $n$, we define
	\[T_n\coloneqq\sum_{\substack{d_1d_2=n\\d_2\mid d_1}}T_{\op{diag}(d_1,d_2)}.\]
	Letting $\Delta_n\subseteq\ZZ^{2\times2}$ be the subset with determinant $n$, the proof of \Cref{lem:gl2-double-coset} implies
	\[T_nf=\sum_{\Gamma\delta\subseteq\Delta_n}f|_\delta.\]
\end{notation}
Let's compute some representatives.
\begin{lemma}
	For positive integer $n$, we have
	\[\Delta_n=\bigsqcup_{\substack{a,d>0\\ad=n\\0\le b<d}}\Gamma\begin{bmatrix}
		a & b \\ d
	\end{bmatrix}.\]
\end{lemma}
\begin{proof}
	The backward inclusion is clear. The union being disjoint is a direct computation. Lastly, the forward inclusion follows by picking up some element of $\Delta_n$ and doing row-reduction to adjust the bottom-left entry.
\end{proof}
We now compute the behavior of $T_n$.
\begin{lemma} \label{lem:compute-hecke-operator}
	For a cusp form $f$ of weight $k$ and level $\Gamma$ with Fourier expansion $f=\sum_{m\ge1}a_mq^m$, we have
	\[T_nf=\sum_{m\ge1}\Bigg(\sum_{\substack{ad=n\\a\mid m}}\left(\frac ad\right)^{k/2}da_{md/a}\Bigg)q^m.\]
\end{lemma}
\begin{proof}
	Direct expansion with the above lemma shows
	\[T_nf(z)=\sum_{\substack{ad=n\\0\le b<d}}\sum_{m\ge1}\left(\frac ad\right)^ka_me^{2\pi im(az/d)}e^{2\pi im(b/d)}.\]
	Now, we sum over $b$ and rearrange the sum into the desired result.
\end{proof}
\begin{lemma}
	Fix a nonzero cusp Hecke eigenform $f$ of weight $k$ where the operator $T_n$ has eigenvalue $n^{1-k/2}\lambda_n$ for some function $\lambda$. Give $f$ the Fourier expansion $f=\sum_{m\ge1}a_mq^m$.
	\begin{listalph}
		\item $a_1\ne1$.
		\item If $a_1=1$, then $\lambda_m=a_m$ for all $m\ge1$.
		\item If $a_1=1$, then the function $a_\bullet$ is multiplicative.
	\end{listalph}
\end{lemma}
\begin{proof}
	Using the previous lemma, we see that
	\begin{equation}
		n^{1-k/2}\lambda_na_m=\sum_{\substack{ad=n\\a\mid m}}\left(\frac ad\right)^{k/2}da_{md/a}. \label{eq:recursive-hecke}
	\end{equation}
	If $\gcd(m,n)=1$, then the sum must have $(a,d)=(1,n)$, so the sum collapses to $\lambda_na_m=a_{mn}$. The result follows.
\end{proof}
And here is our result.
\begin{theorem}
	Fix a nonzero cusp Hecke eigenform $f$ of weight $k$. Give $f$ the Fourier expansion $f=\sum_{m\ge1}a_mq^m$, scaled so that $a_1=1$. Then
	\[L(s,f)=\prod_p\frac1{1-a_pp^{-s}+p^{k-1-2s}}.\]
\end{theorem}
\begin{proof}
	The previous lemma yields
	\[L(s,f)=\prod_p\Bigg(\sum_{\nu=0}^\infty A\left(p^\nu\right)p^{-\nu s}\Bigg),\]
	so we want to compute this infinite sum. Well, \eqref{eq:recursive-hecke} provides the two-term recurrence
	\[a_{p^{\nu+1}}-a_pa_{p^\nu}+p^{k-1}a_{p^{\nu-1}}=0,\]
	from which we can evaluate the sum.
\end{proof}
Let us conclude by saying a little about Hecke operators attached to congruence subgroups $\Gamma(n)$. We require two important congruence subgroups.
\begin{definition}
	For positive integer $N$, we define
	\begin{align*}
		\Gamma_0(N) &\coloneqq \left\{\begin{bmatrix}
			a & b \\ c & d
		\end{bmatrix}\in\op{SL}_2(\ZZ):c\equiv0\pmod N\right\}, \\
		\Gamma_1(N) &\coloneqq \left\{\begin{bmatrix}
			a & b \\ c & d
		\end{bmatrix}\in\op{SL}_2(\ZZ):a,d\equiv1\pmod N,c\equiv0\pmod N\right\}.
	\end{align*}
	Note $\Gamma(N)\subseteq\Gamma_1(N)\subseteq\Gamma_0(N)$.
\end{definition}
It will be helpful to be able to twist a modular form by a Dirichlet character.
\begin{definition}
	For a weight $k$ and positive integer $N$, we define
	\[M_k(\Gamma_0(N),\chi)\coloneqq\left\{f\in M_k(\Gamma_0(N)):f|_\gamma=\chi(d)f\text{ for }\gamma=\begin{bmatrix}
		a & b \\ c & d
	\end{bmatrix}\in\Gamma_0(N)\right\}.\]
	In the sequel, we abbreviate $\chi(d)$ to $\chi(\gamma)$. We define $S_k(\Gamma_0(N),\chi)$ analogously.
\end{definition}
Now, one can show that our characters produce an orthogonal decomposition
\[S_k(\Gamma_1(N))=\bigoplus_{\chi\pmod N}S_k(\Gamma_0(N),\chi).\]
As such, it suffices to define Hecke operators on the spaces $M_k(\Gamma_0(N),\chi)$ and reassemble later. One does this essentially by doing double coset computations with $\Gamma_0(N)\backslash\op{GL}_2(\ZZ_N)^+/\op{GL}_2(\ZZ)$, where $\ZZ_N$ refers to the localization. The arguments of the above theory more or less goes through.

\subsection{Twisting}
We are going to discuss a few converse theorems. The proofs are rather technical, so (as usual) we will not include them in any nontrivial detail.

The moral of the story is that we produced a functional equation for our $L$-function by taking the Mellin transform of a functional equation of a modular form. Morally, one should be able to take the functional equation for the $L$-function and then take the inverse Mellin transform to recover the functional equation of a modular form. In particular, an $L$-function satisfying a suitable functional equation will then be forced to arise from a modular form!

Following Bump, we will sketch two results of this type.
\begin{theorem} \label{thm:hecke-converse}
	Fix a nonnegative integer $k$ and a sequence $\{a_m\}_{m\ge1}$ be a sequence of complex numbers of polynomial growth, and define
	\[L(s)\coloneqq\sum_{n\ge1}\frac{a_n}{n^s}.\]
	Assume the following.
	\begin{listalph}
		\item Analytic continuation: $\Lambda(s)\coloneqq(2\pi)^{-s}\Gamma(s)L(s,f)$ has an analytic continuation to all $s\in\CC$.
		\item Bounded: $\Lambda(s,f)$ is bounded in vertical strips $\{s:\sigma_1\le\Re s\le\sigma_2\}$.
		\item Functional equation: we have $\Lambda(s)=(-1)^{k/2}\Lambda(k-s)$.
	\end{listalph}
	Then $f\coloneqq\sum_{m\ge1}a_mq^m$ lives in $S_k(\op{SL}_2(\ZZ))$.
\end{theorem}
\begin{remark}
	By controlling the pole produced by a modular form which is not a cusp form, one can state a similar result valid for modular forms.
\end{remark}
As outlined above, we want two lemmas.
\begin{lemma} \label{lem:mellin-inversion}
	For continuous $\varphi\colon\RR^+\to\CC$, we note that the Mellin transform
	\[\mc Mf(s)\coloneqq\int_{\RR^+}\varphi(y)y^s\,\frac{dy}y\]
	is converges absolutely on some vertical strip $\{s:\sigma_1\le\Re s\le\sigma_2\}$. Then for $\sigma$ in this strip, we see
	\[\varphi(y)=\frac1{2\pi i}\int_{\Re s=\sigma}\varphi(s)y^{-s}\,ds.\]
\end{lemma}
\begin{proof}
	Bump proves this by relating the Mellin transform to the Fourier transform (which can be done via the isomorphism $\exp\colon\RR\to\RR^+$ of topological groups) and then appealing Fourier inversion. One can also prove this in the same way as the Fourier inversion formula.
\end{proof}
\begin{lemma}[Phragm\'en--Lindel\"of] \label{lem:pl-principle}
	Fix a function $f$ holomorphic on some strip $\{s:\sigma_1\le\Re s\le\sigma_2,\Im s>c\}$ and satisfying a growth condition $f(\sigma+it)=O\left(e^{t^\alpha}\right)$ (as $t\to\infty$) for some real $\alpha$. Then if $f(\sigma+it)=O\left(t^M\right)$ (as $t\to\infty$) for $\sigma\in\{\sigma_1,\sigma_2\}$, then the same bound holds uniformly for $\sigma\in[\sigma_1,\sigma_2]$.
\end{lemma}
\begin{proof}
	By replacing $f$ with $f(s)/s^M$, we may assume that $M=0$. Without loss of generality, we may take $t$ large so that the desired strip occupies a small sector of $\CC$. By shifting and dividing up $[\sigma_1,\sigma_2]$, we may assume that $\sigma_2>0$ is small and $\sigma_1=-\sigma_2$. The point is that our arguments are close to $\pi/2$, so we choose $m\equiv2\pmod4$ of moderate size so that $m\arg s\approx\pi$ for desired $s$. Now, for small $\varepsilon>0$, we consider
	\[g_\varepsilon(s)\coloneqq f(s)e^{\varepsilon s^m}.\]
	One can show that $g_\varepsilon(s)$ is bounded on a rectangle determined by the constraints of $f$, so one receives a bound on $f$ by taking $\varepsilon\to0^+$.
\end{proof}
We now prove \Cref{thm:hecke-converse}.
\begin{proof}[Proof of \Cref{thm:hecke-converse}]
	Define $f$ as in the conclusion, and we want to show that $f\in S_k(\op{SL}_2(\ZZ))$. (The polynomial growth condition on $a_\bullet$ is included so that $L(s)$ converges for $\Re s$ large.) Note $f$ has a Fourier expansion, so $f(z+1)=f(z)$ already; it is thus sufficient to check the functional equation for $\begin{bsmallmatrix}
		0 & -1 \\ 1 & 0
	\end{bsmallmatrix}$. By analytic continuation, we may check the functional equation for $iy\in i\RR^+$. Now, we recall that
	\[\int_{\RR^+}f(iy)y^s\,\frac{dy}y=\Lambda(s),\]
	so Mellin inversion (\Cref{lem:mellin-inversion}) yields
	\[f(iy)=\frac1{2\pi i}\int_{\Re s=\sigma}\Lambda(s)y^{-s}\,ds.\]
	Now, we use the functional equation to replace $s$ with $k-s$. Note $\Lambda$ exhibits rapid decay for $\Re s$ very large and very small, so \Cref{lem:pl-principle} tells us that we exhibit this rapid decay uniformly on any vertical strip $\{s:\sigma_1\le\Re s\le\sigma_2\}$. The point is that we don't have to worry about convergence issues, so we send $k-s\mapsto-s$, from the modularity of $f$ follows.
\end{proof}
\begin{remark}
	In fact, if $L(s)$ further admits an Euler product of the form
	\[L(s)=\prod_p\frac1{1-a_pp^{-s}+p^{k-1-2s}},\]
	then $f$ is a Hecke eigenform. The point is that the Euler product implies a particular recursion among the Fourier coefficients, from which one can use \Cref{lem:compute-hecke-operator} to show that we have a Hecke operator with the expected Hecke eigenvalues.
\end{remark}
Our next converse theorem, due to Weil, requires us to twist our modular forms by Dirichlet characters. In particular, we will deduce our converse theorem from twisted functional equations.
\begin{notation}
	For $f\in S_k(\Gamma_0(N),\psi)$ with Fourier expansion $f=\sum_{m\ge1}a_mq^m$ and Dirichlet character $\chi\pmod D$, we define
	\begin{align*}
		f_\chi(z) &\coloneqq \sum_{n=1}^\infty\chi(n)a_nq^n, \\
		L(s,f,\chi) &\coloneqq \sum_{n=1}^\infty\frac{\chi(n)a_n}{n^s}, \\
		\Lambda(s,f,\chi) &\coloneqq (2\pi)^{-s}\Gamma(s)L(s,f,\chi).
	\end{align*}
	Technically, one does not require $f$ to be a modular form.
\end{notation}
Here is our functional equation.
\begin{proposition}
	Fix $f,g\in S_k(\Gamma_0(N))$ and primitive Dirichlet equation $\chi\pmod D$ such that $\gcd(N,D)=1$. If $f=g|_{w_N}$ where $w_N\coloneqq\begin{bsmallmatrix}
		& -1 \\ N
	\end{bsmallmatrix}$, then
	\[\Lambda(s,f,\chi)=i^k\chi(N)\psi(D)\frac{\tau(\chi)^2}D\left(D^2N\right)^{-s+k/2}\cdot\Lambda(k-s,g,\ov\chi).\]
\end{proposition}
\begin{proof}
	Note that $w_N$ normalizes $\Gamma_0(N)$, so our hypothesis at least makes sense. A discrete Fourier transform shows
	\[f_\chi=\frac{\chi(-1)\tau(\chi)}D\sum_{m\in(\ZZ/D\ZZ)^\times}\ov\chi(m)f|_{\begin{bsmallmatrix}
		D & m \\ & D
	\end{bsmallmatrix}}.\]
	For example, one can use some rearrangement to shows that this implies
	\begin{align*}
		f_\chi|_{\begin{bsmallmatrix}
			& -1 \\ D^2N
		\end{bsmallmatrix}} &= \chi(N)\frac{\tau(\chi)}{D}\sum_{r\in(\ZZ/D\ZZ)^\times}\chi(r)g|_{\begin{bsmallmatrix}
			D & -r \\ -Nm & s
		\end{bsmallmatrix}\begin{bsmallmatrix}
			D & r \\ & D
		\end{bsmallmatrix}} \\
		&= \chi(N)\psi(D)\frac{\tau(\chi)^2}D\cdot g_{\ov\chi}.
	\end{align*}
	Now, in the usual way, plug in $iy$ into this equation and apply the Mellin transform to conclude.
\end{proof}
One would like a converse theorem from these functional equations.
\begin{theorem}[Weil]
	Fix a positive integer $N$ and Dirichlet character $\psi\pmod N$. Further, fix sequences of complex $\{a_m\}$ and $\{b_m\}$ exhibiting polynomial growth, and define the functions $f\coloneqq\sum_{m}a_mq^m$ and $g\coloneqq\sum_mb_mq^m$ so that we can define $L(s,f,\chi)$ and so on as usual. Lastly, fix a finite set of primes $S$ (including the prime divisors of $N$), and we assume the following for all Dirichlet characters $\chi$ with conductor $D$ or a prime not in $S$.
	\begin{listalph}
		\item Analytic continuation: $\Lambda(s,f,\chi)$ and $\Lambda(s,g,\ov\chi)$ has an analytic continuation to all $s\in\CC$.
		\item Bounded: $\Lambda(s,f,\chi)$ and $\Lambda(s,g,\ov\chi)$ are bounded in vertical strips.
		\item Functional equation: we have
		\[\Lambda(s,f,\chi)=i^k\chi(N)\psi(D)\frac{\tau(\chi)^2}D\left(D^2N\right)^{-s+k/2}\Lambda(s,g,\ov\chi).\]
	\end{listalph}
	Then $f\in S_k(\Gamma_0(N),\psi)$.
\end{theorem}
\begin{proof}
	Several pages of manipulation of $2\times2$ matrices. The primary difficulty is that $\Gamma_0(N)$ may potentially have lots of generators, so the same proof technique will not work verbatim. Nonetheless, redoing the proof of \Cref{thm:hecke-converse} does imply
	\[f_\chi|_{\begin{bsmallmatrix}
		& -1 \\ D^2N
	\end{bsmallmatrix}}=\chi(N)\psi(D)\frac{\tau(\chi)^2}D\cdot g_{\ov\chi}.\]
	One now does a lengthy computation to bootstrap this into the required result.
\end{proof}

\section{June 20}
Today we plan on covering \S1.6--1.8.

\subsection{The Rankin--Selberg Method}
In short, the Rankin--Selberg method integrates some automorphic form by an Eisenstein series to produce certain $L$-functions which provably desirable properties. As such, we begin by discussing our required Eisenstein series.
\begin{definition}[Eisenstein series]
	For $z\in\HH$ and $s\in\CC$, we define the \textit{Eisenstein series}
	\[E(z,s)\coloneqq\pi^{-s}\Gamma(s)\cdot\frac12\sum_{\substack{(m,n)\in\ZZ^2\\(m,n)\ne(0,0)}}\frac{y^s}{\left|mz+n\right|^{2s}}.\]
	This series converges absolutely for $\Re s>1$ and thus descends to a holomorphic map on $z\in\op{Sl}_2(\ZZ)\backslash\HH$.
\end{definition}
We will require a functional equation for $E$ (in addition to some growth properties). Our approach will proceed by computing the Fourier coefficients of $E$, a notion which makes sense because $E(z+1,s)=E(z)$, for which we will use Bessel functions.
\begin{definition}[Bessel function]
	For $s\in\CC$ and $y>0$, we define the \textit{Macdonald Bessel function}
	\[K_s(y)\coloneqq\frac12\int_{\RR^+}e^{-y\left(t+t^{-1}\right)/2}t^s\,\frac{dt}t.\]
	This series converges (rapidly) for $y>0$. Note $K_s(y)=K_{-s}(y)$.
\end{definition}
\begin{remark} \label{rem:rapid-decay-bessel}
	Let's provide a basic bound. For $y>4$, one sees $e^{-y\left(t+t^{-1}\right)/2}<e^{-y/2}e^{t+t^{-1}}$, so integrating proves
	\[\left|K_s(y)\right|\le e^{-y/2}K_{\op{Re}s}(2).\]
\end{remark}
The following is the main reason for introducing Bessel functions.
\begin{lemma} \label{lem:use-bessel}
	For $s\in\CC$ with $\Re s>1/2$ and $r\in\RR$, we have
	\[\left(\frac y\pi\right)^s\Gamma(s)\int_\RR\left(x^2+y^2\right)^{-s}e^{2\pi irx}\,dx=\begin{cases}
		\pi^{-s+1/2}\Gamma(s-1/2)y^{1-s} & \text{if }r=0, \\
		2\left|r\right|^{s-1/2}\sqrt yK_{s-1/2}(2\pi\left|r\right|y) & \text{if }r\ne0.
	\end{cases}\]
\end{lemma}
\begin{proof}
	We let $L$ denote the left-hand side. Expanding our $\Gamma(s)$ and interchanging integrals, we see
	\[L=\int_{\RR^+}\underbrace{\int_\RR e^{-\pi t\left(x^2+y^2\right)/y}e^{2\pi irx}\,dx}_{\sqrt{y/t}e^{-t\pi r^2/t}}\,t^s\frac{dt}t,\]
	where the inner integral is computed as the Fourier transform of a Gaussian. Casework on $r$ now completes the proof.
\end{proof}
\begin{proposition} \label{prop:fourier-expansion-eisenstein}
	Write $E(z,s)=\sum_{r\in\ZZ}q_r(y,s)e^{2\pi irx}$. Then
	\[a_r(y,s)=\begin{cases}
		\pi^{-s}\gamma(s)\zeta(2s)y^s+\pi^{s-1}\Gamma(1-s)\zeta(2-2s)y^{1-s} & \text{if }r=0, \\
		2\left|r\right|^{s-1/2}\sigma_{1-2s}(\left|r\right|)\sqrt yK_{s-1/2}(2\pi\left|r\right|y) & \text{if }r\ne0.
	\end{cases}\]
\end{proposition}
\begin{proof}
	We are tasked with computing
	\[a_r(y,s)=\int_{\RR/\ZZ}E(x+iy)e^{-2\pi irx}\,dx=\pi^{-s}\Gamma(s)y^2\cdot\frac12\sum_{\substack{(m,n)\in\ZZ^2\\(m,n)\ne(0,0)}}\frac{e^{-2\pi irx}}{\left|m(x+iy)+n\right|^{2s}}\,dx.\]
	If $m=0$, then we only get contribution when $r=0$, in which case we total to $\pi^{-s}\Gamma(s)\zeta(2s)y^2$. If $m\ne0$, then our contribution comes out to
	\[\pi^{-s}\Gamma(s)y^s\sum_{m=1}^\infty\sum_{n\in\ZZ}\int_{0}^1\frac{e^{2\pi irx}{\left((mx+n)^2+m^2y^2\right)^s}}\,dx.\]
	Sending $x\mapsto x-n/m$ and then isolating a sum over $\sum_ne^{2\pi irn/m}$ shows we get
	\[\pi^{-s}\Gamma(s)y^s\sum_{m\mid r}m^{1-2s}\int_\RR\left(x^2+y^2\right)^{-s}e^{2\pi irx}\,dx.\]
	Plugging into \Cref{lem:use-bessel} and totaling contributions completes the proof.
\end{proof}
\begin{corollary} \label{cor:eisenstein-continuation}
	The function $E(z,s)$ admits a meromorphic continuation to $s\in\CC$ with at worst simple poles only ad $s\in\{0,1\}$. Further, we have the functional equation $E(z,s)=E(z,1-s)$ and growth condition $E(x+iy,s)=O\left(y^\sigma\right)$ as $y\to\infty$ and $\Re s\in[1-\sigma,\sigma]$.
\end{corollary}
\begin{proof}
	The analytic continuation follows from examining the Fourier series in \Cref{prop:fourier-expansion-eisenstein}; notably $a_0$ has poles only at $s\in\{0,1\}$, and otherwise the series converges rapidly (use \Cref{rem:rapid-decay-bessel}). The functional equation also follows from Fourier series upon checking that $a_n(y,s)=a_n(y,1-s)$.
\end{proof}
For the application, it will be useful to have a different series expansion for $E$. Instead of summing over $(m,n)\ne(0,0)$, we sum $(Nc,Nd)$ where $N>0$ and $(c,d)\in\ZZ^2$ with $\gcd(c,d)=1$. A computation shows
\[\frac{y^s}{\left|mz+n\right|^{2s}}=N^{-2s}\Im\left(\begin{bmatrix}
	1 & n \\ & 1
\end{bmatrix}z\right)^s,\]
so we let $\Gamma_\infty\coloneqq\left\{\begin{bsmallmatrix}
	1 & n \\ & 1
\end{bsmallmatrix}:n\in\ZZ\right\}$ denote the stabilizer of $\infty$ in $\op{SL}_2(\ZZ)$. Thus,
\[E(z,s)=\pi^{-s}\Gamma(s)\zeta(2s)\sum_{\gamma\in\ov{\Gamma_\infty}\backslash\op{PSL}_2(\ZZ)},\]
where $\ov{\Gamma_\infty}$ denotes the image of $\Gamma_\infty$ in $\op{PSL}_2(\ZZ)$.

Now here is our result.
\begin{proposition} \label{prop:rankin-selberg}
	Fix a smooth function $\varphi\colon\op{SL}_2(\ZZ)\backslash\HH\to\CC$ such that $\varphi(x+iy)=O\left(y^{-N}\right)$ for all $N>0$. Write $\varphi(z)=\sum_{n\in\ZZ}\varphi_n(y)e^{2\pi inx}$ for the resulting Fourier series. Then we define
	\[\Lambda(s)\coloneqq\pi^{-s}\Gamma(s)\zeta(2s)\mc M\varphi_0(s-1).\]
	Then in fact
	\[\Lambda(s)=\int_{\op{SL}_2(\ZZ)\backslash\HH}E(z,s)\varphi(z)\,\frac{dx\,dy}{y^2},\]
	so $\Lambda(s)$ admits a meromorphic continuation with at worst simple poles at $s\in\{0,1\}$.
\end{proposition}
\begin{proof}
	Note the integral in $\mc M\varphi_0(s)$ converges absolutely for $\op{Re}s>0$ by the growth condition on $\varphi_0$, so $\Lambda$ starts out holomorphic in some right-half plane. Note that the meromorphic continuation will follow from the corresponding facts about $E$ (and rapid decay for $\varphi$) via \Cref{cor:eisenstein-continuation} as soon as we verify the integral representation. For $\Re s>1$, we use the discussion preceding the proposition to see that the integral equals
	\[\pi^{-s}\Gamma(s)\zeta(2s)\int_{\Gamma_\infty\backslash\HH}(\Im z)^s\varphi(z)\frac{dx\,dy}{y^s}\]
	after summing over $\gamma$. Taking $[0,1]\times\RR^+\subseteq\HH$ as a fundamental domain for $\Gamma_\infty\backslash\HH$ completes the proof.
\end{proof}
We now plug in some $\varphi_0$ of some interest.
\begin{theorem}
	Fix cuspidal normalized Hecke eigenforms $f$ and $g$ of weight $k$ and level $\op{SL}_2(\ZZ)$. Then we get Fourier series $f(z)=\sum_{n\ge1}a_nq^n$ and $g(z)=\sum_{n\ge1}b_nq^n$. Define
	\begin{align*}
		L(s,f\times g) &\coloneqq \zeta(2s-2k+2)\sum_{n=1}^\infty a_nb_nn^{-s}, \\
		\Lambda(s,f\times g) &\coloneqq (2\pi)^{-s}\Gamma(s)\Gamma(s-k+1)L(s,f\times g).
	\end{align*}
	Then $\Lambda(s,f\times g)$ admits a meromorphic continuation to all $s\in\CC$ with at worst simple poles at $s\in\{k,k-1\}$ and satisfies the functional equation
	\[\Lambda(s,f\times g)=\Lambda(2k-1-s,f\times g).\]
\end{theorem}
\begin{proof}
	We will apply \Cref{prop:rankin-selberg} to $\varphi_0(z)\coloneqq f(z)\ov{g(z)}(\Im z)^k$. The growth condition is satisfied because $f$ and $g$ are cuspidal, and this descends to a map on $\op{SL}_2(\ZZ)\backslash\HH$ because $f$ and $g$ are modular forms. A direct expansion with the Fourier expansion of $f$ and $g$ shows
	\[\varphi_0(y)=\sum_{m,n\in\ZZ}\int_0^1a_n\ov{b_m}e^{2\pi inx-2\pi ny-2\pi imx-2\pi my}y^k\,dx=\sum_{n=0}^\infty a_nb_ne^{-4\pi ny}y^k\]
	upon integrating and noting $b_n\in\RR$ because they are eigenvalues of a self-adjoint operator. From here, we can compute the Mellin transform as
	\[\mc M\varphi_0(s)=(4\pi)^{-s-k}\Gamma(s+k)\sum_{n=0}^\infty a_nb_nn^{-s-k}.\]
	Shifting $s$, we see $\Lambda(s-k+1)=\pi^{k-1}\Lambda(s,f\times g)$, from which the result follows from \Cref{prop:rankin-selberg}.
\end{proof}
We conclude, in passing, by noting that $L(s,f\times g)$ even admits an Euler product. In the setting of the above theorem, factor
\[1-a_pT+p^{k-1}T^2=\left(1-\alpha_{1p}X\right)\left(1-\alpha_{2p}X\right),\]
and define $\beta_{1p}$ and $\beta_{2p}$ similarly. We will show that
\[L(s,f\times g)=\prod_p\prod_{i,j=1}^2\frac1{1-\alpha_i(p)\beta_j(p)p^{-s}}.\]
Attempting to match up Euler factors on either side, we recall that
\begin{equation}
	\sum_{\nu=0}^\infty a_{p^\nu}T^r=\frac1{1-a_pT+p^{k-1}T^2} \label{eq:almost-geometric-sum}
\end{equation}
and similarly for $b_\bullet$s, so we are essentially tasked with showing
\[\sum_{\nu=0}^\infty a_{p^\nu}b_{p^\nu}T^r\stackrel?=\left(1-\alpha_{p1}\alpha_{p2}\beta_{p1}\beta_{p2}T^2\right)\prod_{i,j=1}^2\frac1{1-\alpha_{pi}\beta_{pj}T}.\]
This is some purely formal algebraic identity. Bump proves this by clever contour integration by considering
\[\frac1{2\pi i}\oint_\gamma\Bigg(\sum_{\nu=0}^\infty a_{p^\nu}(Tq)^r\Bigg)\Bigg(\sum_{\mu=0}^\infty b_{p^\mu}q^{-r}\Bigg)\frac{dq}q,\]
where the contour $\gamma$ is positively oriented around the origin. Expanding the product of the sums produces the desired series over $a_{p^\nu}b_{p^\nu}$; using \eqref{eq:almost-geometric-sum} produces an integral which can be evaluated using residue calculus.

\subsection{Hecke Characters and Hilbert Modular Forms}
We will generalize modular forms and zeta functions away from $\QQ$ to certain number fields. In particular, let $F$ be a totally real number field of degree $n$, and let $\rho_1,\ldots,\rho_n\colon F\to\RR$ be the real embeddings. Eventually, we will want to have $h^+(F)=1$, which concretely means that any ideal has a totally positive generator; however, we will state when this assumption is used. For more notation, we let $\mf d$ denote the different of $F$, and let $D$ denote the discriminant.

The theory is best stated in terms of characters of id\'eles, but we would rather not spend the time required to set up these objects. Instead, we will write everything ideal-theoretically, and instead of working with ideals directly, we will work with explicit field elements whenever possible. As such, many of our arguments requiring checking that certain concepts are independent of units, so we want the following structure theorem.
\begin{theorem}
	Fix $F$ as above. Then $\OO_F^\times$ is finitely generated. In fact, the map
	\[\alpha\mapsto\left(\log\rho_1(\alpha),\ldots,\log\rho_n(\alpha)\right)\]
	is an isomorphism of $\OO_F^\times/\{\pm1\}$ onto a lattice of rank $(n-1)$ inside the trace-zero hyperplane of $\RR^n$.
\end{theorem}
\begin{proof}
	This is a special case of the Dirichlet unit theorem.
\end{proof}
Generalizing Dirichlet characters, we define Hecke characters.
\begin{definition}[Hecke character]
	Fix an ideal $\mf f\subseteq\OO_F$, and let $\chi_{\mf f}\colon(\OO_F/\mf f)^\times\to\CC^\times$ be a character. Then we extend $\chi_{\mf f}$ to a character on $\OO_F$ by taking the value $0$ whenever the input is not coprime with $\mf f$. To make this a character on principal ideals, we must adjust $\chi_{\mf a}$ to be trivial on $\OO_F^\times$, so we define $\chi\coloneqq\chi_{\mf a}\chi_\infty$, where $\chi_\infty$ is chosen so that $\chi|_{\OO_F^\times}=1$ and
	\[\chi_\infty(a)\prod_{i=1}^n\op{sgn}(\sigma_i(a))^{\varepsilon_i}\left|\sigma_i(a)\right|^{\nu_i}\]
	for some $\varepsilon_\bullet$s and $\nu_\bullet$s. As usual, we say that $\chi$ is \textit{primitive} if and only if it is not induced by some $\mf f'$ dividing $\mf f$; we say that $\mf f$ is then the \textit{conductor} of $\chi$.
\end{definition}
\begin{remark}
	Let's explain how to select $\chi_\infty$. Choose the $\varepsilon_\bullet$s so that $\chi$ is trivial on $\OO_F^+$. Then select a basis of $\OO_F^+$ and write down equations which will make $\chi$ trivial on the basis.
\end{remark}
As with Dirichlet characters, we have a notion of Gauss sum.
\begin{definition}[Gauss sum]
	Fix a Hecke character $\chi$ of conductor $\mf f$. Suppose $\mf d=(d)$ and $\mf f=(f)$ where $d,f\in\OO_F$ are totally positive. Then we define the \textit{Gauss sum}
	\[\tau(\chi_\mf f)\coloneqq\sum_{a\in\OO_F/\mf f}\chi_\mf f(a)e^{2\pi i\tr(\alpha/(fd))}.\]
	Importantly, $\tau(\chi_\mf f)$ depends on $d$ and $f$ despite the notation not reflecting this.
\end{definition}
We now may define our $L$-function. For a (primitive) Hecke character $\chi$, we define the $L$-function
\[L(s,\chi)\coloneqq\sum_{\mf a\subseteq\OO_F}\frac{\chi(\mf a)}{\op N(\mf a)^{-s}},\]
which we note has the usual Euler product $\prod_{\mf p}\left(1-\chi(\mf p)\op N(\mf p)^{-s}\right)^{-1}$.
\begin{example}
	If $\chi$ is the trivial character, then we set $\zeta_F\coloneqq L(s,1)$ to be the Dedekind $\zeta$-function. For example, if $F$ is real quadratic, we let $\chi_D$ be the quadratic character with conductor $\left|D\right|$. Noting that prime-splitting behavior in $\OO_F$ is determined by $\chi_D$, one can show that
	\[\zeta_F(s)=\zeta(s)L(s,\chi_D)\]
	by comparing Euler factors.
\end{example}
Here is our analytic continuation and functional equation.
\begin{theorem}
	Fix notation as above, and suppose $h^+(F)=1$. Then define
	\[\Lambda(s,\chi)\coloneqq D^{s/2}\pi^{-ns/2}\prod_{i=1}^n\Gamma\left(\frac{s-\nu_i+\varepsilon_i}2\right)L(s,\chi).\]
	Then $\Lambda(s,\chi)$ has a meromorphic continuation to all $s$ with at worst simple poles at $s\in\{0,1\}$. There is a functional equation
	\[\Lambda(s,\chi)=\frac{\chi_{\mf f}(-1)\chi_\infty(fd)\tau(\chi_{\mf f})}{\sqrt{\op N(\mf f)}}\cdot i^{\tr\varepsilon}\op N(\mf f)^{-s+1/2}\Lambda\left(1-s,\chi^{-1}\right).\]
\end{theorem}
\begin{proof}
	This proof is a direct generalization of the proof for Dirichlet characters. We describe the required ingredients for the generalization. We require a Fourier transformation for functions $h$ on $\RR^n/\ZZ^n$, for which we take as
	\[\mc Fh(x)\coloneqq\frac1{\sqrt D}\int_{\RR^n}h(y)e^{2\pi i\tr(xy/d)}\,dy,\]
	a formula more or less arising from the theory of locally compact abelian groups. For Schwartz functions, \Cref{prop:poisson-sum} now generalizes to the statement
	\[\sum_{a\in\OO_F}h(a)=\sum_{a\in\OO_F}\mc Fh(a),\]
	and \Cref{cor:twisted-poisson-sum} generalizes to
	\[\tau(\ov\chi_\mf f)\sum_{a\in\OO_F}\chi_\mf f(a)F(a)=\sum_{a\in\OO_F}\ov\chi_\mf f(a)\mc Fh(a/f)\]
	using Fourier analysis on $\OO_F/\mf f$. Now, one computes the Fourier transform of the corresponding Gaussian $x\mapsto\op N(x^\varepsilon) e^{-\pi\tr\left(tx^2/d\right)}$ (where $\op N(x)$ means multiplying the coordinates).

	With our Fourier analysis properly set up, we define
	\[\Theta_{\chi_\mf f}(t)\coloneqq\sum_{a\in\OO_F}\chi_\mf f(a)\op N(a)^\varepsilon e^{-\pi\tr\left(ta^2/d\right)},\]
	from which Poisson summation produces the functional equation
	\[\Theta_{\chi_\mf f}(t)=\frac1{\tau(\ov\chi_\mf f)}\frac1{\sqrt{\op N(t)}}\op N((i/ft)^\varepsilon)\Theta_{\ov\chi_\mf f}\left(\frac1{f^2t}\right).\]
	Now, for $\Re s$ sufficiently large, one computes the Mellin transform
	\[\int_{\RR^{n+}/\OO_F^+}\Theta_{\chi_\mf f}(t)\op N\left(t^{(s+\varepsilon-\nu)/2}\right)\frac{\op N(dt)}{\op N(t)}=2\pi^{-\tr\varepsilon}\op N\left(d^{(\varepsilon-\nu)/2}\right)\Lambda(s,\chi),\]
	from which the functional equation and meromorphic continuation follow from the corresponding properties of $\Theta$. (If $\chi$ is trivial, then the integral does not actually converge for enough $s$, so we need to subtract out the pole before taking the Mellin transform to produce the meromorphic continuation.)
\end{proof}
We now turn our attention to Hilbert modular forms. We will write $\begin{bsmallmatrix}
	a & b \\ c & d
\end{bsmallmatrix}$ where $a,b,c,d\in\RR^n$ to refer to $n$-tuple of matrices $\begin{bsmallmatrix}
	a_\bullet & b_\bullet \\ c_\bullet & d_\bullet
\end{bsmallmatrix}$. Then we note that $\op{SL}_2(F)\subseteq\op{SL}_2(\RR)^n$ has a sublattice $\op{SL}_2(\OO_F)\subseteq\op{SL}_2(F)$, which will inherit the natural action on $\HH^n$. The action is discontinuous (roughly speaking, $\op{SL}_2(\OO_F)\subseteq\op{SL}_2(F)$ is cocompact), and the quotient has finite volume with respect to the invariant measure $dx\,dy/y^2$. The theory of complex manifolds allows us to compactify $\Gamma\backslash\HH^n$, essentially by taking the quotient by $(\HH^n)^*\coloneqq\HH^n\sqcup\PP^1_F$. Importantly, the resulting quotient is an algebraic complex variety, but it need not be smooth.

We are now ready to define a Hilbert modular form. For the remainder of this subsection, we always take $h^+(F)=1$.
\begin{definition}[Hilbert modular form]
	Fix an even nonnegative integer $k$. A \textit{Hilbert modular form} $f$ of weight $k$ is a holomorphic function $f\colon\HH^n\to\CC$ such that
	\[f(z)=\op N(cz+d)^{-k}f(\gamma(z))\]
	for all $\gamma\in\op{SL}_2(\OO_F)$.
\end{definition}
Importantly, if $n\ge2$, because $f$ is holomorphic, it will turn out that $f$ is automatically holomorphic on the cusps of $\HH^{n*}$. (Approximately speaking, this is intuitively because being holomorphic outside a set of codimension at least $2$ implies being holomorphic everywhere.)
\begin{remark}
	Let $f$ be a Hilbert modular form of weight $k$. Take $h^+(F)=1$ so that we can write $\mf d=(d)$ for totally positive $d$. Then $a\in\OO_F$ has $f(z+a)=f(z)$, so $f$ descends to a function on $\RR^n/\OO_F$. As such, Fourier analysis on $\RR^n/\OO_F$ produces the Fourier expansion
	\[f(z)=\sum_{\nu\in\OO_F}a_\nu e^{2\pi i\tr(\nu z/d)}.\]
	It turns out that $a_\nu=0$ unless $\nu$ is zero or is totally positive. In fact, $a_\nu=a_{\varepsilon\nu}$ for any totally positive unit $\varepsilon$ by writing the totally positive unit $\varepsilon$ as a square. (This uses $h^+(F)=1$.)
\end{remark}
The previous remark tells us that $a_\bullet$ descends from a function on $\OO_F$ to a function on ideals. Thus, we define
\[L(s,f)\coloneqq\sum_{\mf a\subseteq\OO_F}\frac{a_\mf a}{\op N(\mf a)^s}.\]
One can prove a growth condition on the $a_\mf a$, which promises that this converges for large $\Re s$.
\begin{remark}
	We will not do this, but one can build a Hecke theory analogously to the case where $F=\QQ$ in order to define a notion of a Hecke eigenform and prove a resulting Euler product.
\end{remark}
Here is our functional equation.
\begin{definition}
	Continue supposing $h^+(F)=1$, and let $f$ denote a Hilbert modular cusp form of weight $k$, where $k$ is an even nonnegative integer. Then define
	\[\Lambda(s,f)\coloneqq(2\pi)^{-ns}\Gamma(s)^nD^sL(s,f),\]
	where we recall $D\coloneqq\op{disc}F$. Then $\Lambda(s,f)$ has an analytic continuation to all $s\in\CC$ and satisfies
	\[\Lambda(s,f)=(-1)^{nk/2}\Lambda(k-s,f).\]
\end{definition}
\begin{proof}
	The Fourier expansion of $f$ and some rearranging is able to show that
	\[\Lambda(s,f)=\int_{\OO_F^+\backslash\RR^{n+}}f(iy)\op N(y)^s\,\frac{dy}y.\]
	Notably, this integral is convergent for any $s$ because $f$ is a cusp form, so $y_\bullet\to\infty$ means that $f$ rapidly decays, and $y_\bullet\to0$ still makes $f$ rapidly decay because
	\[f(i/y)=(-1)^{nk/2}\op N(y)^kf(iy).\]
	The above functional equation $f$ in fact provides the functional equation for $\Lambda$.
\end{proof}
We will spend the remainder of the chapter proving the following (quadratic) base-change result.
\begin{theorem}
	Fix a real quadratic field $F$ such that $h^+(F)=1$, and set $D\coloneqq\op{disc}F$. If $\varphi$ is a Hecke eigenform of weight $k$ and level $\op{SL}_2(\ZZ)$, then there is a unique Hilbert modular form $f$ such that
	\[L(s,f)=L(s,\varphi)L(s,\varphi,\chi_D).\]
\end{theorem}
\begin{remark}
	One can expand the right-hand side into Euler factors to reveal that its Euler product does in fact look like $L(s,f)$ for a Hilbert modular form $f$. However, it is rather difficult to check that the corresponding Fourier series is actually a Hilbert modular form, so we see that the main content of the above theorem is the existence.
\end{remark}

\end{document}